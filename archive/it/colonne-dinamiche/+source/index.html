<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Colonne Dinamiche - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Colonne Dinamiche - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/it/colonne-dinamiche/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/it/colonne-dinamiche/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/it/colonne-dinamiche/+source/" rel="nofollow">Accesso</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/it/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/it/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/it/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/it/mariadb-italiano/">MariaDB - Italiano</a>
    

    
    » <a class="crumb" href="/kb/it/documentazione-di-mariadb/">Documentazione di MariaDB</a>
    

    
    » <a class="crumb" href="/kb/it/nosql/">NoSQL</a>
    


    » <a class="node_link crumb" href="/kb/it/colonne-dinamiche/">Colonne Dinamiche</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/it/">Pagina iniziale</a></li>
                            
                                
                                <li><a href="/kb/it/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/it/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/it/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/it/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/it/colonne-dinamiche/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Colonne Dinamiche - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revisione</dt>
            <dd><a href="/kb/it/colonne-dinamiche/+r/11882/">11882</a></dd>
            <dt>Utente</dt>
            <dd>
<span class="user" id="user-982">
<a href="/kb/user/id/982" title="Federico Razzoli">Federico Razzoli</a>
</span></dd>
            <dt>Data</dt>
            <dd>

<span class="datetime" title="2012-09-28 12:18">2012-09-28 12:18</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;


Le Colonne Dinamiche permettono di memorizzare un insieme di &#34;colonne virtuali&#34; per ogni riga della tabella.

E&#39; possibile aggiungere o rimuovere tali colonne da un record in qualsiasi momento.

Questa funzionalità permette di risolvere problemi come un&#39;applicazione per un negozio, dove si hanno molti articoli diversi - come t-shirt e telefoni - e si desidera che ognuno di questi elementi abbia un differente insieme di attributi. Normalmente è molto difficile ottenere questo con un database relazionale.

Le Colonne Dinamiche memorizzano le colonne aggiuntive in un campo BLOB e per gestirle si utilizzano alcune funzioni particolari. Questa caratteristica è stata implementata in [[what-is-mariadb-53|MariaDB 5.3]].

E&#39; anche possibile manipolare le Colonne Dinamiche in SQL o nel client.

La struttura originale delle Colonne Dinamiche è stata realizzata nel MWL#34. Lì sono reperibili ulteriori informazioni su come i dati vengono memorizzati.

La prima implementazione delle Colonne Dinamiche punta a essere altamente efficiente per i programmi che compongono query SQL (probabilmente la maggior parte delle applicazioni per la vendita oggi utilizza questo metodo). Ecco perché si accede alle Colonne Dinamiche identificandole con dei numeri. Ti veda la sezione TO-DO più in basso per ulteriori informazioni sugli sviluppi futuri.

== Funzioni SQL

=== Creare un oggetto per le Colonne Dinamiche

&lt;&lt;code&gt;&gt;
COLUMN_CREATE(numero_colonna, valore [as tipo], [numero_colonna, valore [as tipo]]...)
&lt;&lt;/code&gt;&gt;

* &#39;##tipo##&#39; non è obbligatorio ed è stato aggiunto principalmente per il testing, eccetto casi in cui date e orari potrebbero non essere convertite nel tipo desiderato.

=== Aggiungere o aggiornare le Colonne Dinamiche

&lt;&lt;code&gt;&gt;
COLUMN_ADD(colonna_dinamica, numero_colonna, valore [as tipo], [numero_colonna, valore [as tipo]]...)
&lt;&lt;/code&gt;&gt;

* &#39;##colonna_dinamica##&#39; deve essere il dato creato con ##COLUMN_CREATE()## o una stringa vuota.
* Se &#39;##colonna_dinamica##&#39; è ##NULL## la funzione restituisce ##NULL##.
* Se si aggiunge una colonna già esistente, il vecchio valore verrà sostituito.
* Se si imposta una colonna a ##NULL##, questa verrà cancellata.
* Il tipo non è obbligatorio (viene rilevato automaticamente) e il parametro è stato aggiunto principalmente per i test.

Uso tipico:

&lt;&lt;sql&gt;&gt;
UPDATE t1 SET col_dinamica=COLUMN_ADD(col_dinamica, 5, &#34;prova&#34;) WHERE id=1;
&lt;&lt;/sql&gt;&gt;

In questo esempio, viene aggiunta o sostituita la ##col_dinamica## numero &#39;##5##&#39;, nella quale sarà memorizzato il valore ##&#34;prova&#34;##, nel record avente ##id=1##

##col_dinamica## è scritto due volte perchè ##COLUMN_ADD()## è una normale funzione, come ad esempio ##[[concat|CONCAT()]]##; si desidera rimpiazzare il vecchio valore contenuto in &#39;##col_dinamica##&#39; con il nuovo valore restituito da ##COLUMN_ADD()##.

=== Eliminare una Colonna Dinamica

&lt;&lt;code&gt;&gt;
COLUMN_DELETE(colonna_dinamica, numero_colonna, numero_colonna...);
&lt;&lt;/code&gt;&gt;

=== Leggere una Colonna Dinamica

&lt;&lt;code&gt;&gt;
COLUMN_GET(colonna_dinamica, numero_colonna as tipo)
&lt;&lt;/code&gt;&gt;

Il tipo può essere specificato come si fa all&#39;interno delle funzioni ##[[cast|CAST]]## e ##[[convert|CONVERT]]##:

* ##BINARY[(N)]##
* ##CHAR[(N)]##
* ##DATE##
* ##DATETIME[(D)]##
* ##DECIMAL[(M[,D])]##
* ##DOUBLE[(M[,D])]##
* ##INTEGER##
* ##SIGNED [INTEGER]##
* ##TIME[(D)]##
* ##UNSIGNED [INTEGER]##

Questo parametro è obbligatorio perchè SQL è un linguaggio fortemente tipizzato e le altre funzioni (così come il client) devono conoscere il tipo del dato per poterne leggere il valore.

Se la Colonna Dinamica ha un tipo differente da quello richiesto, il valore verrà convertito.

Si noti che se si utilizza ##CHAR## o ##BINARY## senza specificarne la lunghezza, MariaDB lo considera un BLOB con lunghezza massima ##536870911## (il massimo consentivo in una Colonna Dinamica). Sebbene il server allochi automaticamente uno spazio di memoria con questo limite, i client potrebbero comportarsi diversamente, perciò è sempre meglio specificare la lunghezza.

==== Verificare l&#39;esistenza di una Colonna Dinamica ===

&lt;&lt;code&gt;&gt;
COLUMN_EXISTS(colonna_dinamica, numero_colonna);
&lt;&lt;/code&gt;&gt;

Questa funzione restituisce ##1## se la colonna al numero corrispondente esiste, ##0## se non esiste, ##NULL## se la colonna è ##NULL##.

&lt;&lt;code&gt;&gt;
COLUMN_LIST(colonna_dinamica);
&lt;&lt;/code&gt;&gt;

Restituisce una stringa con tutte le colonne contenute in ##//colonna_dinamica//## separate da una virgola (##,##).

== Esempi

Per prima cosa creiamo la tabella. Le colonne dinamiche saranno memorizzate in strdin.

&lt;&lt;sql&gt;&gt;
create table t1 (id int auto_increment primary key,
                 nome varchar(40),
                 tipo enum (&#34;maglietta&#34;, &#34;telefono&#34;, &#34;computer&#34;),
                 prezzo decimal(10,2),
                 strdin mediumblob);
&lt;&lt;/sql&gt;&gt;

Inseriamo alcuni elementi, che posseggono attributi comuni ma anche attributi specifici.

&lt;&lt;sql&gt;&gt;
insert into t1 (nome, tipo, prezzo, strdin) values
(&#34;maglietta carina&#34;, &#34;maglietta&#34;, 10.0, COLUMN_CREATE(1, &#34;blu&#34;, 10, &#34;XL&#34;)),
(&#34;nokia&#34;, &#34;telefono&#34;, 649, COLUMN_CREATE(1, &#34;nero&#34;, 2, &#34;touchscreen&#34;)),
(&#34;htc Desire hd&#34;, &#34;telefono&#34;, 579, COLUMN_CREATE(1, &#34;nero&#34;, 3, &#34;Android&#34;)),
(&#34;BM/Lenovo Thinkpad X60s&#34;, &#34;computer&#34;, 419, COLUMN_CREATE(1, &#34;nero&#34;, 3, &#34;Linux&#34;));
&lt;&lt;/sql&gt;&gt;

Controlliamo i dati:

&lt;&lt;sql&gt;&gt;
select id, nome, tipo, prezzo, length(strdin) as len, column_list(strdin) as lista from t1;
&lt;&lt;/sql&gt;&gt;

&lt;&lt;code&gt;&gt;
+----+-------------------------+----------+--------+------+-------+
| id | nome                    | tipo     | prezzo | len  | lista |
+----+-------------------------+----------+--------+------+-------+
|  1 | maglietta divertente    | shirt    |  10.00 |   17 | 1,10  |
|  2 | nokia                   | phone    | 649.00 |   27 | 1,2   |
|  3 | htc Desire hd           | phone    | 579.00 |   23 | 1,3   |
|  4 | BM/Lenovo Thinkpad X60s | computer | 419.00 |   21 | 1,3   |
+----+-------------------------+----------+--------+------+-------+
&lt;&lt;/code&gt;&gt;

&lt;&lt;sql&gt;&gt;
SELECT nome FROM t1 WHERE COLUMN_GET(strdin, 1 as char(10)) = &#34;nero&#34;;
&lt;&lt;/sql&gt;&gt;

&lt;&lt;code&gt;&gt;
+-------------------------+
| nome                    |
+-------------------------+
| nokia                   |
| htc Desire hd           |
| BM/Lenovo Thinkpad X60s |
+-------------------------+
&lt;&lt;/code&gt;&gt;

&lt;&lt;sql&gt;&gt;
SELECT name, COLUMN_GET(strdin, 1 as char(10)) FROM t1 WHERE COLUMN_EXISTS(strdin, 1);
&lt;&lt;/sql&gt;&gt;

&lt;&lt;code&gt;&gt;
+-------------------------+--------+
| nome                    | colore |
+-------------------------+--------+
| maglietta divertente    | blue   |
| nokia                   | black  |
| htc Desire hd           | black  |
| BM/Lenovo Thinkpad X60s | black  |
+-------------------------+--------+
&lt;&lt;/code&gt;&gt;

Modifichiamo tutti gli elementi aventi ##colore=&#34;nero&#34;##, trasformandolo in rosso

&lt;&lt;sql&gt;&gt;
UPDATE t1 set strdin=COLUMN_ADD(strdin, 1, &#34;rosso&#34;) where COLUMN_GET(strdin, 1 as char(10)) = &#34;nero&#34;;
SELECT nome, COLUMN_GET(strdin, 1 as char(10)) FROM t1 WHERE COLUMN_EXISTS(strdin, 1);
&lt;&lt;/sql&gt;&gt;

&lt;&lt;code&gt;&gt;
+-------------------------+-----------------------------------+
| nome                    | COLUMN_GET(strdin, 1 as char(10)) |
+-------------------------+-----------------------------------+
| maglietta divertente    | blu                               |
| nokia                   | rosso                             |
| htc Desire hd           | rosso                             |
| BM/Lenovo Thinkpad X60s | rosso                             |
+-------------------------+-----------------------------------+
&lt;&lt;/code&gt;&gt;

&lt;&lt;sql&gt;&gt;
SELECT COLUMN_GET(strdin, 1 as char(10)) as colore, count(*) FROM t1 group by COLUMN_GET(strdin, 1 as char(10));
&lt;&lt;/sql&gt;&gt;

&lt;&lt;code&gt;&gt;
+--------+----------+
| colour | count(*) |
+--------+----------+
| blu    |        1 |
| rosso  |        3 |
+--------+----------+
&lt;&lt;/code&gt;&gt;

Aggiungere una nuova colonna:

&lt;&lt;sql&gt;&gt;
UPDATE t1 set dinstr=COLUMN_ADD(dinstr, 15, &#34;4G ram&#34;) where type=&#34;computer&#34;;
SELECT nome, tipo, prezzo, length(strdin) as len, column_list(strdin) as lista from t1 where type=&#34;computer&#34;;
&lt;&lt;/sql&gt;&gt;

&lt;&lt;code&gt;&gt;
+-------------------------+----------+--------+------+--------+
| nome                    | tipo     | prezzo | len  | lista  |
+-------------------------+----------+--------+------+--------+
| BM/Lenovo Thinkpad X60s | computer | 419.00 |   29 | 1,3,15 |
+-------------------------+----------+--------+------+--------+
&lt;&lt;/code&gt;&gt;

== Integrità delle colonne dinamiche

Le colonne dinamiche cercano di comprimere i dati in modo da richiedere meno spazio su disco pur garantendo un tempo d&#39;accesso ragionevole. Per questo motivo un danno nella stringa può causare la perdita completa dei dati nelle colonne dinamiche di un record.

Ciò probabilmente accade se si aggiornano le colonne dinamiche con dati troppo lunghi. MariaDB (per default) tronca i dati e produce un warning. La scrittura di dati troncati potrebbe causare la perdita dei dati nelle colonne dinamiche dei record (modificati o meno). Per prevenire questo problema, se non si è certi che la dimensione della colonna sia sufficiente, si usi l&#39;##SQL_MODE## strict, che evita di cancellare i vecchi dati e abortisce l&#39;operazione di modifica.

== Le funzioni client in C

Le funzioni per gestire le Colonne Dinamiche sono incluse in ##libmysqld.a##, in MariaDB 5.3.
In questo modo è possibile recuperare l&#39;intero oggetto che racchiude le colonne dinamiche (normalmente un campo BLOB) dal server e scompattarlo nel client.

Le definizioni delle strutture e delle funzioni si trovano in ##include/ma_dyncol.h##. L&#39;implementazione si trova in ##mysys/ma_dyncol.c##.  Un esempio di utilizzo delle funzioni C si trova in ##unittest/mysys/ma_dyncol-t.c##.

=== Valore dell&#39;oggetto

Quando si recupera un valore dall&#39;oggetto con ##dynamic_column_get()## si ottiene un risultato avente la seguente struttura:

&lt;&lt;code lang=c inline=false&gt;&gt;
enum enum_dynamic_column_type
{
  DYN_COL_NULL= 0,
  DYN_COL_INT,
  DYN_COL_UINT,
  DYN_COL_DOUBLE,
  DYN_COL_STRING,
  DYN_COL_DECIMAL,
  DYN_COL_DATETIME,
  DYN_COL_DATE,
  DYN_COL_TIME
};

typedef enum enum_dynamic_column_type DYNAMIC_COLUMN_TYPE;
struct st_dynamic_column_value
{
  DYNAMIC_COLUMN_TYPE type;
  union
  {
    long long long_value;
    unsigned long long ulong_value;
    double double_value;
    struct {
      LEX_STRING string_value;
      CHARSET_INFO *charset;
    };
    struct {
      decimal_digit_t decimal_buffer[DECIMAL_BUFF_LENGTH];
      decimal_t decimal_value;
    };
    MYSQL_TIME time_value;
  };
};
&lt;&lt;/code&gt;&gt;

&#39;##type##&#39; dice quale tipo di dati si trova nell&#39;oggetto, mentre i dati stessi si trovano nelle parte union.

=== Risultati delle funzioni

Tutte le funzioni restituiscono un ##enum## con uno dei seguenti risultati:

&lt;&lt;code lang=c inline=false&gt;&gt;
enum enum_dyncol_func_result
{
  ER_DYNCOL_OK= 0,
  ER_DYNCOL_YES= 1,                /* Per le funzioni che restituiscono 0/1 */
  ER_DYNCOL_FORMAT= -1,            /* Formato stringa errato */
  ER_DYNCOL_LIMIT=  -2,            /* Un limite è stato raggiunto */
  ER_DYNCOL_RESOURCE= -3,          /* Fuori dalle risorse */
  ER_DYNCOL_DATA= -4,              /* Dati in input non corretti */
  ER_DYNCOL_UNKNOWN_CHARSET= -5    /* Set di caratteri sconosciuto */
};
&lt;&lt;/code&gt;&gt;

=== Inizializzare e liberare l&#39;oggetto

Per inizializzare un oggetto ##DYNAMIC_COLUMN## si usa il codice seguente (che imposta a ##0## tutti i valori):

&lt;&lt;code lang=c inline=false&gt;&gt;
void dynamic_column_initialize(DYNAMIC_COLUMN *str);
&lt;&lt;/code&gt;&gt;

Quando non si ha più bisogno dell&#39;oggetto, è meglio liberare la memoria allocata:

&lt;&lt;code lang=c inline=false&gt;&gt;
void dynamic_column_column_free(DYNAMIC_COLUMN *str);
&lt;&lt;/code&gt;&gt;

=== Creare un oggetto

Per creare un oggetto con un valore:

&lt;&lt;code lang=c inline=false&gt;&gt;
enum enum_dyncol_func_result
dynamic_column_create(DYNAMIC_COLUMN *str,
                      uint column_nr, DYNAMIC_COLUMN_VALUE *value);
&lt;&lt;/code&gt;&gt;

Per creare un oggetto con più valori:

&lt;&lt;code lang=c inline=false&gt;&gt;
enum enum_dyncol_func_result
dynamic_column_create_many(DYNAMIC_COLUMN *str,
                           uint column_count,
                           uint *column_numbers,
                           DYNAMIC_COLUMN_VALUE *values);
&lt;&lt;/code&gt;&gt;

In questo caso si crea un array contenente i numeri delle colonne e un altro array per i valori.

&#39;##str##&#39; può essere un oggetto inizializzato con ##dynamic_column_initialize(DYNAMIC_COLUMN *str)##, oppure un oggetto ##DYNAMIC_COLUMN *## già esistente che si desidera riutilizzare.

=== Cancellare l&#39;oggetto

&lt;&lt;code lang=c inline=false&gt;&gt;
enum enum_dyncol_func_result
dynamic_column_delete(DYNAMIC_COLUMN *org, uint column_nr);
&lt;&lt;/code&gt;&gt;

=== Verificare quali colonne esistono

Per sapere se una colonna esiste:

&lt;&lt;code lang=c inline=false&gt;&gt;
enum enum_dyncol_func_result
dynamic_column_exists(DYNAMIC_COLUMN *org, uint column_nr);
&lt;&lt;/code&gt;&gt;

Per ottenere un elenco delle colonne esistenti:

&lt;&lt;code lang=c inline=false&gt;&gt;
enum enum_dyncol_func_result
dynamic_column_list(DYNAMIC_COLUMN *org, DYNAMIC_ARRAY *array_of_uint);
&lt;&lt;/code&gt;&gt;

Nell&#39;ultimo caso, l&#39;oggetto ##DYNAMIC_ARRAY## verrà inizializzato dalla funzione. Per funzioni per manipolare ##DYNAMIC_ARRAY## sono:

&lt;&lt;code&gt;&gt;
Liberare l&#39;array:

delete_dynamic(DYNAMIC_ARRAY *array);

Numero di elementi nell&#39;array:

array.elements 

Accedere a un elemento:

unsigned int column= dynamic_element(array, index, unsigned int)
&lt;&lt;/code&gt;&gt;

=== Utilizzare le Colonne Dinamiche con i propri oggetti

Se si legge un campo BLOB da MariaDB e si desidera utilizzarlo con le funzioni sopra illustrate, probabilmente non si desidera duplicarlo per accedere ai suoi dati. Si può allora utilizzare il seguente trucco per creare un oggetto DYNAMIC_COLUMN che si potrà utilizzare con quelle funzioni che non lo modificano:

&lt;&lt;code lang=c inline=false&gt;&gt;
char   *blob;           /* i dati */
size_t  blob_length;    /* lunghezza del blob */
DYNAMIC_STRING dynstr;
struct st_dynamic_column_value value;

dynamic_column_initialize(DYNAMIC_COLUMN &amp;str);

dynstr.str= blog;
dynstr.length= length;
if (dynamic_column_get(&amp;str, 1, &amp;value))
{
  /* fai qualcosa con il valore della colonna 1... */
}
&lt;&lt;/code&gt;&gt;

== Obiettivi dell&#39;implementazione

Lo sviluppo delle Colonne Dinamiche ha tentato di soddisfare i seguenti obiettivi:

* Possibilità di utilizzare le Colonne Dinamiche ovunque si utilizzi una colonna normale (ORDER BY, GROUP BY etc.)
* Per lavorare con le Colonne Dinamiche si usano le funzioni (non gli opetatori) per rendere più facile l&#39;utilizzo dai diversi client SQL (come ODBC). 
* Richiedono un sovrappiù di memoria molto ridotto, rispetto alle altre colonne (attualmente 4-6 byte per ogni colonna)
* Ottimizzate per la lettura; la velocità in lettura si avvicina a quella di qualsiasi altra colonna.
* Le Colonne Dinamiche non supportano il valore NULL; se non hanno un valore, allora non viene immagazzinato. Per questo una Colonna Dinamica viene eliminata se si inserisce NULL.
* Poche funzioni, perché siano facili da comprendere e da utilizzare.
* Licenza libera (BSD) per facilitarne il port in linguaggi diversi dal C.
* In futuro dovrebbe essere possibile modificare il formato senza modificare i dati già esistenti (il primo byte del formato è un flag).
* La prima versione è ottimizzata per istruzioni SQL generate da programma; se questa funzionalità verrà utilizzata, verranno aggiunte altre caratteristiche come i nomi per le colonne.

== Limiti

* Le colonne sono identificate da numeri (si veda il To-Do, sotto)
* E&#39; possibile utilizzare numeri da 0 a 65535 per una colonna
* Le dimensioni massime dell&#39;oggetto sono di 536870911 byte (29 bit).
* L&#39;unico modo per indicizzare una Colonna Dinamica è creare una [[colonne-virtuali|Colonna Virtuale]]. Tutta via in questo caso verrà creata un&#39;istanza della colonna virtuale.
* Non è possibile specificare due volte lo stesso numero di colonna in COLUMN_CREATE() o COLUMN_ADD(). Se si tenta di farlo si ottiene un errore poco chiaro: **&#34;Illegal value used as argument of dynamic column function&#34;**. Questo problema verrà risolto in futuro in modo che venga usato l&#39;ultimo argomento.

== To-Do

* Implementare una funzione ##COLUMN_CHECK()## per controllare se il contenuto della colonna è ben formato. (Utile per verificare l&#39;integrità e trovare errori).
* Permettere di specificare due volte lo stesso numero di colonna in COLUMN_CREATE() / COLUMN_ADD().
* Modificare la sintassi di COLUMN_CREATE() perché sia uguale a COLUMN_GET().
* Implementare gli indici funzionali. Questo risolverà in parte il problema di indicizzare le colonne virtuali (perché aggiungere un indice funzionale non implica una nuova istanza).
* Prevedere un modo per associare dei nomi alle colonne virtuali. Il problema è decidere dove memorizzare il nome: in ogni riga, nel file .frm o in un nuovo file. tutte le soluzioni hanno vantaggi differenti in termini di spazio e velocità, perciò gli sviluppatori attendono di ottenere dei feedback per prendere questa decisione.

== Si veda anche

* [[what-is-mariadb-53|Cos&#39;è MariaDB 5.3]]
* [[microsecondi-in-mariadb|Microsecondi in MariaDB]]

</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>