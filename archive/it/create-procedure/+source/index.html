<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>CREATE PROCEDURE - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.b9e1e104f007.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="CREATE PROCEDURE - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/it/create-procedure/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/it/create-procedure/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/it/create-procedure/+source/" rel="nofollow">Accesso</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/it/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/it/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/it/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/it/mariadb-italiano/">MariaDB - Italiano</a>
    

    
    » <a class="crumb" href="/kb/it/documentazione-di-mariadb/">Documentazione di MariaDB</a>
    

    
    » <a class="crumb" href="/kb/it/comandi-sql/">Comandi SQL</a>
    

    
    » <a class="crumb" href="/kb/it/definizione-dei-dati/">Definizione dei dati</a>
    

    
    » <a class="crumb" href="/kb/it/create/">CREATE</a>
    


    » <a class="node_link crumb" href="/kb/it/create-procedure/">CREATE PROCEDURE</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/it/">Pagina iniziale</a></li>
                            
                                
                                    <li><a href="/kb/it/+questions/">Domande Aperte</a></li>
                                
                                <li><a href="/kb/it/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/it/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/it/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/it/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/it/create-procedure/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>CREATE PROCEDURE - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revisione</dt>
            <dd><a href="/kb/it/create-procedure/+r/56335/">56335</a></dd>
            <dt>Utente</dt>
            <dd>
<span class="user" id="user-982">
<a href="/kb/user/id/982" title="Federico Razzoli">Federico Razzoli</a>
</span></dd>
            <dt>Data</dt>
            <dd>

<span class="datetime" title="2017-07-04 17:59">2017-07-04 17:59</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">== Sintassi ==

&lt;&lt;code&gt;&gt;
CREATE [OR REPLACE]
    [DEFINER = { utente | CURRENT_USER | role | CURRENT_ROLE }]
    PROCEDURE nome_sp ([parametro_sp[, ...]])
    [caratteristica ...] corpo_routine

CREATE
    [DEFINER = { utente | CURRENT_USER }]
    FUNCTION nome_sp ([parametro_funz[, ...]])
    RETURNS tipo
    [caratteristica ...] corpo_routine
    
parametro_sp:
    [ IN | OUT | INOUT ] nome_param tipo
    
parametro_funz:
    nome_param tipo

tipo:
    Qualsiasi tipo valido di MariaDB

characteristic:
    LANGUAGE SQL
  | [NOT] DETERMINISTIC
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }
  | COMMENT &#39;stringa&#39;

corpo_routine:
    Istruzione SQL valida
&lt;&lt;/code&gt;&gt;

== Spiegazione

Queste istruzioni creano le Stored Routine. Per default, una routine viene associata al database corrente. Per associarla esplicitamente ad un altro database, nel crearla si può specificare un nome qualificato con la sintassi nome_db.nome_routine.

L&#39;istruzione ##CREATE FUNCTION## può essere usata anche per creare le UDF
(User Defined Function, funzioni definite dall&#39;utente). Si veda la pagina http://dev.mysql.com/doc/refman/5.1/en/adding-functions.html. Una UDF può essere considerata come una Stored Function esterna. Si noti che le Stored Function condividono lo stesso namespace delle UDF. Si veda http://dev.mysql.com/doc/refman/5.1/en/function-resolution.html per sapere in che modo il server interpreta i riferimenti a diversi tipi di funzioni.

Quando la routine viene invocata, viene eseguito un comando USE nome_db implicito, che viene annullato quando al termine della procedura. In questo modo il database di default usato dalle istruzioni contenute nella procedura, sarà quello a cui appartiene la procedura stessa. L&#39;istruzione USE non è permessa all&#39;interno del corpo della routine.

Le Stored Function si invocano facendo riferimento ad essere come ad un&#39;espressione SQL. Quando vengono elaborate restituiscono un valore, come le espressioni. Le Stored Procedure si invocano invece con l&#39;istruzione ##CALL## (si veda [[call|CALL]]).

Per eseguire le istruzioni ##CREATE PROCEDURE## e ##CREATE FUNCTION## occorre disporre del privilegio ##CREATE ROUTINE##. Per default, MariaDB assegna i permessi ##ALTER ROUTINE## e ##EXECUTE## al creatore delle routine. Si veda la pagina http://dev.mysql.com/doc/refman/5.1/en/stored-routines-privileges.html. Se il log binario è abilitato, l&#39;istruzione ##CREATE FUNCTION## potrebbe richiedere anche il privilegio ##SUPER##, come spiegato alla pagina http://dev.mysql.com/doc/refman/5.1/en/stored-programs-logging.html.

Le clausole ##DEFINER## e ##SQL SECURITY## specificano il contesto di sicurezza da usare quando vengono verificati i permessi di accesso al momento dell&#39;esecuzione della routine, come spiegato più avanti.

Se il nome di una routine è uguale a quello di una funzione SQL built-in, occorre inserire uno spazio tra il nome e le parentesi che seguono, si al momento della creazione sia quando la si invoca, altrimenti si ottiene un errore di sintassi. Per questo motivo si suggerisce di evitare di utilizzare per le Stored Routine i nomi delle funzioni SQL esistenti.

La modalità SQL ##IGNORE_SPACE## si applica solo alle funzioni built-in, e non alle Stored Procedure. Dopo il nome della routine è sempre permesso inserire uno spazio, indipendentemente dal fatto che IGNORE_SPACE sia abilitata o meno.

La lista dei parametri deve sempre essere presente, tra le parentesi. Se non vi sono parametri, occorre specificare una lista vuota, in questo modo: (). I nomi dei parametri non sono case sensitive, cioè non vi è differenza tra le lettere maiuscole e le minuscole.

Ogni parametro deve essere associato a un tipo di dato valido e non è permesso utilizzare l&#39;attributo ##COLLATE##.

Ogni parametro per default è ##IN##. Per specificare diversamente, si usano le parole chiave ##OUT## o ##INOUT## prima del suo nome.

**Nota**: Solo nelle ##PROCEDURE## è possibile specificare un parametro come ##IN##, ##OUT## o ##INOUT##. I parametri delle ##FUNCTION## sono sempre considerati ##IN##.

Ogni parametro ##IN## passa un valore alla procedura. Essa può modificarlo, ma la modifica non è visibile al chiamante al termine della proceduta. Ogni parametro ##OUT## passa un valore dalla procedura al chiamante. Il suo valore iniziale nella procedura è NULL, e questo valore sarà visibile al chiamante al termine della procedura. Ogni parametro ##INOUT## è inizializzato dal chiamante, può essere modificato dalla procedura e qualsiasi cambiamento sarà visibile al termine della stessa.

Per ogni parametro ##OUT## o ##INOUT##, occorre passare una variabile definita dall&#39;utente nell&#39;istruzione ##CALL##, per poter vedere il nuovo valore al termine della procedura. Se questa viene chiamata dall&#39;interno di un&#39;altra Stored Routine, è possibile anche passare un suo parametro, o una sua variabile locale, come parametro ##IN## o ##INOUT##.

La clausola ##RETURNS## può essere specificata solo per le funzioni, ed è obbligatoria. Indica quale tipo di dato viene restituito e il corpo della funzione deve contenere un&#39;istruzione ##RETURN##. Se questa funzione restituisce un valore di tipo differente, verrà convertito nel tipo appropriato. Per esempio, se una funzione ha una clausola ##RETURNS## che indica un tipo ##ENUM## o ##SET##, ma poi restituisce un intero, questo valore verrà convertito nel membro corrispondente della lista ##ENUM## o ##SET##.

Il corpo della routine deve essere un&#39;istruzione SQL valida. Può essere un comando semplice come ##SELECT## o ##INSERT##, o un&#39;istruzione composta che utilizza ##BEGIN## e ##END##. Le istruzioni composte possono contenere dichiarazioni, cicli e altre strutture di controllo. La sintassi di queste istruzioni è descritta alla pagina: http://dev.mysql.com/doc/refman/5.1/en/sql-syntax-compound-statements.html

MariaDB permette che le routine contengano istruzioni DDL, come ##CREATE## e ##DROP##. Permette inoltre che le Stored Procedure (ma non le Stored Function) contengano istruzioni per le transazioni, come ##COMMIT##. Le funzioni non possono contenere istruzioni che effettuano esplicitamente o implicitamente un commit o un rollback. Il supporto per tali istruzioni non è richiesto dallo standard SQL, il quale afferma che ogni venditore di DBMS può decidere se permetterli o meno.

Le istruzioni che restituiscono un set di risultati non possono essere utilizzati all&#39;interno di una Stored Function. Ad esempio, non si possono usare istruzioni ##SELECT## che non hanno una clausola INTO, e altri comandi come SHOW, EXPLAIN e CHECK TABLE. Se viene utilizzata una funzione che restituisce un set di risultati e questo è rilevabile al momento della definizione, viene restituito un errore Not allowed to return a result set from a function (ER_SP_NO_RETSET). Se invece viene rilevato solo al momento dell&#39;esecuzione, viene restituito un errore ##PROCEDURE## %s
can&#39;t return a result set in the given context (ER_SP_BADSELECT).

Per ulteriori informazioni sulle istruzioni che non sono ammesse nelle Stored Routine, si veda http://dev.mysql.com/doc/refman/5.1/en/stored-program-restrictions.html
.

L&#39;esempio seguente mostra una semplice Stored Procedure che fa uso di un parametro ##OUT##:

&lt;&lt;code&gt;&gt;
MariaDB [test]&gt; delimiter //

MariaDB [test]&gt; CREATE PROCEDURE procSemplice (OUT param1 INT)
    -&gt; BEGIN
    -&gt;   SELECT COUNT(*) INTO param1 FROM t;
    -&gt; END;
    -&gt; //
Query OK, 0 rows affected (0.03 sec)

MariaDB [test]&gt; delimiter ;

MariaDB [test]&gt; CALL procSemplice(@a);
Query OK, 0 rows affected (0.00 sec)

MariaDB [test]&gt; SELECT @a;
+------+
| @a   |
+------+
|    1 |
+------+
1 row in set (0.00 sec)

MariaDB [test]&gt; 
&lt;&lt;/code&gt;&gt;

L&#39;esempio utilizza il comando delimiter del client mysql, per modificare il delimitatore delle istruzioni da {{{;}}} a {{{//}}} durante la definizione della procedura. Questo permette di utilizzare {{{;}}}, che verrà passato al server all&#39;interno dell&#39;istruzione, e non interpretato dal client come termine del comando.  Si veda la pagina http://dev.mysql.com/doc/refman/5.1/en/stored-programs-defining.html

Per ulteriori informazioni su come invocare le Stored Procedure dall&#39;interno dei programmi scritti in un linguaggio che abbia un&#39;interfaccia a MySQL/MariaDB, si veda [[call|CALL]].

Il seguente esempio accetta un parametro, esegue un&#39;operazione usando una funzione SQL e restituisce il risultato. In questo caso, non è necessario usare il comando delimiter perché la funzione non contiene &#39;;&#39; al suo interno:

&lt;&lt;code&gt;&gt;
MariaDB [test]&gt; CREATE FUNCTION hello (s CHAR(20))
    -&gt; RETURNS CHAR(50) DETERMINISTIC
    -&gt; RETURN CONCAT(&#39;Hello, &#39;,s,&#39;!&#39;);
Query OK, 0 rows affected (0.00 sec)

MariaDB [test]&gt; SELECT hello(&#39;world&#39;);
+----------------+
| hello(&#39;world&#39;) |
+----------------+
| Hello, world!  |
+----------------+
1 row in set (0.00 sec)

MariaDB [test]&gt; 
&lt;&lt;/code&gt;&gt;

MariaDB ricorda il valore della variabile di sistema sql_mode che è in uso al momento della creazione delle routine, e lo utilizza sempre nell&#39;esecuzione delle routine, indipendentemente dalla modalità SQL in uso al momento dell&#39;invocazione.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>