<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Transazioni XA - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.b9e1e104f007.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Transazioni XA - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/it/xa-transactions/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/it/xa-transactions/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/it/xa-transactions/+source/" rel="nofollow">Accesso</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/it/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/it/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/it/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/it/mariadb-italiano/">MariaDB - Italiano</a>
    

    
    » <a class="crumb" href="/kb/it/documentazione-di-mariadb/">Documentazione di MariaDB</a>
    

    
    » <a class="crumb" href="/kb/it/comandi-sql/">Comandi SQL</a>
    

    
    » <a class="crumb" href="/kb/it/transazioni/">Transazioni</a>
    


    » <a class="node_link crumb" href="/kb/it/xa-transactions/">Transazioni XA</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/it/">Pagina iniziale</a></li>
                            
                                
                                    <li><a href="/kb/it/+questions/">Domande Aperte</a></li>
                                
                                <li><a href="/kb/it/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/it/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/it/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/it/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/it/xa-transactions/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Transazioni XA - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revisione</dt>
            <dd><a href="/kb/it/xa-transactions/+r/24920/">24920</a></dd>
            <dt>Utente</dt>
            <dd>
<span class="user" id="user-982">
<a href="/kb/user/id/982" title="Federico Razzoli">Federico Razzoli</a>
</span></dd>
            <dt>Data</dt>
            <dd>

<span class="datetime" title="2014-02-14 22:05">2014-02-14 22:05</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">== Panoramica

L&#39;implementazione di XA in MariaDB è basata sul documento di X/Open CAE chiamato Distributed Transaction Processing: The XA Specification. Questo documento è distribuito da The Open Group ed è reperibile all&#39;indirizzo http://www.opengroup.org/public/pubs/catalog/c193.htm.

Le transazioni XA sono progettate per essere transazioni distribuite, dove un transaction manager (l&#39;applicazione) controlla una transazione che coinvolge più risorse. Queste risorse sono solitamente DBMS, ma possono essere risorse di qualunque tipo. L&#39;insieme delle operazioni transazionali richieste si chiama transazione globale. Ogni sottoinsieme di operazioni che coinvolge una sola risorsa si chiama transazione locale. XA utilizza il commit a due fasi (two-phases commit, 2PC). Con il primo commit, il transaction manager chiede alla risorsa di preparare il commit effettivo, e attende un messaggio di conferma. Le modifiche non sono ancora effettive, a questo punto. Se una qualsiasi risorsa ha riscontrato un errore, il transaction manager annullerà la transazione globale. Se tutte le risorse comunicano che il primo commit ha avuto successo, il transaction managaer può richiedere il secondo commit, che rende le modifiche effettive.

In MariaDB, le transazioni XA possono essere utilizzate solo con gli storage engine che le supportano. Almeno [[InnoDB]], [[TokuDB]] e [[SPIDER]] le supportano. Per InnoDB, le transazioni XA possono essere disabilitate impostando la variabile di sistema [[xtradbinnodb-server-system-variables#innodb_support_xa|innodb_support_xa]] a 0. Le transazioni XA non sono attualmente disponibili in [[galera|MariaDB Galera Cluster]].

Come le transazioni normali, le transazioni XA creano [[metadata-locking|dei lock sui metadati]] delle tabelle a cui accedono.

Cercare di avviare più di una transazione XA allo stesso tempo produce un errore 1400 ([[sqlstate|SQLSTATE]] &#39;XAE09&#39;). Lo stesso errore viene prodotto se si avvia una transazione XA mentre è in corso una transazione normale. Cercare di avviare una transazione normale mentre una transazione XA è in corso produce un errore 1399 ([[sqlstate|SQLSTATE]] &#39;XAE07&#39;).

Le [[sql-statements-that-cause-an-implicit-commit|istruzioni che causano un COMMIT implicito]] per le transazioni normali producono un errore 1400 ([[sqlstate|SQLSTATE]] &#39;XAE09&#39;) se una transazione XA è in corso.

== Sintassi

&lt;&lt;code&gt;&gt;
XA {START|BEGIN} xid [JOIN|RESUME]

XA END xid [SUSPEND [FOR MIGRATE]]

XA PREPARE xid

XA COMMIT xid [ONE PHASE]

XA ROLLBACK xid

XA RECOVER

xid: gtrid [, bqual [, formatID ]]
&lt;&lt;/code&gt;&gt;

L&#39;interfaccia alle transazioni XA è un insieme di istruzioni SQL che iniziano con ##XA##. Ogni istruzione modifica lo stato della transazione, determinando quali prossime azioni potrà compiere. Una transazione che non esiste è nello stato ##NON-EXISTING##.

##XA START## (o ##BEGIN##) avvia una transazione e definisce il suo ##xid## (l&#39;identificatore della transazione). Le parole chiave ##JOIN## e ##RESUME## non hanno effetto. La nuova transazione sarà nello stato ##ACTIVE##.

Lo ##xid## può avere tre componenti, sebbene solo la prima sia obbligatoria. ##gtrid## è una stringa virgolettata che trappresenta l&#39;identificatore della transazione globale. ##bqual## è una stringa virgolettata che rappresenta l&#39;identificatore della transazione locale. ##formatID## è un intero senza segno che indica il formato utilizzato per i primi due componenti; se non è specificato, il default è 1. MariaDB non interpreta in alcun modo questi componenti, li utilizza solo per identificare le transazioni. Gli ##xid## delle transazioni in corso devono essere univoci.

##XA END## dichiara che la transazione specificata, nello stato ##ACTIVE##, è terminata; perciò passa ora allo stato ##IDLE##. ##SUSPEND [FOR MIGRATE]## non ha effetto.

##XA PREPARE## prepara una transazione ##IDLE## per il commit, modificando il suo stato in ##PREPARED##. Questo è il primo commit.

##XA COMMIT## effettua il commit definitivo e termina una transazione che era nello stato ##PREPARED##. Se si specifica la clausola ##ONE PHASE##, questa istruzione effettua il commit a 1 fase su una transazione ##IDLE##.

##XA ROLLBACK## annulla e termina una transazione ##IDLE## o ##PREPARED##.

##XA RECOVER## mostra informazioni su tutte le transazioni ##PREPARED##.

Quando si tenta di eseguire un&#39;operazione che non è permessa su una transazione nello stato corrente, viene prodotto un errore:

&lt;&lt;sql&gt;&gt;
XA COMMIT &#39;test&#39; ONE PHASE;
ERROR 1399 (XAE07): XAER_RMFAIL: The command cannot be executed when global transaction is in the  ACTIVE state

XA COMMIT &#39;test2&#39;;
ERROR 1399 (XAE07): XAER_RMFAIL: The command cannot be executed when global transaction is in the  NON-EXISTING state
&lt;&lt;/sql&gt;&gt;

== ##XA RECOVER##

L&#39;istruzione ##XA RECOVER## mostra informazioni su tutte le transazioni che sono nello stato ##PREPARED##. Non è importa quale connessione ha creato la transazione: se è nello stato ##PREPARED##, viene visualizzata. Ma questo non significa che una connessione possa effettuare il commit o annullare una transazione che è stata avviata da un&#39;altra connessione. Si noti che le transazioni che utilizzano il commit commit a una fase non sono mai nello stato ##PREPARED##, perciò non possono essere mostrate da ##XA RECOVER##.

##XA RECOVER## restituisce quattro colonne:

&lt;&lt;sql&gt;&gt;
XA RECOVER;
+----------+--------------+--------------+------+
| formatID | gtrid_length | bqual_length | data |
+----------+--------------+--------------+------+
|        1 |            4 |            0 | test |
+----------+--------------+--------------+------+
&lt;&lt;/sql&gt;&gt;

##formatID## è la parte ##formatID## dello ##xid##.

##data## sono le parti ##gtrid## e ##bqual## dello ##xid##, concatenate.

##gtrid_length## e ##bqual_length## sono le lunghezze di ##gtrid## e ##bqual##, rispettivamente.

== Esempi

Commit a 2 fasi:
&lt;&lt;sql&gt;&gt;
XA START &#39;test&#39;;

INSERT INTO t VALUES (1,2);

XA END &#39;test&#39;;

XA PREPARE &#39;test&#39;;

XA COMMIT &#39;test&#39;;
&lt;&lt;/sql&gt;&gt;

Commit a 1 fase:

&lt;&lt;sql&gt;&gt;
XA START &#39;test&#39;;

INSERT INTO t VALUES (1,2);

XA END &#39;test&#39;;

XA COMMIT &#39;test&#39; ONE PHASE;
&lt;&lt;/sql&gt;&gt;





</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>