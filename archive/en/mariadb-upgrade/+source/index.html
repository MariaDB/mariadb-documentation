<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>mariadb-upgrade - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="mariadb-upgrade - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariadb-upgrade/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-upgrade/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-upgrade/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/using-mariadb-server/">Using MariaDB Server</a>
    

    
    » <a class="crumb" href="/kb/en/clients-utilities/">Clients &amp; Utilities</a>
    


    » <a class="node_link crumb" href="/kb/en/mariadb-upgrade/">mariadb-upgrade</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/mariadb-upgrade/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>mariadb-upgrade - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/mariadb-upgrade/+r/128945/">128945</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-1368">
<a href="/kb/user/id/1368" title="Ian Gilfillan">Ian Gilfillan</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2023-08-21 08:22">2023-08-21 08:22</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">##mariadb-upgrade## is a tool that checks and updates your tables to the latest version.

&lt;&lt;product mariadb from=10.4.6&gt;&gt;
From MariaDB 10.4.6, ##mariadb-upgrade## is a symlink to ##mysql_upgrade##, the tool that checks and updates your tables to the latest version.
&lt;&lt;/product&gt;&gt;

&lt;&lt;product mariadb from=10.5.2&gt;&gt;
From MariaDB 10.5.2, ##mysql_upgrade## is the symlink, and ##mariadb-upgrade## the binary name.
&lt;&lt;/product&gt;&gt;

&lt;&lt;product mariadb from=10.4.23&gt;&gt;
Starting from ##mysql_upgrade## / ##mariadb-upgrade## 2.0, the user running the upgrade tool must have write access to ##datadir/mysql_upgrade_info##, so that the tool can write the current MariaDB version into the file. ##mysql-upgrade## was updated in MariaDB 10.2.42, MariaDB 10.3.33, MariaDB 10.4.23, MariaDB 10.5.14, MariaDB 10.6.6, MariaDB 10.7.2 and newer.
&lt;&lt;/product&gt;&gt;

&lt;&lt;toc&gt;&gt;


You should run ##mariadb-upgrade## after upgrading from one major MySQL/MariaDB release to another, such as [[upgrading-to-mariadb-from-mysql|from MySQL 5.0 to MariaDB 10.4]] or MariaDB 10.4 to MariaDB 10.5. You also have to use ##mariadb-upgrade## after a direct &#34;horizontal&#34; migration, for example from MySQL 5.5.40 to MariaDB 5.5.40. It&#39;s also safe to run ##mariadb-upgrade## for minor upgrades, as if there are no incompatibilities nothing is changed.

It needs to be run as a user with write access to the data directory.

##mariadb-upgrade## is run after starting the new MariaDB server.  Running it before you shut down the old version will not hurt anything and will allow you to make sure it works and figure out authentication for it ahead of time.


It is recommended to make a [[backing-up-and-restoring|backup]] of all the databases before running ##mariadb-upgrade##.

In most cases, ##mariadb-upgrade## should just take a few seconds.  The main work of ##mariadb-upgrade## is to:
* Update the system tables in the ##mysql## database to the latest version (normally just add new fields to a few tables).
* Check that all tables are up to date (runs [[sql-commands-check-table|CHECK TABLE table_name FOR UPGRADE]]). For tables that are not up to date, runs [[alter-table|ALTER TABLE table_name FORCE]] on the table to update it. A table is not up to date if:
** The table uses an index for which there has been a [[character-sets|collation]] change (rare)
** A format change in the storage engine requires an update (very rare)

== Using mariadb-upgrade

&lt;&lt;code&gt;&gt;
mariadb-upgrade [--force] [--user=# --password=# 
  --host=hostname --port=# --socket=#
  --protocol=tcp|socket|pipe|memory 
  --verbose] [OTHER_OPTIONS]
&lt;&lt;/code&gt;&gt;

##mariadb-upgrade## is mainly a framework to call [[mariadb-check]]. ##mariadb-upgrade## works by doing the following operations:

&lt;&lt;code&gt;&gt;
# Find out path to datadir
echo &#34;show show variables like &#39;datadir&#39;&#34; | mysql
mariadb-check --no-defaults --check-upgrade --auto-repair --databases mysql
mysql_fix_privilege_tables
mariadb-check --no-defaults --all-databases --fix-db-names --fix-table-names
mariadb-check --no-defaults --check-upgrade --all-databases --auto-repair
&lt;&lt;/code&gt;&gt;

The connect options given to ##mariadb-upgrade## are passed along to [[mariadb-check]] and [[mysql-command-line-client|mysql]].

The ##mysql_fix_privilege_tables## script is not actually called; it&#39;s included as part of ##mariadb-upgrade##

If you have a problem with ##mariadb-upgrade## try run it in very verbose mode:
&lt;&lt;code&gt;&gt;
mariadb-upgrade --verbose --verbose other-options
&lt;&lt;/code&gt;&gt;

##mariadb-upgrade## also saves the MariaDB version number in a file named ##mysql_upgrade_info## in the [[server-system-variables/#datadir|data directory]]. This is used to quickly check whether all tables have been checked for this release so that table-checking can be skipped. For this reason, 
##mariadb-upgrade## needs to be run as a user with write access to the data directory. To ignore this file and perform the check regardless, use the ##--force## option.

=== Options

##mariadb-upgrade## supports the following options:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Option |= Description |= Version|
| ##-?##, ##--help## | Display this help message and exit. | |
| ##--basedir=path## | Old option accepted for backward compatibility but ignored. | |
| ##--character-sets-dir=path## | Old option accepted for backward compatibility but ignored. | |
| ##check-if-upgrade-is-needed## | Do a quick check if upgrade is needed. Returns 0 if yes, 1 if no. |2.0|
| ##--compress=name## | Old option accepted for backward compatibility but ignored. | |
| ##--datadir=name## | Old option accepted for backward compatibility but ignored. | |
| ##-# [name]##, ##--debug[=name]## | For debug builds, output debug log. | |
| ##--debug-check## | Check memory and open file usage at exit. | |
| ##-T##, ##--debug-info## | Print some debug info at exit. | |
| ##--default-character-set=name## | Old option accepted for backward compatibility but ignored. | |
| ##-f##, ##--force## | Force execution of mariadb-check even if ##mariadb-upgrade## has already been executed for the current version of MariaDB. Ignores ##mysql_upgrade_info##. | |
| ##-h##, ##--host=name## | Connect to MariaDB on the given host. | |
| ##-p##, ##--password[=name]## | Password to use when connecting to server. If password is not given, it&#39;s solicited on the command line (which should be considered insecure). You can use an option file to avoid giving the password on the command line. | |
| ##-P##, ##--port=name## | Port number to use for connection or 0 for default to, in order of preference, my.cnf, the MYSQL_TCP_PORT [[mariadb-environment-variables|environment variable]], /etc/services, built-in default (3306). | |
| ##--protocol=name## | The protocol to use for connection (tcp, socket, pipe, memory). | |
| ##--silent## | Print less information. | |
| ##-S##, ##--socket=name## | For connections to localhost, the Unix socket file to use, or, on Windows, the name of the named pipe to use. | |
| ##--ssl## | Enables [[data-in-transit-encryption|TLS]]. TLS is also enabled even without setting this option when certain other TLS options are set. Starting with MariaDB 10.2, the ##--ssl## option will not enable [[secure-connections-overview/#server-certificate-verification|verifying the server certificate]] by default. In order to verify the server certificate, the user must specify the ##--ssl-verify-server-cert## option. | |
| ##--ssl-ca=name## | Defines a path to a PEM file that should contain one or more X509 certificates for trusted Certificate Authorities (CAs) to use for [[data-in-transit-encryption|TLS]]. This option requires that you use the absolute path, not a relative path. See [[secure-connections-overview/#certificate-authorities-cas|Secure Connections Overview: Certificate Authorities (CAs)]] for more information. This option implies the ##--ssl## option. | |
| ##--ssl-capath=name##  | Defines a path to a directory that contains one or more PEM files that should each contain one X509 certificate for a trusted Certificate Authority (CA) to use for [[data-in-transit-encryption|TLS]]. This option requires that you use the absolute path, not a relative path. The directory specified by this option needs to be run through the [[https://www.openssl.org/docs/man1.1.1/man1/rehash.html|openssl rehash]] command. See [[secure-connections-overview/#certificate-authorities-cas|Secure Connections Overview: Certificate Authorities (CAs)]] for more information. This option is only supported if the client was built with OpenSSL or yaSSL. If the client was built with GnuTLS or Schannel, then this option is not supported. See [[tls-and-cryptography-libraries-used-by-mariadb|TLS and Cryptography Libraries Used by MariaDB]] for more information about which libraries are used on which platforms. This option implies the ##--ssl## option. | |
| ##--ssl-cert=name##  | Defines a path to the X509 certificate file to use for [[data-in-transit-encryption|TLS]]. This option requires that you use the absolute path, not a relative path. This option implies the ##--ssl## option. | |
| ##--ssl-cipher=name## | List of permitted ciphers or cipher suites to use for [[data-in-transit-encryption|TLS]]. This option implies the ##--ssl## option. | |
| ##--ssl-crl=name## | Defines a path to a PEM file that should contain one or more revoked X509 certificates to use for [[data-in-transit-encryption|TLS]]. This option requires that you use the absolute path, not a relative path. See [[secure-connections-overview/#certificate-revocation-lists-crls|Secure Connections Overview: Certificate Revocation Lists (CRLs)]] for more information. This option is only supported if the client was built with OpenSSL or Schannel. If the client was built with yaSSL or GnuTLS, then this option is not supported. See [[tls-and-cryptography-libraries-used-by-mariadb|TLS and Cryptography Libraries Used by MariaDB]] for more information about which libraries are used on which platforms. | |
| ##--ssl-crlpath=name## | Defines a path to a directory that contains one or more PEM files that should each contain one revoked X509 certificate to use for [[data-in-transit-encryption|TLS]]. This option requires that you use the absolute path, not a relative path. The directory specified by this option needs to be run through the [[https://www.openssl.org/docs/man1.1.1/man1/rehash.html|openssl rehash]] command. See [[secure-connections-overview/#certificate-revocation-lists-crls|Secure Connections Overview: Certificate Revocation Lists (CRLs)]] for more information. This option is only supported if the client was built with OpenSSL. If the client was built with yaSSL, GnuTLS, or Schannel, then this option is not supported. See [[tls-and-cryptography-libraries-used-by-mariadb|TLS and Cryptography Libraries Used by MariaDB]] for more information about which libraries are used on which platforms. | |
| ##--ssl-key=name## | Defines a path to a private key file to use for [[data-in-transit-encryption|TLS]]. This option requires that you use the absolute path, not a relative path. This option implies the ##--ssl## option. | |
| ##--ssl-verify-server-cert##     | Enables [[secure-connections-overview/#server-certificate-verification|server certificate verification]]. This option is disabled by default. | |
| ##-t##, ##--tmpdir=name## | Directory for temporary files. | |
| ##-s##, ##--upgrade-system-tables## |  Only upgrade the system tables in the mysql database. Tables in other databases are not checked or touched. | |
| ##-u##, ##--user=name## | User for login if not current user. | |
| ##-v##, ##--verbose## | Display more output about the process, using it twice will print connection arguments; using it 3 times will print out all [[check-table|CHECK]], [[rename-table|RENAME]] and [[alter-table|ALTER TABLE]] commands used during the check phase; using it 4 times will also write out all [[mariadb-check]] commands used.  | |
| ##-V##, ##--version## | Output version information and exit. | |
| ##-k##, ##--version-check## | Run this program only if its &#39;server version&#39; matches the version of the server to which it&#39;s connecting check. Note: the &#39;server version&#39; of the program is the version of the MariaDB server with which it was built/distributed.  (Defaults to on; use ##--skip-version-check## to disable.) | |
| ##--write-binlog## | All commands including those run by [[mariadb-check]] are written to the [[binary-log|binary log]]. Disabled by default. Before MariaDB 10.0.6 and MariaDB 5.5.34, this was enabled by default, and ##--skip-write-binlog## should be used when commands should not be sent to replication slaves. | |
&lt;&lt;/style&gt;&gt;

== mariadb-upgrade 2.0

##mariadb-upgrate/mysql_upgrade 2.0## was introduced in MariaDB 10.2.42, MariaDB 10.3.33, MariaDB 10.4.23, MariaDB 10.5.14, MariaDB 10.6.6, MariaDB 10.7.2.

Previously the tool first ran the upgrade process and then created the ##datadir/mysql_upgrade_info## file. If the file could not be created because of permissions (##mariadb-upgrade## did not have rights to create the file), ##mariadb-upgrad## gave an error, but this was often ignored.
One effect of not being able to create the ##mysql_upgrade_info## file was that every new ##mariadb-upgrade## run would have to do a full upgrade check, which can take a while if there are a lot of tables.

##mariadb-upgrade## 2.0 fixes the following issues:
* The ##datadir/mysql_upgrade_info## is now created at the start of the upgrade process and locked. This ensures that two ##mariadb-upgrade## processes cannot be run in parallel, which can cause deadlocks (MDEV-27068). One side-effect of this is that ##mariadb-upgrade## has to have write access to ##datadir##, which means it has to be run as as the user that installed MariaDB, normally &#39;mysql&#39; or &#39;root&#39; .
* One can use ##mariadb-upgrade --force --force## to force the upgrade to be run, even if there was no version change or if one doesn&#39;t have write access to ##datadir##. Note that if this option is used, the next ##mariadb-upgrade## run will assume that there is a major version change and the upgrade must be done (again).
* The upgrade will only be done if there is a major server version change (10.4.X -&gt; 10.5.X). This will avoid unnecessary upgrades.
* New option added: ##--check-if-upgrade-is-needed##.  If this is used, ##mariadb-upgrade## will return 0 if there has been a major version change and one should run ##mariadb-upgrade##. If not upgrade is need, 1 will be returned.
* ##--verbose## writes more information, including from which version to which version the upgrade will be done.
* Better messages when there is no need to run ##mariadb-upgrade##.

=== Option Files

In addition to reading options from the command-line, ##mariadb-upgrade## can also read options from [[configuring-mariadb-with-option-files|option files]]. If an unknown option is provided to ##mariadb-upgrade## in an option file, then it is ignored.

The following options relate to how MariaDB command-line tools handles option files. They must be given as the first argument on the command-line:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Option |= Description
| ##--print-defaults## | Print the program argument list and exit.|
| ##--no-defaults## | Don&#39;t read default options from any option file.|
| ##--defaults-file=# ## | Only read default options from the given file #.|
| ##--defaults-extra-file=# ## | Read this file after the global files are read.|
| ##--defaults-group-suffix=# ## | In addition to the default option groups, also read option groups with this suffix.|
&lt;&lt;/style&gt;&gt;

In MariaDB 10.2 and later, ##mariadb-upgrade## is linked with [[about-mariadb-connector-c|MariaDB Connector/C]]. However, MariaDB Connector/C does not yet handle the parsing of option files for this client. That is still performed by the server option file parsing code. See  MDEV-19035 for more information.

==== Option Groups

##mariadb-upgrade## reads options from the following [[configuring-mariadb-with-option-files/#option-groups|option groups]] from [[configuring-mariadb-with-option-files|option files]]:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Group |= Description |
| ##[mysql_upgrade]## | Options read by ##mariadb-upgrade##, which includes both MariaDB Server and MySQL Server. |
| ##[mariadb-upgrade]## | Options read by ##mariadb-upgrade##. Available starting with MariaDB 10.4.6. |
| ##[client]## | Options read by all MariaDB and MySQL [[clients-utilities|client programs]], which includes both MariaDB and MySQL clients. For example, ##mysqldump##. |
| ##[client-server]## | Options read by all MariaDB [[clients-utilities|client programs]] and the MariaDB Server. This is useful for options like socket and port, which is common between the server and the clients. |
| ##[client-mariadb]## | Options read by all MariaDB [[clients-utilities|client programs]]. |
&lt;&lt;/style&gt;&gt;

== Differences Between mysql_upgrade in MariaDB and MySQL

This is as of MariaDB 5.1.50:

* MariaDB will convert long [[identifier-names|table names]] properly.
* MariaDB will convert [[xtradb-and-innodb|InnoDB]] tables (no need to do a dump/restore or ##[[alter-table|ALTER TABLE]]##).
* MariaDB will convert old archive tables to the new 5.1 format.
* &#34;mysql_upgrade --verbose&#34; will run &#34;mariadb-check --verbose&#34; so that you get more information of what is happening.  Running with 3 times --verbose will in MariaDB 10.0 print out all CHECK, RENAME and ALTER TABLE commands executed.
* The [[mysqlevent-table|mysql.event table]] is upgraded live; no need to restart the server to use events if the event table has changed (MariaDB 10.0.22 and MariaDB 10.1.9).
* More descriptive output.

== Speeding Up mariadb-upgrade

- If you are sure that all your tables are up to date with the current version, then you can run ##mariadb-upgrade ---upgrade-system-tables##, which will only fix your system tables in the mysql database to be compatible with the latest version.

The main reason to run ##mariadb-upgrade## on all your tables is to allow it to check that:
* There has not been any change in table formats between versions.
** This has not happened since MariaDB 5.1.
* If some of the tables are using an index for which we have changed sort order.
** This has not happened since MariaDB 5.5.
 
If you are 100% sure this applies to you, you can just run ##mariadb-upgrade## with the ##---upgrade-system-tables## option.

== Symptoms of Not Having Run mariadb-upgrade When It Was Needed

* Errors in the [[error-log|error log]] that some system tables don&#39;t have all needed columns.
* Updates or searches may not find the record they are attempting to update or search for.
* [[checksum-table|CHECKSUM TABLE]] may report the wrong checksum for [[myisam|MyISAM]] or [[aria|Aria]] tables.
* The error message &#34;Cannot load from mysql.proc. The table is probably corrupted.&#34;

To fix issues like this, run ##mariadb-upgrade##, [[mariadb-check]],  [[sql-commands-check-table|CHECK TABLE]] and if needed [[repair-table|REPAIR TABLE]] on the wrong table.

== Other Uses

* ##mariadb-upgrade## will re-create any missing tables in the [[the-mysql-database-tables|mysql database]].  It will not touch any data in existing tables.

== See Also
* [[mariadb-check]]
* [[sql-commands-check-table|CHECK TABLE]] 
* [[repair-table|REPAIR TABLE]]
* [[downgrading-between-major-versions-of-mariadb|Downgrading between Major Versions of MariaDB]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>