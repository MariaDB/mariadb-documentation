<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Step 6: Test MariaDB MaxScale - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Step 6: Test MariaDB MaxScale - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/step-6-test-mariadb-maxscale/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/step-6-test-mariadb-maxscale/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/step-6-test-mariadb-maxscale/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/topologies/">Topologies</a>
    

    
    » <a class="crumb" href="/kb/en/topologies-galera-cluster/">Galera Cluster</a>
    


    » <a class="node_link crumb" href="/kb/en/step-6-test-mariadb-maxscale/">Step 6: Test MariaDB MaxScale</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/step-6-test-mariadb-maxscale/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Step 6: Test MariaDB MaxScale - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/step-6-test-mariadb-maxscale/+r/150971/">150971</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-16293">
<a href="/kb/user/id/16293" title="Shwetha CM">Shwetha CM</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2025-04-29 10:11">2025-04-29 10:11</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;

= Overview
This page details step 6 of the 6-step procedure &#34;[[deploy-galera-cluster-topology|Deploy Galera Cluster Topology]]&#34;.

This step tests MariaDB MaxScale.

Interactive commands are detailed. Alternatively, the described operations can be performed using automation.

= Check Global Configuration

Use [[mariadb-maxscale-2302-maxctrl/#show-maxscale|maxctrl show maxscale]] command to view the global MaxScale configuration.

This action is performed on the MaxScale node:

&lt;&lt;code&gt;&gt;
$ maxctrl show maxscale
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
┌──────────────┬───────────────────────────────────────────────────────┐
│ Version      │ 25.01.2                                               │
├──────────────┼───────────────────────────────────────────────────────┤
│ Commit       │ 3761fa7a52046bc58faad8b5a139116f9e33364c              │
├──────────────┼───────────────────────────────────────────────────────┤
│ Started At   │ Thu, 05 Aug 2021 20:21:20 GMT                         │
├──────────────┼───────────────────────────────────────────────────────┤
│ Activated At │ Thu, 05 Aug 2021 20:21:20 GMT                         │
├──────────────┼───────────────────────────────────────────────────────┤
│ Uptime       │ 868                                                   │
├──────────────┼───────────────────────────────────────────────────────┤
│ Config Sync  │ null                                                  │
├──────────────┼───────────────────────────────────────────────────────┤
│ Parameters   │ {                                                     │
│              │     &#34;admin_auth&#34;: true,                               │
│              │     &#34;admin_enabled&#34;: true,                            │
│              │     &#34;admin_gui&#34;: true,                                │
│              │     &#34;admin_host&#34;: &#34;0.0.0.0&#34;,                          │
│              │     &#34;admin_log_auth_failures&#34;: true,                  │
│              │     &#34;admin_pam_readonly_service&#34;: null,               │
│              │     &#34;admin_pam_readwrite_service&#34;: null,              │
│              │     &#34;admin_port&#34;: 8989,                               │
│              │     &#34;admin_secure_gui&#34;: false,                        │
│              │     &#34;admin_ssl_ca_cert&#34;: null,                        │
│              │     &#34;admin_ssl_cert&#34;: null,                           │
│              │     &#34;admin_ssl_key&#34;: null,                            │
│              │     &#34;admin_ssl_version&#34;: &#34;MAX&#34;,                       │
│              │     &#34;auth_connect_timeout&#34;: &#34;10000ms&#34;,                │
│              │     &#34;auth_read_timeout&#34;: &#34;10000ms&#34;,                   │
│              │     &#34;auth_write_timeout&#34;: &#34;10000ms&#34;,                  │
│              │     &#34;cachedir&#34;: &#34;/var/cache/maxscale&#34;,                │
│              │     &#34;config_sync_cluster&#34;: null,                      │
│              │     &#34;config_sync_interval&#34;: &#34;5000ms&#34;,                 │
│              │     &#34;config_sync_password&#34;: &#34;*****&#34;,                  │
│              │     &#34;config_sync_timeout&#34;: &#34;10000ms&#34;,                 │
│              │     &#34;config_sync_user&#34;: null,                         │
│              │     &#34;connector_plugindir&#34;: &#34;/usr/lib64/mysql/plugin&#34;, │
│              │     &#34;datadir&#34;: &#34;/var/lib/maxscale&#34;,                   │
│              │     &#34;debug&#34;: null,                                    │
│              │     &#34;dump_last_statements&#34;: &#34;never&#34;,                  │
│              │     &#34;execdir&#34;: &#34;/usr/bin&#34;,                            │
│              │     &#34;language&#34;: &#34;/var/lib/maxscale&#34;,                  │
│              │     &#34;libdir&#34;: &#34;/usr/lib64/maxscale&#34;,                  │
│              │     &#34;load_persisted_configs&#34;: true,                   │
│              │     &#34;local_address&#34;: null,                            │
│              │     &#34;log_debug&#34;: false,                               │
│              │     &#34;log_info&#34;: false,                                │
│              │     &#34;log_notice&#34;: true,                               │
│              │     &#34;log_throttling&#34;: {                               │
│              │         &#34;count&#34;: 10,                                  │
│              │         &#34;suppress&#34;: 10000,                            │
│              │         &#34;window&#34;: 1000                                │
│              │     },                                                │
│              │     &#34;log_warn_super_user&#34;: false,                     │
│              │     &#34;log_warning&#34;: true,                              │
│              │     &#34;logdir&#34;: &#34;/var/log/maxscale&#34;,                    │
│              │     &#34;max_auth_errors_until_block&#34;: 10,                │
│              │     &#34;maxlog&#34;: true,                                   │
│              │     &#34;module_configdir&#34;: &#34;/etc/maxscale.modules.d&#34;,    │
│              │     &#34;ms_timestamp&#34;: false,                            │
│              │     &#34;passive&#34;: false,                                 │
│              │     &#34;persistdir&#34;: &#34;/var/lib/maxscale/maxscale.cnf.d&#34;, │
│              │     &#34;piddir&#34;: &#34;/var/run/maxscale&#34;,                    │
│              │     &#34;query_classifier&#34;: &#34;qc_sqlite&#34;,                  │
│              │     &#34;query_classifier_args&#34;: null,                    │
│              │     &#34;query_classifier_cache_size&#34;: 289073971,         │
│              │     &#34;query_retries&#34;: 1,                               │
│              │     &#34;query_retry_timeout&#34;: &#34;5000ms&#34;,                  │
│              │     &#34;rebalance_period&#34;: &#34;0ms&#34;,                        │
│              │     &#34;rebalance_threshold&#34;: 20,                        │
│              │     &#34;rebalance_window&#34;: 10,                           │
│              │     &#34;retain_last_statements&#34;: 0,                      │
│              │     &#34;session_trace&#34;: 0,                               │
│              │     &#34;skip_permission_checks&#34;: false,                  │
│              │     &#34;sql_mode&#34;: &#34;default&#34;,                            │
│              │     &#34;syslog&#34;: true,                                   │
│              │     &#34;threads&#34;: 1,                                     │
│              │     &#34;users_refresh_interval&#34;: &#34;0ms&#34;,                  │
│              │     &#34;users_refresh_time&#34;: &#34;30000ms&#34;,                  │
│              │     &#34;writeq_high_water&#34;: 16777216,                    │
│              │     &#34;writeq_low_water&#34;: 8192                          │
│              │ }                                                     │
└──────────────┴───────────────────────────────────────────────────────┘
&lt;&lt;/code&gt;&gt;

Output should align to the global MaxScale configuration in the [[step-5-start-and-configure-mariadb-maxscale/#replace-the-default-configuration-file|new configuration file]] you created.

= Check Server Configuration

Use the [[mariadb-maxscale-2302-maxctrl/#list-servers|maxctrl list servers]] and [[mariadb-maxscale-2302-maxctrl/#show-server|maxctrl show server]] commands to view the configured server objects.

This action is performed on the MaxScale node:

1. Obtain the full list of servers objects:

&lt;&lt;code&gt;&gt;
$ maxctrl list servers
&lt;&lt;/code&gt;&gt;
&lt;&lt;code&gt;&gt;
┌────────┬─────────────┬──────┬─────────────┬─────────────────────────┬──────┐
│ Server │ Address     │ Port │ Connections │ State                   │ GTID │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node1  │ 192.0.2.101 │ 3306 │ 0           │ Slave, Synced, Running  │      │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node2  │ 192.0.2.102 │ 3306 │ 0           │ Slave, Synced, Running  │      │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node3  │ 192.0.2.103 │ 3306 │ 0           │ Master, Synced, Running │      │
└────────┴─────────────┴──────┴─────────────┴─────────────────────────┴──────┘
&lt;&lt;/code&gt;&gt;

2. For each server object, view the configuration:

&lt;&lt;code&gt;&gt;
$ maxctrl show server node3
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
┌─────────────────────┬───────────────────────────────────────────┐
│ Server              │ node3                                     │
├─────────────────────┼───────────────────────────────────────────┤
│ Address             │ 192.0.2.103                               │
├─────────────────────┼───────────────────────────────────────────┤
│ Port                │ 3306                                      │
├─────────────────────┼───────────────────────────────────────────┤
│ State               │ Master, Synced, Running                   │
├─────────────────────┼───────────────────────────────────────────┤
│ Version             │ 11.4.5-3-MariaDB-enterprise-log           │
├─────────────────────┼───────────────────────────────────────────┤
│ Last Event          │ master_up                                 │
├─────────────────────┼───────────────────────────────────────────┤
│ Triggered At        │ Thu, 05 Aug 2021 20:22:26 GMT             │
├─────────────────────┼───────────────────────────────────────────┤
│ Services            │ connection_router_service                 │
│                     │ query_router_service                      │
├─────────────────────┼───────────────────────────────────────────┤
│ Monitors            │ cluster_monitor                           │
├─────────────────────┼───────────────────────────────────────────┤
│ Master ID           │ -1                                        │
├─────────────────────┼───────────────────────────────────────────┤
│ Node ID             │ 1                                         │
├─────────────────────┼───────────────────────────────────────────┤
│ Slave Server IDs    │                                           │
├─────────────────────┼───────────────────────────────────────────┤
│ Current Connections │ 1                                         │
├─────────────────────┼───────────────────────────────────────────┤
│ Total Connections   │ 1                                         │
├─────────────────────┼───────────────────────────────────────────┤
│ Max Connections     │ 1                                         │
├─────────────────────┼───────────────────────────────────────────┤
│ Statistics          │ {                                         │
│                     │     &#34;active_operations&#34;: 0,               │
│                     │     &#34;adaptive_avg_select_time&#34;: &#34;0ns&#34;,    │
│                     │     &#34;connection_pool_empty&#34;: 0,           │
│                     │     &#34;connections&#34;: 1,                     │
│                     │     &#34;max_connections&#34;: 1,                 │
│                     │     &#34;max_pool_size&#34;: 0,                   │
│                     │     &#34;persistent_connections&#34;: 0,          │
│                     │     &#34;reused_connections&#34;: 0,              │
│                     │     &#34;routed_packets&#34;: 0,                  │
│                     │     &#34;total_connections&#34;: 1                │
│                     │ }                                         │
├─────────────────────┼───────────────────────────────────────────┤
│ Parameters          │ {                                         │
│                     │     &#34;address&#34;: &#34;192.0.2.103&#34;,               │
│                     │     &#34;disk_space_threshold&#34;: null,         │
│                     │     &#34;extra_port&#34;: 0,                      │
│                     │     &#34;monitorpw&#34;: null,                    │
│                     │     &#34;monitoruser&#34;: null,                  │
│                     │     &#34;persistmaxtime&#34;: &#34;0ms&#34;,              │
│                     │     &#34;persistpoolmax&#34;: 0,                  │
│                     │     &#34;port&#34;: 3306,                         │
│                     │     &#34;priority&#34;: 0,                        │
│                     │     &#34;proxy_protocol&#34;: false,              │
│                     │     &#34;rank&#34;: &#34;primary&#34;,                    │
│                     │     &#34;socket&#34;: null,                       │
│                     │     &#34;ssl&#34;: false,                         │
│                     │     &#34;ssl_ca_cert&#34;: null,                  │
│                     │     &#34;ssl_cert&#34;: null,                     │
│                     │     &#34;ssl_cert_verify_depth&#34;: 9,           │
│                     │     &#34;ssl_cipher&#34;: null,                   │
│                     │     &#34;ssl_key&#34;: null,                      │
│                     │     &#34;ssl_verify_peer_certificate&#34;: false, │
│                     │     &#34;ssl_verify_peer_host&#34;: false,        │
│                     │     &#34;ssl_version&#34;: &#34;MAX&#34;                  │
│                     │ }                                         │
└─────────────────────┴───────────────────────────────────────────┘

&lt;&lt;/code&gt;&gt;


Output should align to the [[step-5-start-and-configure-mariadb-maxscale/#configure-server-objects|Server Object configuration]] you performed.

= Check Monitor Configuration

Use the [[mariadb-maxscale-2302-maxctrl/#list-monitors|maxctrl list monitors]] and [[mariadb-maxscale-2302-maxctrl/#show-monitor|maxctrl show monitor]] commands to view the configured monitors.

This action is performed on the MaxScale node:

1. Obtain the full list of monitors:

&lt;&lt;code&gt;&gt;

$ maxctrl list monitors
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;

┌─────────────────┬─────────┬─────────────────────┐
│ Monitor         │ State   │ Servers             │
├─────────────────┼─────────┼─────────────────────┤
│ cluster_monitor │ Running │ node1, node2, node3 │
└─────────────────┴─────────┴─────────────────────┘
&lt;&lt;/code&gt;&gt;


2. For each monitor, view the monitor configuration:

&lt;&lt;code&gt;&gt;

$ maxctrl show monitor cluster_monitor
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;

┌─────────────────────┬──────────────────────────────────────────────────────┐
│ Monitor             │ cluster_monitor                                      │
├─────────────────────┼──────────────────────────────────────────────────────┤
│ Module              │ galeramon                                            │
├─────────────────────┼──────────────────────────────────────────────────────┤
│ State               │ Running                                              │
├─────────────────────┼──────────────────────────────────────────────────────┤
│ Servers             │ node1                                                │
│                     │ node2                                                │
│                     │ node3                                                │
├─────────────────────┼──────────────────────────────────────────────────────┤
│ Parameters          │ {                                                    │
│                     │     ..                                               │
│                     │ }                                                    │
├─────────────────────┼──────────────────────────────────────────────────────┤
│ Monitor Diagnostics │ {                                                    │
│                     │     ..                                               │
│                     │ }                                                    │
└─────────────────────┴──────────────────────────────────────────────────────┘
&lt;&lt;/code&gt;&gt;

Output should align to the [[step-5-start-and-configure-mariadb-maxscale/#configure-the-galera-monitor|Galera Monitor (galeramon) configuration]] you performed.

= Check Service Configuration

Use the [[mariadb-maxscale-2302-maxctrl/#list-services|maxctrl list services]] and [[mariadb-maxscale-2302-maxctrl/#show-services|maxctrl show service]] commands to view the configured routing services.

This action is performed on the MaxScale node:

1. Obtain the full list of routing services:

&lt;&lt;code&gt;&gt;

$ maxctrl list services
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;

┌───────────────────────────┬────────────────┬─────────────┬───────────────────┬─────────────────────┐
│ Service                   │ Router         │ Connections │ Total Connections │ Servers             │
├───────────────────────────┼────────────────┼─────────────┼───────────────────┼─────────────────────┤
│ connection_router_service │ readconnroute  │ 0           │ 0                 │ node1, node2, node3 │
├───────────────────────────┼────────────────┼─────────────┼───────────────────┼─────────────────────┤
│ query_router_service      │ readwritesplit │ 1           │ 1                 │ node1, node2, node3 │
└───────────────────────────┴────────────────┴─────────────┴───────────────────┴─────────────────────┘
&lt;&lt;/code&gt;&gt;


2. For each service, view the service configuration:

&lt;&lt;code&gt;&gt;

$ maxctrl show service query_router_service
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;

┌─────────────────────┬─────────────────────────────────────────────────────────────┐
│ Service             │ query_router_service                                        │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Router              │ readwritesplit                                              │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ State               │ Started                                                     │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Started At          │ Thu Aug  5 20:23:38 2021                                    │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Current Connections │ 1                                                           │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Total Connections   │ 1                                                           │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Max Connections     │ 1                                                           │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Cluster             │                                                             │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Servers             │ node1                                                       │
│                     │ node2                                                       │
│                     │ node3                                                       │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Services            │                                                             │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Filters             │                                                             │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Parameters          │ {                                                           │
│                     │     &#34;auth_all_servers&#34;: false,                              │
│                     │     &#34;causal_reads&#34;: &#34;false&#34;,                                │
│                     │     &#34;causal_reads_timeout&#34;: &#34;10000ms&#34;,                      │
│                     │     &#34;connection_keepalive&#34;: &#34;300000ms&#34;,                     │
│                     │     &#34;connection_timeout&#34;: &#34;0ms&#34;,                            │
│                     │     &#34;delayed_retry&#34;: false,                                 │
│                     │     &#34;delayed_retry_timeout&#34;: &#34;10000ms&#34;,                     │
│                     │     &#34;disable_sescmd_history&#34;: false,                        │
│                     │     &#34;enable_root_user&#34;: false,                              │
│                     │     &#34;idle_session_pool_time&#34;: &#34;-1000ms&#34;,                    │
│                     │     &#34;lazy_connect&#34;: false,                                  │
│                     │     &#34;localhost_match_wildcard_host&#34;: true,                  │
│                     │     &#34;log_auth_warnings&#34;: true,                              │
│                     │     &#34;master_accept_reads&#34;: false,                           │
│                     │     &#34;master_failure_mode&#34;: &#34;fail_instantly&#34;,                │
│                     │     &#34;master_reconnection&#34;: false,                           │
│                     │     &#34;max_connections&#34;: 0,                                   │
│                     │     &#34;max_sescmd_history&#34;: 50,                               │
│                     │     &#34;max_slave_connections&#34;: 255,                           │
│                     │     &#34;max_slave_replication_lag&#34;: &#34;0ms&#34;,                     │
│                     │     &#34;net_write_timeout&#34;: &#34;0ms&#34;,                             │
│                     │     &#34;optimistic_trx&#34;: false,                                │
│                     │     &#34;password&#34;: &#34;*****&#34;,                                    │
│                     │     &#34;prune_sescmd_history&#34;: true,                           │
│                     │     &#34;rank&#34;: &#34;primary&#34;,                                      │
│                     │     &#34;retain_last_statements&#34;: -1,                           │
│                     │     &#34;retry_failed_reads&#34;: true,                             │
│                     │     &#34;reuse_prepared_statements&#34;: false,                     │
│                     │     &#34;router&#34;: &#34;readwritesplit&#34;,                             │
│                     │     &#34;session_trace&#34;: false,                                 │
│                     │     &#34;session_track_trx_state&#34;: false,                       │
│                     │     &#34;slave_connections&#34;: 255,                               │
│                     │     &#34;slave_selection_criteria&#34;: &#34;LEAST_CURRENT_OPERATIONS&#34;, │
│                     │     &#34;strict_multi_stmt&#34;: false,                             │
│                     │     &#34;strict_sp_calls&#34;: false,                               │
│                     │     &#34;strip_db_esc&#34;: true,                                   │
│                     │     &#34;transaction_replay&#34;: false,                            │
│                     │     &#34;transaction_replay_attempts&#34;: 5,                       │
│                     │     &#34;transaction_replay_max_size&#34;: 1073741824,              │
│                     │     &#34;transaction_replay_retry_on_deadlock&#34;: false,          │
│                     │     &#34;type&#34;: &#34;service&#34;,                                      │
│                     │     &#34;use_sql_variables_in&#34;: &#34;all&#34;,                          │
│                     │     &#34;user&#34;: &#34;mxs&#34;,                                          │
│                     │     &#34;version_string&#34;: null                                  │
│                     │ }                                                           │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Router Diagnostics  │ {                                                           │
│                     │     &#34;avg_sescmd_history_length&#34;: 0,                         │
│                     │     &#34;max_sescmd_history_length&#34;: 0,                         │
│                     │     &#34;queries&#34;: 1,                                           │
│                     │     &#34;replayed_transactions&#34;: 0,                             │
│                     │     &#34;ro_transactions&#34;: 0,                                   │
│                     │     &#34;route_all&#34;: 0,                                         │
│                     │     &#34;route_master&#34;: 0,                                      │
│                     │     &#34;route_slave&#34;: 1,                                       │
│                     │     &#34;rw_transactions&#34;: 0,                                   │
│                     │     &#34;server_query_statistics&#34;: [                            │
│                     │         {                                                   │
│                     │             &#34;avg_selects_per_session&#34;: 0,                   │
│                     │             &#34;avg_sess_duration&#34;: &#34;0ns&#34;,                     │
│                     │             &#34;id&#34;: &#34;node2&#34;,                                  │
│                     │             &#34;read&#34;: 1,                                      │
│                     │             &#34;total&#34;: 1,                                     │
│                     │             &#34;write&#34;: 0                                      │
│                     │         }                                                   │
│                     │     ]                                                       │
│                     │ }                                                           │
└─────────────────────┴─────────────────────────────────────────────────────────────┘
&lt;&lt;/code&gt;&gt;

Output should align to the [[step-5-start-and-configure-mariadb-maxscale/#choose-a-maxscale-router|Read Connection Router (readconnroute) or Read/Write Split Router (readwritesplit)]] configuration you performed.

= Test Application User

Applications should use a dedicated user account. The user account must be created on the primary server.

When users connect to MaxScale, MaxScale authenticates the user connection before routing it to an Enterprise Server node. Enterprise Server authenticates the connection as originating from the IP address of the MaxScale node.

The application users must have one user account with the host IP address of the application server and a second user account with the host IP address of the MaxScale node.

The requirement of a duplicate user account can be avoided by enabling the ##proxy_protocol## parameter for MaxScale and the [[server-system-variables/#proxy_protocol_networks|proxy_protocol_networks]] for Enterprise Server.

== Create a User to Connect from MaxScale

This action is performed on any Enterprise Cluster node:

1. Connect to the node:

&lt;&lt;code&gt;&gt;

$ sudo mariadb
&lt;&lt;/code&gt;&gt;

2. Create the database user account for your MaxScale node:

&lt;&lt;code&gt;&gt;
CREATE USER &#39;app_user&#39;@&#39;192.0.2.104&#39; IDENTIFIED BY &#39;app_user_passwd&#39;;
&lt;&lt;/code&gt;&gt;

Replace 192.0.2.104 with the relevant IP address specification for your MaxScale node.

Passwords should meet your organization&#39;s password policies.


3. Grant the privileges required by your application to the database user account for your MaxScale node:

&lt;&lt;code&gt;&gt;
GRANT ALL ON test.* TO &#39;app_user&#39;@&#39;192.0.2.104&#39;;
&lt;&lt;/code&gt;&gt;

The privileges shown are designed to allow the tests in the subsequent sections to work. The user account for your production application may require different privileges.

== Create a User to Connect from the Application Server

This action is performed on any Enterprise Cluster node:

1. Create the database user account for your application server:

&lt;&lt;code&gt;&gt;
CREATE USER &#39;app_user&#39;@&#39;192.0.2.11&#39; IDENTIFIED BY &#39;app_user_passwd&#39;;
&lt;&lt;/code&gt;&gt;
Replace 192.0.2.11 with the relevant IP address specification for your application server.

Passwords should meet your organization&#39;s password policies.

2. Grant the privileges required by your application to the database user account for your application server:

&lt;&lt;code&gt;&gt;
GRANT ALL ON test.* TO &#39;app_user&#39;@&#39;192.0.2.11&#39;;
&lt;&lt;/code&gt;&gt;
The privileges shown are designed to allow the tests in the subsequent sections to work. The user account for your production application may require different privileges.

== Test Connection with Application User

To test the connection, use the [[mariadb-client|MariaDB Client]] from your application server to connect to an Enterprise Cluster node through MaxScale.

This action is performed on the application server:

&lt;&lt;code&gt;&gt;
$ mariadb --host 192.0.2.104 --port 3307
      --user app_user --password
&lt;&lt;/code&gt;&gt;

= Test Connection with Read Connection Router

If you configured the [[step-5-start-and-configure-mariadb-maxscale/#configure-read-connection-router|Read Connection Router]], confirm that MaxScale routes connections to the replica servers.

1. On the MaxScale node, use the [[mariadb-maxscale-2302-maxctrl/#list-listeners|maxctrl list listeners]] command to view the available listeners and ports:

&lt;&lt;code&gt;&gt;
$ maxctrl list listeners
&lt;&lt;/code&gt;&gt;
&lt;&lt;code&gt;&gt;
┌────────────────────────────┬──────┬──────┬─────────┬───────────────────────────┐
│ Name                       │ Port │ Host │ State   │ Service                   │
├────────────────────────────┼──────┼──────┼─────────┼───────────────────────────┤
│ connection_router_listener │ 3308 │ ::   │ Running │ connection_router_service │
├────────────────────────────┼──────┼──────┼─────────┼───────────────────────────┤
│ query_router_listener      │ 3307 │ ::   │ Running │ query_router_service      │
└────────────────────────────┴──────┴──────┴─────────┴───────────────────────────┘
&lt;&lt;/code&gt;&gt;

2. Open multiple terminals connected to your application server, in each use [[mariadb-client|MariaDB Client]] to connect to the listener port for the Read Connection Router (in the example 3308):

&lt;&lt;code&gt;&gt;
$ mariadb --host 192.0.2.104 --port 3308 \
      --user app_user --password
&lt;&lt;/code&gt;&gt;

Use [[step-6-test-mariadb-maxscale/#test-application-user|the application user]] credentials you created for the ##--user## and ##--password## options.

3. In each terminal, query the [[server-system-variables/#hostname|hostname]] system variable to identify to which you&#39;re connected:

&lt;&lt;code&gt;&gt;
SELECT @@global.hostname;

+-------------------+
| @@global.hostname |
+-------------------+
|             node2 |
+-------------------+
&lt;&lt;/code&gt;&gt;

Different terminals should return different values since MaxScale routes the connections to different nodes.

Since the router was configured the slave router option, the Read Connection Router only routes connections to replica servers.

= Test Write Queries with the Read/Write Split Router

If you configured the [[step-5-start-and-configure-mariadb-maxscale/#choose-a-maxscale-router|Read/Write Split Router, confirm that readwritesplit]] correctly routes write queries.

This action is performed with multiple client connections to the MaxScale node.

1. On the MaxScale node, use the [[mariadb-maxscale-2302-maxctrl/#list-servers|maxctrl list servers]] command to identify the Enterprise Cluster node currently operating as the primary server:

&lt;&lt;code&gt;&gt;
$ maxctrl list servers
&lt;&lt;/code&gt;&gt;
&lt;&lt;code&gt;&gt;

┌────────┬─────────────┬──────┬─────────────┬─────────────────────────┬──────┐
│ Server │ Address     │ Port │ Connections │ State                   │ GTID │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node1  │ 192.0.2.101 │ 3306 │ 0           │ Slave, Synced, Running  │      │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node2  │ 192.0.2.102 │ 3306 │ 0           │ Slave, Synced, Running  │      │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node3  │ 192.0.2.103 │ 3306 │ 0           │ Master, Synced, Running │      │
└────────┴─────────────┴──────┴─────────────┴─────────────────────────┴──────┘
&lt;&lt;/code&gt;&gt;

The server listed as Master is currently operating as the primary server.

2. On the MaxScale node, use the [[mariadb-maxscale-2302-maxctrl/#list-listeners|maxctrl list listeners]] command to identify the correct listener port:

&lt;&lt;code&gt;&gt;
$ maxctrl list listeners galerarouter
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
┌────────────────────────────┬──────┬───────┬─────────┬───────────────────────────┐
│ Name                       │ Port │ Host  │ State   │ Service                   │
├────────────────────────────┼──────┼───────┼─────────┼───────────────────────────┤
│ connection_router_listener │ 3308 │       │ Running │ connection_router_service │
│ query_router_listener      │ 3307 │       │ Running │ query_router_service      │
└────────────────────────────┴──────┴───────┴─────────┴───────────────────────────┘
&lt;&lt;/code&gt;&gt;
In the example, the listener port for the Read/Write Split router is 3307.

3. Use the [[mariadb-client|MariaDB Client]] to establish multiple connections to the listener configured for the Read/Write Split routing service, ##query_router_listener##, on the MaxScale node:

&lt;&lt;code&gt;&gt;
$ mariadb --host=192.0.2.104 --port=3307 \
      --user=app_user --password=app_user_passwd
&lt;&lt;/code&gt;&gt;

The [[step-6-test-mariadb-maxscale/#test-application-user|database user account]] for your application server should be specified by the ##--user## option.

4. Using any client connection, create a test table:

&lt;&lt;code&gt;&gt;
CREATE TABLE test.load_balancing_test (
   id INT PRIMARY KEY AUTO_INCREMENT,
   hostname VARCHAR(256)
);

&lt;&lt;/code&gt;&gt;

5. Using each client connection, insert the values of the [[server-system-variables/#hostname|hostname]] system variable into the table using the [[insert|INSERT]] statement to identify the node that executes the statement:

&lt;&lt;code&gt;&gt;
INSERT INTO test.load_balancing_test (hostname)
VALUES (@@global.hostname);
&lt;&lt;/code&gt;&gt;

6. Using any client connection, query the table using the [[select|SELECT]] statement:

&lt;&lt;code&gt;&gt;
SELECT * FROM test.load_balancing_test;
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
+----+----------+
| id | hostname |
+----+----------+
|  1 | node3    |
|  4 | node3    |
|  7 | node3    |
+----+----------+
&lt;&lt;/code&gt;&gt;

The output shows the [[server-system-variables/#hostname|hostname]] from the Enterprise Cluster node operating as the primary server. (Enterprise Cluster offsets auto-increment values by node to avoid write conflicts.)

Confirm that MaxScale is routing write queries to the Enterprise Cluster node operating as the primary server by checking that the test table only contains the [[server-system-variables/#hostname|hostname]] of the correct Enterprise Cluster node.

=Test Read Queries with the Read/Write Split Router

If you configured the [[step-5-start-and-configure-mariadb-maxscale/#choose-a-maxscale-router|Read/Write Split Router]], confirm that readwritesplit properly routes read queries to multiple replica servers.

This action is performed with multiple clients connected to the MaxScale node.

1. On the MaxScale node, use [[mariadb-maxscale-2302-maxctrl/#list-servers|maxctrl list servers]] to identify the Enterprise Cluster nodes that are currently operating as replica servers:

&lt;&lt;code&gt;&gt;
$ maxctrl list servers
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
┌────────┬─────────────┬──────┬─────────────┬─────────────────────────┬──────┐
│ Server │ Address     │ Port │ Connections │ State                   │ GTID │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node1  │ 192.0.2.101 │ 3306 │ 0           │ Slave, Synced, Running  │      │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node2  │ 192.0.2.102 │ 3306 │ 0           │ Slave, Synced, Running  │      │
├────────┼─────────────┼──────┼─────────────┼─────────────────────────┼──────┤
│ node3  │ 192.0.2.103 │ 3306 │ 0           │ Master, Synced, Running │      │
└────────┴─────────────┴──────┴─────────────┴─────────────────────────┴──────┘
&lt;&lt;/code&gt;&gt;

The servers listed as Slave are currently operating as replica servers.

2. On the MaxScale node, use the [[mariadb-maxscale-2302-maxctrl/#list-listeners|maxctrl list listeners]] command to identify the correct listener port:

&lt;&lt;code&gt;&gt;
$ maxctrl list listeners
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
┌────────────────────────────┬──────┬───────┬─────────┬───────────────────────────┐
│ Name                       │ Port │ Host  │ State   │ Service                   │
├────────────────────────────┼──────┼───────┼─────────┼───────────────────────────┤
│ connection_router_listener │ 3308 │       │ Running │ connection_router_service │
│ query_router_listener      │ 3307 │       │ Running │ query_router_service      │
└────────────────────────────┴──────┴───────┴─────────┴───────────────────────────┘
&lt;&lt;/code&gt;&gt;
In the example, the listener port for the Read/Write Split router is 3307.

3. Use the [[mariadb-client|MariaDB Client]] to establish multiple connections to ##query_router_listener## which is the listener configured for the Read/Write Split routing service on the MaxScale node:

&lt;&lt;code&gt;&gt;
$ mariadb --host=192.0.2.104 --port=3307 \
   --user=app_user --password=app_user_passwd
&lt;&lt;/code&gt;&gt;

The [[step-6-test-mariadb-maxscale/#test-application-user|database user account]] for your application server should be specified by the --user option.

4. Using each client connection, query the [[server-system-variables/#hostname|hostname]] system variable to identify the node that executes the statement:

&lt;&lt;code&gt;&gt;
SELECT @@global.hostname;

+-------------------+
| @@global.hostname |
+-------------------+
|             node2 |
+-------------------+
&lt;&lt;/code&gt;&gt;

The output shows the hostname value from one of the Enterprise Cluster nodes operating as replica servers.

Confirm that MaxScale is routing read queries to multiple Enterprise Cluster nodes operating as replica servers by checking that different client connections return different hostname values.

For more information on different routing criteria, ##slave_selection_criteria##

= Next Step

Navigation in the procedure &#34;[[deploy-galera-cluster-topology|Deploy Galera Cluster Topology]]&#34;:

This page was step 6 of 6.

This procedure is complete.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>