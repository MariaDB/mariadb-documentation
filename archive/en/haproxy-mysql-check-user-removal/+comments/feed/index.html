<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>MariaDB Knowledge Base Comments for: Haproxy mysql-check user removal</title><link>https://mariadb.com/kb/en/haproxy-mysql-check-user-removal/+comments/feed/</link><description></description><atom:link href="https://mariadb.com/kb/en/haproxy-mysql-check-user-removal/+comments/feed/" rel="self"></atom:link><language>en-us</language><lastBuildDate>Mon, 29 Jul 2024 14:39:42 +0000</lastBuildDate><item><title>Re: Haproxy mysql-check user removal</title><link>https://mariadb.com/kb/en/haproxy-mysql-check-user-removal/+comments/5323</link><description>&lt;p&gt;I'm looking at &lt;a href="https://www.mail-archive.com/haproxy@formilux.org/msg40848.html"&gt;working with the haproxy development community&lt;/a&gt; to provide you an alternate solution. I hope these options are acceptable to you.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Daniel Black</dc:creator><guid>https://mariadb.com/kb/en/haproxy-mysql-check-user-removal/+comments/5323</guid></item><item><title>Re: Haproxy mysql-check user removal</title><link>https://mariadb.com/kb/en/haproxy-mysql-check-user-removal/+comments/5319</link><description>&lt;p&gt;mysql-check requires a user. This is the answer given by the &lt;a href="https://discourse.haproxy.org/t/haproxy-mysql-check-user-removal/6685"&gt;haproxy people too&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Per haproxy docs and &lt;a href="https://stackoverflow.com/questions/57786879/haproxy-with-mysql-check-option-not-working"&gt;other answers&lt;/a&gt; there is no password and setting one causes the check to fail. Because there is no password PASSWORD EXIRE options cannot be used. ACCOUNT LOCK I also checked isn't compatible with the haproxy mysql-check.&lt;/p&gt;
&lt;p&gt;The user that haproxy uses does not need any access to anything. This is the default for a created user. Per &lt;a href="https://cbonte.github.io/haproxy-dconv/2.5/configuration.html#4-option%20mysql-check"&gt;the ha-proxy documentation&lt;/a&gt; it doesn't even execute a query and aborts very soon into the protocol.&lt;/p&gt;
&lt;p&gt;What could be done is a constraint of the user to the network of the ha-proxy and apply resource constraints.&lt;/p&gt;
&lt;pre class="fixed"&gt;CREATE USER 'haproxycheck'@'192.168.2.20/255.255.255.252'   WITH MAX_QUERIES_PER_HOUR 1 MAX_UPDATES_PER_HOUR 0  MAX_STATEMENT_TIME 0.0000000001;
&lt;/pre&gt;&lt;p&gt;Any risk based assessment with a basic understanding of haproxy and mariadb and networking shouldn't have a problem here.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Daniel Black</dc:creator><guid>https://mariadb.com/kb/en/haproxy-mysql-check-user-removal/+comments/5319</guid></item></channel></rss>