<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Aria Storage Engine - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Aria Storage Engine - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/aria-storage-engine/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/aria-storage-engine/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/aria-storage-engine/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/aria/">Aria</a>
    


    » <a class="node_link crumb" href="/kb/en/aria-storage-engine/">Aria Storage Engine</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/aria-storage-engine/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Aria Storage Engine - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/aria-storage-engine/+r/121936/">121936</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-2">
<a href="/kb/user/id/2" title="Daniel Bartholomew">Daniel Bartholomew</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2022-11-29 15:46">2022-11-29 15:46</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;
The [[aria|Aria]] storage engine is compiled in by default from MariaDB 5.1 and it is required to be &#39;in use&#39; when MariaDB is started.

From MariaDB 10.4, all [[system-tables|system tables]] are Aria.

Additionally, internal on-disk tables are in the Aria table format instead of
the [[myisam|MyISAM]] table format. This should speed up some [[group-by|GROUP BY]]
and [[count-distinct|DISTINCT]] queries because Aria has better caching than
MyISAM. 

&lt;&lt;style class=&#34;greenbox&#34;&gt;&gt;
Note: The **//Aria//** storage engine was previously called //**Maria**// (see
[[the-aria-name|The Aria Name]] for details on the
rename) and in previous versions of [[MariaDB]] the engine was still called
Maria.
&lt;&lt;/style&gt;&gt;

The following table options to Aria tables in [[create-table|CREATE TABLE]] and [[alter-table|ALTER TABLE]]:

* **##TRANSACTIONAL= 0 {{{|}}} 1## :** If the ##TRANSACTIONAL## table option is set for an Aria table, then the table will be crash-safe. This is implemented by logging any changes to the table to Aria&#39;s transaction log, and syncing those writes at the end of the statement. This will marginally slow down writes and updates. However, the benefit is that if the server dies before the statement ends, all non-durable changes will roll back to the state at the beginning of the statement. This also needs up to 6 bytes more for each row and key to store the transaction id (to allow concurrent insert&#39;s and selects).
** ##TRANSACTIONAL=1## is not supported for partitioned tables.
** An Aria table&#39;s default value for the ##TRANSACTIONAL## table option depends on the table&#39;s value for the ##ROW_FORMAT## table option. See below for more details.
** If the ##TRANSACTIONAL## table option is set for an Aria table, the table does not actually support transactions. See MDEV-21364 for more information. In this context, //transactional// just means //crash-safe//.
* **##PAGE_CHECKSUM= 0 {{{|}}} 1## :** If index and data should use
  page checksums for extra safety.
* **##TABLE_CHECKSUM= 0 {{{|}}} 1## :**
  Same as ##CHECKSUM## in MySQL 5.1
* **##ROW_FORMAT=PAGE {{{|}}} FIXED {{{|}}} DYNAMIC## :** The table&#39;s [[aria-storage-formats|row format]].
** The default value is ##PAGE##.
** To emulate MyISAM, set ##ROW_FORMAT=FIXED## or ##ROW_FORMAT=DYNAMIC##

The ##TRANSACTIONAL## and ##ROW_FORMAT## table options interact as follows:

* If ##TRANSACTIONAL=1## is set, then the only supported row format is ##PAGE##. If ##ROW_FORMAT## is set to some other value, then Aria issues a warning, but still forces the row format to be ##PAGE##.
* If ##TRANSACTIONAL=0## is set, then the table will be not be crash-safe, and any row format is supported.
* If ##TRANSACTIONAL## is not set to any value, then any row format is supported. If ##ROW_FORMAT## is set, then the table will use that row format. Otherwise, the table will use the default ##PAGE## row format. In this case, if the table uses the ##PAGE## row format, then it will be crash-safe. If it uses some other row format, then it will not be crash-safe.

Some other improvements are:

* [[checksum-table|CHECKSUM TABLE]] now ignores values in NULL fields. This
  makes ##CHECKSUM TABLE## faster and fixes some cases where
  same table definition could give different checksum values depending on [[aria-storage-formats|row
  format]]. The disadvantage is that the value is now different compared to other
  MySQL installations. The new checksum calculation is fixed for all table
  engines that uses the default way to calculate and MyISAM which does the
  calculation internally. Note: Old MyISAM tables with internal checksum will
  return the same checksum as before. To fix them to calculate according to new
  rules you have to do an ##[[alter-table|ALTER TABLE]]##. You can use the old
  ways to calculate checksums by using the option &lt;&lt;code&gt;&gt;--old&lt;&lt;/code&gt;&gt; to mariadbd//mysqld or set the
  system variable &#39;##@@old##&#39; to ##1## when you
  do ##CHECKSUM TABLE ...  EXTENDED;##
* At startup Aria will check the Aria logs and automatically recover the tables
  from the last checkpoint if the server was not taken down correctly. See [[#aria-log-files|Aria Log Files]]

== Startup Options for Aria

For a full list, see [[aria-server-system-variables|Aria System Variables]].

In normal operations, the only variables you have to consider are:

* [[aria-server-system-variables#aria_pagecache_buffer_size|aria-pagecache-buffer-size]]
** This is where all index and data pages are cached. The bigger this is, the faster
   Aria will work.
*[[[aria-server-system-variables#aria_block_size|aria-block-size]]
** The default value 8192, should be ok for most cases. The only problem with a higher
   value is that it takes longer to find a packed key in the block as one has to
   search roughly 8192/2 to find each key.  We plan to fix this by adding a
   dictionary at the end of the page to be able to do a binary search within
   the block before starting a scan.  Until this is done and key lookups takes
   too long time even if you are not hitting disk, then you should consider
   making this smaller.
** Possible values to try are ##2048##, ##4096## or ##8192##
** Note that you can&#39;t change this without dumping, deleting old tables and
   deleting all log files and then restoring your Aria tables. (This is the
   only option that requires a dump and load)
* [[aria-server-system-variables#aria_log_purge_type|aria-log-purge-type]]
** Set this to &#34;##at_flush##&#34; if you want to keep a copy of the transaction logs
   (good as an extra backup). The logs will stay around until you
   execute [[flush|FLUSH ENGINE LOGS]].

== Aria Log Files

##aria_log_control## file is a very short log file (52 bytes) that contains the current state of all Aria tables related to logging and checkpoints. In particular, it contains the following information:
&lt;&lt;code&gt;&gt;
Aria file version: 1
Block size: 8192
maria_uuid: ee948482-6cb7-11ed-accb-3c7c3ff16468
last_checkpoint_lsn: (1,0x235a)
last_log_number: 1
trid: 28
recovery_failures: 0
&lt;&lt;/code&gt;&gt;

* The ##uuid## is a unique identifier per system. All Aria files created will have a copy of this in their .MAI headers. This is mainly used to check if someone has copied an Aria file between MariaDB servers.
* ##last_checkpoint_lsn## and ##last_log_number## are information about the current aria_log files.
* ##trid## is the highest transaction number seen so far. Used by recovery.

##aria_log.*## files contain the log of all operations that change Aria files (including create table, drop table, insert etc..) This is a &#39;normal&#39; WAL (Write Ahead Log), similar to the InnoDB log file, except that aria_logs contain both redo and undo. Old aria_log files are automatically deleted when they are not needed anymore (Neither the last checkpoint or any running transaction need to refer to the old data anymore).

=== Missing valid id
The error ##Missing valid id at start of file. File is not a valid aria control file## means that something overwrote at least the first 4 bytes in the file. This can happen due to a problem with the file system (hardware or software), or a bug in which a thread inside MariaDB wrote on the wrong file descriptor (in which case you should [[reporting-bugs|report the bug]], attaching a copy of the control file to assist).

In the case of a corrupted log file, with the server shut down, one should be able to fix that by deleting all aria_log files.
If the control_file is corrupted, then one has to delete the aria_control_file and all aria_log.* files.
The effect of this is that on table open of an Aria table, the server will think that it has been moved from another system and do an automatic check and repair of it. If there was no issues, the table will be opened and can be used as normal. See also [[aria-faq/#when-is-it-safe-to-remove-old-log-files|When is it safe to remove old log files]].

== See Also
* [[aria-faq|Aria FAQ]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>