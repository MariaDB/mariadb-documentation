<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>CONNECT Table Types - Special &#34;Virtual&#34; Tables - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="CONNECT Table Types - Special &#34;Virtual&#34; Tables" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/connect-table-types-special-virtual-tables/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="VIR, WMI and MAC special table types" />

    <meta name="description" content="VIR, WMI and MAC special table types" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/connect-table-types-special-virtual-tables/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/connect-table-types-special-virtual-tables/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/connect/">CONNECT</a>
    

    
    » <a class="crumb" href="/kb/en/connect-table-types/">CONNECT Table Types</a>
    


    » <a class="node_link crumb" href="/kb/en/connect-table-types-special-virtual-tables/">CONNECT Table Types - Special &#34;Virtual&#34; Tables</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/connect-table-types-special-virtual-tables/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/connect-table-types-special-virtual-tables/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/connect-table-types-special-virtual-tables/+flag"
                data-flag-url="/kb/en/connect-table-types-special-virtual-tables/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/connect-table-types-special-virtual-tables/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2013-04-19 19:28">11 years, 5 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2017-06-13 09:39">7 years, 4 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/connect-table-types-special-virtual-tables/+license/">GPLv2</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/connect-table-types-special-virtual-tables/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/connect-table-types-special-virtual-tables/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/connect-table-types-special-virtual-tables/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>CONNECT Table Types - Special &#34;Virtual&#34; Tables</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#dir-type" title="DIR Type">DIR Type</a>    <ol class="toc">

        <li class=""><a href="#the-subdir-option" title="The Subdir option">The Subdir option</a></li>

        <li class=""><a href="#the-nodir-option-windows" title="The Nodir option (Windows)">The Nodir option (Windows)</a>    </ol>
</li>

    <li class=""><a href="#windows-management-instrumentation-table-type-wmi" title="Windows Management Instrumentation Table Type “WMI”">Windows Management Instrumentation Table Type “WMI”</a>    <ol class="toc">

        <li class=""><a href="#getting-column-information" title="Getting column information">Getting column information</a></li>

        <li class=""><a href="#performance-consideration" title="Performance Consideration">Performance Consideration</a></li>

        <li class=""><a href="#syntax-of-wmi-queries" title="Syntax of WMI queries">Syntax of WMI queries</a>    </ol>
</li>

    <li class=""><a href="#mac-address-table-type-mac" title="MAC Address Table Type “MAC”">MAC Address Table Type “MAC”</a> </ol>
</li>
</div><p>
The special table types supported by CONNECT are the Virtual table type (<a href="/kb/en/connect-table-types-vir/">VIR</a> - introduced in <a href="/kb/en/mariadb-10015-release-notes/">MariaDB 10.0.15</a>), Directory Listing table type (DIR), the Windows Management Instrumentation Table Type (WMI), and the “Mac Address” type (MAC).</p>
<p>These tables are “virtual tables”, meaning they have no physical data but rather produce result data using specific algorithms. Note that this is close to what Views are, so they could be regarded as special views.</p>
<h2 class="anchored_heading" id="dir-type">DIR Type</h2>
<p>A table of type DIR returns a list of file name and description as a result set. To create a DIR table, use a Create Table statement such as:</p>
<pre class="fixed"><span class="k">create</span> <span class="k">table</span> <span class="nf">source</span> <span class="p">(</span>
  <span class="n">DRIVE</span> <span class="kt">char</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="n">PATH</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="n">FNAME</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="n">FTYPE</span> <span class="kt">char</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="n">SIZE</span> <span class="kt">double</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="n">flag</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
  <span class="n">MODIFIED</span> <span class="kt">datetime</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">)</span>
<span class="kp">engine</span><span class="o">=</span><span class="n">CONNECT</span> <span class="n">table_type</span><span class="o">=</span><span class="n">DIR</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;..\\*.cc&#39;</span><span class="p">;</span>
</pre><p>When used in a query, the table returns the same file information listing than the system "DIR <code>*.cc</code>" statement would return if executed in the same current directory (here supposedly ..\)</p>
<p>For instance, the query:</p>
<pre class="fixed"><span class="k">select</span> <span class="n">fname</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">modified</span> <span class="k">from</span> <span class="n">source</span>
  <span class="k">where</span> <span class="n">fname</span> <span class="k">like</span> <span class="s1">&#39;%handler%&#39;</span><span class="p">;</span>
</pre><p>Displays:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>fname</th><th>size</th><th>modified</th></tr>
<tr><td>handler</td><td>152177</td><td>2011-06-13 18:08:29</td></tr>
<tr><td>sql_handler</td><td>25321</td><td>2011-06-13 18:08:31</td></tr>
</table>
</div><p><strong>Note:</strong> the important item in this table is the flag option value (set sequentially from 0 by default) because it determines which particular information item is returned in the column:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>Flag value</th><th>Information</th></tr>
<tr><td>0</td><td>The disk drive (Windows)</td></tr>
<tr><td>1</td><td>The file path</td></tr>
<tr><td>2</td><td>The file name</td></tr>
<tr><td>3</td><td>The file type</td></tr>
<tr><td>4</td><td>The file attribute</td></tr>
<tr><td>5</td><td>The file size</td></tr>
<tr><td>6</td><td>The last write access date</td></tr>
<tr><td>7</td><td>The last read access date</td></tr>
<tr><td>8</td><td>The file creation date</td></tr>
</table>
</div><h3 class="anchored_heading" id="the-subdir-option">The Subdir option</h3>
<p>When specified in the create table statement, the subdir option indicates to list, in addition to the files contained in the specified directory, all the files verifying the filename pattern that are contained in sub-directories of the specified directory. For instance, using:</p>
<pre class="fixed"><span class="k">create</span> <span class="k">table</span> <span class="nf">data</span> <span class="p">(</span>
  <span class="n">PATH</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="n">flag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">FNAME</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="n">FTYPE</span> <span class="kt">char</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="n">SIZE</span> <span class="kt">double</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="n">flag</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="kp">engine</span><span class="o">=</span><span class="n">CONNECT</span> <span class="n">table_type</span><span class="o">=</span><span class="n">DIR</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;*.frm&#39;</span>
<span class="n">option_list</span><span class="o">=</span><span class="s1">&#39;subdir=1&#39;</span><span class="p">;</span>

<span class="k">select</span> <span class="n">path</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="nf">sum</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="k">from</span> <span class="n">data</span> <span class="k">group</span> <span class="k">by</span> <span class="n">path</span><span class="p">;</span>
</pre><p>You will get the following result set showing how many tables are created in the MariaDB databases and what is the total length of the FRM files:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>path</th><th>count(*)</th><th>sum(size)</th></tr>
<tr><td>\CommonSource\mariadb-5.2.7\sql\data\connect\</td><td>30</td><td>264469</td></tr>
<tr><td>\CommonSource\mariadb-5.2.7\sql\data\mysql\</td><td>23</td><td>207168</td></tr>
<tr><td>\CommonSource\mariadb-5.2.7\sql\data\test\</td><td>22</td><td>196882</td></tr>
</table>
</div><h3 class="anchored_heading" id="the-nodir-option-windows">The Nodir option (Windows)</h3>
<p>The Boolean Nodir option can be set to false (0 or no) to add directories that match the file name pattern from the listed files (it is true by default). This is an addition to CONNECT version 1.6. Previously, directory names matching pattern were listed on Windows. Directories were and are never listed on Linux.</p>
<p>Note: The way file names are retrieved makes positional access to them impossible. Therefore, DIR tables cannot be indexed or sorted when it is done using positions.</p>
<p>Be aware, in particular when using the subdir option, that queries on DIR tables are slow and can last almost forever if made on a directory that contains a great number of files in it and its sub-directories. </p>
<p>dir tables can be used to populate a list of files used to create a multiple=2 table. However, this is not as useful as it was when the multiple 3 did not exist.</p>
<h2 class="anchored_heading" id="windows-management-instrumentation-table-type-wmi">Windows Management Instrumentation Table Type “WMI”</h2>
<div class="cstm-style bluebox"><p><strong>Note:</strong> This table type is available on Windows only.</p>
</div><p>WMI provides an operating system interface through which instrumented components provide information. Some Microsoft tools to retrieve information through WMI are the WMIC console command and the WMI CMI Studio application.</p>
<p>The CONNECT WMI table type enables administrators and operators not capable of scripting or programming on top of WMI to enjoy the benefit of WMI without even learning about it. It permits to present this information as tables that can be queried, transformed, copied in documents or other tables.</p>
<p>To create a WMI table displaying information coming from a WMI provider, you must provide the namespace and the class name that characterize the information you want to retrieve. The best way to find them is to use the WMI CIM Studio that have tools to browse namespaces and classes and that can display the names of the properties of that class.</p>
<p>The column names of the tables must be the names (case insensitive) of the properties you want to retrieve. For instance:</p>
<pre class="fixed"><span class="k">create</span> <span class="k">table</span> <span class="nf">alias</span> <span class="p">(</span>
  <span class="n">friendlyname</span> <span class="kt">char</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">target</span> <span class="kt">char</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span><span class="p">)</span>
<span class="kp">engine</span><span class="o">=</span><span class="n">CONNECT</span> <span class="n">table_type</span><span class="o">=</span><span class="s1">&#39;WMI&#39;</span>
<span class="n">option_list</span><span class="o">=</span><span class="s1">&#39;Namespace=root\\cli,Class=Msft_CliAlias&#39;</span><span class="p">;</span>
</pre><p>WMI tables returns one row for each instance of the related information. The above example is handy to get the class equivalent of the alias of the WMIC command and also to have a list of many classes commonly used.</p>
<p>Because most of the useful classes belong to the 'root\cimv2' namespace, this
is the default value for WMI tables when the namespace is not specified. Some
classes have many properties whose name and type may not be known when creating
the table. To find them, you can use the WMI CMI Studio application but his
will be rarely required because CONNECT is able to retrieve them.</p>
<p>Actually, the class specification also has default values for some namespaces.
For the ‘root\cli’ namespace the class name defaults to ‘Msft_CliAlias’ and for
the ‘root_cimv2’ namespace the class default value is
‘Win32_ComputerSystemProduct’. Because many class names begin with ‘Win32_’ it
is not necessary to say it and specifying the class as ‘Product’ will
effectively use class ‘Win32_Product’.</p>
<p>For example if you define a table as:</p>
<pre class="fixed"><span class="k">create</span> <span class="k">table</span> <span class="n">CSPROD</span> <span class="kp">engine</span><span class="o">=</span><span class="n">CONNECT</span> <span class="n">table_type</span><span class="o">=</span><span class="s1">&#39;WMI&#39;</span><span class="p">;</span>
</pre><p>It will return the information on the current machine, using the class
ComputerSystemProduct of the CIMV2 namespace. For instance:</p>
<pre class="fixed"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">csprod</span><span class="p">;</span>
</pre><p>Will return a result such as:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>Column</th><th>Row 1</th></tr>
<tr><td>Caption</td><td>Computer system product</td></tr>
<tr><td>Description</td><td>Computer system product</td></tr>
<tr><td>IdentifyingNumber</td><td>LXAP50X32982327A922300</td></tr>
<tr><td>Name</td><td>Aspire 8920</td></tr>
<tr><td>SKUNumber</td><td></td></tr>
<tr><td>UUID</td><td>00FC523D-B8F7-DC12-A70E-00B0D1A46136</td></tr>
<tr><td>Vendor</td><td>Acer</td></tr>
<tr><td>Version</td><td>Aspire 8920</td></tr>
</table>
</div><p><strong>Note:</strong> This is a transposed display that can be obtained with some GUI.</p>
<h3 class="anchored_heading" id="getting-column-information">Getting column information</h3>
<p>An issue, when creating a WMI table, is to make its column definition. Indeed,
even when you know the namespace and the class for the wanted information, it
is not easy to find what are the names and types of its properties. However,
because CONNECT can retrieve this information from the WMI provider, you can
simply omit defining columns and CONNECT will do the job.</p>
<p>Alternatively, you can get this information using a catalog table (see below).</p>
<h3 class="anchored_heading" id="performance-consideration">Performance Consideration</h3>
<p>Some WMI providers can be very slow to answer. This is not an issue for those
that return few object instances, such as the ones returning computer,
motherboard, or Bios information. They generally return only one row
(instance). However, some can return many rows, in particular the
"CIM_DataFile" class. This is why care must be taken about them.</p>
<p>Firstly, it is possible to limit the allocated result size by using the
‘Estimate’ create table option. To avoid result truncation, CONNECT allocates a
result of 100 rows that is enough for almost all tables.The 'Estimate' option
permits to reduce this size for all classes that return only a few rows, and in
some rare case to increase it to avoid truncation.</p>
<p>However, it is not possible to limit the time taken by some WMI providers to
answer, in particular the CIM_DATAFILE class. Indeed the Microsoft
documentation says about it:</p>
<div style="margin-left:2em"><p> "Avoid enumerating or querying for all instances of CIM_DataFile on a
 computer because the volume of data is likely to either affect performance or
 cause the computer to stop responding."</p>
</div>
<p>Sure enough, even a simple query such as:</p>
<pre class="fixed"><span class="k">select</span> <span class="nf">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="n">cim</span> <span class="k">where</span> <span class="n">drive</span> <span class="o">=</span> <span class="s1">&#39;D:&#39;</span> <span class="k">and</span> <span class="n">path</span> <span class="k">like</span> <span class="s1">&#39;\\MariaDB\\%&#39;</span><span class="p">;</span>
</pre><p>is prone to last almost forever (probably due to the LIKE clause). This is why,
when not asking for some specific items, you should consider using the DIR
table type instead.</p>
<h3 class="anchored_heading" id="syntax-of-wmi-queries">Syntax of WMI queries</h3>
<p>Queries to WMI providers are done using the WQL language, not the SQL language.
CONNECT does the job of making the WQL query. However, because of the
restriction of the WQL syntax, the WHERE clause will be generated only when
respecting the following restrictions:</p>
<ol start="1"><li>No function.
</li><li>No comparison between two columns.
</li><li>No expression (currently a CONNECT restriction)
</li><li>No BETWEEN and IN predicates.
</li></ol>
<p>Filtering with WHERE clauses not respecting these conditions will still be done by MariaDB only,
except in the case of CIM_Datafile class for the reason given above.</p>
<p>However, there is one point that is not covered yet, the syntax used to specify dates in queries. WQL does not recognize dates as number items but translates them to its internal format dates specified as text. Many formats are recognized as described in the Microsoft documentation but only one is useful because common to WQL and MariaDB SQL. Here is an example of a query on a table named "cim" created by:</p>
<pre class="fixed"><span class="k">create</span> <span class="k">table</span> <span class="nf">cim</span> <span class="p">(</span>
  <span class="n">Name</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
  <span class="n">LastModified</span> <span class="kt">datetime</span> <span class="k">not</span> <span class="no">null</span><span class="p">)</span>
<span class="kp">engine</span><span class="o">=</span><span class="n">CONNECT</span> <span class="n">table_type</span><span class="o">=</span><span class="s1">&#39;WMI&#39;</span>
<span class="n">option_list</span><span class="o">=</span><span class="s1">&#39;class=CIM_DataFile,estimate=5000&#39;</span><span class="p">;</span>
</pre><p>The date must be specified with the format in which CIM DATETIME values are stored (WMI uses the date and time formats defined by the Distributed Management Task Force).</p>
<pre class="fixed"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">cim</span> <span class="k">where</span> <span class="n">drive</span> <span class="o">=</span> <span class="s1">&#39;D:&#39;</span> <span class="k">and</span> <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;\\PlugDB\\Bin\\&#39;</span>
     <span class="k">and</span> <span class="n">lastmodified</span> <span class="o">&gt;</span> <span class="s1">&#39;20120415000000.000000+120&#39;</span><span class="p">;</span>
</pre><p>This syntax must be strictly respected. The text has the format:</p>
<pre class="fixed">yyyymmddHHMMSS.mmmmmmsUUU
</pre><p>It is: year, month, day, hour, minute, second, millisecond, and signed minute deviation from <a href="/kb/en/coordinated-universal-time/">UTC</a>. This format is locale-independent so you can write a query that runs on any machine.</p>
<p><strong>Note 1:</strong> The WMI table type is available only in Windows versions of CONNECT.</p>
<p><strong>Note 2:</strong> WMI tables are read only.</p>
<p><strong>Note 3:</strong> WMI tables are not indexable.</p>
<p><strong>Note 4:</strong> WMI consider all strings as case insensitive.</p>
<h2 class="anchored_heading" id="mac-address-table-type-mac">MAC Address Table Type “MAC”</h2>
<div class="cstm-style bluebox"><p><strong>Note:</strong> This table type is available on Windows only.</p>
</div><p>This type is used to display various general information about the computer and, in particular, about its network cards. To create such a table, the syntax to use is:</p>
<pre class="fixed"><span class="k">create</span> <span class="k">table</span> <span class="nf">tabname</span> <span class="p">(</span><span class="k">column</span> <span class="n">definition</span><span class="p">)</span>
<span class="kp">engine</span><span class="o">=</span><span class="n">CONNECT</span> <span class="n">table_type</span><span class="o">=</span><span class="n">MAC</span><span class="p">;</span>
</pre><p>Column names can be freely chosen because their signification, i.e. the values they will display, comes from the specified Flag option. The valid values for Flag are:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>Flag</th><th>Valeur</th><th>Type</th></tr>
<tr><td>1</td><td>Host name</td><td>varchar(132)</td></tr>
<tr><td>2</td><td>Domain</td><td>varchar(132)</td></tr>
<tr><td>3</td><td>DNS address</td><td>varchar(24)</td></tr>
<tr><td>4</td><td>Node type</td><td>int(1)</td></tr>
<tr><td>5</td><td>Scope ID</td><td>varchar(256)</td></tr>
<tr><td>6</td><td>Routing</td><td>int(1)</td></tr>
<tr><td>7</td><td>Proxy</td><td>int(1)</td></tr>
<tr><td>8</td><td>DNS</td><td>int(1)</td></tr>
<tr><td>10</td><td>Name</td><td>varchar(260)</td></tr>
<tr><td>11</td><td>Description</td><td>varchar(132)</td></tr>
<tr><td>12</td><td>MAC address</td><td>char(24)</td></tr>
<tr><td>13</td><td>Type</td><td>int(3)</td></tr>
<tr><td>14</td><td>DHCP</td><td>int(1)</td></tr>
<tr><td>15</td><td>IP address</td><td>char(16)</td></tr>
<tr><td>16</td><td>SUBNET mask</td><td>char(16)</td></tr>
<tr><td>17</td><td>GATEWAY</td><td>char(16)</td></tr>
<tr><td>18</td><td>DHCP server</td><td>char(16)</td></tr>
<tr><td>19</td><td>Have WINS</td><td>int(1)</td></tr>
<tr><td>20</td><td>Primary WINS</td><td>char(16)</td></tr>
<tr><td>21</td><td>Secondary WINS</td><td>char(16)</td></tr>
<tr><td>22</td><td>Lease obtained</td><td>datetime</td></tr>
<tr><td>23</td><td>Lease expires</td><td>datetime</td></tr>
</table>
</div><p><strong>Note:</strong> The information of columns having a Flag value less than 10 are unique for the computer, the other ones are specific to the network cards of the computer.</p>
<p>For instance, you can define the table <em>macaddr</em> as:</p>
<pre class="fixed"><span class="k">create</span> <span class="k">table</span> <span class="nf">macaddr</span> <span class="p">(</span>
  <span class="n">Host</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span> <span class="n">flag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">Card</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span> <span class="n">flag</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
  <span class="n">Address</span> <span class="kt">char</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="n">flag</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
  <span class="n">IP</span> <span class="kt">char</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="n">flag</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
  <span class="n">Gateway</span> <span class="kt">char</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="n">flag</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
  <span class="n">Lease</span> <span class="kt">datetime</span> <span class="n">flag</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<span class="kp">engine</span><span class="o">=</span><span class="n">CONNECT</span> <span class="n">table_type</span><span class="o">=</span><span class="n">MAC</span><span class="p">;</span>
</pre><p>If you execute the query:</p>
<pre class="fixed"><span class="k">select</span> <span class="n">host</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">gateway</span><span class="p">,</span> <span class="n">lease</span> <span class="k">from</span> <span class="n">macaddr</span><span class="p">;</span>
</pre><p>It will return, for example:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>Host</th><th>Address</th><th>IP</th><th>Gateway</th><th>Lease</th></tr>
<tr><td>OLIVIER</td><td>00-A0-D1-A4-61-36</td><td>0.0.0.0</td><td>0.0.0.0</td><td>1970-01-01 00:00:00</td></tr>
<tr><td>OLIVIER</td><td>00-1D-E0-9B-90-0B</td><td>192.168.0.10</td><td>192.168.0.254</td><td>2011-09-18 10:28:5</td></tr>
</table>
</div>
    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/connect-table-types-special-virtual-tables/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/connect-table-types-special-virtual-tables/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/connect-using-the-tbl-and-mysql-table-types-together/">
                        ← CONNECT - Using the TBL and MYSQL Table Types Together
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/connect-table-types/">
                        ↑ CONNECT Table Types ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/connect-table-types-vir/">
                        CONNECT Table Types - VIR →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="3343" data-comments-url="/kb/en/connect-table-types-special-virtual-tables/+comments"
         data-reply-url="/kb/en/connect-table-types-special-virtual-tables/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/connect-table-types/">
                    ↑ CONNECT Table Types ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/connect-table-types-overview/">
                            
                            CONNECT Table Types Overview
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/inward-and-outward-tables/">
                            
                            Inward and Outward Tables
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-table-types-data-files/">
                            
                            CONNECT Table Types - Data Files
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-zipped-file-tables/">
                            
                            CONNECT Zipped File Tables
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-dos-and-fix-table-types/">
                            
                            CONNECT DOS and FIX Table Types
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-dbf-table-type/">
                            
                            CONNECT DBF Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-bin-table-type/">
                            
                            CONNECT BIN Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-vec-table-type/">
                            
                            CONNECT VEC Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-csv-and-fmt-table-types/">
                            
                            CONNECT CSV and FMT Table Types
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-nosql-table-types/">
                            
                            CONNECT - NoSQL Table Types
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-files-retrieved-using-rest-queries/">
                            
                            CONNECT - Files Retrieved Using Rest Queries
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-json-table-type/">
                            
                            CONNECT JSON Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-xml-table-type/">
                            
                            CONNECT XML Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-ini-table-type/">
                            
                            CONNECT INI Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-external-table-types/">
                            
                            CONNECT - External Table Types
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-odbc-table-type-accessing-tables-from-another-dbms/">
                            
                            CONNECT ODBC Table Type: Accessing Tables From Another DBMS
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-jdbc-table-type-accessing-tables-from-another-dbms/">
                            
                            CONNECT JDBC Table Type: Accessing Tables from Another DBMS
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-mongo-table-type/">
                            
                            CONNECT MONGO Table Type: Accessing Collections from MongoDB
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-mysql-table-type-accessing-mysqlmariadb-tables/">
                            
                            CONNECT MYSQL Table Type: Accessing MySQL/MariaDB Tables
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-proxy-table-type/">
                            
                            CONNECT PROXY Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-xcol-table-type/">
                            
                            CONNECT XCOL Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-occur-table-type/">
                            
                            CONNECT OCCUR Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-pivot-table-type/">
                            
                            CONNECT PIVOT Table Type
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-tbl-table-type-table-list/">
                            
                            CONNECT TBL Table Type: Table List
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-using-the-tbl-and-mysql-table-types-together/">
                            
                            CONNECT - Using the TBL and MYSQL Table Types Together
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>CONNECT Table Types - Special &#34;Virtual&#34; Tables</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-table-types-vir/">
                            
                            CONNECT Table Types - VIR
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-table-types-oem/">
                            
                            CONNECT Table Types - OEM: Implemented in an External LIB
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect-table-types-catalog-tables/">
                            
                            CONNECT Table Types - Catalog Tables
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>