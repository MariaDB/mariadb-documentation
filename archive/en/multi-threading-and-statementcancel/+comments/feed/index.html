<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>MariaDB Knowledge Base Comments for: Multi-threading and Statement.cancel()</title><link>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/feed/</link><description></description><atom:link href="https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/feed/" rel="self"></atom:link><language>en-us</language><lastBuildDate>Mon, 29 Jul 2024 15:10:23 +0000</lastBuildDate><item><title>Re: Multi-threading and Statement.cancel()</title><link>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/726</link><description>&lt;p&gt;Fair enough. Thanks for your time.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Rich Stepanski</dc:creator><guid>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/726</guid></item><item><title>Re: Multi-threading and Statement.cancel()</title><link>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/724</link><description>&lt;p&gt;It is the only thing what server can do - connection wide  cancellation with "kill query &amp;lt;connection&amp;gt;". Statement cancellation can only be emulated on client by checking if thus statement is being executed currently&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Vladislav Vaintroub</dc:creator><guid>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/724</guid></item><item><title>Re: Multi-threading and Statement.cancel()</title><link>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/721</link><description>&lt;p&gt;Cleaned up my test code. You were correct about the 'unknown thread' being from a closed connection. oops.&lt;/p&gt;
&lt;p&gt;It sounds like you're describing what I'm hitting. Statement.cancel() on one thread interrupting a Statement.executeQuery() on a different Statement owned by a different thread.&lt;/p&gt;
&lt;p&gt;I'll see if I can attach my test code. I do get different behavior based on the jdbc driver included. Seems like Connection wide cancellation vs Statement cancellation.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Rich Stepanski</dc:creator><guid>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/721</guid></item><item><title>Re: Multi-threading and Statement.cancel()</title><link>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/720</link><description>&lt;p&gt;Ok, I noticed one minor bug in cancel()  implementation (I filed in &lt;a href="https://jira.mariadb.org/browse/CONJ-58"&gt;CONJ-58&lt;/a&gt; and fixed already). Basically, even if statement was not executed, active query on current connection was interrupted. This could describe your multithreading scenario. However, the fix is still not  100% bulletproof ('kill query' is not entirely deterministic), but it should behave a bit better.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Vladislav Vaintroub</dc:creator><guid>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/720</guid></item><item><title>Re: Multi-threading and Statement.cancel()</title><link>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/719</link><description>&lt;p&gt;The mechanism used for cancel() is the same among all client drivers, so I really doubt it works with one driver and not with another one.&lt;/p&gt;
&lt;p&gt;Drivers execute  "kill query &amp;lt;connection_uid&amp;gt;", and the currently  active query on this connection is interrupted. If you get "unknown thread", then the connection was already closed.&lt;/p&gt;
&lt;p&gt;If you're getting "Query execution was interrupted" - yes it is what you should get after cancel() or "kill query" . Driver cannot pretend everything went OK :)&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Vladislav Vaintroub</dc:creator><guid>https://mariadb.com/kb/en/multi-threading-and-statementcancel/+comments/719</guid></item></channel></rss>