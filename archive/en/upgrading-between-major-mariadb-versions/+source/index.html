<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Upgrading Between Major MariaDB Versions - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.b9e1e104f007.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Upgrading Between Major MariaDB Versions - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/upgrading-between-major-mariadb-versions/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/upgrading-between-major-mariadb-versions/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/upgrading-between-major-mariadb-versions/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/getting-installing-and-upgrading-mariadb/">Getting, Installing, and Upgrading MariaDB</a>
    

    
    » <a class="crumb" href="/kb/en/upgrading/">Upgrading MariaDB</a>
    


    » <a class="node_link crumb" href="/kb/en/upgrading-between-major-mariadb-versions/">Upgrading Between Major MariaDB Versions</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/upgrading-between-major-mariadb-versions/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Upgrading Between Major MariaDB Versions - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/upgrading-between-major-mariadb-versions/+r/133801/">133801</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-7911">
<a href="/kb/user/id/7911" title="Michael Widenius">Michael Widenius</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2023-12-30 09:25">2023-12-30 09:25</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;
MariaDB is designed to allow easy upgrades. You should be able to trivially upgrade from ANY earlier
MariaDB version to the latest one (for example MariaDB 10.3.x to MariaDB 10.11.x), usually in a few seconds. This is also mainly true for any MySQL version &lt; 8.0 to MariaDB 10.4 and up.

Upgrades are normally easy because:

* All MariaDB table data files are backward compatible
* The MariaDB connection protocol is backward compatible. You don&#39;t normally need to upgrade any of your old clients to be able to connect to a newer MariaDB version.
* The MariaDB replica can be of any newer version than the primary.

MariaDB Corporation regularly runs tests to check that one can upgrade from MariaDB 5.5 to the latest MariaDB version without any trouble. All older versions should work too (as long as the storage engines you were using are still around).

Note that if you are using [[galera-cluster|MariaDB Galera Cluster]], you have to follow the [[upgrading-galera-cluster|Galera upgrading instructions]]!

== Requirements for Doing an Upgrade Between Major Versions

* Go through the individual version upgrade notes (listed below) to look for any major changes or configuration options that have changed.
* Ensure that the target MariaDB version supports the storage engines you are using. For example, in 10.5 [[tokudb|TokuDB]] is not supported.
* Backup the database (just in case). At least, take a copy of the &lt;&lt;code&gt;&gt;mysql&lt;&lt;/code&gt;&gt; data directory with [[mariadb-dump|mariadb-dump --add-drop-table mysql]] (called mysqldump in MariaDB 10.3 and earlier) as most of the upgrade changes are done there (adding new fields and new system tables etc).
* Cleanly shutdown the server. This is necessary because even if data files are compatible between versions, recovery logs may not be.
** Ensure that the [[innodb-system-variables/#innodb_fast_shutdown|innodb_fast_shutdown]] variable is not 2 (fast crash shutdown) or 3. The default of this variable is 1. The safest and recommended option for upgrades is 0. The shutdown time may be notably larger with 0 than for 1 as there are a lot more cleanups done for 0, however when preparing for an upgrade this should not be an issue.
** [[innodb-system-variables/#innodb_force_recovery|innodb_force_recovery]] must be less than ##3##.

Note that rpms don&#39;t support upgrading between major versions, only minor like 10.4.1 to 10.4.2. If you are using rpms, you should de-install the old MariaDB rpms and install the new MariaDB rpms before running [[mariadb-upgrade]]. Note that when installing the new rpms, [[mariadb-upgrade]] may be run automatically. There is no problem with running [[mariadb-upgrade]] many times.

== Recommended Steps

* If you have a [[standard-replication|primary-replica setup]], first upgrade one replica and when you have verified that the replica works well, upgrade the rest of the replicas (if any). Then [[changing-a-replica-to-become-the-primary|upgrade one replica to primary]], upgrade the primary, and change the replica to a primary.

* If you don&#39;t have a primary-replica setup, then [[mariabackup|take a backup]], [[mysqladmin|shutdown MariaDB]] and do the upgrade.

=== Step by Step Instructions for Upgrades

* Upgrade MariaDB binaries and libraries, preferably without starting MariaDB.
* If the MariaDB server process, [[/mysqld-options|mysqld or mariadbd]] was not started as part of the upgrade, start it by executing &lt;&lt;code&gt;&gt;mysqld --skip-grant-tables&lt;&lt;/code&gt;&gt;. This may produce some warnings about some system tables not being up to date, but you can ignore these for now as [[mariadb-upgrade]] will fix that.
* Run [[mariadb-upgrade]]
* Restart MariaDB server.

== Work Done by mariadb-upgrade

The main work done when upgrading is done by running [[mariadb-upgrade]]. The main things it does are:

* Updating the system tables in the &lt;&lt;code&gt;&gt;mysql&lt;&lt;/code&gt;&gt; database to the newest version. This is very quick.
* [[mariadb-upgrade]] also runs [[mariadb-check|mariadb-check --check-upgrade]] to check if there have been any collation changes between the major versions. This recreates indexes in old tables that are using any of the changed collations. This can take a bit of time if there are a lot of tables or there are many tables which used the changed collation. The last time a collation changed was in MariaDB/MySQL 5.1.23.

== Post Upgrade Work

Check the [[error-log|MariaDB error log]] for any problems during upgrade. If there are any warnings in the log files, do your best to get rid of them!

The common warnings/errors are:
* Using obsolete options.  If this is the case, remove them from your [[configuring-mariadb-with-option-files|my.cnf files]].

* Check the manual for [[upgrading|new features]] that have been added since your last MariaDB version.
* Test that your application works as before. The main difference from before is that because of optimizer improvements your application should work better than before, but in some rare cases the optimizer may get something wrong. In this case, you can try to use [[explain]], [[mariadb-internals-documentation-optimizer-trace|optimizer trace]] or [[optimizer-switch|optimizer_switch]] to fix the queries.

== If Something Goes Wrong

* First, check the [[error-log|MariaDB error log]] to see if you are using configure options that are not supported anymore.
* Check the upgrade notices for the MariaDB release that you are upgrading to.
* File an issue in the [[bug-tracking|MariaDB bug tracker]] so that we know about the issue and can provide a fix to make upgrades even better.
* Add a comment to this manual entry for how we can improve it.

=== Disaster Recovery
In the unlikely event something goes wrong, you can try the following:
* Remove the InnoDB tables from the &lt;&lt;code&gt;&gt;mysql&lt;&lt;/code&gt;&gt; data directory. They are:
** gtid_slave_pos
** innodb_table_stats
** innodb_index_stats
** transaction_registry
* Move the &lt;&lt;code&gt;&gt;mysql&lt;&lt;/code&gt;&gt; data directory to &lt;&lt;code&gt;&gt;mysql-old&lt;&lt;/code&gt;&gt; and run [[mariadb-install-db]] to generate a new one.
* After the above, you have to add back your old users.
* When done, delete the &lt;&lt;code&gt;&gt;mysql-old&lt;&lt;/code&gt;&gt; data directory.

== Downgrading

MariaDB server is not designed for downgrading. That said, in most cases, as long as you haven&#39;t run any [[alter-table|ALTER TABLE]] or [[create-table|CREATE TABLE]] statements and you have a [[mariadb-dump]] of your old &lt;&lt;code&gt;&gt;mysql&lt;&lt;/code&gt;&gt; database , you should be able to downgrade to your previous version by doing the following:

* Do a clean shutdown. For this special case you have to set [[innodb-system-variables/#innodb_fast_shutdown|innodb_fast_shutdown]] to 0,before taking down the new MariaDB server,  to ensure there are no redo or undo logs that need to be applied on the downgraded server.
* Delete the tables in the &lt;&lt;code&gt;&gt;mysql&lt;&lt;/code&gt;&gt; database (if you didn&#39;t use the option &lt;&lt;code&gt;&gt;--add-drop-table&lt;&lt;/code&gt;&gt; to [[mariadb-dump]])
* Delete the new MariaDB installation
* Install the old MariaDB version
* Start the server with [[mysqld-options/#-skip-grant-tables|mysqld --skip-grant-tables]]
* Install the old &lt;&lt;code&gt;&gt;mysql&lt;&lt;/code&gt;&gt; database
* Execute in the [[mariadb-client|mariadb client]] &lt;&lt;code&gt;&gt;FLUSH PRIVILEGES&lt;&lt;/code&gt;&gt;

== See Also
* [[upgrading-from-mysql-to-mariadb|Upgrading from MySQL to MariaDB]]
* [[upgrading-from-mariadb-11-2-to-mariadb-11-3|Upgrading from MariaDB 11.2 to MariaDB 11.3]]
* [[upgrading-from-mariadb-11-1-to-mariadb-11-2|Upgrading from MariaDB 11.1 to MariaDB 11.2]]
* [[upgrading-from-mariadb-11-0-to-mariadb-11-1|Upgrading from MariaDB 11.0 to MariaDB 11.1]]
* [[upgrading-from-mariadb-10-11-to-mariadb-11-0|Upgrading from MariaDB 10.11 to MariaDB 11.0]]
* [[upgrading-from-mariadb-10-6-to-mariadb-10-11|Upgrading from MariaDB 10.6 to MariaDB 10.11]]
* [[upgrading-from-mariadb-106-to-mariadb-107|Upgrading from MariaDB 10.6 to MariaDB 10.7]]
* [[upgrading-from-mariadb-105-to-mariadb-106|Upgrading from MariaDB 10.5 to MariaDB 10.6]]
* [[upgrading-from-mariadb-104-to-mariadb-105|Upgrading from MariaDB 10.4 to MariaDB 10.5]]
* [[upgrading-from-mariadb-103-to-mariadb-104|Upgrading from MariaDB 10.3 to MariaDB 10.4]]

* [[upgrading-galera-cluster|Galera upgrading instructions]]
* [[innodb-system-variables/#innodb_fast_shutdown|innodb_fast_shutdown]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>