<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Configuring MariaDB Replication between MariaDB Galera Cluster and MariaDB Server - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Configuring MariaDB Replication between MariaDB Galera Cluster and MariaDB Server" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Information on configuring replication between MariaDB Galera Cluster and MariaDB Server." />

    <meta name="description" content="Information on configuring replication between MariaDB Galera Cluster and MariaDB Server." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/replication-cluster-multi-master/">High Availability &amp; Performance Tuning</a>
    

    
    » <a class="crumb" href="/kb/en/galera-cluster/">MariaDB Galera Cluster</a>
    

    
    » <a class="crumb" href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster/">Using MariaDB Replication with MariaDB Galera Cluster</a>
    


    » <a class="node_link crumb" href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/">Configuring MariaDB Replication between MariaDB Galera Cluster and MariaDB Server</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+flag"
                data-flag-url="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2019-01-22 23:34">4 years, 5 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2022-04-26 22:34">1 year, 2 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Configuring MariaDB Replication between MariaDB Galera Cluster and MariaDB Server</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#configuring-the-cluster" title="Configuring the Cluster">Configuring the Cluster</a>    <ol class="toc">

        <li class=""><a href="#configuring-wsrep-gtid-mode" title="Configuring Wsrep GTID Mode">Configuring Wsrep GTID Mode</a>    </ol>
</li>

    <li class=""><a href="#configuring-the-replica" title="Configuring the Replica">Configuring the Replica</a></li>

    <li class=""><a href="#setting-up-replication" title="Setting up Replication">Setting up Replication</a>    <ol class="toc">

        <li class=""><a href="#start-the-cluster" title="Start the Cluster">Start the Cluster</a></li>

        <li class=""><a href="#backup-the-database-on-the-clusters-primary-node-and-prepare-it" title="Backup the Database on the Cluster&#39;s Primary Node and Prepare It">Backup the Database on the Cluster&#39;s Primary Node and Prepare It</a></li>

        <li class=""><a href="#copy-the-backup-to-the-replica" title="Copy the Backup to the Replica">Copy the Backup to the Replica</a></li>

        <li class=""><a href="#restore-the-backup-on-the-second-clusters-replica" title="Restore the Backup on the Second Cluster&#39;s Replica">Restore the Backup on the Second Cluster&#39;s Replica</a></li>

        <li class=""><a href="#start-the-new-replica" title="Start the New Replica">Start the New Replica</a></li>

        <li class=""><a href="#create-a-replication-user-on-the-clusters-primary" title="Create a Replication User on the Cluster&#39;s Primary">Create a Replication User on the Cluster&#39;s Primary</a></li>

        <li class=""><a href="#start-replication-on-the-new-replica" title="Start Replication on the New Replica">Start Replication on the New Replica</a>        <ol class="toc">

            <li class=""><a href="#gtids" title="GTIDs">GTIDs</a></li>

            <li class=""><a href="#file-and-position" title="File and Position">File and Position</a>        </ol>
</li>

        <li class=""><a href="#check-the-status-of-the-new-replica" title="Check the Status of the New Replica">Check the Status of the New Replica</a>    </ol>
</li>

    <li class=""><a href="#setting-up-circular-replication" title="Setting up Circular Replication">Setting up Circular Replication</a>    <ol class="toc">

        <li class=""><a href="#create-a-replication-user-on-the-mariadb-server-primary" title="Create a Replication User on the MariaDB Server Primary">Create a Replication User on the MariaDB Server Primary</a></li>

        <li class=""><a href="#start-circular-replication-on-the-cluster" title="Start Circular Replication on the Cluster">Start Circular Replication on the Cluster</a>        <ol class="toc">

            <li class=""><a href="#gtids" title="GTIDs">GTIDs</a></li>

            <li class=""><a href="#file-and-position" title="File and Position">File and Position</a>        </ol>
</li>

        <li class=""><a href="#check-the-status-of-the-circular-replication" title="Check the Status of the Circular Replication">Check the Status of the Circular Replication</a>    </ol>
 </ol>
</li>
</div>
<p><a href="/kb/en/high-availability-performance-tuning-mariadb-replication/">MariaDB replication</a> can be used to replicate between <a href="/kb/en/galera-cluster/">MariaDB Galera Cluster</a> and MariaDB Server. This article will discuss how to do that.</p>
<h2 class="anchored_heading" id="configuring-the-cluster">Configuring the Cluster</h2>
<p>Before we set up replication, we need to ensure that the cluster is configured properly. This involves the following steps:</p>
<ul start="1"><li>Set <code><a href="/kb/en/replication-and-binary-log-system-variables/#log_slave_updates">log_slave_updates=ON</a></code> on all nodes in the cluster. See <a href="/kb/en/configuring-mariadb-galera-cluster/#writing-replicated-write-sets-to-the-binary-log">Configuring MariaDB Galera Cluster: Writing Replicated Write Sets to the Binary Log</a> and <a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-using-mariadb-replica/#configuring-a-cluster-node-as-a-replication-master">Using MariaDB Replication with MariaDB Galera Cluster: Configuring a Cluster Node as a Replication Master</a> for more information on why this is important. This is also needed to <a href="/kb/en/using-mariadb-gtids-with-mariadb-galera-cluster/#enabling-wsrep-gtid-mode">enable wsrep GTID mode</a>.
</li></ul>
<ul start="1"><li>Set <code><a href="/kb/en/replication-and-binary-log-system-variables/#server_id">server_id</a></code> to the same value on all nodes in the cluster. See <a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-using-mariadb-replica/#setting-server_id-on-cluster-nodes">Using MariaDB Replication with MariaDB Galera Cluster: Setting server_id on Cluster Nodes</a> for more information on what this means.
</li></ul>
<h3 class="anchored_heading" id="configuring-wsrep-gtid-mode">Configuring Wsrep GTID Mode</h3>
<p>If you want to use <a href="/kb/en/gtid/">GTID</a> replication, then you also need to configure some things to <a href="/kb/en/using-mariadb-gtids-with-mariadb-galera-cluster/#enabling-wsrep-gtid-mode">enable wsrep GTID mode</a>. For example:</p>
<ul start="1"><li><code><a href="/kb/en/galera-cluster-system-variables/#wsrep_gtid_mode">wsrep_gtid_mode=ON</a></code> needs to be set on all nodes in the cluster.
</li></ul>
<ul start="1"><li><code><a href="/kb/en/galera-cluster-system-variables/#wsrep_gtid_domain_id">wsrep_gtid_domain_id</a></code> needs to be set to the same value on all nodes in the cluster, so that each cluster node uses the same domain when assigning <a href="/kb/en/gtid/">GTIDs</a> for Galera Cluster's write sets.
</li></ul>
<ul start="1"><li><code><a href="/kb/en/replication-and-binary-log-system-variables/#log_slave_updates">log_slave_updates</a></code> needs to be enabled on all nodes in the cluster. See <a href="https://jira.mariadb.org/browse/MDEV-9855">MDEV-9855</a> about that.
</li></ul>
<ul start="1"><li><code><a href="/kb/en/replication-and-binary-log-server-system-variables/#log_bin">log_bin</a></code> needs to be set to the same path on all nodes in the cluster. See <a href="https://jira.mariadb.org/browse/MDEV-9856">MDEV-9856</a> about that.
</li></ul>
<p>And as an extra safety measure:</p>
<ul start="1"><li><a href="/kb/en/gtid/#gtid_domain_id">gtid_domain_id</a> should be set to a different value on all nodes in a given cluster, and each of these values should be different than the configured <a href="/kb/en/galera-cluster-system-variables/#wsrep_gtid_domain_id">wsrep_gtid_domain_id</a> value. This is to prevent a node from using the same domain used for Galera Cluster's write sets when assigning <a href="/kb/en/gtid/">GTIDs</a> for non-Galera transactions, such as DDL executed with <a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_method">wsrep_sst_method=RSU</a> set or DML executed with <a href="/kb/en/galera-cluster-system-variables/#wsrep_on">wsrep_on=OFF</a> set.
</li></ul>
<h2 class="anchored_heading" id="configuring-the-replica">Configuring the Replica</h2>
<p>Before we set up replication, we also need to ensure that the MariaDB Server replica is configured properly. This involves the following steps:</p>
<ul start="1"><li>Set <a href="/kb/en/replication-and-binary-log-system-variables/#server_id">server_id</a> to a different value than the one that the cluster nodes are using.
</li></ul>
<ul start="1"><li>Set <a href="/kb/en/gtid/#gtid_domain_id">gtid_domain_id</a> to a value that is different than the <a href="/kb/en/galera-cluster-system-variables/#wsrep_gtid_domain_id">wsrep_gtid_domain_id</a> and <a href="/kb/en/gtid/#gtid_domain_id">gtid_domain_id</a> values that the cluster nodes are using.
</li></ul>
<ul start="1"><li>Set <a href="/kb/en/replication-and-binary-log-server-system-variables/#log_bin">log_bin</a> and <a href="/kb/en/replication-and-binary-log-system-variables/#log_slave_updates">log_slave_updates=ON</a> if you want the replica to log the transactions that it replicates.
</li></ul>
<h2 class="anchored_heading" id="setting-up-replication">Setting up Replication</h2>
<p>Our process to set up replication is going to be similar to the process described at <a href="/kb/en/setting-up-a-replication-slave-with-mariabackup/">Setting up a Replication Slave with Mariabackup</a>, but it will be modified a bit to work in this context.</p>
<h3 class="anchored_heading" id="start-the-cluster">Start the Cluster</h3>
<p>The very first step is to start the nodes in the first cluster. The first node will have to be <a href="/kb/en/getting-started-with-mariadb-galera-cluster/#bootstrapping-a-new-cluster">bootstrapped</a>. The other nodes can be <a href="/kb/en/starting-and-stopping-mariadb-starting-and-stopping-mariadb/">started normally</a>.</p>
<p>Once the nodes are started, you need to pick a specific node that will act as the replication primary for the MariaDB Server.</p>
<h3 class="anchored_heading" id="backup-the-database-on-the-clusters-primary-node-and-prepare-it">Backup the Database on the Cluster's Primary Node and Prepare It</h3>
<p>The first step is to simply take and prepare a fresh <a href="/kb/en/full-backup-and-restore-with-mariabackup/">full backup</a> of the node that you have chosen to be the replication primary. For example:</p>
<pre class="fixed">$ mariabackup --backup \
   --target-dir=/var/mariadb/backup/ \
   --user=mariabackup --password=mypassword
</pre><p>And then you would prepare the backup as you normally would. For example:</p>
<pre class="fixed">$ mariabackup --prepare \
   --target-dir=/var/mariadb/backup/ 
</pre><h3 class="anchored_heading" id="copy-the-backup-to-the-replica">Copy the Backup to the Replica</h3>
<p>Once the backup is done and prepared, you can copy it to the MariaDB Server that will be acting as replica. For example:</p>
<pre class="fixed">$ rsync -avrP /var/mariadb/backup dc2-dbserver1:/var/mariadb/backup
</pre><h3 class="anchored_heading" id="restore-the-backup-on-the-second-clusters-replica">Restore the Backup on the Second Cluster's Replica</h3>
<p>At this point, you can restore the backup to the <a href="/kb/en/server-system-variables/#datadir">datadir</a>, as you normally would. For example:</p>
<pre class="fixed">$ mariabackup --copy-back \
   --target-dir=/var/mariadb/backup/ 
</pre><p>And adjusting file permissions, if necessary:</p>
<pre class="fixed">$ chown -R mysql:mysql /var/lib/mysql/
</pre><h3 class="anchored_heading" id="start-the-new-replica">Start the New Replica</h3>
<p>Now that the backup has been restored to the MariaDB Server replica, you can <a href="/kb/en/starting-and-stopping-mariadb-starting-and-stopping-mariadb/">start the MariaDB Server process</a>.</p>
<h3 class="anchored_heading" id="create-a-replication-user-on-the-clusters-primary">Create a Replication User on the Cluster's Primary</h3>
<p>Before the MariaDB Server replica can begin replicating from the cluster's primary, you need to <a href="/kb/en/create-user/">create a user account</a> on the primary that the replica can use to connect, and you need to <a href="/kb/en/grant/">grant</a> the user account the <a href="/kb/en/grant/#global-privileges">REPLICATION SLAVE</a> privilege. For example:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">&#39;repl&#39;</span><span class="o">@</span><span class="s1">&#39;dc2-dbserver1&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;password&#39;</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="n">REPLICATION</span> <span class="n">SLAVE</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span>  <span class="k">TO</span> <span class="s1">&#39;repl&#39;</span><span class="o">@</span><span class="s1">&#39;dc2-dbserver1&#39;</span><span class="p">;</span>
</pre><h3 class="anchored_heading" id="start-replication-on-the-new-replica">Start Replication on the New Replica</h3>
<p>At this point, you need to get the replication coordinates of the primary from the original backup.</p>
<p>The coordinates will be in the <a href="/kb/en/files-created-by-mariabackup/#xtrabackup_binlog_info">xtrabackup_binlog_info</a> file.</p>
<p>Mariabackup dumps replication coordinates in two forms: <a href="/kb/en/gtid/">GTID strings</a> and <a href="/kb/en/binary-log/">binary log</a> file and position coordinates, like the ones you would normally see from <a href="/kb/en/show-master-status/">SHOW MASTER STATUS</a> output. In this case, it is probably better to use the <a href="/kb/en/gtid/">GTID</a> coordinates.</p>
<p>For example:</p>
<pre class="fixed">mariadb-bin.000096 568 0-1-2
</pre><p>Regardless of the coordinates you use, you will have to set up the primary connection using <a href="/kb/en/change-master-to/">CHANGE MASTER TO</a> and then start the replication threads with <a href="/kb/en/start-slave/">START SLAVE</a>.</p>
<h4 class="anchored_heading" id="gtids">GTIDs</h4>
<p>If you want to use GTIDs, then you will have to first set <a href="/kb/en/gtid/#gtid_slave_pos">gtid_slave_pos</a>  to the <a href="/kb/en/gtid/">GTID</a> coordinates that we pulled from the <a href="/kb/en/files-created-by-mariabackup/#xtrabackup_binlog_info">xtrabackup_binlog_info</a> file, and we would set <code>MASTER_USE_GTID=slave_pos</code> in the <a href="/kb/en/change-master-to/">CHANGE MASTER TO</a> command. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">gtid_slave_pos</span> <span class="o">=</span> <span class="ss">&quot;0-1-2&quot;</span><span class="p">;</span>
<span class="n">CHANGE</span> <span class="n">MASTER</span> <span class="k">TO</span> 
   <span class="n">MASTER_HOST</span><span class="o">=</span><span class="ss">&quot;c1dbserver1&quot;</span><span class="p">,</span> 
   <span class="n">MASTER_PORT</span><span class="o">=</span><span class="mi">3310</span><span class="p">,</span> 
   <span class="n">MASTER_USER</span><span class="o">=</span><span class="ss">&quot;repl&quot;</span><span class="p">,</span>  
   <span class="n">MASTER_PASSWORD</span><span class="o">=</span><span class="ss">&quot;password&quot;</span><span class="p">,</span> 
   <span class="n">MASTER_USE_GTID</span><span class="o">=</span><span class="n">slave_pos</span><span class="p">;</span>
<span class="k">START</span> <span class="n">SLAVE</span><span class="p">;</span>
</pre><h4 class="anchored_heading" id="file-and-position">File and Position</h4>
<p>If you want to use the <a href="/kb/en/binary-log/">binary log</a> file and position coordinates, then you would set <code>MASTER_LOG_FILE</code> and <code>MASTER_LOG_POS</code> in the <a href="/kb/en/change-master-to/">CHANGE MASTER TO</a> command to the file and position coordinates that we pulled the <a href="/kb/en/files-created-by-mariabackup/#xtrabackup_binlog_info">xtrabackup_binlog_info</a> file. For example:</p>
<pre class="fixed"><span class="n">CHANGE</span> <span class="n">MASTER</span> <span class="k">TO</span> 
   <span class="n">MASTER_HOST</span><span class="o">=</span><span class="ss">&quot;c1dbserver1&quot;</span><span class="p">,</span> 
   <span class="n">MASTER_PORT</span><span class="o">=</span><span class="mi">3310</span><span class="p">,</span> 
   <span class="n">MASTER_USER</span><span class="o">=</span><span class="ss">&quot;repl&quot;</span><span class="p">,</span>  
   <span class="n">MASTER_PASSWORD</span><span class="o">=</span><span class="ss">&quot;password&quot;</span><span class="p">,</span> 
   <span class="n">MASTER_LOG_FILE</span><span class="o">=</span><span class="s1">&#39;mariadb-bin.000096&#39;</span><span class="p">,</span>
   <span class="n">MASTER_LOG_POS</span><span class="o">=</span><span class="mi">568</span><span class="p">,</span>
<span class="k">START</span> <span class="n">SLAVE</span><span class="p">;</span>
</pre><h3 class="anchored_heading" id="check-the-status-of-the-new-replica">Check the Status of the New Replica</h3>
<p>You should be done setting up the replica now, so you should check its status with <a href="/kb/en/show-slave-status/">SHOW SLAVE STATUS</a>. For example:</p>
<pre class="fixed">SHOW SLAVE STATUS\G
</pre><p>Now that the MariaDB Server is up, ensure that it does not start accepting writes yet if you want to set up <a href="/kb/en/replication-overview/#ring-replication">circular replication</a> between the cluster and the MariaDB Server.</p>
<h2 class="anchored_heading" id="setting-up-circular-replication">Setting up Circular Replication</h2>
<p>You can also set up <a href="/kb/en/replication-overview/#ring-replication">circular replication</a> between the cluster and MariaDB Server, which means that the MariaDB Server replicates from the cluster, and the cluster also replicates from the MariaDB Server.</p>
<h3 class="anchored_heading" id="create-a-replication-user-on-the-mariadb-server-primary">Create a Replication User on the MariaDB Server Primary</h3>
<p>Before circular replication can begin, you also need to <a href="/kb/en/create-user/">create a user account</a> on the MariaDB Server, since it will be acting as replication primary to the cluster's replica, and you need to <a href="/kb/en/grant/">grant</a> the user account the <a href="/kb/en/grant/#global-privileges">REPLICATION SLAVE</a> privilege. For example:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">&#39;repl&#39;</span><span class="o">@</span><span class="s1">&#39;c1dbserver1&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;password&#39;</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="n">REPLICATION</span> <span class="n">SLAVE</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span>  <span class="k">TO</span> <span class="s1">&#39;repl&#39;</span><span class="o">@</span><span class="s1">&#39;c1dbserver1&#39;</span><span class="p">;</span>
</pre><h3 class="anchored_heading" id="start-circular-replication-on-the-cluster">Start Circular Replication on the Cluster</h3>
<p>How this is done would depend on whether you want to use the <a href="/kb/en/gtid/">GTID</a> coordinates or the <a href="/kb/en/binary-log/">binary log</a> file and position coordinates.</p>
<p>Regardless, you need to ensure that the second cluster is not accepting any writes other than those that it replicates from the cluster at this stage.</p>
<h4 class="anchored_heading" id="gtids">GTIDs</h4>
<p>To get the GTID coordinates on the MariaDB Server you can check <code><a href="/kb/en/gtid/#gtid_current_pos">gtid_current_pos</a></code> by executing:</p>
<pre class="fixed"><span class="k">SHOW</span> <span class="k">GLOBAL</span> <span class="n">VARIABLES</span> <span class="k">LIKE</span> <span class="s1">&#39;gtid_current_pos&#39;</span><span class="p">;</span>
</pre><p>Then on the node acting as replica in the cluster, you can set up replication by setting <a href="/kb/en/gtid/#gtid_slave_pos">gtid_slave_pos</a> to the GTID that was returned and then executing <a href="/kb/en/change-master-to/">CHANGE MASTER TO</a>:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">gtid_slave_pos</span> <span class="o">=</span> <span class="ss">&quot;0-1-2&quot;</span><span class="p">;</span>
<span class="n">CHANGE</span> <span class="n">MASTER</span> <span class="k">TO</span> 
   <span class="n">MASTER_HOST</span><span class="o">=</span><span class="ss">&quot;c2dbserver1&quot;</span><span class="p">,</span> 
   <span class="n">MASTER_PORT</span><span class="o">=</span><span class="mi">3310</span><span class="p">,</span> 
   <span class="n">MASTER_USER</span><span class="o">=</span><span class="ss">&quot;repl&quot;</span><span class="p">,</span>  
   <span class="n">MASTER_PASSWORD</span><span class="o">=</span><span class="ss">&quot;password&quot;</span><span class="p">,</span> 
   <span class="n">MASTER_USE_GTID</span><span class="o">=</span><span class="n">slave_pos</span><span class="p">;</span>
<span class="k">START</span> <span class="n">SLAVE</span><span class="p">;</span>
</pre><h4 class="anchored_heading" id="file-and-position">File and Position</h4>
<p>To get the <a href="/kb/en/binary-log/">binary log</a> file and position coordinates on the MariaDB Server, you can execute <a href="/kb/en/show-master-status/">SHOW MASTER STATUS</a>:</p>
<pre class="fixed"><span class="k">SHOW</span> <span class="n">MASTER</span> <span class="n">STATUS</span>
</pre><p>Then on the node acting as replica in the cluster, you would set <code>master_log_file</code> and <code>master_log_pos</code> in the <a href="/kb/en/change-master-to/">CHANGE MASTER TO</a> command. For example:</p>
<pre class="fixed"><span class="n">CHANGE</span> <span class="n">MASTER</span> <span class="k">TO</span> 
   <span class="n">MASTER_HOST</span><span class="o">=</span><span class="ss">&quot;c2dbserver1&quot;</span><span class="p">,</span> 
   <span class="n">MASTER_PORT</span><span class="o">=</span><span class="mi">3310</span><span class="p">,</span> 
   <span class="n">MASTER_USER</span><span class="o">=</span><span class="ss">&quot;repl&quot;</span><span class="p">,</span>  
   <span class="n">MASTER_PASSWORD</span><span class="o">=</span><span class="ss">&quot;password&quot;</span><span class="p">,</span> 
   <span class="n">MASTER_LOG_FILE</span><span class="o">=</span><span class="s1">&#39;mariadb-bin.000096&#39;</span><span class="p">,</span>
   <span class="n">MASTER_LOG_POS</span><span class="o">=</span><span class="mi">568</span><span class="p">;</span>
<span class="k">START</span> <span class="n">SLAVE</span><span class="p">;</span>
</pre><h3 class="anchored_heading" id="check-the-status-of-the-circular-replication">Check the Status of the Circular Replication</h3>
<p>You should be done setting up the circular replication on the node in the first cluster now, so you should check its status with <a href="/kb/en/show-slave-status/">SHOW SLAVE STATUS</a>. For example:</p>
<pre class="fixed">SHOW SLAVE STATUS\G
</pre>
    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/using-mariadb-gtids-with-mariadb-galera-cluster/">
                        ← Using MariaDB GTIDs with MariaDB Galera Cluster
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster/">
                        ↑ Using MariaDB Replication with MariaDB Galera Cluster ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/configuring-mariadb-replication-between-two-mariadb-galera-clusters/">
                        Configuring MariaDB Replication between Two MariaDB Galera Clusters →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="8350" data-comments-url="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/+comments"
         data-reply-url="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-configuring-mariadb-r/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster/">
                    ↑ Using MariaDB Replication with MariaDB Galera Cluster ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/using-mariadb-replication-with-mariadb-galera-cluster-using-mariadb-replica/">
                            
                            Using MariaDB Replication with MariaDB Galera Cluster
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/using-mariadb-gtids-with-mariadb-galera-cluster/">
                            
                            Using MariaDB GTIDs with MariaDB Galera Cluster
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>Configuring MariaDB Replication between MariaDB Galera Cluster and MariaDB Server</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/configuring-mariadb-replication-between-two-mariadb-galera-clusters/">
                            
                            Configuring MariaDB Replication between Two MariaDB Galera Clusters
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>