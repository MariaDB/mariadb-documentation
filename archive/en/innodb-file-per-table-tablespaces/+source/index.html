<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>InnoDB File-Per-Table Tablespaces - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="InnoDB File-Per-Table Tablespaces - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/innodb-file-per-table-tablespaces/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/innodb-file-per-table-tablespaces/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/innodb-file-per-table-tablespaces/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/innodb/">InnoDB</a>
    

    
    » <a class="crumb" href="/kb/en/innodb-tablespaces/">InnoDB Tablespaces</a>
    


    » <a class="node_link crumb" href="/kb/en/innodb-file-per-table-tablespaces/">InnoDB File-Per-Table Tablespaces</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/innodb-file-per-table-tablespaces/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>InnoDB File-Per-Table Tablespaces - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/innodb-file-per-table-tablespaces/+r/134265/">134265</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-5454">
<a href="/kb/user/id/5454" title="Kenneth Dyer">Kenneth Dyer</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2024-01-17 01:09">2024-01-17 01:09</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;
When you create a table using the [[xtradb-and-innodb|InnoDB storage engine]], data written to that table is stored on the file system in a data file called a tablespace.  Tablespace files contain both the data and indexes.

When [[innodb-system-variables#innodb_file_per_table|innodb_file_per_table=ON]] is set, InnoDB uses one tablespace file per InnoDB table. These tablespace files have the ##.ibd## extension. When [[innodb-system-variables#innodb_file_per_table|innodb_file_per_table=OFF]] is set, InnoDB stores all tables in the [[innodb-system-tablespaces|InnoDB system tablespace]].

InnoDB versions in MySQL 5.7 and above also support an additional type of tablespace called [[https://dev.mysql.com/doc/refman/5.7/en/general-tablespaces.html|general tablespaces]] that are created with [[https://dev.mysql.com/doc/refman/5.7/en/create-tablespace.html|CREATE TABLESPACE]]. However, InnoDB versions in MariaDB Server do not support general tablespaces or [[create-tablespace|CREATE TABLESPACE]].

== File-Per-Table Tablespace Locations

By default, InnoDB&#39;s file-per-table tablespaces are created in the system&#39;s data directory, which is defined by the [[server-system-variables#datadir|datadir]] system variable. The system variable [[innodb-system-variables#innodb_data_home_dir|innodb_data_home_dir]] will not change the location of file-per-table tablespaces.

In the event that you have a specific tablespace that you need stored in a dedicated path, you can set the location using the [[create-table/#data-directoryindex-directory|DATA DIRECTORY]] table option when you create the table.

For instance,

&lt;&lt;sql&gt;&gt;
CREATE TABLE test.t1 (
   id INT PRIMARY KEY AUTO_INCREMENT,
   name VARCHAR(50)
) ENGINE=InnoDB
DATA DIRECTORY = &#34;/data/contact&#34;;
&lt;&lt;/sql&gt;&gt;

MariaDB then creates a database directory on the configured path and the file-per-table tablespace will be created inside that directory.  On Unix-like operating systems, you can see the file using the ls command:

&lt;&lt;code&gt;&gt;
# ls -al /data/contact/test
drwxrwx--- 2 mysql mysql  4096 Dec 8 18:46 .
drwxr-xr-x 3 mysql mysql  4096 Dec 8 18:46 ..
-rw-rw---- 1 mysql mysql 98304 Dec 8 20:41 t1.ibd
&lt;&lt;/code&gt;&gt;

Note, the system user that runs the MariaDB Server process (which is usually ##mysql##) must have write permissions on the given path.

== Copying Transportable Tablespaces

InnoDB&#39;s file-per-table tablespaces are transportable, which means that you can copy a file-per-table tablespace from one MariaDB Server to another server.  You may find this useful in cases where you need to transport full tables between servers and don&#39;t want to use backup tools like [[mariabackup|mariabackup]] or [[mariadb-dump]]. In fact, this process can even be used with [[mariabackup|mariabackup]] in some cases, such as when [[partial-backup-and-restore-with-mariabackup|restoring partial backups]] or when [[restoring-individual-tables-and-partitions-with-mariabackup|restoring individual tables or partitions from a backup]].

=== Copying Transportable Tablespaces for Non-partitioned Tables

You can copy the transportable tablespace of a non-partitioned table from one server to another by exporting the tablespace file from the original server, and then importing the tablespace file into the new server.

&lt;&lt;product mariadb from=11.2.1&gt;&gt;
The workflow is simplified starting from MariaDB 11.2.1. On the source server, simply do:

&lt;&lt;sql&gt;&gt;
FLUSH TABLES t1 FOR EXPORT;
# scp /data/contacts/test/t1.ibd target-server.com:/var/lib/mysql/test/
# scp /data/contacts/test/t1.cfg target-server.com:/var/lib/mysql/test/
# scp /data/contacts/test/t1.frm target-server.com:/var/lib/mysql/test/
UNLOCK TABLES;
&lt;&lt;/sql&gt;&gt;

On the destination server, simply do:
&lt;&lt;sql&gt;&gt;
ALTER TABLE t1 IMPORT TABLESPACE;
&lt;&lt;/sql&gt;&gt;
&lt;&lt;/product&gt;&gt;

==== Exporting Transportable Tablespaces for Non-partitioned Tables

You can export a non-partitioned table by locking the table and copying the table&#39;s ##.ibd## and ##.cfg## files from the relevant [[#file-per-table-tablespace-locations|tablespace location]] for the table to a backup location. For example, the process would go like this:

* First, use the [[flush-tables-for-export|FLUSH TABLES ... FOR EXPORT]] statement on the target table:

&lt;&lt;sql&gt;&gt;
FLUSH TABLES test.t1 FOR EXPORT;
&lt;&lt;/sql&gt;&gt;

This forces the server to close the table and provides your connection with a read lock on the table.

* Then, while your connection still holds the lock on the table, copy the tablespace file and the metadata file to a safe directory:

&lt;&lt;code&gt;&gt;
# cp /data/contacts/test/t1.ibd /data/saved-tablespaces/
# cp /data/contacts/test/t1.cfg /data/saved-tablespaces/
&lt;&lt;/code&gt;&gt;

* Then, once you&#39;ve copied the files, you can release the lock with [[lock-tables-and-unlock-tables|UNLOCK TABLES]]:

&lt;&lt;sql&gt;&gt;
UNLOCK TABLES;
&lt;&lt;/sql&gt;&gt;

==== Importing Transportable Tablespaces for Non-partitioned Tables

You can import a non-partitioned table by discarding the table&#39;s original tablespace, copying the table&#39;s ##.ibd## and ##.cfg## files from the backup location to the relevant [[#file-per-table-tablespace-locations|tablespace location]] for the table, and then telling the server to import the tablespace.

For example, the process would go like this:

* First, on the destination server, you need to create a copy of the table. Use the same [[create-table|CREATE TABLE]] statement that was used to create the table on the original server.

&lt;&lt;sql&gt;&gt;
CREATE TABLE test.t1 (
   id INT PRIMARY KEY AUTO_INCREMENT,
   name VARCHAR(50)
) ENGINE=InnoDB;
&lt;&lt;/sql&gt;&gt;

* Then, use [[alter-table/#discard-tablespace|ALTER TABLE ... DISCARD TABLESPACE]] to discard the new table&#39;s tablespace:

&lt;&lt;sql&gt;&gt;
ALTER TABLE test.t1 DISCARD TABLESPACE;
&lt;&lt;/sql&gt;&gt;

* Then, copy the ##.ibd## and ##.cfg## files from the original server to the relevant directory on the target MariaDB Server.

&lt;&lt;code&gt;&gt;
# scp /data/tablespaces/t1.ibd target-server.com:/var/lib/mysql/test/
# scp /data/tablespaces/t1.cfg target-server.com:/var/lib/mysql/test/
&lt;&lt;/code&gt;&gt;

&lt;&lt;style class=&#34;bluebox&#34;&gt;&gt;
File-per-table tablespaces can be imported with just the ##.ibd## file in many cases. If you do not have the tablespace&#39;s ##.cfg## file for whatever reason, then it is usually worth trying to import the tablespace with just the ##.ibd## file.
&lt;&lt;/style&gt;&gt;

* Then, once the files are in the proper directory on the target server, use [[alter-table/#import-tablespace|ALTER TABLE ... IMPORT TABLESPACE]] to import the new table&#39;s tablespace:

&lt;&lt;sql&gt;&gt;
ALTER TABLE test.t1 IMPORT TABLESPACE;
&lt;&lt;/sql&gt;&gt;

=== Copying Transportable Tablespaces for Partitioned Tables

Currently, MariaDB does not directly support the transport of tablespaces from partitioned tables. See MDEV-10568 for more information about that. It is still possible to transport partitioned tables if we use a workaround. You can copy the transportable tablespaces of a partitioned table from one server to another by exporting the tablespace file of each partition from the original server, and then importing the tablespace file of each partition into the new server.

==== Exporting Transportable Tablespaces for Partitioned Tables

You can export a partitioned table by locking the table and copying the ##.ibd## and ##.cfg## files of each partition from the relevant [[#file-per-table-tablespace-locations|tablespace location]] for the partition to a backup location. For example, the process would go like this:

* First, let&#39;s create a test table with some data on the original server:

&lt;&lt;sql&gt;&gt;
CREATE TABLE test.t2 (
   employee_id INT,
   name VARCHAR(50)
) ENGINE=InnoDB
PARTITION BY RANGE (employee_id) (
   PARTITION p0 VALUES LESS THAN (6),
   PARTITION p1 VALUES LESS THAN (11),
   PARTITION p2 VALUES LESS THAN (16),
   PARTITION p3 VALUES LESS THAN MAXVALUE
);

INSERT INTO test.t2 (name, employee_id) VALUES
   (&#39;Geoff Montee&#39;, 1), 
   (&#39;Chris Calendar&#39;, 6),
   (&#39;Kyle Joiner&#39;, 11), 
   (&#39;Will Fong&#39;, 16);
&lt;&lt;/sql&gt;&gt;

* Then, we need to export the partitioned tablespace from the original server, which follows the same process as exporting non-partitioned tablespaces. That means that we need to use the [[flush-tables-for-export|FLUSH TABLES ... FOR EXPORT]] statement on the target table:

&lt;&lt;sql&gt;&gt;
FLUSH TABLES test.t2 FOR EXPORT;
&lt;&lt;/sql&gt;&gt;

This forces the server to close the table and provides your connection with a read lock on the table.

* Then, if we grep the database directory in the data directory for the newly created ##t2## table, we can see a number of ##.ibd## and ##.cfg## files for the table:

&lt;&lt;code&gt;&gt;
# ls -l /var/lib/mysql/test/ | grep t2
total 428
-rw-rw---- 1 mysql mysql 827 Dec 5 16:08 t2.frm
-rw-rw---- 1 mysql mysql 48 Dec 5 16:08 t2.par
-rw-rw---- 1 mysql mysql 579 Dec 5 18:47 t2#P#p0.cfg
-rw-r----- 1 mysql mysql 98304 Dec 5 16:43 t2#P#p0.ibd
-rw-rw---- 1 mysql mysql 579 Dec 5 18:47 t2#P#p1.cfg
-rw-rw---- 1 mysql mysql 98304 Dec 5 16:08 t2#P#p1.ibd
-rw-rw---- 1 mysql mysql 579 Dec 5 18:47 t2#P#p2.cfg
-rw-rw---- 1 mysql mysql 98304 Dec 5 16:08 t2#P#p2.ibd
-rw-rw---- 1 mysql mysql 579 Dec 5 18:47 t2#P#p3.cfg
-rw-rw---- 1 mysql mysql 98304 Dec 5 16:08 t2#P#p3.ibd
&lt;&lt;/code&gt;&gt;

* Then, while our connection still holds the lock on the table, we need to copy the tablespace files and the metadata files to a safe directory:

&lt;&lt;code&gt;&gt;
$ mkdir /tmp/backup
$ sudo cp /var/lib/mysql/test/t2*.ibd /tmp/backup
$ sudo cp /var/lib/mysql/test/t2*.cfg /tmp/backup
&lt;&lt;/code&gt;&gt;

* Then, once we&#39;ve copied the files, we can release the lock with [[lock-tables-and-unlock-tables|UNLOCK TABLES]]:

&lt;&lt;sql&gt;&gt;
UNLOCK TABLES;
&lt;&lt;/sql&gt;&gt;

==== Importing Transportable Tablespaces for Partitioned Tables

You can import a partitioned table by creating a placeholder table, discarding the placeholder table&#39;s original tablespace, copying the partition&#39;s ##.ibd## and ##.cfg## files from the backup location to the relevant [[#file-per-table-tablespace-locations|tablespace location]] for the placeholder table, and then telling the server to import the tablespace. At that point, the server can exchange the tablespace for the placeholder table with the one for the partition. For example, the process would go like this:

* First, we need to copy the saved tablespace files from the original server to the target server:

&lt;&lt;code&gt;&gt;
$ scp /tmp/backup/t2* user@target-host:/tmp/backup
&lt;&lt;/code&gt;&gt;

* Then, we need to import the partitioned tablespaces onto the target server. The import process for partitioned tables is more complicated than the import process for non-partitioned tables.  To start with, if it doesn&#39;t already exist, then we need to create a partitioned table on the target server that matches the partitioned table on the original server:

&lt;&lt;sql&gt;&gt;
CREATE TABLE test.t2 (
   employee_id INT,
   name VARCHAR(50)
) ENGINE=InnoDB
PARTITION BY RANGE (employee_id) (
   PARTITION p0 VALUES LESS THAN (6),
   PARTITION p1 VALUES LESS THAN (11),
   PARTITION p2 VALUES LESS THAN (16),
   PARTITION p3 VALUES LESS THAN MAXVALUE
);
&lt;&lt;/sql&gt;&gt;

* Then, using this table as a model, we need to create a placeholder of this table with the same structure that does not use partitioning. This can be done with a [[create-table#create-select|CREATE TABLE... AS SELECT]] statement:

&lt;&lt;sql&gt;&gt;
CREATE TABLE test.t2_placeholder LIKE test.t2;
ALTER TABLE test.t2_placeholder REMOVE PARTITIONING;
&lt;&lt;/sql&gt;&gt;

This statement will create a new table called ##t2_placeholder## that has the same schema structure as ##t2##, but it does not use partitioning and it contains no rows.

===== For Each Partition

From this point forward, the rest of our steps need to happen for each individual partition. For each partition, we need to do the following process:

* First, we need to use [[alter-table/#discard-tablespace|ALTER TABLE ... DISCARD TABLESPACE]] to discard the placeholder table&#39;s tablespace:

&lt;&lt;sql&gt;&gt;
ALTER TABLE test.t2_placeholder DISCARD TABLESPACE;
&lt;&lt;/sql&gt;&gt;

* Then, copy the ##.ibd## and ##.cfg## files for the next partition to the relevant directory for the ##t2_placeholder## table on the target MariaDB Server:

&lt;&lt;code&gt;&gt;
# cp /tmp/backup/t2#P#p0.cfg /var/lib/mysql/test/t2_placeholder.cfg
# cp /tmp/backup/t2#P#p0.ibd /var/lib/mysql/test/t2_placeholder.ibd
# chown mysql:mysql /var/lib/mysql/test/t2_placeholder*
&lt;&lt;/code&gt;&gt;

&lt;&lt;style class=&#34;bluebox&#34;&gt;&gt;
File-per-table tablespaces can be imported with just the ##.ibd## file in many cases. If you do not have the tablepace&#39;s ##.cfg## file for whatever reason, then it is usually worth trying to import the tablespace with just the ##.ibd## file.
&lt;&lt;/style&gt;&gt;

* Then, once the files are in the proper directory on the target server, we need to use [[alter-table/#import-tablespace|ALTER TABLE ... IMPORT TABLESPACE]] to import the new table&#39;s tablespace:

&lt;&lt;sql&gt;&gt;
ALTER TABLE test.t2_placeholder IMPORT TABLESPACE;
&lt;&lt;/sql&gt;&gt;

The placeholder table now contains data from the ##p0## partition on the source server.

&lt;&lt;sql&gt;&gt;
SELECT * FROM test.t2_placeholder;

+-------------+--------------+
| employee_id | name         |
+-------------+--------------+
|           1 | Geoff Montee |
+-------------+--------------+
&lt;&lt;/sql&gt;&gt;

* Then, it&#39;s time to transfer the partition from the placeholder to the target table.  This can be done with an [[alter-table/#exchange-partition|ALTER TABLE... EXCHANGE PARTITION]] statement:

&lt;&lt;sql&gt;&gt;
ALTER TABLE test.t2 EXCHANGE PARTITION p0 WITH TABLE test.t2_placeholder;
&lt;&lt;/sql&gt;&gt;

The target table now contains the first partition from the source table.

&lt;&lt;sql&gt;&gt;
SELECT * FROM test.t2;

+-------------+--------------+
| employee_id | name         |
+-------------+--------------+
|           1 | Geoff Montee |
+-------------+--------------+
&lt;&lt;/sql&gt;&gt;

* Repeat this procedure for each partition you want to import. For each partition, we need to discard the placeholder table&#39;s tablespace, and then import the partitioned table&#39;s tablespace into the placeholder table, and then exchange the tablespaces between the placeholder table and the partition of our target table.

When this process is complete for all partitions, the target table will contain the imported data:

&lt;&lt;sql&gt;&gt;
SELECT * FROM test.t2;

+-------------+----------------+
| employee_id | name           |
+-------------+----------------+
|           1 | Geoff Montee   |
|           6 | Chris Calendar |
|          11 | Kyle Joiner    |
|          16 | Will Fong      |
+-------------+----------------+
&lt;&lt;/sql&gt;&gt;

* Then, we can remove the placeholder table from the database:

&lt;&lt;sql&gt;&gt;
DROP TABLE test.t2_placeholder;
&lt;&lt;/sql&gt;&gt;

=== Known Problems with Copying Transportable Tablespaces

==== Differing Storage Formats for Temporal Columns

MariaDB 10.1.2 added the [[server-system-variables/#mysql56_temporal_format|mysql56_temporal_format]] system variable, which enables a new MySQL 5.6-compatible storage format for the [[time|TIME]], [[datetime|DATETIME]] and [[timestamp|TIMESTAMP]] data types.

If a file-per-tablespace file contains columns that use one or more of these temporal data types and if the tablespace file&#39;s original table was created with a certain storage format for these columns, then the tablespace file can only be imported into tables that were also created with the same storage format for these columns as the original table. Otherwise, you will see errors like the following:

&lt;&lt;sql&gt;&gt;
ALTER TABLE dt_test IMPORT TABLESPACE;
ERROR 1808 (HY000): Schema mismatch (Column dt precise type mismatch.)
&lt;&lt;/sql&gt;&gt;

See MDEV-15225 for more information.

See the pages for the [[time|TIME]], [[datetime|DATETIME]] and [[timestamp|TIMESTAMP]] data types to determine how to update the storage format for temporal columns in tables that were created before MariaDB 10.1.2 or that were created with [[server-system-variables/#mysql56_temporal_format|mysql56_temporal_format=OFF]].

==== Differing ROW_FORMAT Values

InnoDB file-per-table tablespaces can use different [[xtradbinnodb-storage-formats|row formats]]. A specific row format can be specified when creating a table either by setting the [[create-table/#row_format|ROW_FORMAT]] table option or by the setting the [[innodb-system-variables/#innodb_default_row_format|innodb_default_row_format]] system variable. See [[innodb-storage-formats/#setting-a-tables-row-format|Setting a Table&#39;s Row Format]] for more information on how to set an InnoDB table&#39;s row format.

If a file-per-tablespace file was created with a certain row format, then the tablespace file can only be imported into tables that were created with the same row format as the original table. Otherwise, you will see errors like the following:

&lt;&lt;sql&gt;&gt;
ALTER TABLE t0 IMPORT TABLESPACE;
ERROR 1808 (HY000): Schema mismatch (Expected FSP_SPACE_FLAGS=0x21, .ibd file contains 0x0.)
&lt;&lt;/sql&gt;&gt;

The error message is a bit more descriptive in MariaDB 10.2.17 and later:

&lt;&lt;code lang=sql wrap=true&gt;&gt;
ALTER TABLE t0 IMPORT TABLESPACE;
ERROR 1808 (HY000): Schema mismatch (Table flags don&#39;t match, server table has 0x1 and the meta-data file has 0x0; .cfg file uses ROW_FORMAT=REDUNDANT)
&lt;&lt;/code&gt;&gt;

Be sure to check a tablespace&#39;s row format before moving it from one server to another. Keep in mind that the default row format can change between major versions of MySQL or MariaDB. See [[innodb-storage-formats/#checking-a-tables-row-format|Checking a Table&#39;s Row Format]] for information on how to check an InnoDB table&#39;s row format.

See MDEV-15049 and MDEV-16851 for more information.

==== Foreign Key Constraints

DISCARD on a table with foreign key constraints is only possible after disabling [[server-system-variables#foreign_key_checks|foreign_key_checks]]:

&lt;&lt;sql&gt;&gt;
SET SESSION foreign_key_checks=0;
ALTER TABLE t0 DISCARD TABLESPACE;
&lt;&lt;/sql&gt;&gt;

IMPORT on the other hand does not enforce foreign key constraints. So when importing tablespaces, referential integrity can only be guaranteed to import all tables bound by foreign key constraint at the same time, from an EXPORT of those tables taken with the same transactional state.

== Tablespace Encryption

MariaDB supports data-at-rest encryption for the InnoDB storage engine.  When enabled, the Server encrypts data before writing it to the tablespace and decrypts reads from the tablespace before returning result-sets.  This means that a malicious user attempting to exfiltrate sensitive data won&#39;t be able to import the tablespace onto a different server as shown above without the encryption key.

For more information on data encryption, see [[encrypting-data-for-innodb-xtradb|Encrypting Data for InnoDB]].

== See Also
* [[http://www.geoffmontee.com/importing-innodb-partitions-in-mysql-5-6-and-mariadb-10-010-1/|Geoff Montee:Importing InnoDB Partitions in MySQL 5.6 and MariaDB 10.0/10.1]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>