<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>CREATE FUNCTION - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="CREATE FUNCTION" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/create-function/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Creates a stored function." />

    <meta name="description" content="Creates a stored function." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/create-function/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/create-function/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/using-mariadb-server/">Using MariaDB Server</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements-structure/">SQL Statements &amp; Structure</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements/">SQL Statements</a>
    

    
    » <a class="crumb" href="/kb/en/data-definition/">Data Definition</a>
    

    
    » <a class="crumb" href="/kb/en/create/">CREATE</a>
    


    » <a class="node_link crumb" href="/kb/en/create-function/">CREATE FUNCTION</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/create-function/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/create-function/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/create-function/+flag"
                data-flag-url="/kb/en/create-function/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/create-function/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2010-04-02 18:42">13 years, 2 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2023-05-23 19:15">1 month ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/create-function/+license/">GPLv2 fill_help_tables.sql</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/create-function/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/create-function/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/create-function/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    
        

<div class="well well-small box"><div><h5>Localized Versions</h5></div><div>

        <ul>
            
            <li><a href="/kb/it/create-function/">CREATE FUNCTION</a> [it]</li>
            
            <li><a href="/kb/pt-br/create-function/">CREATE FUNCTION</a> [pt-br]</li>
            
            <li><a href="/kb/zh-cn/create-function/">CREATE FUNCTION</a> [zh-cn]</li>
            
        </ul>
        
</div>
</div>

    



    
    

<div class="well well-small box"><div><h5>Product Versions</h5></div><div>

        <ul id="product_chooser">
            
                <li class="mariadb_from_10_8_0">
                    <label><input type="checkbox" data-product-class="mariadb_from_10_8_0"
                            >MariaDB starting with 10.8.0</label>
                </li>
            
                <li class="mariadb_from_10_8_0">
                    <label><input type="checkbox" data-product-class="mariadb_from_10_8_0"
                            >MariaDB starting with 10.8.0</label>
                </li>
            
        </ul>
    
</div>
</div>





    

<div class="well well-small box"><div><h5>Parents</h5></div><div>

        <ul>
            
                <li><a href="/kb/en/create/">CREATE</a></li>
            
                <li><a href="/kb/en/stored-functions/">Stored Functions</a></li>
            
        </ul>
    
</div>
</div>



</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>CREATE FUNCTION</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <h2 class="anchored_heading" id="syntax">Syntax</h2>
<pre class="highlight fixed"><p>CREATE [OR REPLACE]
    [DEFINER = {user | CURRENT_USER | role | CURRENT_ROLE }]
    [AGGREGATE] FUNCTION [IF NOT EXISTS] func_name ([func_parameter[,...]])
    RETURNS type
    [characteristic ...]
    RETURN func_body</p>
<p>func_parameter:
    [ IN | OUT | INOUT | IN OUT ]  param_name type</p>
<p>type:
    Any valid MariaDB data type</p>
<p>characteristic:
    LANGUAGE SQL
  <code>|</code> [NOT] DETERMINISTIC
  <code>|</code> { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  <code>|</code> SQL SECURITY { DEFINER | INVOKER }
  <code>|</code> COMMENT 'string'</p>
<p>func_body:
    Valid SQL procedure statement</p></pre><div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class="mariadb_from_10_8_0"><a href="#syntax" title="Syntax">Syntax</a></li>

    <li class="mariadb_from_10_8_0"><a href="#description" title="Description">Description</a>    <ol class="toc">

        <li class="mariadb_from_10_8_0"><a href="#in-out-inout-in-out" title="IN | OUT | INOUT | IN OUT">IN | OUT | INOUT | IN OUT</a></li>

        <li class="mariadb_from_10_8_0"><a href="#aggregate" title="AGGREGATE">AGGREGATE</a></li>

        <li class="mariadb_from_10_8_0"><a href="#returns" title="RETURNS">RETURNS</a></li>

        <li class="mariadb_from_10_8_0"><a href="#language-sql" title="LANGUAGE SQL">LANGUAGE SQL</a></li>

        <li class="mariadb_from_10_8_0"><a href="#or-replace" title="OR REPLACE">OR REPLACE</a></li>

        <li class="mariadb_from_10_8_0"><a href="#if-not-exists" title="IF NOT EXISTS">IF NOT EXISTS</a></li>

        <li class="mariadb_from_10_8_0"><a href="#not-deterministic" title="[NOT] DETERMINISTIC">[NOT] DETERMINISTIC</a></li>

        <li class="mariadb_from_10_8_0"><a href="#modifies-sql-data" title="MODIFIES SQL DATA">MODIFIES SQL DATA</a></li>

        <li class="mariadb_from_10_8_0"><a href="#reads-sql-data" title="READS SQL DATA">READS SQL DATA</a></li>

        <li class="mariadb_from_10_8_0"><a href="#contains-sql" title="CONTAINS SQL">CONTAINS SQL</a></li>

        <li class="mariadb_from_10_8_0"><a href="#no-sql" title="NO SQL">NO SQL</a></li>

        <li class="mariadb_from_10_8_0"><a href="#oracle-mode" title="Oracle Mode">Oracle Mode</a>    </ol>
</li>

    <li class="mariadb_from_10_8_0"><a href="#security" title="Security">Security</a></li>

    <li class="mariadb_from_10_8_0"><a href="#character-sets-and-collations" title="Character sets and collations">Character sets and collations</a></li>

    <li class="mariadb_from_10_8_0"><a href="#examples" title="Examples">Examples</a></li>

    <li class="mariadb_from_10_8_0"><a href="#see-also" title="See Also">See Also</a> </ol>
</li>
</div>
<h2 class="anchored_heading" id="description">Description</h2>
<p>Use the <code>CREATE FUNCTION</code> statement to create a new <a href="/kb/en/stored-functions/">stored function</a>. You must have
the <a href="/kb/en/grant/#database-privileges">CREATE ROUTINE</a> database privilege to use <code>CREATE FUNCTION</code>.
A function takes any number of arguments and returns a value from the function body. The
function body can be any valid SQL expression as you would use, for example, in any select
expression. If you have the appropriate privileges, you can call the function exactly as you
would any built-in function. See <a href="#security">Security</a> below for details on privileges.</p>
<p>You can also use a variant of the <code>CREATE FUNCTION</code> statement to install a user-defined
function (UDF) defined by a plugin. See <a href="/kb/en/create-function-udf/">CREATE FUNCTION (UDF)</a>
for details.</p>
<p>You can use a <a href="/kb/en/select/">SELECT</a> statement for the function body by enclosing it in
parentheses, exactly as you would to use a subselect for any other expression. The <code>SELECT</code>
statement must return a single value. If more than one column is returned when the function is called,
error 1241 results. If more than one row is returned when the function is called, error 1242
results. Use a <code>LIMIT</code> clause to ensure only one row is returned.</p>
<p>You can also replace the <code>RETURN</code> clause with a <a href="/kb/en/begin-end/">BEGIN...END</a> compound
statement. The compound statement must contain a <code>RETURN</code> statement. When the function is
called, the <code>RETURN</code> statement immediately returns its result, and any statements after <code>RETURN</code>
are effectively ignored.</p>
<p>By default, a function is associated with the current database. To associate the function explicitly
with a given database, specify the fully-qualified name as <code><em>db_name</em>.<em>func_name</em></code>
when you create it. If the function name is the same as the name of a built-in function, you must
use the fully qualified name when you call it.</p>
<p>The parameter list enclosed within parentheses must always be present.
If there are no parameters, an empty parameter list of () should be
used. Parameter names are not case sensitive.</p>
<p>Each parameter can be declared to use any valid data type, except that
the COLLATE attribute cannot be used.</p>
<p>For valid identifiers to use as function names, see <a href="/kb/en/identifier-names/">Identifier Names</a>.</p>
<h4 class="anchored_heading" id="in-out-inout-in-out">IN | OUT | INOUT | IN OUT</h4>
<div class="mariadb_from_10_8_0 mariadb from_10_8_0 product"><h5 class="product_title">MariaDB starting with <a href="/kb/en/mariadb-1080-release-notes/">10.8.0</a></h5><p>The function parameter qualifiers for <code>IN</code>, <code>OUT</code>, <code>INOUT</code>, and <code>IN OUT</code> were added in a 10.8.0 preview release. Prior to 10.8.0 quantifiers were supported only in procedures.</p>
</div><p><code>OUT</code>, <code>INOUT</code> and its equivalent <code>IN OUT</code>, are only valid if called from <code>SET</code> and not <code>SELECT</code>. These quantifiers are especially useful for creating functions with more than one return value. This allows functions to be more complex and nested.</p>
<pre class="fixed">DELIMITER $$
CREATE FUNCTION add_func3(IN a INT, IN b INT, OUT c INT) RETURNS INT
BEGIN
  SET c = 100;
  RETURN a + b;
END;
$$
DELIMITER ;
 
SET @a = 2;
SET @b = 3;
SET @c = 0;
SET @res= add_func3(@a, @b, @c);

SELECT add_func3(@a, @b, @c);
ERROR 4186 (HY000): OUT or INOUT argument 3 for function add_func3 is not allowed here

DELIMITER $$
CREATE FUNCTION add_func4(IN a INT, IN b INT, d INT) RETURNS INT
BEGIN
  DECLARE c, res INT;
  SET res = add_func3(a, b, c) + d;
  if (c &gt; 99) then
    return  3;
  else
    return res;
  end if;
END;
$$

DELIMITER ;

SELECT add_func4(1,2,3);
+------------------+
| add_func4(1,2,3) |
+------------------+
|                3 |
+------------------+
</pre><h4 class="anchored_heading" id="aggregate">AGGREGATE</h4>
<p>It is possible to create stored aggregate functions as well. See <a href="/kb/en/stored-aggregate-functions/">Stored Aggregate Functions</a> for details.</p>
<h4 class="anchored_heading" id="returns">RETURNS</h4>
<p>The <code>RETURNS</code> clause specifies the return type of the function. <code>NULL</code> values are permitted with all return types.</p>
<p>What happens if the <code>RETURN</code> clause returns a value of a different type? It depends on the <a href="/kb/en/sql-mode/">SQL_MODE</a> in effect at the moment of the function creation.</p>
<p>If the SQL_MODE is strict (STRICT_ALL_TABLES or STRICT_TRANS_TABLES flags are specified), a 1366 error will be produced.</p>
<p>Otherwise, the value is coerced to the proper type. For example, if a function
specifies an <code>ENUM</code> or <code>SET</code> value in the <code>RETURNS</code> clause, but the <code>RETURN</code>
clause returns an integer, the value returned from the function is the string for the corresponding <code>ENUM</code>
member of set of <code>SET</code> members.</p>
<p>MariaDB stores the SQL_MODE system variable setting that is in effect at the
time a routine is created, and always executes the routine with this setting in
force, regardless of the server SQL mode in effect when the routine is invoked.</p>
<h4 class="anchored_heading" id="language-sql">LANGUAGE SQL</h4>
<p><code>LANGUAGE SQL</code> is a standard SQL clause, and it can be used in MariaDB for portability. However that clause has no meaning, because SQL is the only supported language for stored functions.</p>
<p>A function is deterministic if it can produce only one result for a given list of parameters. If the result may be affected by stored data, server variables, random numbers or any value that is not explicitly passed, then the function is not deterministic. Also, a function is non-deterministic if it uses non-deterministic functions like <a href="/kb/en/now/">NOW()</a> or <a href="/kb/en/current_user/">CURRENT_TIMESTAMP()</a>. The optimizer may choose a faster execution plan if it known that the function is deterministic. In such cases, you should declare the routine using the <code>DETERMINISTIC</code> keyword. If you want to explicitly state that the function is not deterministic (which is the default) you can use the <code>NOT DETERMINISTIC</code> keywords.</p>
<p>If you declare a non-deterministic function as <code>DETERMINISTIC</code>, you may get incorrect results. If you declare a deterministic function as <code>NOT DETERMINISTIC</code>, in some cases the queries will be slower.</p>
<h4 class="anchored_heading" id="or-replace">OR REPLACE</h4>
<p>If the optional <code>OR REPLACE</code> clause is used, it acts as a shortcut for:</p>
<pre class="fixed"><span class="k">DROP</span> <span class="k">FUNCTION</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="n">function_name</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">function_name</span> <span class="p">...;</span>
</pre><p>with the exception that any existing <a href="/kb/en/stored-routine-privileges/">privileges</a> for the function are not dropped.</p>
<h4 class="anchored_heading" id="if-not-exists">IF NOT EXISTS</h4>
<p>If the IF NOT EXISTS clause is used, MariaDB will return a warning instead of an error if the function already exists. Cannot be used together with OR REPLACE.</p>
<h4 class="anchored_heading" id="not-deterministic">[NOT] DETERMINISTIC</h4>
<p>The <code>[NOT] DETERMINISTIC</code> clause also affects <a href="/kb/en/binary-log/">binary logging</a>, because the <code>STATEMENT</code> format can not be used to store or replicate non-deterministic statements.</p>
<p><code>CONTAINS SQL</code>, <code>NO SQL</code>, <code>READS SQL DATA</code>, and <code>MODIFIES SQL DATA</code> are informative clauses that tell the server what the function does. MariaDB does not check in any way whether the specified clause is correct. If none of these clauses are specified, <code>CONTAINS SQL</code> is used by default.</p>
<h4 class="anchored_heading" id="modifies-sql-data">MODIFIES SQL DATA</h4>
<p><code>MODIFIES SQL DATA</code> means that the function contains statements that may modify data stored in databases. This happens if the function contains statements like <a href="/kb/en/delete/">DELETE</a>, <a href="/kb/en/update/">UPDATE</a>, <a href="/kb/en/insert/">INSERT</a>, <a href="/kb/en/replace/">REPLACE</a> or DDL.</p>
<h4 class="anchored_heading" id="reads-sql-data">READS SQL DATA</h4>
<p><code>READS SQL DATA</code> means that the function reads data stored in databases, but does not modify any data. This happens if <a href="/kb/en/select/">SELECT</a> statements are used, but there no write operations are executed.</p>
<h4 class="anchored_heading" id="contains-sql">CONTAINS SQL</h4>
<p><code>CONTAINS SQL</code> means that the function contains at least one SQL statement, but it does not read or write any data stored in a database. Examples include <a href="/kb/en/set/">SET</a> or <a href="/kb/en/do/">DO</a>.</p>
<h4 class="anchored_heading" id="no-sql">NO SQL</h4>
<p><code>NO SQL</code> means nothing, because MariaDB does not currently support any language other than SQL.</p>
<h4 class="anchored_heading" id="oracle-mode">Oracle Mode</h4>
<p>A subset of Oracle's PL/SQL language is supported in addition to the traditional SQL/PSM-based MariaDB syntax. See <a href="/kb/en/sql_modeoracle-from-mariadb-103/#stored-procedures-and-stored-functions">Oracle mode</a> for details on changes when running Oracle mode.</p>
<h2 class="anchored_heading" id="security">Security</h2>
<p>You must have the <a href="/kb/en/grant/#function-privileges">EXECUTE</a> privilege on a function to call it.
MariaDB automatically grants the <code>EXECUTE</code> and <code>ALTER ROUTINE</code> privileges to the
account that called <code>CREATE FUNCTION</code>, even if the <code>DEFINER</code> clause was used.</p>
<p>Each function has an account associated as the definer. By default, the definer is the account
that created the function. Use the <code>DEFINER</code> clause to specify a different account as the
definer. You must have the <a href="/kb/en/grant/#super">SUPER</a> privilege, or, from <a href="/kb/en/mariadb-1052-release-notes/">MariaDB 10.5.2</a>, the <a href="/kb/en/grant/#set-user">SET USER</a> privilege, to use the <code>DEFINER</code>
clause. See <a href="/kb/en/create-user/#account-names">Account Names</a> for details on specifying accounts.</p>
<p>The <code>SQL SECURITY</code> clause specifies what privileges are used when a function is called.
If <code>SQL SECURITY</code> is <code>INVOKER</code>, the function body will be evaluated using the privileges
of the user calling the function. If <code>SQL SECURITY</code> is <code>DEFINER</code>, the function body is
always evaluated using the privileges of the definer account. <code>DEFINER</code> is the default.</p>
<p>This allows you to create functions that grant limited access to certain data. For example, say
you have a table that stores some employee information, and that you've granted <code>SELECT</code>
privileges <a href="/kb/en/grant/#column-privileges">only on certain columns</a> to the user account <code>roger</code>.</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">employees</span> <span class="p">(</span><span class="n">name</span> <span class="n">TINYTEXT</span><span class="p">,</span> <span class="n">dept</span> <span class="n">TINYTEXT</span><span class="p">,</span> <span class="n">salary</span> <span class="nb">INT</span><span class="p">);</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dept</span><span class="p">)</span> <span class="k">ON</span> <span class="n">employees</span> <span class="k">TO</span> <span class="n">roger</span><span class="p">;</span>
</pre><p>To allow the user the get the maximum salary for a department, define a function and grant
the <code>EXECUTE</code> privilege:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">max_salary</span> <span class="p">(</span><span class="n">dept</span> <span class="n">TINYTEXT</span><span class="p">)</span> <span class="k">RETURNS</span> <span class="nb">INT</span> <span class="k">RETURN</span>
  <span class="p">(</span><span class="k">SELECT</span> <span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">employees</span> <span class="k">WHERE</span> <span class="n">employees</span><span class="p">.</span><span class="n">dept</span> <span class="o">=</span> <span class="n">dept</span><span class="p">);</span>
<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ON</span> <span class="k">FUNCTION</span> <span class="n">max_salary</span> <span class="k">TO</span> <span class="n">roger</span><span class="p">;</span>
</pre><p>Since <code>SQL SECURITY</code> defaults to <code>DEFINER</code>, whenever the user <code>roger</code> calls
this function, the subselect will execute with your privileges. As long as you have privileges to
select the salary of each employee, the caller of the function will be able to get the maximum
salary for each department without being able to see individual salaries.</p>
<h2 class="anchored_heading" id="character-sets-and-collations">Character sets and collations</h2>
<p>Function return types can be declared to use any valid <a href="/kb/en/character-sets/">character set and collation</a>. If used, the COLLATE attribute needs to be preceded by a CHARACTER SET attribute.</p>
<p>If the character set and collation are not specifically set in the statement, the database defaults at the time of creation will be used. If the database defaults change at a later stage, the stored function character set/collation will not be changed at the same time; the stored function needs to be dropped and recreated to ensure the same character set/collation as the database is used.</p>
<h2 class="anchored_heading" id="examples">Examples</h2>
<p>The following example function takes a parameter, performs an operation using
an SQL function, and returns the result.</p>
<pre class="fixed">CREATE FUNCTION hello (s CHAR(20))
    RETURNS CHAR(50) DETERMINISTIC
    RETURN CONCAT('Hello, ',s,'!');

SELECT hello('world');
+----------------+
| hello('world') |
+----------------+
| Hello, world!  |
+----------------+
</pre><p>You can use a compound statement in a function to manipulate data with statements
like <code>INSERT</code> and <code>UPDATE</code>. The following example creates a counter function
that uses a temporary table to store the current value. Because the compound statement
contains statements terminated with semicolons, you have to first change the statement
delimiter with the <code>DELIMITER</code> statement to allow the semicolon to be used in the
function body. See <a href="/kb/en/delimiters/">Delimiters in the mariadb client</a> for more.</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">TEMPORARY</span> <span class="k">TABLE</span> <span class="n">counter</span> <span class="p">(</span><span class="k">c</span> <span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">counter</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="k">DELIMITER</span> <span class="o">//</span>
<span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">counter</span> <span class="p">()</span> <span class="k">RETURNS</span> <span class="nb">INT</span>
  <span class="k">BEGIN</span>
    <span class="k">UPDATE</span> <span class="n">counter</span> <span class="k">SET</span> <span class="k">c</span> <span class="o">=</span> <span class="k">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">RETURN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">c</span> <span class="k">FROM</span> <span class="n">counter</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">END</span> <span class="o">//</span>
<span class="k">DELIMITER</span> <span class="p">;</span>
</pre><p>Character set and collation:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">hello2</span> <span class="p">(</span><span class="n">s</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
  <span class="k">RETURNS</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="nb">CHARACTER</span> <span class="k">SET</span> <span class="s1">&#39;utf8&#39;</span> <span class="k">COLLATE</span> <span class="s1">&#39;utf8_bin&#39;</span> <span class="k">DETERMINISTIC</span>
  <span class="k">RETURN</span> <span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;Hello, &#39;</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="s1">&#39;!&#39;</span><span class="p">);</span>
</pre><h2 class="anchored_heading" id="see-also">See Also</h2>
<ul start="1"><li><a href="/kb/en/identifier-names/">Identifier Names</a>
</li><li><a href="/kb/en/stored-aggregate-functions/">Stored Aggregate Functions</a>
</li><li><a href="/kb/en/create-function-udf/">CREATE FUNCTION (UDF)</a>
</li><li><a href="/kb/en/show-create-function/">SHOW CREATE FUNCTION</a>
</li><li><a href="/kb/en/alter-function/">ALTER FUNCTION</a>
</li><li><a href="/kb/en/drop-function/">DROP FUNCTION</a>
</li><li><a href="/kb/en/show-function-status/">SHOW FUNCTION STATUS</a>
</li><li><a href="/kb/en/stored-routine-privileges/">Stored Routine Privileges</a>
</li><li><a href="/kb/en/information-schema-routines-table/">Information Schema ROUTINES Table</a></li></ul>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/create-function/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/create-function/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/create-event/">
                        ← CREATE EVENT
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/create/">
                        ↑ CREATE ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/create-function-udf/">
                        CREATE FUNCTION UDF →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="240" data-comments-url="/kb/en/create-function/+comments"
         data-reply-url="/kb/en/create-function/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/create/">
                    ↑ CREATE ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/create-database/">
                            
                            CREATE DATABASE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-event/">
                            
                            CREATE EVENT
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>CREATE FUNCTION</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-function-udf/">
                            <span class="pull-right not_primary"></span>
                            CREATE FUNCTION UDF
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-index/">
                            
                            CREATE INDEX
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-logfile-group/">
                            
                            CREATE LOGFILE GROUP
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-package/">
                            
                            CREATE PACKAGE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-package-body/">
                            
                            CREATE PACKAGE BODY
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-procedure/">
                            <span class="pull-right not_primary"></span>
                            CREATE PROCEDURE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-role/">
                            <span class="pull-right not_primary"></span>
                            CREATE ROLE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-sequence/">
                            <span class="pull-right not_primary"></span>
                            CREATE SEQUENCE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-server/">
                            
                            CREATE SERVER
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-table/">
                            
                            CREATE TABLE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-tablespace/">
                            
                            CREATE TABLESPACE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-trigger/">
                            <span class="pull-right not_primary"></span>
                            CREATE TRIGGER
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-user/">
                            <span class="pull-right not_primary"></span>
                            CREATE USER
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-view/">
                            <span class="pull-right not_primary"></span>
                            CREATE VIEW
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/silent-column-changes/">
                            
                            Silent Column Changes
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/generated-columns/">
                            
                            Generated (Virtual and Persistent/Stored) Columns
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/invisible-columns/">
                            
                            Invisible Columns
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>