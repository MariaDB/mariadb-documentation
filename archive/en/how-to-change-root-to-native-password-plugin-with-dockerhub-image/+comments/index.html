



<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>
Comments - How to change root to native-password plugin with dockerhub image
 - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    
        <meta name="robots" content="noindex, nofollow" />
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="
Comments - How to change root to native-password plugin with dockerhub image
" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes node_comments jqui" id="node_comments">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/getting-installing-and-upgrading-mariadb/">Getting, Installing, and Upgrading MariaDB</a>
    

    
    » <a class="crumb" href="/kb/en/binary-packages/">MariaDB Binary Packages</a>
    

    
    » <a class="crumb" href="/kb/en/automated-mariadb-deployment-and-administration/">Automated MariaDB Deployment and Administration</a>
    

    
    » <a class="crumb" href="/kb/en/docker-and-mariadb/">MariaDB Containers</a>
    


    » <a class="node_link crumb" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/">How to change root to native-password plugin with dockerhub image</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
            
            
            
            <section id="content" class="limited_width col-md-12 clearfix">
                
                    <h1>
Comments - How to change root to native-password plugin with dockerhub image
</h1>
                

                



                <div>
                    
<div id="comments" data-node-id="10761" data-comments-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments"
        data-reply-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/comments/post/">
<div class="comment_top_menu hidden-print">&nbsp;
            <div class="pull-right">
                <label>
                    Include Archived
                    <input id="include_archived" type="checkbox" name="include_archived" value="1"
                           />
                </label>
            </div>
        </div>
        <a name="comment_5299"></a>
        <div class="comment approved" style="margin-left: 0px">
            <div class="info">
                

<span class="datetime" title="2021-06-28 04:59">3 years, 1 month ago</span>
                
<span class="user" id="user-6187">
<a href="/kb/user/id/6187" title="Daniel Black">Daniel Black</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5299">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>Based on a possibility that your secret included a \n at the end, the next release of the Docker Library MariaDB containers will contain <a href="https://github.com/MariaDB/mariadb-docker/commit/2809485eba66f862d21d218bbd008b01ccdb2094">this fix</a> that will correctly start if there is one (or more) \n at the end of the password (and a few other odd exception cases).</p>
<p>The other possibility is that you are putting a space between "-p" and the password in the mysql command line which treats the password as a database name. Run without the space like above.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5299/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5299/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5301"></a>
        <div class="comment approved" style="margin-left: 10px">
            <div class="info">
                

<span class="datetime" title="2021-06-28 11:57">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5301">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>I see you are using version 10.5.   I have been trying with the mariadb:latest image, which I now see defaults to version 10.5.</p>
<p>When I try the following commands in a script:</p>
<p>read -p "Enter your MYSQL_ROOT_PASSWORD : " mysql_root_password
podman exec -e MYSQL_ROOT_PASSWORD=${mysql_root_password} -e DB_NAME=${DB_NAME} -e DB_USER=${DB_USER} -e DB_HOST=${DB_HOST} -e DB_PASSWORD=${DB_PASSWORD} -it ${MARIA_CONT_NAME} bash -c "mysql -uroot -p\${MYSQL_ROOT_PASSWORD} -hlocalhost -e \"CREATE DATABASE \${DB_NAME} CHARSET utf8; grant all privileges on \${DB_NAME}.* TO \${DB_USER}@\${DB_HOST} identified by '$\{DB_PASSWORD}';\""</p>
<p>or when I try and log in from a command line having exec'ed into a bash session inside the maria container, I get the following error:
ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)</p>
<p>I have checked and the variable 'mysql_root_password' does not contain a newline character.
There is no space between -p and the password in any command.</p>
<p>This is my command for making the Mariadb secret:
$(read -p "Enter variable for MARIADB_ROOT_PASSWORD : " token) &amp;&amp; printf token | podman secret create "MARIADB_ROOT_PASSWORD" -</p>
<p>which I then later use:
podman run -dit --secret=MARIADB_ROOT_PASSWORD,type=env --name ${MARIA_CONT_NAME} --pod ${POD_NAME} ${MARIA_IMAGE}</p>
<p>the above run command is followed immediately by:</p>
<p>read -p "Enter your MYSQL_ROOT_PASSWORD : " mysql_root_password</p>
<p>podman exec -e MARIADB_ROOT_PASSWORD=${mysql_root_password} -e DB_NAME=${DB_NAME} -e DB_USER=${DB_USER} -e DB_HOST=${DB_HOST} -e DB_PASSWORD=${DB_PASSWORD} -it ${MARIA_CONT_NAME} bash -c "mysql -uroot -p\${MARIADB_ROOT_PASSWORD} -hlocalhost -e \"CREATE DATABASE \${DB_NAME} CHARSET utf8; grant all privileges on \${DB_NAME}.* TO \${DB_USER}@\${DB_HOST} identified by '$\{DB_PASSWORD}';\""</p>
<p>And this command (or me manually trying to log into the mariadb with the root password) fails with access denied.</p>
<p>I am creating it this way, because I want to use the command 'podman generate systemd --files --new' so that the systemd script create the container from new each time.  So, I will, if I can connect to mariadb, mount the /var/lib/sql directory on the host in the run command.  The aim is that the newly created by systemd container will reuse the database each time.</p>
<p>But I can't get this basic command to work.  I have tried creating the maria container with -e MARIADB_ROOT_PASSWORD="some_password", but I still get no luck.</p>
<p>I'm stumped...</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5301/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5301/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5306"></a>
        <div class="comment approved" style="margin-left: 20px">
            <div class="info">
                

<span class="datetime" title="2021-06-29 00:24">3 years, 1 month ago</span>
                
<span class="user" id="user-6187">
<a href="/kb/user/id/6187" title="Daniel Black">Daniel Black</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5306">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <pre class="fixed">$(read -p &#34;Enter variable for MARIADB_ROOT_PASSWORD : &#34; token) &amp;&amp; printf token
Enter variable for MARIADB_ROOT_PASSWORD : what is this password
token
</pre><p>Note:</p>
<ol start="1"><li>a literal "token" is printed so that is the password.
</li><li>because <em>read</em> is in a subshell, the token variable isn't saved.
</li></ol>
<p>To observe results:</p>
<pre class="fixed">Use podman inspect {container} | grep -i password
</pre><p>Use:</p>
<pre class="fixed">read -p &#34;Enter variable for MARIADB_ROOT_PASSWORD : &#34; token &amp;&amp; echo -n $token | podman secret create &#34;MARIADB_ROOT_PASSWORD&#34; -
</pre><p>If you use the environment variables <em>MARIADB_USER</em>, <em>MARIADB_PASSWORD</em> and <em>MARIADB_DATABASE</em> you end up with that user <a href="https://github.com/MariaDB/mariadb-docker/blob/master/docker-entrypoint.sh#L328-L329">having all grants on the database</a> exactly how you are trying to achieve this.</p>
<p>Attempted your podman exec:</p>
<pre class="fixed">$ podman exec -e ROOT_PASSWORD='davebob' -e DB_NAME=space -e DB_USER=major -e DB_HOST=% -e DB_PASSWORD=soverysecret -it mdbtest bash -c &#34;mysql -uroot -p\${ROOT_PASSWORD} -hlocalhost -e \&#34;CREATE DATABASE \${DB_NAME} CHARSET utf8; grant all privileges on \${DB_NAME}.* TO \${DB_USER}@\${DB_HOST} identified by '$\{DB_PASSWORD}';\&#34;&#34;
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '% identified by '$\{DB_PASSWORD}'' at line 1

$ podman exec   mdbtest mysql -pdavebob -e 'drop database space'

$ podman exec -e ROOT_PASSWORD='davebob' -e DB_NAME=space -e DB_USER=major -e DB_HOST=% -e DB_PASSWORD=soverysecret -it mdbtest bash -c &#34;mysql -uroot -p\${ROOT_PASSWORD} -hlocalhost -e \&#34;CREATE DATABASE \${DB_NAME} CHARSET utf8; grant all privileges on \${DB_NAME}.* TO '\${DB_USER}'@'\${DB_HOST}' identified by '\${DB_PASSWORD}';\&#34;&#34;

$ podman exec   mdbtest mysql -pdavebob -e 'show databases'
Database
information_schema
mysql
performance_schema
space

$ podman exec   mdbtest mysql -pdavebob -e 'show create user major'
CREATE USER for major@%
CREATE USER `major`@`%` IDENTIFIED BY PASSWORD '*D03D15427D788A324B1D75E87F702540998589DB'

$ podman exec   mdbtest mysql -u major -psoverysecret -e 'show databases'
Database
information_schema
space
</pre><p>To fix (as I did above):</p>
<ol start="1"><li>quote your hostname, and possibly username if it can be more than just basic
</li><li><em>\</em> should be before <em>$</em> near <em>DB_PASSWORD</em>
</li></ol>
<pre class="fixed">$ podman exec   mdbtest mysql -pdavebob -e 'select * from mysql.global_priv'
Host	User	Priv
localhost	mariadb.sys	{&#34;access&#34;:0,&#34;plugin&#34;:&#34;mysql_native_password&#34;,&#34;authentication_string&#34;:&#34;&#34;,&#34;account_locked&#34;:true,&#34;password_last_changed&#34;:0}
localhost	root	{&#34;access&#34;:549755813887,&#34;plugin&#34;:&#34;mysql_native_password&#34;,&#34;authentication_string&#34;:&#34;*F64E0B8EB4D0A34AD85562E6BF2E2F9C8274DAB5&#34;,&#34;password_last_changed&#34;:1624925339,&#34;version_id&#34;:100510}
%	root	{&#34;access&#34;:549755813887,&#34;version_id&#34;:100510,&#34;plugin&#34;:&#34;mysql_native_password&#34;,&#34;authentication_string&#34;:&#34;*F64E0B8EB4D0A34AD85562E6BF2E2F9C8274DAB5&#34;,&#34;password_last_changed&#34;:1624925339}
%	major	{&#34;access&#34;:0,&#34;version_id&#34;:100510,&#34;plugin&#34;:&#34;mysql_native_password&#34;,&#34;authentication_string&#34;:&#34;*D03D15427D788A324B1D75E87F702540998589DB&#34;,&#34;password_last_changed&#34;:1624925600}
</pre><p>In 10.4+ don't depend on the <em>mysql.user</em> view, look at <em>mysql.global_priv</em> directly.</p>
<p>Focus on your scripting and observing its behaviour. The container is actually ok.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5306/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5306/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5309"></a>
        <div class="comment approved" style="margin-left: 30px">
            <div class="info">
                

<span class="datetime" title="2021-06-29 01:14">3 years, 1 month ago</span>
                
<span class="user" id="user-6187">
<a href="/kb/user/id/6187" title="Daniel Black">Daniel Black</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5309">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>edit use the following to prevent shell escaping of the password:</p>
<pre class="fixed">read -p &#34;Enter variable for MARIADB_ROOT_PASSWORD : &#34; token &amp;&amp; echo -n &#34;$token&#34; | podman secret create &#34;MARIADB_ROOT_PASSWORD&#34; 
</pre><p>Note I recommend leaving it to the container entrypoint to create the non-root user and its password. It handles the escaping of passwords in shell and SQL significantly better that the scripting you have written.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5309/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5309/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5310"></a>
        <div class="comment approved" style="margin-left: 40px">
            <div class="info">
                

<span class="datetime" title="2021-06-29 09:29">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5310">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>Many thanks for your help.   I discovered the issue.   When a pod is created, a network namespace is created for it automatically.  This has the following name 'ceramic_isles_dev_pod', in my case.
So, if I run:
 podman exec -it maria_cont2 bash -c "mysql -uroot -h'ceramic_isles_dev_pod' -p"
I am able to successfully enter the password with no issue.
....you said....
Note I recommend leaving it to the container entrypoint to create the non-root user and its password. It handles the escaping of passwords in shell and SQL significantly better that the scripting you have written.
.....
There are two reasons that I don't use the container entrypoint with environment variables.  The first and principle reason is that I intend to start/restart the container with a systemd script that generates a new container each time the host starts.   This container will then connect to an existing database, as although the container will be new and fresh, the database will still exist at the bind mount to /var/lib/mysql.   This will allow me to run/create the containers under a system (&lt;999 id) user, for extra security.
Since the podman generate-systemd command uses the initial run command to start the new container each time, I don't want to have a new database and user recreated each time, as I want to reuse the existing database.  I will be using the --files and --new flags of the podman generate systemd command...
<a href="http://docs.podman.io/en/latest/markdown/podman-generate-systemd.1.html">http://docs.podman.io/en/latest/markdown/podman-generate-systemd.1.html</a></p>
<p>The second reason, is that in the past, when I tried to use the initial database creation environment variables, is that it didn't work, as I remember.  The container failed to run, quitting immediately, and on restarting it, I seem to recall that either the database wasn't created or I couldn't see it because of my current issues.
So, I have just tried it again, and counter-intuitively, the new user and database is created but on the host of 'ceramic_isles_dev_pod' - the pod name, but root is created on localhost.   I am able to login successfully in both cases.  So, if I don't create a database initially, then root is pod_name but if I do then root is 'localhost'.
My bash scripting is not particularly good, you are quite right.  I had changed the printf in the read command from echo, to remove a newline character and must have deleted the $ sign in front of the variable 'token' then.  I will use your syntax provided, many thanks.
And many thanks overall, not just for your help, but for your work in supporting the community with your maintenance of this image.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5310/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5310/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5311"></a>
        <div class="comment approved" style="margin-left: 50px">
            <div class="info">
                

<span class="datetime" title="2021-06-29 09:37">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5311">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>just in case anyone reads the post, the secret creation command is correct except for a hyphen at the end -</p>
<p>read -p "Enter variable for MARIADB_ROOT_PASSWORD : " token &amp;&amp; echo -n "$token" | podman secret create "MARIADB_ROOT_PASSWORD"  -</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5311/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5311/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5313"></a>
        <div class="comment approved" style="margin-left: 60px">
            <div class="info">
                

<span class="datetime" title="2021-06-29 11:43">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5313">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>So, I finally got it to work.  I was having another issue which is that once I had created the container using podman run,  I had to wait an unspecified amount of time before the database in the container would accept commands.
I ended up running a podman exec command to delete root@% as a do, done loop, like so...
until podman exec -e ROOT_PASSWORD="$mysql_root_password" -it "${MARIA_CONT_NAME}" bash -c "mysql -uroot  -p\"\${ROOT_PASSWORD}\" -h'localhost' -e \"delete from mysql.global_priv where user='root' and host='%'; flush privileges;\""  &gt; /dev/null 2&gt;&amp;1
do
	echo -n "."
done</p>
<p>Note, I added the redirection to null after I last tested it, but it should be ok, I guess.</p>
<p>Then I ran the podman exec command to create the database, and it worked fine.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5313/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5313/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5316"></a>
        <div class="comment approved" style="margin-left: 70px">
            <div class="info">
                

<span class="datetime" title="2021-06-30 01:49">3 years, 1 month ago</span>
                
<span class="user" id="user-6187">
<a href="/kb/user/id/6187" title="Daniel Black">Daniel Black</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5316">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>Thanks for explaining your use and fixing my missing -.</p>
<p>Using MARIADB_ROOT_HOST=localhost will prevent a root@% creation. There will still be a root@localhost user which is unix socket only, so only a podman exec can use it.</p>
<p>If you do need to remove a user please use <a href="https://mariadb.com/kb/en/drop-user/">drop user</a>. The entrypoint that does similar hackery needs to be cleaned up and is obviously a bad example.</p>
<p>Waiting until it starts is something I plan to fix with a healthcheck script (<a href="https://jira.mariadb.org/browse/MDEV-25434">MDEV-25434</a>).</p>
<p>In the mean time your loop should be using mysql --protocol=tcp as there can be a few temporary starts which could get your command executed early.</p>
<p>Happy to take issues/feature requests on github or JIRA.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5316/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5316/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5318"></a>
        <div class="comment approved" style="margin-left: 80px">
            <div class="info">
                

<span class="datetime" title="2021-06-30 12:29">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5318">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>Many thanks for all your help.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5318/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5318/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    

    

    

    

    

    

    
        <a name="comment_5302"></a>
        <div class="comment approved" style="margin-left: 20px">
            <div class="info">
                

<span class="datetime" title="2021-06-28 12:02">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5302">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>Perhaps it is because my maria_container is being created inside a pod which only exposes ports 80 and 445?
But I am execing into the container so the port shouldn't be necessary.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5302/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5302/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5303"></a>
        <div class="comment approved" style="margin-left: 30px">
            <div class="info">
                

<span class="datetime" title="2021-06-28 14:02">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5303">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>This...</p>
<p>MariaDB [(none)]&gt; show create user root;
ERROR 1290 (HY000): The MariaDB server is running with the --skip-grant-tables option so it cannot execute this statement
MariaDB [(none)]&gt; select user,host,plugin from mysql.user;
+-------------+--------------------------+-----------------------+</p>
<table><tr><td>User</td><td>Host</td><td>plugin</td></tr>
</table>
<p>+-------------+--------------------------+-----------------------+</p>
<table><tr><td>mariadb.sys</td><td>localhost</td><td>mysql_native_password</td></tr>
<tr><td>root</td><td>localhost</td><td></td></tr>
<tr><td>root</td><td>ceramic\_isles\_dev\_pod</td><td></td></tr>
<tr><td>root</td><td>127.0.0.1</td><td></td></tr>
<tr><td>root</td><td>::1</td><td></td></tr>
</table>
<p>+-------------+--------------------------+-----------------------+
5 rows in set (0.062 sec)</p>
<p>So that explains why I am getting access denied, because no plugin is being used</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5303/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5303/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5304"></a>
        <div class="comment approved" style="margin-left: 40px">
            <div class="info">
                

<span class="datetime" title="2021-06-28 14:35">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5304">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>If I do the following:
podman run -dit -e MARIADB_ROOT_PASSWORD='davebob' -e MARIADB_ROOT_HOST='localhost' --name ${MARIA_CONT_NAME} --pod ${POD_NAME} ${MARIA_IMAGE} 
and
podman exec -e ROOT_PASSWORD='davebob' -e DB_NAME=${DB_NAME} -e DB_USER=${DB_USER} -e DB_HOST=${DB_HOST} -e DB_PASSWORD=${DB_PASSWORD} -it ${MARIA_CONT_NAME} bash -c "mysql -uroot -p\${ROOT_PASSWORD} -hlocalhost -e \"CREATE DATABASE \${DB_NAME} CHARSET utf8; grant all privileges on \${DB_NAME}.* TO \${DB_USER}@\${DB_HOST} identified by '$\{DB_PASSWORD}';\""</p>
<p>I get told that no connection can be made through the socket.
<strong>tearing my hair out</strong></p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5304/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5304/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_5305"></a>
        <div class="comment approved" style="margin-left: 50px">
            <div class="info">
                

<span class="datetime" title="2021-06-28 14:48">3 years, 1 month ago</span>
                
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5305">Re: How to change root to native-password plugin with dockerhub image</a>
                
            </div><div class="comment_text">
                <p>Ok, I am certain it is because it is running inside a pod.  I made a new container using the same commands,  and was able to get into it easily.</p>
<p>So, something about the container being inside a pod is causing the issues that I am having.</p>
<p>I guess it is because it is using a network namespace with only 445 and 80 exposed, but that shouldn't stop me from being able to exec into the container and connect using localhost socket.  Gah....</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5305/flag"
                       data-flag-url="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+comments/5305/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    

    

    

    

    

    

</div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>