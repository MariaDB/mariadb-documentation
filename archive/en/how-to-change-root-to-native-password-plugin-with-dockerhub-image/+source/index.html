<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>How to change root to native-password plugin with dockerhub image - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="How to change root to native-password plugin with dockerhub image - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/getting-installing-and-upgrading-mariadb/">Getting, Installing, and Upgrading MariaDB</a>
    

    
    » <a class="crumb" href="/kb/en/binary-packages/">MariaDB Binary Packages</a>
    

    
    » <a class="crumb" href="/kb/en/automated-mariadb-deployment-and-administration/">Automated MariaDB Deployment and Administration</a>
    

    
    » <a class="crumb" href="/kb/en/docker-and-mariadb/">MariaDB Containers</a>
    


    » <a class="node_link crumb" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/">How to change root to native-password plugin with dockerhub image</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/">Return to question</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>How to change root to native-password plugin with dockerhub image - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/how-to-change-root-to-native-password-plugin-with-dockerhub-image/+r/107951/">107951</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-10539">
<a href="/kb/user/id/10539" title="James Stewart Miller">James Stewart Miller</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2021-06-28 03:35">2021-06-28 03:35</span></dd>
        </dl>
    </div>
    


    
        <textarea id="question_source" class="creole_source autogrow">The version of maria in the latest dockerhub image expects root to login using root access ie sudo mysql.
This is not possible with podman rootless, and so I want to log in using a password.  When creating the container I use the environment variable MARIADB_ROOT_PASSWORD, but when I try to connect to maria using &#39;mysql -u root -p, I get access denied.

In the Maria literature it states:

You want passwords back, no unix_socket authentication anymore? Run

ALTER USER root@localhost IDENTIFIED VIA mysql_native_password USING PASSWORD(&#34;verysecret&#34;)

But how can I run sql, including a password, without being able to log in to maria as root?

I could try creating an executable .sh file, for example, and baking it into a custom image, having placed it into /docker-entrypoint-initdb.d.  But the .sh file would still have to contain:
mysql -u root -p ${_can_get_root_password_in_environment_variable_when_I_start_container_with_run } -e &#34;ALTER USER root... as above&#34;
An executable sh file would allow me to use the MARIADB_ROOT_PASSWORD, creating it as a podman secret and passing it in as an environment variable when I run the container - ie podman run --secret=MARIADB_ROOT_PASSWORD,type=env -it container_name

If I try the same thing with a raw sql file, I can&#39;t pass in the password.

So, basically, I am stuck, and unable to connect to the mariadb database using the docker image.

Any help gratefully received...</textarea>
    

    
        
            <h2>Answer</h2>
        
        <textarea id="answer_source" class="creole_source autogrow">Just to make sure I understand this correctly this is what I have tested:

&lt;&lt;code&gt;&gt;
$ podman run --name mdbtest_root_password -e MARIADB_ROOT_PASSWORD=bob -d -P  docker.io/library/mariadb:10.5


$ podman exec -ti mdbtest_root_password bash
root@499f950b9a5d:/# env | grep PASSWORD
MARIADB_ROOT_PASSWORD=bob
root@499f950b9a5d:/# mysql
ERROR 1045 (28000): Access denied for user &#39;root&#39;@&#39;localhost&#39; (using password: NO)
root@499f950b9a5d:/# mysql -pbob
Welcome to the MariaDB monitor.  Commands end with ; or \g.
MariaDB [(none)]&gt; show create user root@localhost;
+---------------------------------------------------------------------------------------------------+
| CREATE USER for root@localhost                                                                    |
+---------------------------------------------------------------------------------------------------+
| CREATE USER `root`@`localhost` IDENTIFIED BY PASSWORD &#39;*61584B76F6ECE8FB9A328E7CF198094B2FAC55C7&#39; |
+---------------------------------------------------------------------------------------------------+
1 row in set (0.000 sec)

MariaDB [(none)]&gt; show create user root@`%`;
+-------------------------------------------------------------------------------------------+
| CREATE USER for root@%                                                                    |
+-------------------------------------------------------------------------------------------+
| CREATE USER `root`@`%` IDENTIFIED BY PASSWORD &#39;*61584B76F6ECE8FB9A328E7CF198094B2FAC55C7&#39; |
+-------------------------------------------------------------------------------------------+
1 row in set (0.000 sec)

MariaDB [(none)]&gt; select user,host from mysql.global_priv;
+-------------+-----------+
| user        | host      |
+-------------+-----------+
| root        | %         |
| mariadb.sys | localhost |
| root        | localhost |
+-------------+-----------+
3 rows in set (0.001 sec)

$ podman port mdbtest_root_password 3306/tcp
0.0.0.0:36243

$ mysql -u root --protocol tcp --port 36243 -pbob -e &#39;select version()&#39;
+---------------------------------------+
| version()                             |
+---------------------------------------+
| 10.5.10-MariaDB-1:10.5.10+maria~focal |
+---------------------------------------+
&lt;&lt;/code&gt;&gt;

Testing with secrets:
&lt;&lt;code&gt;&gt;
$ echo $(pwgen 30) | podman secret create MARIADB_ROOT_PASSWORD -
$ podman run --name mdbtest_root_password --secret=MARIADB_ROOT_PASSWORD,type=env -d  -P  docker.io/library/mariadb:10.5
2f2f8ccc81a165016e0b264f48aa537f51019bee53d6c678573753ca23e05dac
$ podman inspect mdbtest_root_password | grep PASSWORD
                &#34;MARIADB_ROOT_PASSWORD=doocoh8AeChee8eimieb0xePhiTh8u\n&#34;
                &#34;--secret=MARIADB_ROOT_PASSWORD,type=env&#34;,
$ podman logs 2f2f8ccc81a165016e0b264f48aa537f51019bee53d6c678573753ca23e05dac
2021-06-28 00:10:02+00:00 [Note] [Entrypoint]: Stopping temporary server
2021-06-28  0:10:02 6 [Warning] Access denied for user &#39;root&#39;@&#39;localhost&#39; (using password: YES)
mysqladmin: connect to server at &#39;localhost&#39; failed
error: &#39;Access denied for user &#39;root&#39;@&#39;localhost&#39; (using password: YES)&#39;
2021-06-28 00:10:02+00:00 [ERROR] [Entrypoint]: Unable to shut down server.
&lt;&lt;/code&gt;&gt;

So this looks like there&#39;s an error handing a password that ends with \n. So I suspect that https://github.com/MariaDB/mariadb-docker/commit/58f4020613e4b96ab0a937890af1a7a4e0dc4b00 needs more handling.

Having a password without \n however:
&lt;&lt;code&gt;&gt;
$ echo -n $(pwgen 30) | podman secret create MARIADB_ROOT_PASSWORD -
70b2de3385c806d5a3fa3a8eb
$ podman run --name mdbtest_root_password --secret=MARIADB_ROOT_PASSWORD,type=env -d  -P  docker.io/library/mariadb:10.5
53172c18a18898f384ef1b130e5fa14538e154adb71fe90ac147ea28b6f6ebef
$ podman port  mdbtest_root_password
3306/tcp -&gt; 0.0.0.0:35889
$ podman inspect mdbtest_root_password | grep PASSWORD
                &#34;MARIADB_ROOT_PASSWORD=Jool0ae0eew2aeha2cahchoovaSha6&#34;
                &#34;--secret=MARIADB_ROOT_PASSWORD,type=env&#34;,
$ mysql -u root --protocol=tcp --port 35889 -pJool0ae0eew2aeha2cahchoovaSha6 -e &#39;select version()&#39;
+---------------------------------------+
| version()                             |
+---------------------------------------+
| 10.5.10-MariaDB-1:10.5.10+maria~focal |
+---------------------------------------+
&lt;&lt;/code&gt;&gt;

So in conclusion:
* the mariadb container doesn&#39;t have unix_socket authentication at all (would of shown up in the SHOW CREATE USER)
* Both root users, @localhost and @% get the password from MARIADB_ROOT_PASSWORD
* No sudo/su is needed as the root mapped user is understood as being root by mariadb
* Most likely this is the old old compatibility thing that there must not be a space between {{-p}} and the password.
* The image needs to be more testing with passwords ending in \n.

As the maintainer of the MariaDB docker library image I do most of my testing with podman. Thanks for cluing me into the use of podman secrets. I haven&#39;t used them before.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>