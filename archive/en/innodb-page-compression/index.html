<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>InnoDB Page Compression - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="InnoDB Page Compression" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/innodb-page-compression/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="InnoDB page compression, which is more sophisticated than the COMPRESSED row format." />

    <meta name="description" content="InnoDB page compression, which is more sophisticated than the COMPRESSED row format." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/innodb-page-compression/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/innodb-page-compression/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/innodb/">InnoDB</a>
    


    » <a class="node_link crumb" href="/kb/en/innodb-page-compression/">InnoDB Page Compression</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/innodb-page-compression/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/innodb-page-compression/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/innodb-page-compression/+flag"
                data-flag-url="/kb/en/innodb-page-compression/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/innodb-page-compression/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2015-02-23 13:55">8 years, 4 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2022-10-18 11:01">8 months, 1 week ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/innodb-page-compression/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/innodb-page-compression/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/innodb-page-compression/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/innodb-page-compression/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    





    

<div class="well well-small box"><div><h5>Parents</h5></div><div>

        <ul>
            
                <li><a href="/kb/en/innodb-and-xtradb/">InnoDB</a></li>
            
                <li><a href="/kb/en/optimization-and-tuning-compression/">Compression</a></li>
            
        </ul>
    
</div>
</div>



</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>InnoDB Page Compression</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#overview" title="Overview">Overview</a></li>

    <li class=""><a href="#use-cases" title="Use Cases">Use Cases</a></li>

    <li class=""><a href="#comparison-with-the-compressed-row-format" title="Comparison with the COMPRESSED Row Format">Comparison with the COMPRESSED Row Format</a></li>

    <li class=""><a href="#comparison-with-storage-engine-independent-column-compression" title="Comparison with Storage Engine-Independent Column Compression">Comparison with Storage Engine-Independent Column Compression</a></li>

    <li class=""><a href="#configuring-the-innodb-page-compression-algorithm" title="Configuring the InnoDB Page Compression Algorithm">Configuring the InnoDB Page Compression Algorithm</a>    <ol class="toc">

        <li class=""><a href="#checking-supported-innodb-page-compression-algorithms" title="Checking Supported InnoDB Page Compression Algorithms">Checking Supported InnoDB Page Compression Algorithms</a></li>

        <li class=""><a href="#adding-support-for-an-innodb-page-compression-algorithm" title="Adding Support for an InnoDB Page Compression Algorithm">Adding Support for an InnoDB Page Compression Algorithm</a>    </ol>
</li>

    <li class=""><a href="#enabling-innodb-page-compression" title="Enabling InnoDB Page Compression">Enabling InnoDB Page Compression</a>    <ol class="toc">

        <li class=""><a href="#enabling-innodb-page-compression-by-default" title="Enabling InnoDB Page Compression by Default">Enabling InnoDB Page Compression by Default</a></li>

        <li class=""><a href="#enabling-innodb-page-compression-for-individual-tables" title="Enabling InnoDB Page Compression for Individual Tables">Enabling InnoDB Page Compression for Individual Tables</a>    </ol>
</li>

    <li class=""><a href="#configuring-the-compression-level" title="Configuring the Compression Level">Configuring the Compression Level</a>    <ol class="toc">

        <li class=""><a href="#configuring-the-default-compression-level" title="Configuring the Default Compression Level">Configuring the Default Compression Level</a></li>

        <li class=""><a href="#configuring-the-compression-level-for-individual-tables" title="Configuring the Compression Level for Individual Tables">Configuring the Compression Level for Individual Tables</a>    </ol>
</li>

    <li class=""><a href="#configuring-the-failure-threshold-and-maximum-padding" title="Configuring the Failure Threshold and Maximum Padding">Configuring the Failure Threshold and Maximum Padding</a>    <ol class="toc">

        <li class=""><a href="#configuring-the-failure-threshold" title="Configuring the Failure Threshold">Configuring the Failure Threshold</a></li>

        <li class=""><a href="#configuring-the-maximum-padding" title="Configuring the Maximum Padding">Configuring the Maximum Padding</a>    </ol>
</li>

    <li class=""><a href="#saving-storage-space-with-sparse-files" title="Saving Storage Space with Sparse Files">Saving Storage Space with Sparse Files</a>    <ol class="toc">

        <li class=""><a href="#sparse-file-support-on-linux" title="Sparse File Support on Linux">Sparse File Support on Linux</a></li>

        <li class=""><a href="#sparse-file-support-on-windows" title="Sparse File Support on Windows">Sparse File Support on Windows</a></li>

        <li class=""><a href="#configuring-innodb-to-use-sparse-files" title="Configuring InnoDB to use Sparse Files">Configuring InnoDB to use Sparse Files</a>    </ol>
</li>

    <li class=""><a href="#optimized-for-flash-storage" title="Optimized for Flash Storage">Optimized for Flash Storage</a></li>

    <li class=""><a href="#configuring-innodb-page-flushing" title="Configuring InnoDB Page Flushing">Configuring InnoDB Page Flushing</a></li>

    <li class=""><a href="#monitoring-innodb-page-compression" title="Monitoring InnoDB Page Compression">Monitoring InnoDB Page Compression</a></li>

    <li class=""><a href="#compatibility-with-backup-tools" title="Compatibility with Backup Tools">Compatibility with Backup Tools</a></li>

    <li class=""><a href="#acknowledgements" title="Acknowledgements">Acknowledgements</a></li>

    <li class=""><a href="#see-also" title="See Also">See Also</a> </ol>
</li>
</div>
<h2 class="anchored_heading" id="overview">Overview</h2>
<p>InnoDB page compression provides a way to compress InnoDB tables.</p>
<h2 class="anchored_heading" id="use-cases">Use Cases</h2>
<ul start="1"><li>InnoDB page compression can be used on any storage device and any file system.
</li></ul>
<ul start="1"><li>InnoDB page compression is most efficient on file systems that support sparse files. See <a href="#saving-storage-space-with-sparse-files">Saving Storage Space with Sparse Files</a> for more information.
</li></ul>
<ul start="1"><li>InnoDB page compression is most beneficial on solid state drives (SSDs) and other flash storage. See <a href="#optimized-for-flash-storage">Optimized for Flash Storage</a> for more information.
</li></ul>
<ul start="1"><li>InnoDB page compression performs best when your storage device and file system support atomic writes, since that allows the <a href="/kb/en/xtradbinnodb-doublewrite-buffer/">InnoDB doublewrite buffer</a> to be disabled. See <a href="/kb/en/atomic-write-support/">Atomic Write Support</a> for more information. 
</li></ul>
<h2 class="anchored_heading" id="comparison-with-the-compressed-row-format">Comparison with the <code>COMPRESSED</code> Row Format</h2>
<p>InnoDB page compression is a modern way to compress your InnoDB tables. It is similar to InnoDB's <a href="/kb/en/innodb-compressed-row-format/">COMPRESSED</a> row format, but it has many advantages. Some of the differences are:</p>
<ul start="1"><li>With InnoDB page compression, compressed pages are immediately decompressed after being read from the tablespace file, and only uncompressed pages are stored in the buffer pool. In contrast, with InnoDB's <a href="/kb/en/innodb-compressed-row-format/">COMPRESSED</a> row format, compressed pages are decompressed immediately after they are read from the tablespace file, and both the uncompressed and compressed pages are stored in the buffer pool. This means that the <a href="/kb/en/innodb-compressed-row-format/">COMPRESSED</a> row format uses more space in the buffer pool than InnoDB page compression does.
</li><li>With InnoDB page compression, pages are compressed just before being written to the tablespace file. In contrast, with InnoDB's <a href="/kb/en/innodb-compressed-row-format/">COMPRESSED</a> row format, pages are re-compressed immediately after any changes, and the compressed pages are stored in the buffer pool alongside the uncompressed pages. These changes are then occasionally flushed to disk. This means that the <a href="/kb/en/innodb-compressed-row-format/">COMPRESSED</a> row format re-compresses data more frequently than InnoDB page compression does.
</li><li>With InnoDB page compression, multiple compression algorithms are supported. In contrast, with InnoDB's <a href="/kb/en/innodb-compressed-row-format/">COMPRESSED</a> row format, <a href="https://www.zlib.net/">zlib</a> is the only supported compression algorithm. This means that the <a href="/kb/en/innodb-compressed-row-format/">COMPRESSED</a> row format has less compression options than InnoDB page compression does.
</li></ul>
<p>In general, InnoDB page compression is superior to the <a href="/kb/en/innodb-compressed-row-format/">COMPRESSED</a> row format.</p>
<h2 class="anchored_heading" id="comparison-with-storage-engine-independent-column-compression">Comparison with Storage Engine-Independent Column Compression</h2>
<ul start="1"><li>See <a href="/kb/en/storage-engine-independent-column-compression/#comparison-with-innodb-page-compression">Storage Engine-Independent Column Compression - Comparison with InnoDB Page Compression</a>.
</li></ul>
<h2 class="anchored_heading" id="configuring-the-innodb-page-compression-algorithm">Configuring the InnoDB Page Compression Algorithm</h2>
<p>There is not currently a table option to set different InnoDB page compression algorithms for individual tables.</p>
<p>However, the server-wide InnoDB page compression algorithm can be configured by setting the
<a href="/kb/en/innodb-system-variables/#innodb_compression_algorithm">innodb_compression_algorithm</a> system variable.</p>
<p>When this system variable is changed, the InnoDB page compression algorithm does not change for existing pages that were already compressed with a different InnoDB page compression algorithm. InnoDB is able to handle this situation without issues, because every page in an InnoDB tablespace contains metadata about the InnoDB page compression algorithm in the page header. This means that InnoDB supports having uncompressed pages and pages compressed with different InnoDB page compression algorithms in the same InnoDB tablespace at the same time.</p>
<p>This system variable can be set to one of the following values:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>System Variable Value</th><th>Description</th></tr>
<tr><td><code>none</code></td><td>Pages are not compressed. This is the default value in <a href="/kb/en/mariadb-1023-release-notes/">MariaDB 10.2.3</a> and before, and <a href="/kb/en/mariadb-10121-release-notes/">MariaDB 10.1.21</a> and before.</td></tr>
<tr><td><code>zlib</code></td><td>Pages are compressed using the bundled <a href="https://www.zlib.net/">zlib</a> compression algorithm. This is the default value in <a href="/kb/en/mariadb-1024-release-notes/">MariaDB 10.2.4</a> and later, and <a href="/kb/en/mariadb-10122-release-notes/">MariaDB 10.1.22</a> and later.</td></tr>
<tr><td><code>lz4</code></td><td>Pages are compressed using the <a href="https://code.google.com/p/lz4/">lz4</a> compression algorithm.</td></tr>
<tr><td><code>lzo</code></td><td>Pages are compressed using the <a href="http://www.oberhumer.com/opensource/lzo/">lzo</a> compression algorithm.</td></tr>
<tr><td><code>lzma</code></td><td>Pages are compressed using the <a href="http://tukaani.org/xz/">lzma</a> compression algorithm.</td></tr>
<tr><td><code>bzip2</code></td><td>Pages are compressed using the <a href="http://www.bzip.org/">bzip2</a> compression algorithm.</td></tr>
<tr><td><code>snappy</code></td><td>Pages are compressed using the <a href="http://google.github.io/snappy/">snappy</a> algorithm.</td></tr>
</table>
</div><p>However, on many distributions, the standard MariaDB builds do not support all InnoDB page compression algorithms by default. From <a href="/kb/en/what-is-mariadb-107/">MariaDB 10.7</a>, algorithms can be <a href="/kb/en/compression-plugins/">installed as a plugin</a>.</p>
<p>This system variable can be changed dynamically with <a href="/kb/en/set/#global-session">SET GLOBAL</a>. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_algorithm</span><span class="o">=</span><span class="s1">&#39;lzma&#39;</span><span class="p">;</span>
</pre><p>This system variable can also be set in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up the server. For example:</p>
<pre class="fixed">[mariadb]
...
innodb_compression_algorithm=lzma
</pre><h3 class="anchored_heading" id="checking-supported-innodb-page-compression-algorithms">Checking Supported InnoDB Page Compression Algorithms</h3>
<p>On many distributions, the standard MariaDB builds do not support all InnoDB page compression algorithms by default. Therefore, if you want to use a specific InnoDB page compression algorithm, then you should check whether your MariaDB build supports it.</p>
<p>The <a href="https://www.zlib.net/">zlib</a> compression algorithm is always supported. From <a href="/kb/en/what-is-mariadb-107/">MariaDB 10.7</a>, algorithms can be <a href="/kb/en/compression-plugins/">installed as a plugin</a>.</p>
<p>A MariaDB build's support for other InnoDB page compression algorithms can be checked by querying the following status variables with <a href="/kb/en/show-status/">SHOW GLOBAL STATUS</a>:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>Status Variable</th><th>Description</th></tr>
<tr><td><a href="/kb/en/innodb-server-status-variables/#innodb_have_lz4">Innodb_have_lz4</a></td><td>Whether InnoDB supports the <a href="https://code.google.com/p/lz4/">lz4</a> compression algorithm.</td></tr>
<tr><td><a href="/kb/en/innodb-server-status-variables/#innodb_have_lzo">Innodb_have_lzo</a></td><td>Whether InnoDB supports the <a href="http://www.oberhumer.com/opensource/lzo/">lzo</a> compression algorithm.</td></tr>
<tr><td><a href="/kb/en/innodb-server-status-variables/#innodb_have_lzma">Innodb_have_lzma</a></td><td>Whether InnoDB supports the <a href="http://tukaani.org/xz/">lzma</a> compression algorithm.</td></tr>
<tr><td><a href="/kb/en/innodb-server-status-variables/#innodb_have_bzip2">Innodb_have_bzip2</a></td><td>Whether InnoDB supports the <a href="http://www.bzip.org/">bzip2</a> compression algorithm.</td></tr>
<tr><td><a href="/kb/en/innodb-server-status-variables/#innodb_have_snappy">Innodb_have_snappy</a></td><td>Whether InnoDB supports the <a href="http://google.github.io/snappy/">snappy</a> compression algorithm.</td></tr>
</table>
</div><p>For example:</p>
<pre class="fixed"><span class="k">SHOW</span> <span class="k">GLOBAL</span> <span class="n">STATUS</span> <span class="k">WHERE</span> <span class="n">Variable_name</span> <span class="k">IN</span> <span class="p">(</span>
   <span class="s1">&#39;Innodb_have_lz4&#39;</span><span class="p">,</span> 
   <span class="s1">&#39;Innodb_have_lzo&#39;</span><span class="p">,</span> 
   <span class="s1">&#39;Innodb_have_lzma&#39;</span><span class="p">,</span> 
   <span class="s1">&#39;Innodb_have_bzip2&#39;</span><span class="p">,</span> 
   <span class="s1">&#39;Innodb_have_snappy&#39;</span>
<span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------+-------+</span>
<span class="o">|</span> <span class="n">Variable_name</span>      <span class="o">|</span> <span class="n">Value</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-------+</span>
<span class="o">|</span> <span class="n">Innodb_have_lz4</span>    <span class="o">|</span> <span class="k">OFF</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">Innodb_have_lzo</span>    <span class="o">|</span> <span class="k">OFF</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">Innodb_have_lzma</span>   <span class="o">|</span> <span class="k">ON</span>    <span class="o">|</span>
<span class="o">|</span> <span class="n">Innodb_have_bzip2</span>  <span class="o">|</span> <span class="k">OFF</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">Innodb_have_snappy</span> <span class="o">|</span> <span class="k">OFF</span>   <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+-------+</span>
</pre><h3 class="anchored_heading" id="adding-support-for-an-innodb-page-compression-algorithm">Adding Support for an InnoDB Page Compression Algorithm</h3>
<p>On many distributions, the standard MariaDB builds do not support all InnoDB page compression algorithms by default. From <a href="/kb/en/what-is-mariadb-107/">MariaDB 10.7</a>, algorithms can be <a href="/kb/en/compression-plugins/">installed as a plugin</a>, but in earlier versions, if you want to use certain InnoDB page compression algorithms, then you may need to do the following:</p>
<ul start="1"><li>Download the package for the desired compression library from the above links.
</li><li>Install the package for the desired compression library. 
</li><li>Compile MariaDB from the source distribution.
</li></ul>
<p>The general steps for compiling MariaDB are:</p>
<ul start="1"><li>Download and unpack the source code distribution:
</li></ul>
<pre class="fixed">wget https://downloads.mariadb.com/MariaDB/mariadb-10.4.8/source/mariadb-10.4.8.tar.gz
tar -xvzf mariadb-10.4.8.tar.gz
cd mariadb-10.4.8/
</pre><ul start="1"><li>Configure the build using <a href="/kb/en/generic-build-instructions/#using-cmake">cmake</a>:
</li></ul>
<pre class="fixed">cmake .
</pre><ul start="1"><li>Check <a href="https://cmake.org/runningcmake/">CMakeCache.txt</a> to confirm that it has found the desired compression library on your system.
</li></ul>
<ul start="1"><li>Compile the build:
</li></ul>
<pre class="fixed">make
</pre><ul start="1"><li>Either install the build:
</li></ul>
<pre class="fixed">make install
</pre><p>Or make a package to install:</p>
<pre class="fixed">make package
</pre><p>See <a href="/kb/en/compiling-mariadb-from-source/">Compiling MariaDB From Source</a> for more information.</p>
<h2 class="anchored_heading" id="enabling-innodb-page-compression">Enabling InnoDB Page Compression</h2>
<p>InnoDB page compression is not enabled by default. However, InnoDB page compression can be enabled for just individual InnoDB tables or it can be enabled for all new InnoDB tables by default.</p>
<p>InnoDB page compression is also only supported if the InnoDB table is in a <a href="/kb/en/innodb-file-per-table-tablespaces/">file per-table</a> tablespace. Therefore, the <a href="/kb/en/innodb-system-variables/#innodb_file_per_table">innodb_file_per_table</a> system variable must be set to <code>ON</code> to use InnoDB page compression.</p>
<p>InnoDB page compression is only supported if the InnoDB table uses the <code>Barracuda</code> <a href="/kb/en/xtradbinnodb-file-format/">file format</a>.Therefore, in <a href="/kb/en/what-is-mariadb-101/">MariaDB 10.1</a> and before, the <a href="/kb/en/innodb-system-variables/#innodb_file_format">innodb_file_format</a> system variable must be set to <code>Barracuda</code> to use InnoDB page compression.</p>
<p>InnoDB page compression is also only supported if the InnoDB table's <a href="/kb/en/innodb-row-formats-overview/">row format</a> is <a href="/kb/en/innodb-compact-row-format/">COMPACT</a> or <a href="/kb/en/innodb-dynamic-row-format/">DYNAMIC</a>.</p>
<h3 class="anchored_heading" id="enabling-innodb-page-compression-by-default">Enabling InnoDB Page Compression by Default</h3>
<p>In <a href="/kb/en/mariadb-1023-release-notes/">MariaDB 10.2.3</a> and later, InnoDB page compression can be enabled for all new InnoDB tables by default by setting the <a href="/kb/en/innodb-system-variables/#innodb_compression_default">innodb_compression_default</a> system variable to <code>ON</code>.</p>
<p>This system variable can be set to one of the following values:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>System Variable Value</th><th>Description</th></tr>
<tr><td><code>OFF</code></td><td>New InnoDB tables do not use InnoDB page compression. This is the default value.</td></tr>
<tr><td><code>ON</code></td><td>New InnoDB tables use InnoDB page compression.</td></tr>
</table>
</div><p>This system variable can be changed dynamically with <a href="/kb/en/set/#global-session">SET GLOBAL</a>. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_default</span><span class="o">=</span><span class="k">ON</span><span class="p">;</span>
</pre><p>This system variable's session value can be changed dynamically with <a href="/kb/en/set/#global-session">SET SESSION</a>. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_file_per_table</span><span class="o">=</span><span class="k">ON</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_file_format</span><span class="o">=</span><span class="s1">&#39;Barracuda&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_default_row_format</span><span class="o">=</span><span class="s1">&#39;dynamic&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_algorithm</span><span class="o">=</span><span class="s1">&#39;lzma&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">SESSION</span>  <span class="n">innodb_compression_default</span><span class="o">=</span><span class="k">ON</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">users</span> <span class="p">(</span>
   <span class="n">user_id</span> <span class="nb">int</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span> 
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> 
   <span class="k">primary</span> <span class="k">key</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
<span class="p">)</span> 
   <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span><span class="p">;</span>
</pre><p>This system variable can also be set in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up the server. For example:</p>
<pre class="fixed">[mariadb]
...
innodb_compression_default=ON
</pre><h3 class="anchored_heading" id="enabling-innodb-page-compression-for-individual-tables">Enabling InnoDB Page Compression for Individual Tables</h3>
<p>InnoDB page compression can be enabled for individual tables by setting the <a href="/kb/en/create-table/#page_compressed">PAGE_COMPRESSED</a> table option to <code>1</code>. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_file_per_table</span><span class="o">=</span><span class="k">ON</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_file_format</span><span class="o">=</span><span class="s1">&#39;Barracuda&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_default_row_format</span><span class="o">=</span><span class="s1">&#39;dynamic&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_algorithm</span><span class="o">=</span><span class="s1">&#39;lzma&#39;</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">users</span> <span class="p">(</span>
   <span class="n">user_id</span> <span class="nb">int</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span> 
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> 
   <span class="k">primary</span> <span class="k">key</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
<span class="p">)</span> 
   <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span>
   <span class="n">PAGE_COMPRESSED</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</pre><h2 class="anchored_heading" id="configuring-the-compression-level">Configuring the Compression Level</h2>
<p>Some InnoDB page compression algorithms support a compression level option, which configures how the InnoDB page compression algorithm will balance speed and compression.</p>
<p>The compression level's supported values range from <code>1</code> to <code>9</code>. The range goes from the fastest to the most compact, which means that <code>1</code> is the fastest and <code>9</code> is the most compact.</p>
<p>Only the following InnoDB page compression algorithms currently support compression levels:</p>
<ul start="1"><li><a href="https://www.zlib.net/">zlib</a>
</li><li><a href="http://tukaani.org/xz/">lzma</a> 
</li></ul>
<p>If an InnoDB page compression algorithm does not support compression levels, then it ignores any provided compression level value.</p>
<h3 class="anchored_heading" id="configuring-the-default-compression-level">Configuring the Default Compression Level</h3>
<p>The default compression level can be configured by setting the
<a href="/kb/en/innodb-system-variables/#innodb_compression_level">innodb_compression_level</a> system variable.</p>
<p>This system variable's default value is <code>6</code>.</p>
<p>This system variable can be changed dynamically with <a href="/kb/en/set/#global-session">SET GLOBAL</a>. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_level</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span>
</pre><p>This system variable can also be set in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up the server. For example:</p>
<pre class="fixed">[mariadb]
...
innodb_compression_level=9
</pre><h3 class="anchored_heading" id="configuring-the-compression-level-for-individual-tables">Configuring the Compression Level for Individual Tables</h3>
<p>The compression level for individual tables can also be configured by setting the <a href="/kb/en/create-table/#page_compression_level">PAGE_COMPRESSION_LEVEL</a> table option for the table. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_file_per_table</span><span class="o">=</span><span class="k">ON</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_file_format</span><span class="o">=</span><span class="s1">&#39;Barracuda&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_default_row_format</span><span class="o">=</span><span class="s1">&#39;dynamic&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_algorithm</span><span class="o">=</span><span class="s1">&#39;lzma&#39;</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">users</span> <span class="p">(</span>
   <span class="n">user_id</span> <span class="nb">int</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span> 
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> 
   <span class="k">primary</span> <span class="k">key</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
<span class="p">)</span> 
   <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span>
   <span class="n">PAGE_COMPRESSED</span><span class="o">=</span><span class="mi">1</span>
   <span class="n">PAGE_COMPRESSION_LEVEL</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span>
</pre><h2 class="anchored_heading" id="configuring-the-failure-threshold-and-maximum-padding">Configuring the Failure Threshold and Maximum Padding</h2>
<p>InnoDB page compression can encounter compression failures.</p>
<p>InnoDB page compression's failure threshold can be configured. If InnoDB encounters more compression failures than the failure threshold, then it pads pages with zeroed out bytes before attempting to compress them as a way to reduce failures. If the failure rate stays above the failure threshold, then InnoDB pads pages with more zeroed out bytes in 128 byte increments.  </p>
<p>InnoDB page compression's maximum padding can also be configured.</p>
<h3 class="anchored_heading" id="configuring-the-failure-threshold">Configuring the Failure Threshold</h3>
<p>The failure threshold can be configured by setting the <a href="/kb/en/innodb-system-variables/#innodb_compression_failure_threshold_pct">innodb_compression_failure_threshold_pct</a> system variable.</p>
<p>This system variable's supported values range from <code>0</code> to <code>100</code>.</p>
<p>This system variable's default value is <code>5</code>.</p>
<p>This system variable can be changed dynamically with <a href="/kb/en/set/#global-session">SET GLOBAL</a>. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_failure_threshold_pct</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
</pre><p>This system variable can also be set in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up the server. For example:</p>
<pre class="fixed">[mariadb]
...
innodb_compression_failure_threshold_pct=10
</pre><h3 class="anchored_heading" id="configuring-the-maximum-padding">Configuring the Maximum Padding</h3>
<p>The maximum padding can be configured by setting the <a href="/kb/en/innodb-system-variables/#innodb_compression_pad_pct_max">innodb_compression_pad_pct_max</a> system variable.</p>
<p>This system variable's supported values range from <code>0</code> to <code>75</code>.</p>
<p>This system variable's default value is <code>50</code>.</p>
<p>This system variable can be changed dynamically with <a href="/kb/en/set/#global-session">SET GLOBAL</a>. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_pad_pct_max</span><span class="o">=</span><span class="mi">75</span><span class="p">;</span>
</pre><p>This system variable can also be set in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up the server. For example:</p>
<pre class="fixed">[mariadb]
...
innodb_compression_pad_pct_max=75
</pre><h2 class="anchored_heading" id="saving-storage-space-with-sparse-files">Saving Storage Space with Sparse Files</h2>
<p>When InnoDB page compression is used, InnoDB may still write the compressed page to the tablespace file with the original size of the uncompressed page, which would be equivalent to the value of the <a href="/kb/en/innodb-system-variables/#innodb_page_size">innodb_page_size</a> system variable. This is done by design, because when InnoDB's I/O code needs to read the page from disk, it can only read the full page size. However, this is obviously not optimal.</p>
<p>On file systems that support sparse files, this problem is solved by writing the tablespace file as a sparse file using the <em>punch hole</em> technique. With the <em>punch hole</em> technique, InnoDB will only write the actual compressed page size to the tablespace file, aligned to sector size. The rest of the page is trimmed.</p>
<p>This <em>punch hole</em> technique allows InnoDB to read the compressed page from disk as the full page size, even though the compressed page really takes up less space on the file system.</p>
<p>There are some potential disadvantages to using sparse files:</p>
<ul start="1"><li>Some utilities may require special options in order to handle sparse files in an efficient manner.
</li><li>Most existing file systems are slow to <a href="https://linux.die.net/man/2/unlink">unlink()</a> sparse files. As a consequence, if a tablespace file is a sparse file, then dropping the table can be very slow.
</li></ul>
<h3 class="anchored_heading" id="sparse-file-support-on-linux">Sparse File Support on Linux</h3>
<p>On Linux, the following file systems support sparse files:</p>
<ul start="1"><li><code>ext3</code>
</li><li><code>ext4</code>
</li><li><code>xfs</code>
</li><li><code>btrfs</code>
</li><li><code>nvmfs</code>
</li></ul>
<p>On Linux, file systems need to support the <a href="https://linux.die.net/man/2/fallocate">fallocate()</a> system call with the <code>FALLOC_FL_PUNCH_HOLE</code> and <code>FALLOC_FL_KEEP_SIZE</code> flags. For example:</p>
<pre class="fixed">fallocate(file_handle, FALLOC_FL_PUNCH_HOLE | FALLOC_FL_KEEP_SIZE, file_offset, remainder_len);
</pre><p>Some Linux utilities may require special options in order to work with sparse files efficiently. For example:</p>
<ul start="1"><li>The <a href="https://linux.die.net/man/1/ls">ls</a> utility will report the non-sparse size of the tablespace file when executed with default behavior, but <code><a href="https://linux.die.net/man/1/ls">ls -s</a></code> will report the actual amount of storage allocated for the tablespace file.
</li><li>The <a href="https://linux.die.net/man/1/cp">cp</a> utility is pretty good at auto-detecting sparse files, but it also provides the <a href="https://linux.die.net/man/1/cp">cp --sparse=always</a> and <a href="https://linux.die.net/man/1/cp">cp --sparse=never</a> options, if the auto-detection is not desired.
</li><li>The <a href="https://linux.die.net/man/1/tar">tar</a> utility will archive sparse files with their non-sparse size when executed with default behavior, but <a href="https://linux.die.net/man/1/tar">tar --sparse</a> will auto-detect sparse files, and archive them with their sparse size.
</li></ul>
<h3 class="anchored_heading" id="sparse-file-support-on-windows">Sparse File Support on Windows</h3>
<p>On Windows, the following file systems support sparse files:</p>
<ul start="1"><li><code>NTFS</code>
</li></ul>
<p>On Windows, file systems need to support the <a href="https://docs.microsoft.com/en-us/windows/win32/api/ioapiset/nf-ioapiset-deviceiocontrol">DeviceIoControl()</a> function with the <a href="https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-fsctl_set_sparse">FSCTL_SET_SPARSE</a> and <a href="https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-fsctl_set_zero_data">FSCTL_SET_ZERO_DATA</a> control codes. For example:</p>
<pre class="fixed">DeviceIoControl(file_handle, FSCTL_SET_SPARSE, inbuf, inbuf_size, 
   outbuf, outbuf_size,  NULL, &amp;overlapped)
...
DeviceIoControl(file_handle, FSCTL_SET_ZERO_DATA, inbuf, inbuf_size, 
   outbuf, outbuf_size,  NULL, &amp;overlapped)
</pre><h3 class="anchored_heading" id="configuring-innodb-to-use-sparse-files">Configuring InnoDB to use Sparse Files</h3>
<p>In <a href="/kb/en/what-is-mariadb-103/">MariaDB 10.3</a> and later, InnoDB uses the <em>punch hole</em> technique to create sparse files used automatically when the underlying file system supports sparse files.</p>
<p>In <a href="/kb/en/what-is-mariadb-102/">MariaDB 10.2</a> and before, InnoDB can be configured to use the <em>punch hole</em> technique to create sparse files by configuring the <a href="/kb/en/innodb-system-variables/#innodb_use_trim">innodb_use_trim</a> and <a href="/kb/en/innodb-system-variables/#innodb_use_fallocate">innodb_use_fallocate</a> system variables. These system variables can be set in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up the server. For example:</p>
<pre class="fixed">[mariadb]
...
innodb_use_trim=ON
innodb_use_fallocate=ON
</pre><h2 class="anchored_heading" id="optimized-for-flash-storage">Optimized for Flash Storage</h2>
<p>InnoDB page compression was designed to be optimized on solid state drives (SSDs) and other flash storage.</p>
<p>InnoDB page compression was originally developed by collaborating with <a href="http://fusionio.com">Fusion-io</a>. As a consequence, it was originally designed to work best on <a href="/kb/en/fusion-io-introduction/">FusionIO devices</a> using <a href="https://ieeexplore.ieee.org/document/6558434">NVMFS</a>. <a href="http://fusionio.com">Fusion-io</a> has since been acquired by <a href="https://www.westerndigital.com/">Western Digital</a>, and they have decided not to continue supporting <a href="https://ieeexplore.ieee.org/document/6558434">NVMFS</a>.</p>
<p>However, InnoDB page compression is still likely to be most optimized on solid state drives (SSDs) and other flash storage.</p>
<p>InnoDB page compression works without any issues on hard disk drives (HDDs). However, since its compression relies on the use of sparse files, the data may be somewhat fragmented on disk. This fragmentation may hurt performance on HDDs, since they handle random reads and writes much more slowly than flash storage.</p>
<h2 class="anchored_heading" id="configuring-innodb-page-flushing">Configuring InnoDB Page Flushing</h2>
<p>With InnoDB page compression, pages are compressed when they are flushed to disk. Therefore, it can be helpful to optimize the configuration of InnoDB's page flushing. See <a href="/kb/en/innodb-page-flushing/">InnoDB Page Flushing</a> for more information.</p>
<h2 class="anchored_heading" id="monitoring-innodb-page-compression">Monitoring InnoDB Page Compression</h2>
<p>InnoDB page compression can be monitored by querying the following status variables with <a href="/kb/en/show-status/">SHOW GLOBAL STATUS</a>:</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>Status Variable</th><th>Description</th></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_page_compression_saved">Innodb_page_compression_saved</a></td><td>Bytes saved by compression</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_page_compression_trim_sect512">Innodb_page_compression_trim_sect512</a></td><td>Number of 512 sectors trimmed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_page_compression_trim_sect1024">Innodb_page_compression_trim_sect1024</a></td><td>Number of 1024 sectors trimmed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_page_compression_trim_sect2048">Innodb_page_compression_trim_sect2048</a></td><td>Number of 2048 sectors trimmed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_page_compression_trim_sect4096">Innodb_page_compression_trim_sect4096</a></td><td>Number of 4096 sectors trimmed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_page_compression_trim_sect8192">Innodb_page_compression_trim_sect8192</a></td><td>Number of 8192 sectors trimmed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_page_compression_trim_sect16384">Innodb_page_compression_trim_sect16384</a></td><td>Number of 16384 sectors trimmed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_page_compression_trim_sect32768">Innodb_page_compression_trim_sect32768</a></td><td>Number of 32768 sectors trimmed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_num_pages_page_compressed">Innodb_num_pages_page_compressed</a></td><td>Number of pages compressed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_num_page_compressed_trim_op">Innodb_num_page_compressed_trim_op</a></td><td>Number of trim operations</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_num_page_compressed_trim_op_saved">Innodb_num_page_compressed_trim_op_saved</a></td><td>Number of trim operations saved</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_num_pages_page_decompressed">Innodb_num_pages_page_decompressed</a></td><td>Number of pages decompressed</td></tr>
<tr><td><a href="/kb/en/xtradbinnodb-server-status-variables/#innodb_num_pages_page_compression_error">Innodb_num_pages_page_compression_error</a></td><td>Number of compression errors</td></tr>
</table>
</div><p>With InnoDB page compression, a page is only compressed when it is flushed to disk. This means that if you are monitoring InnoDB page compression via these status variables, then the status variables values will only get incremented when the dirty pages are flushed to disk, which does not necessarily happen immediately. For example:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">tab</span><span class="o">`</span> <span class="p">(</span>
     <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
     <span class="o">`</span><span class="n">str</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
     <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
   <span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span><span class="p">;</span>
 
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">tab</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;str1&#39;</span><span class="p">);</span>

<span class="k">SHOW</span> <span class="k">GLOBAL</span> <span class="n">STATUS</span> <span class="k">LIKE</span> <span class="s1">&#39;Innodb_num_pages_page_compressed&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
<span class="o">|</span> <span class="n">Variable_name</span>                    <span class="o">|</span> <span class="n">Value</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
<span class="o">|</span> <span class="n">Innodb_num_pages_page_compressed</span> <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
 
<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_file_per_table</span><span class="o">=</span><span class="k">ON</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_file_format</span><span class="o">=</span><span class="s1">&#39;Barracuda&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_default_row_format</span><span class="o">=</span><span class="s1">&#39;dynamic&#39;</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">innodb_compression_algorithm</span><span class="o">=</span><span class="s1">&#39;lzma&#39;</span><span class="p">;</span>
 
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="n">PAGE_COMPRESSED</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

<span class="k">SHOW</span> <span class="k">GLOBAL</span> <span class="n">STATUS</span> <span class="k">LIKE</span> <span class="s1">&#39;Innodb_num_pages_page_compressed&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
<span class="o">|</span> <span class="n">Variable_name</span>                    <span class="o">|</span> <span class="n">Value</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
<span class="o">|</span> <span class="n">Innodb_num_pages_page_compressed</span> <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
 
<span class="k">SELECT</span> <span class="n">SLEEP</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span> <span class="n">SLEEP</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
<span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+</span>
 
<span class="k">SHOW</span> <span class="k">GLOBAL</span> <span class="n">STATUS</span> <span class="k">LIKE</span> <span class="s1">&#39;Innodb_num_pages_page_compressed&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
<span class="o">|</span> <span class="n">Variable_name</span>                    <span class="o">|</span> <span class="n">Value</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
<span class="o">|</span> <span class="n">Innodb_num_pages_page_compressed</span> <span class="o">|</span> <span class="mi">3</span>     <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------+-------+</span>
</pre><h2 class="anchored_heading" id="compatibility-with-backup-tools">Compatibility with Backup Tools</h2>
<p><a href="/kb/en/mariabackup/">Mariabackup</a> supports InnoDB page compression.</p>
<p><a href="/kb/en/percona-xtrabackup/">Percona XtraBackup</a> does not support InnoDB page compression.</p>
<h2 class="anchored_heading" id="acknowledgements">Acknowledgements</h2>
<ul start="1"><li>InnoDB page compression was developed by collaborating with <a href="http://fusionio.com">Fusion-io</a>. Special thanks especially to Dhananjoy Das and Torben Mathiasen.
</li></ul>
<h2 class="anchored_heading" id="see-also">See Also</h2>
<ul start="1"><li><a href="/kb/en/storage-engine-independent-column-compression/">Storage-Engine Independent Column Compression</a>
</li><li><a href="/kb/en/atomic-write-support/">Atomic Write Support</a>
</li><li><a href="https://blog.mariadb.org/mariadb-introduces-atomic-writes/">MariaDB Introduces Atomic Writes</a>
</li><li><a href="http://smalldatum.blogspot.com/2015/09/third-day-with-innodb-transparent-page.html">Small Datum: Third day with InnoDB transparent page compression</a>
</li><li><a href="https://blog.mariadb.org/innodb-holepunch-compression-vs-the-filesystem-in-mariadb-10-1/">InnoDB holepunch compression vs the filesystem in MariaDB 10.1</a>
</li><li><a href="https://blog.mariadb.org/significant-performance-boost-with-new-mariadb-page-compression-on-fusionio/">Significant performance boost with new MariaDB page compression on FusionIO</a>
</li><li><a href="https://www.usenix.org/conference/inflow14/workshop-program/presentation/das">INFLOW '14: NVM Compression—Hybrid Flash-Aware Application Level Compression</a></li></ul>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/innodb-page-compression/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/innodb-page-compression/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/binary-log-group-commit-and-innodb-flushing-performance/">
                        ← Binary Log Group Commit and InnoDB Flushing Performance
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/innodb-and-xtradb/">
                        ↑ InnoDB ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/innodb-data-scrubbing/">
                        InnoDB Data Scrubbing →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="4877" data-comments-url="/kb/en/innodb-page-compression/+comments"
         data-reply-url="/kb/en/innodb-page-compression/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/innodb-and-xtradb/">
                    ↑ InnoDB ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/innodb-versions/">
                            
                            InnoDB Versions
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-limitations/">
                            
                            InnoDB Limitations
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-troubleshooting/">
                            
                            InnoDB Troubleshooting
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-system-variables/">
                            
                            InnoDB System Variables
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-status-variables/">
                            <span class="pull-right not_primary"></span>
                            InnoDB Server Status Variables
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/auto_increment-handling-in-innodb/">
                            
                            AUTO_INCREMENT Handling in InnoDB
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-buffer-pool/">
                            
                            InnoDB Buffer Pool
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-change-buffering/">
                            
                            InnoDB Change Buffering
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-doublewrite-buffer/">
                            
                            InnoDB Doublewrite Buffer
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-tablespaces/">
                            
                            InnoDB Tablespaces
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-file-format/">
                            
                            InnoDB File Format
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-row-formats/">
                            
                            InnoDB Row Formats
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-strict-mode/">
                            
                            InnoDB Strict Mode
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-redo-log/">
                            
                            InnoDB Redo Log
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-undo-log/">
                            
                            InnoDB Undo Log
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-page-flushing/">
                            
                            InnoDB Page Flushing
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-purge/">
                            
                            InnoDB Purge
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/information-schema-innodb-tables/">
                            <span class="pull-right not_primary"></span>
                            Information Schema InnoDB Tables
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-online-ddl/">
                            
                            InnoDB Online DDL
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/binary-log-group-commit-and-innodb-flushing-performance/">
                            
                            Binary Log Group Commit and InnoDB Flushing Performance
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>InnoDB Page Compression</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-data-scrubbing/">
                            
                            InnoDB Data Scrubbing
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-lock-modes/">
                            
                            InnoDB Lock Modes
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-monitors/">
                            
                            InnoDB Monitors
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-encryption-overview/">
                            <span class="pull-right not_primary"></span>
                            InnoDB Encryption Overview
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-unmaintained/">
                            
                            InnoDB - Unmaintained
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>