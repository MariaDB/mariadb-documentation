



<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>
Comments - Data-at-Rest Encryption Overview
 - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    
        <meta name="robots" content="noindex, nofollow" />
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="
Comments - Data-at-Rest Encryption Overview
" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/data-at-rest-encryption-overview/+comments" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes node_comments jqui" id="node_comments">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/data-at-rest-encryption-overview/+comments"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/data-at-rest-encryption-overview/+comments" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/user-server-security/">User &amp; Server Security</a>
    

    
    » <a class="crumb" href="/kb/en/securing-mariadb/">Securing MariaDB</a>
    

    
    » <a class="crumb" href="/kb/en/securing-mariadb-encryption/">Encryption</a>
    

    
    » <a class="crumb" href="/kb/en/encryption-data-at-rest-encryption/">Data-at-Rest Encryption</a>
    


    » <a class="node_link crumb" href="/kb/en/data-at-rest-encryption-overview/">Data-at-Rest Encryption Overview</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
            
            
            
            <section id="content" class="limited_width col-md-12 clearfix">
                
                    <h1>
Comments - Data-at-Rest Encryption Overview
</h1>
                

                



                <div>
                    
<div id="comments" data-node-id="4805" data-comments-url="/kb/en/data-at-rest-encryption-overview/+comments"
        data-reply-url="/kb/en/data-at-rest-encryption-overview/comments/post/">
<div class="comment_top_menu hidden-print">&nbsp;
            <div class="pull-right">
                <label>
                    Include Archived
                    <input id="include_archived" type="checkbox" name="include_archived" value="1"
                           />
                </label>
            </div>
        </div>
        <a name="comment_5047"></a>
        <div class="comment approved" style="margin-left: 0px">
            <div class="info">
                

<span class="datetime" title="2021-02-10 18:26">3 years, 8 months ago</span>
                
<span class="user" id="user-10184">
<a href="/kb/user/id/10184" title="Sebastian Sajaroff">Sebastian Sajaroff</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_5047">Re: Data-at-Rest Encryption Overview</a>
                
            </div><div class="comment_text">
                <p>Hello to everyone,</p>
<p>Would you know, please, if we TDE is available on MariaDB Community Edition (latest release). Thanks a lot !</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/5047/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/5047/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    
        <a name="comment_3300"></a>
        <div class="comment approved" style="margin-left: 0px">
            <div class="info">
                

<span class="datetime" title="2018-03-26 12:42">6 years, 6 months ago</span>
                
<span class="user" id="user-3779">
<a href="/kb/user/id/3779" title="Nick Bolton">Nick Bolton</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_3300">Re: Data at Rest Encryption</a>
                
            </div><div class="comment_text">
                <p>Could this page be updated to include the detail on the equivalent korean page?    <a href="https://mariadb.com/kb/ko/data-at-rest-encryption/">https://mariadb.com/kb/ko/data-at-rest-encryption/</a></p>
<p>There is a lot more detail on there about settings around encryption that is not on the English version; which look like the very things I am after - BUT I can't read them.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/3300/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/3300/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_3301"></a>
        <div class="comment approved" style="margin-left: 10px">
            <div class="info">
                

<span class="datetime" title="2018-03-26 16:13">6 years, 6 months ago</span>
                
<span class="user" id="user-5454">
<a href="/kb/user/id/5454" title="Kenneth Dyer">Kenneth Dyer</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_3301">Re: Data at Rest Encryption</a>
                
            </div><div class="comment_text">
                <p>The Korean page is behind.  The content you're looking for was moved to <a href="/kb/en/encryption-key-management/">Encryption Key Management</a>, <a href="/kb/en/encrypting-data-for-innodb-xtradb/">Encrypting Data for InnoDB/XtraDB</a>, and <a href="/kb/en/encrypting-data-for-aria/">Encrypting Data for Aria</a> to allow for more detailed explanations without crowding the overview.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/3301/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/3301/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    

    
        <a name="comment_2749"></a>
        <div class="comment approved" style="margin-left: 0px">
            <div class="info">
                

<span class="datetime" title="2017-02-08 22:10">7 years, 8 months ago</span>
                
<span class="user" id="user-2571">
<a href="/kb/user/id/2571" title="Chris Calender">Chris Calender</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2749">Detecting Encrypted Tables</a>
                
            </div><div class="comment_text">
                <p>You cannot always tell which tables are encrypted or not via SHOW CREATE TABLE, but you can with (ENCRYPTION_SCHEME=1 for encrypted tables, 0 for non-encrypted tables):&lt;br&gt;</p>
<p><code class="fixed" style="white-space:pre-wrap">SELECT * FROM INFORMATION_SCHEMA.INNODB_TABLESPACES_ENCRYPTION;</code></p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2749/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2749/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    
        <a name="comment_2546"></a>
        <div class="comment approved" style="margin-left: 0px">
            <div class="info">
                

<span class="datetime" title="2016-10-17 16:55">7 years, 12 months ago</span>
                
<span class="user" id="user-4681">
<a href="/kb/user/id/4681" title="Johan Eriksson">Johan Eriksson</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2546">Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>Having support for data-at-rest encryption is awesome, but I have to admit I'm a bit puzzled on how to get a viable backup-strategy with encryption in place as xtrabackup wont work with it enabled.</p>
<p>Can someone advice on a good way to implement hot backups with encryption enabled ?</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2546/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2546/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2547"></a>
        <div class="comment approved" style="margin-left: 10px">
            <div class="info">
                

<span class="datetime" title="2016-10-17 17:33">7 years, 12 months ago</span>
                
<span class="user" id="user-1">
<a href="/kb/user/id/1" title="Bryan Alsdorf">Bryan Alsdorf</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2547">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>We use LVM snapshots for our servers here at MariaDB.</p>
<p><a href="https://mariadb.com/kb/en/mariadb-enterprise/mariadb-enterprise-backup-guide/#lvm-logical-volume-management">https://mariadb.com/kb/en/mariadb-enterprise/mariadb-enterprise-backup-guide/#lvm-logical-volume-management</a></p>
<p>The other common option would be replicating to a backup server and where you could perform blocking backups.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2547/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2547/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2601"></a>
        <div class="comment approved" style="margin-left: 20px">
            <div class="info">
                

<span class="datetime" title="2016-11-10 16:57">7 years, 11 months ago</span>
                
<span class="user" id="user-4758">
<a href="/kb/user/id/4758" title="Vlad Tokarskiy">Vlad Tokarskiy</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2601">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>Using LVM snapshots leaves the data encrypted which is a good thing. However, what happens if the key(either local or AWS) gets rotated? </p>
<p>How do you restore data on servers not connected to AWS?</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2601/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2601/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2603"></a>
        <div class="comment approved" style="margin-left: 30px">
            <div class="info">
                

<span class="datetime" title="2016-11-10 17:22">7 years, 11 months ago</span>
                
<span class="user" id="user-3528">
<a href="/kb/user/id/3528" title="Vladislav Vaintroub">Vladislav Vaintroub</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2603">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>This is the question about AWS Key Management plugin, I assume?</p>
<p>If AWS rotates its master key, it does not remove the old one. That means it is still able to decrypt old keys stored in the datadir.</p>
<p>Same is true about local keys. Rotation does not remove the old keys, they are kept in the datadir. They can be deleted when they are not used. But we don't do this.  Keys are not used, after Innodb keys rotation completes, and, in case you encrypt binlogs, after binlogs using that key are removed.</p>
<p>There is no automatic way to restore data on servers not connected to AWS.</p>
<p> If you want to do this, you need to do what server does, namely decrypt keys to get plaintext, and for that </p>
<p>a) decrypt the aws-kms.x.y files inside the datadir yourself. You can do it with AWS KMS API called Decrypt, or even using aws-cli for example. You need the plaintext keys for every file</p>
<p>b) write your own aws_key_management plugin that would work with plaintext instead of sending files to AWS</p>
<p>Maybe, you can reuse file_key_management given plaintext keys, if you're not using rotation, but I have not checked that myself.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2603/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2603/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    
        <a name="comment_2602"></a>
        <div class="comment approved" style="margin-left: 30px">
            <div class="info">
                

<span class="datetime" title="2016-11-10 17:09">7 years, 11 months ago</span>
                
<span class="user" id="user-2087">
<a href="/kb/user/id/2087" title="Kolbe Kegel">Kolbe Kegel</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2602">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>The LVM snapshot should be of the entire directory, which will include the encrypted data keys stored locally, so local key rotation is not a concern when restoring from a snapshot. You will still need access to the Customer Master Key in AWS in order to decrypt those data keys. Key Rotation in AWS KMS "currently retains all prior backing keys so that decryption of encrypted data can take place transparently" (see <a href="http://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html">http://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html</a>), so rotating your CMK is not a concern when restoring from a snapshot. If you *delete* your CMK, you will be unable to decrypt the data keys (and thus unable to decrypt your data). Your MariaDB instance must be able to connect to AWS KMS in order to decrypt the data; there is no way to decrypt the encrypted data keys without access to the correct CMK in AWS KMS.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2602/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2602/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2604"></a>
        <div class="comment approved" style="margin-left: 40px">
            <div class="info">
                

<span class="datetime" title="2016-11-11 00:44">7 years, 11 months ago</span>
                
<span class="user" id="user-4758">
<a href="/kb/user/id/4758" title="Vlad Tokarskiy">Vlad Tokarskiy</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2604">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>Is recommended way to rotate keys using plugin aws_key_management_rotate_key option and configure appropriate permissions in AWS or setup AWS IAM to rotate the key. In galera cluster would it be better to use AWS IAM to rotate instead of individual servers rotating.</p>
<p>Also, once the key is rotated, will "create table" pick up current key or it must be specified?</p>
<p>Thank you for your feedback</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2604/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2604/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2606"></a>
        <div class="comment approved" style="margin-left: 50px">
            <div class="info">
                

<span class="datetime" title="2016-11-11 09:21">7 years, 11 months ago</span>
                
<span class="user" id="user-3528">
<a href="/kb/user/id/3528" title="Vladislav Vaintroub">Vladislav Vaintroub</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2606">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>Just enabling annual rotation on AWS does not have any effect until the local keys are rotated.</p>
<p>One approach would be to  enable rotation of the key in AWS, and use aws_key_management_rotate_key once a year (so that you're sure that master key has rotated) </p>
<p>Another approach would be to use a  different master_key_id for new version 
- create several master keys in AWS IAM, and change aws_key_management_master_key_id  prior to rotating keys with  aws_key_management_rotate_key</p>
<p>I'm not sure how all this relates to galera.  Whenever new key or  key version is created (implicitly, with CREATE/ALTER table if you specify encryption id), or via rotate_key, the new "data" key is created is stored locally in aws-kms-key.x.y . Those keys are not exchanged between servers via replication or galera. </p>
<p>CREATE TABLE always picks up the latest version of the key. </p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2606/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2606/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2607"></a>
        <div class="comment approved" style="margin-left: 60px">
            <div class="info">
                

<span class="datetime" title="2016-11-11 21:46">7 years, 11 months ago</span>
                
<span class="user" id="user-4758">
<a href="/kb/user/id/4758" title="Vlad Tokarskiy">Vlad Tokarskiy</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2607">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>If I understand correctly, the plugin will start rotate keys process and use newly specified master key to create new local key to encrypt. However, since it's pointing to different master key, how does it decrypt previous local key so that tables can be decrypted prior to rotation. If they don't need to be decrypted, how are they decrypted in during database operation since previous local key can not be decrypted with previous master key id.</p>
<p>Does the aws-kms-key contain master key id?</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2607/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2607/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2610"></a>
        <div class="comment approved" style="margin-left: 70px">
            <div class="info">
                

<span class="datetime" title="2016-11-11 23:46">7 years, 11 months ago</span>
                
<span class="user" id="user-3528">
<a href="/kb/user/id/3528" title="Vladislav Vaintroub">Vladislav Vaintroub</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2610">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <div style="margin-left:2em"><p>Does the aws-kms-key contain master key id?</p>
</div>
<p>We don't record it ourselves, the contents of the file is just cipherblob from GenerateDataKey() response. 
But AWS knows which keys was used. The question "how does it know" interesting, I'll check the KMS documentation. </p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2610/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2610/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2611"></a>
        <div class="comment approved" style="margin-left: 80px">
            <div class="info">
                

<span class="datetime" title="2016-11-12 00:03">7 years, 11 months ago</span>
                
<span class="user" id="user-3528">
<a href="/kb/user/id/3528" title="Vladislav Vaintroub">Vladislav Vaintroub</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2611">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>Ok,  found  a (slightly cryptic) explanation here, on slide 18, under 4.</p>
<p><a href="http://www.slideshare.net/AmazonWebServices/encryption-and-key-management-in-aws">http://www.slideshare.net/AmazonWebServices/encryption-and-key-management-in-aws</a></p>
<p>The cipherblob we get with GenerateDataKey and store on disk, actually contains encrypted master key id + datakey.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2611/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2611/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    

    
        <a name="comment_2609"></a>
        <div class="comment approved" style="margin-left: 70px">
            <div class="info">
                

<span class="datetime" title="2016-11-11 22:08">7 years, 11 months ago</span>
                
<span class="user" id="user-3528">
<a href="/kb/user/id/3528" title="Vladislav Vaintroub">Vladislav Vaintroub</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2609">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>AWS KMS does not need or accept master key id for Decrypt, it only needs it for GenerateDataKey/Encrypt.
<a href="http://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html">http://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html</a></p>
<p>As you can see, Decrypt actually *returns* the master-key-id that was used for GenerateDataKey  its response (how does it know it, I have no idea, never checked), in addition to Plaintext that we use.</p>
<p>Thus:
- rotate does KMS-GenerateDataKey., It *needs* master key id.  ditto CREATE/ALTER TABLE with new key ids, or
- decrypt(at the startup time) does KMS-Decrypt(). It *does  not need* master-key-id.  It can decrypt multiple local keys, backed by different CMK, or by single CMK that was transparently rotated by AWS.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2609/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2609/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    
        <a name="comment_2608"></a>
        <div class="comment approved" style="margin-left: 70px">
            <div class="info">
                

<span class="datetime" title="2016-11-11 22:00">7 years, 11 months ago</span>
                
<span class="user" id="user-2087">
<a href="/kb/user/id/2087" title="Kolbe Kegel">Kolbe Kegel</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2608">Re: Backups with Data at Rest Encryption </a>
                
            </div><div class="comment_text">
                <p>When a key is rotated in AWS KMS, it keeps the same key alias and earlier versions of the key are still available for decryption. Take a look at <a href="http://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html">http://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html</a> for more information. Local key rotation, done by MariaDB Server, causes the new version of the key to be written to a file in your datadir. Old versions of the key are kept as well, since they'll be needed to decrypt tables/pages/logs encrypted using earlier versions of the key. When you're certain that an older version of a key is no longer needed, you can delete the corresponding file from the datadir.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2608/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2608/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    

    

    

    

    

    

    

    
        <a name="comment_2346"></a>
        <div class="comment approved" style="margin-left: 0px">
            <div class="info">
                

<span class="datetime" title="2016-07-13 13:50">8 years, 3 months ago</span>
                
<span class="user" id="user-1612">
<a href="/kb/user/id/1612" title="Honza Horak">Honza Horak</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2346">Re: Data at Rest Encryption</a>
                
            </div><div class="comment_text">
                <p>I'm a bit puzzled here -- there is said that 128, 192 or 256-bit keys are supported, but later AES_CTR and AES_CBC modes talk only about 128bit keys. What piece of information am I missing?</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2346/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2346/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2347"></a>
        <div class="comment approved" style="margin-left: 10px">
            <div class="info">
                

<span class="datetime" title="2016-07-15 09:19">8 years, 3 months ago</span>
                
<span class="user" id="user-27">
<a href="/kb/user/id/27" title="Sergei Golubchik">Sergei Golubchik</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2347">Re: Data at Rest Encryption</a>
                
            </div><div class="comment_text">
                <p>The exact wording is "the plugin will use AES with the 128-bit keys in the CTR mode for encrypting tablespace pages". Because tablespace pages are always encrypted with a 128-bit tablespace key. Which is different for every tablespace and it is generated from the user-specified key, which might be 128-, 192-, or 256-bit.</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2347/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2347/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    

    
        <a name="comment_2259"></a>
        <div class="comment approved" style="margin-left: 0px">
            <div class="info">
                

<span class="datetime" title="2016-05-17 00:26">8 years, 5 months ago</span>
                
<span class="user" id="user-3344">
<a href="/kb/user/id/3344" title="Dba Btissam">Dba Btissam</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2259">Re: Data at Rest Encryption</a>
                
            </div><div class="comment_text">
                <p>Using the parameter innodb-encryption-rotate-key-age ,  in "Re-encrypt in background all pages that were encrypted with a key at least that many versions old" what do you mean by "page"?</p>
<p>Thanks</p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2259/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2259/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <a name="comment_2260"></a>
        <div class="comment approved" style="margin-left: 10px">
            <div class="info">
                

<span class="datetime" title="2016-05-17 10:32">8 years, 5 months ago</span>
                
<span class="user" id="user-1368">
<a href="/kb/user/id/1368" title="Ian Gilfillan">Ian Gilfillan</a>
</span>
            </div>
            <div class="title">
                <a href="#comment_2260">Re: Data at Rest Encryption</a>
                
            </div><div class="comment_text">
                <p>A page is a fixed-size unit (see the <a href="https://dev.mysql.com/doc/internals/en/innodb-page-structure.html">MySQL docs</a> for a detailed overview), usually 16KB, but can be changed by adjusting <a href="/kb/en/xtradbinnodb-server-system-variables/#innodb_page_size">innodb_page_size</a></p>

            </div>
            <div class="comment_actions hidden-print">
                
                
                &nbsp;

                <div class="pull-right">
                    
                    <a class="flag btn btn-mini" href="/kb/en/data-at-rest-encryption-overview/+comments/2260/flag"
                       data-flag-url="/kb/en/data-at-rest-encryption-overview/+comments/2260/flag"
                            title="Flag as Spam/Inappropriate">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        </a>
                    
                    
                    
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        
    

    

    

</div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>