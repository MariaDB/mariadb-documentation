<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Foreign Keys - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Foreign Keys" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/foreign-keys/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Foreign keys can be used to enforce data integrity." />

    <meta name="description" content="Foreign keys can be used to enforce data integrity." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/foreign-keys/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/foreign-keys/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/replication-cluster-multi-master/">High Availability &amp; Performance Tuning</a>
    

    
    » <a class="crumb" href="/kb/en/optimization-and-tuning/">Optimization and Tuning</a>
    

    
    » <a class="crumb" href="/kb/en/optimization-and-indexes/">Optimization and Indexes</a>
    


    » <a class="node_link crumb" href="/kb/en/foreign-keys/">Foreign Keys</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/foreign-keys/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/foreign-keys/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/foreign-keys/+flag"
                data-flag-url="/kb/en/foreign-keys/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/foreign-keys/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2014-02-09 14:53">10 years, 7 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2024-07-17 13:32">2 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/foreign-keys/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/foreign-keys/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/foreign-keys/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/foreign-keys/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    
        

<div class="well well-small box"><div><h5>Localized Versions</h5></div><div>

        <ul>
            
            <li><a href="/kb/it/chiavi-esterne/">Chiavi esterne</a> [it]</li>
            
            <li><a href="/kb/ko/foreign-keys/">외래키 (Foreign Keys)</a> [ko]</li>
            
        </ul>
        
</div>
</div>

    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Foreign Keys</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#overview" title="Overview">Overview</a></li>

    <li class=""><a href="#syntax" title="Syntax">Syntax</a></li>

    <li class=""><a href="#constraints" title="Constraints">Constraints</a></li>

    <li class=""><a href="#metadata" title="Metadata">Metadata</a></li>

    <li class=""><a href="#limitations" title="Limitations">Limitations</a></li>

    <li class=""><a href="#examples" title="Examples">Examples</a>    <ol class="toc">

        <li class=""><a href="#references" title="REFERENCES">REFERENCES</a>    </ol>
</li>

    <li class=""><a href="#see-also" title="See Also">See Also</a> </ol>
</li>
</div>
<h2 class="anchored_heading" id="overview">Overview</h2>
<p>A foreign key is a constraint which can be used to enforce data integrity. It is composed by a column (or a set of columns) in a table called the child table, which references to a column (or a set of columns) in a table called the parent table. If foreign keys are used, MariaDB performs some checks to enforce that some integrity rules are always enforced. For a more exhaustive explanation, see <a href="/kb/en/relational-databases-foreign-keys/">Relational databases: Foreign Keys</a>.</p>
<p>Foreign keys can only be used with storage engines that support them. The default <a href="/kb/en/innodb/">InnoDB</a> and the obsolete <a href="/kb/en/pbxt/">PBXT</a> support foreign keys.</p>
<p><a href="/kb/en/managing-mariadb-partitioning/">Partitioned tables</a> cannot contain foreign keys, and cannot be referenced by a foreign key.</p>
<h2 class="anchored_heading" id="syntax">Syntax</h2>
<div class="cstm-style greenbox"><p><strong>Note:</strong> Until <a href="/kb/en/what-is-mariadb-104/">MariaDB 10.4</a>, MariaDB accepts the shortcut format with a REFERENCES clause only in ALTER TABLE and CREATE TABLE statements, but that syntax does nothing. For example:</p>
<pre class="fixed">CREATE TABLE b(for_key INT REFERENCES a(not_key));
</pre><p>MariaDB simply parses it without returning any error or warning, for compatibility with other DBMS's. However, only the syntax described below creates foreign keys.</p>
<p>From <a href="/kb/en/what-is-mariadb-105/">MariaDB 10.5</a>, MariaDB will attempt to apply the constraint. See the <a href="#references">Examples</a> below.</p>
</div><p>Foreign keys are created with <a href="/kb/en/create-table/">CREATE TABLE</a> or <a href="/kb/en/alter-table/">ALTER TABLE</a>. The definition must follow this syntax:</p>
<pre class="fixed">[CONSTRAINT [symbol]] FOREIGN KEY
    [index_name] (index_col_name, ...)
    REFERENCES tbl_name (index_col_name,...)
    [ON DELETE reference_option]
    [ON UPDATE reference_option]

reference_option:
    RESTRICT | CASCADE | SET NULL | NO ACTION | SET DEFAULT
</pre><p>The <code>symbol</code> clause, if specified, is used in error messages and must be unique in the database.</p>
<p>The columns in the child table must be a BTREE (not HASH, RTREE, or FULLTEXT — see <a href="/kb/en/show-index/">SHOW INDEX</a>) index, or the leftmost part of a BTREE index. Index prefixes are not supported (thus, <a href="/kb/en/text/">TEXT</a> and <a href="/kb/en/blob/">BLOB</a> columns cannot be used as foreign keys). If MariaDB automatically creates an index for the foreign key (because it does not exist and is not explicitly created), its name will be <code>index_name</code>.</p>
<p>The referenced columns in the parent table must be a an index or a prefix of an index.</p>
<p>The foreign key columns and the referenced columns must be of the same type, or similar types. For integer types, the size and sign must also be the same.</p>
<p>Both the foreign key columns and the referenced columns can be <a href="/kb/en/virtual-columns/">PERSISTENT</a> columns. However, the ON UPDATE CASCADE, ON UPDATE SET NULL, ON DELETE SET NULL clauses are not allowed in this case.</p>
<p>The parent and the child table must use the same storage engine, and must not be <code>TEMPORARY</code> or partitioned tables. They can be the same table.</p>
<h2 class="anchored_heading" id="constraints">Constraints</h2>
<p>If a foreign keys exists, each row in the child table must match a row in the parent table. Multiple child rows can match the same parent row. A child row <em>matches</em> a parent row if all its foreign key values are identical to a parent row's values in the parent table. However, if at least one of the foreign key values is <code>NULL</code>, the row has no parents, but it is still allowed.</p>
<p>MariaDB performs certain checks to guarantee that the data integrity is enforced:</p>
<ul start="1"><li>Trying to insert non-matching rows (or update matching rows in a way that makes them non-matching rows) in the child table produces a 1452 error (<a href="/kb/en/sqlstate/">SQLSTATE</a> '23000').
</li><li>When a row in the parent table is deleted and at least one child row exists, MariaDB performs an action which depends on the <code>ON DELETE</code> clause of the foreign key.
</li><li>When a value in the column referenced by a foreign key changes and at least one child row exists, MariaDB performs an action which depends on the <code>ON UPDATE</code> clause of the foreign key.
</li><li>Trying to drop a table that is referenced by a foreign key produces a 1217 error (<a href="/kb/en/sqlstate/">SQLSTATE</a> '23000').
</li><li>A <a href="/kb/en/truncate-table/">TRUNCATE TABLE</a> against a table containing one or more foreign keys is executed as a <a href="/kb/en/delete/">DELETE</a> without WHERE, so that the foreign keys are enforced for each row.
</li></ul>
<p>The allowed actions for <code>ON DELETE</code> and <code>ON UPDATE</code> are:</p>
<ul start="1"><li><code>RESTRICT</code>: The change on the parent table is prevented. The statement terminates with a 1451 error (<a href="/kb/en/sqlstate/">SQLSTATE</a> '2300'). This is the default behavior for both <code>ON DELETE</code> and <code>ON UPDATE</code>.
</li><li><code>NO ACTION</code>: Synonym for <code>RESTRICT</code>.
</li><li><code>CASCADE</code>: The change is allowed and propagates on the child table. For example, if a parent row is deleted, the child row is also deleted; if a parent row's ID changes, the child row's ID will also change.
</li><li><code>SET NULL</code>: The change is allowed, and the child row's foreign key columns are set to <code>NULL</code>.
</li><li><code>SET DEFAULT</code>: Only worked with PBXT. Similar to <code>SET NULL</code>, but the foreign key columns were set to their default values. If default values do not exist, an error is produced.
</li></ul>
<p>The delete or update operations triggered by foreign keys do not activate <a href="/kb/en/triggers/">triggers</a> and are not counted in the <a href="/kb/en/server-status-variables/#com_delete">Com_delete</a> and <a href="/kb/en/server-status-variables/#com_update">Com_update</a> status variables.</p>
<p>Foreign key constraints can be disabled by setting the <a href="/kb/en/server-system-variables/#foreign_key_checks">foreign_key_checks</a> server system variable to 0. This speeds up the insertion of large quantities of data.</p>
<h2 class="anchored_heading" id="metadata">Metadata</h2>
<p>The <a href="/kb/en/information_schema/">Information Schema</a> <code><a href="/kb/en/information-schema-referential_constraints-table/">REFERENTIAL_CONSTRAINTS</a></code> table contains information about foreign keys. The individual columns are listed in the <code><a href="/kb/en/information-schema-key_column_usage-table/">KEY_COLUMN_USAGE</a></code> table.</p>
<p>The InnoDB-specific Information Schema tables also contain information about the InnoDB foreign keys. The foreign key information is stored in the <code><a href="/kb/en/information-schema-innodb_sys_foreign-table/">INNODB_SYS_FOREIGN</a></code>. Data about the individual columns are stored in <code><a href="/kb/en/information-schema-innodb_sys_foreign_cols-table/">INNODB_SYS_FOREIGN_COLS</a></code>.</p>
<p>The most human-readable way to get information about a table's foreign keys sometimes is the <code><a href="/kb/en/show-create-table/">SHOW CREATE TABLE</a></code> statement.</p>
<h2 class="anchored_heading" id="limitations">Limitations</h2>
<p>Foreign keys have the following limitations in MariaDB:</p>
<ul start="1"><li>Currently, foreign keys are only supported by InnoDB.
</li><li>Cannot be used with views.
</li><li>The <code>SET DEFAULT</code> action is not supported.
</li><li>Foreign keys actions do not activate <a href="/kb/en/triggers/">triggers</a>.
</li><li>If ON UPDATE CASCADE recurses to update the same table it has previously updated during the cascade, it acts like RESTRICT. 
</li><li>Indexed <a href="/kb/en/generated-columns/">generated columns</a> (both VIRTUAL and PERSISTENT) are not supported as InnoDB foreign key indexes.
</li></ul>
<h2 class="anchored_heading" id="examples">Examples</h2>
<p>Let's see an example. We will create an <code>author</code> table and a <code>book</code> table. Both tables have a primary key called <code>id</code>. <code>book</code> also has a foreign key composed by a field called <code>author_id</code>, which refers to the <code>author</code> primary key. The foreign key constraint name is optional, but we'll specify it because we want it to appear in error messages: <code>fk_book_author</code>.</p>
<pre class="fixed">CREATE TABLE author (
  id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) NOT NULL
) ENGINE = InnoDB;

CREATE TABLE book (
  id MEDIUMINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  title VARCHAR(200) NOT NULL,
  author_id SMALLINT UNSIGNED NOT NULL,
  CONSTRAINT `fk_book_author`
    FOREIGN KEY (author_id) REFERENCES author (id)
    ON DELETE CASCADE
    ON UPDATE RESTRICT
) ENGINE = InnoDB;
</pre><p>Now, if we try to insert a book with a non-existing author, we will get an error:</p>
<pre class="fixed">INSERT INTO book (title, author_id) VALUES ('Necronomicon', 1);
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails
 (`test`.`book`, CONSTRAINT `fk_book_author` FOREIGN KEY (`author_id`) 
  REFERENCES `author` (`id`) ON DELETE CASCADE)
</pre><p>The error is very descriptive.</p>
<p>Now, let's try to properly insert two authors and their books:</p>
<pre class="fixed">INSERT INTO author (name) VALUES ('Abdul Alhazred');
INSERT INTO book (title, author_id) VALUES ('Necronomicon', LAST_INSERT_ID());

INSERT INTO author (name) VALUES ('H.P. Lovecraft');
INSERT INTO book (title, author_id) VALUES
  ('The call of Cthulhu', LAST_INSERT_ID()),
  ('The colour out of space', LAST_INSERT_ID());
</pre><p>It worked!</p>
<p>Now, let's delete the second author. When we created the foreign key, we specified <code>ON DELETE CASCADE</code>. This should propagate the deletion, and make the deleted author's books disappear:</p>
<pre class="fixed">DELETE FROM author WHERE name = 'H.P. Lovecraft';

SELECT * FROM book;
+----+--------------+-----------+
| id | title        | author_id |
+----+--------------+-----------+
|  3 | Necronomicon |         1 |
+----+--------------+-----------+
</pre><p>We also specified <code>ON UPDATE RESTRICT</code>. This should prevent us from modifying an author's <code>id</code> (the column referenced by the foreign key) if a child row exists:</p>
<pre class="fixed">UPDATE author SET id = 10 WHERE id = 1;
ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails 
 (`test`.`book`, CONSTRAINT `fk_book_author` FOREIGN KEY (`author_id`) 
  REFERENCES `author` (`id`) ON DELETE CASCADE)
</pre><h3 class="anchored_heading" id="references">REFERENCES</h3>
<p>Until <a href="/kb/en/what-is-mariadb-104/">MariaDB 10.4</a></p>
<pre class="fixed">CREATE TABLE a(a_key INT primary key, not_key INT);

CREATE TABLE b(for_key INT REFERENCES a(not_key));

SHOW CREATE TABLE b;
+-------+----------------------------------------------------------------------------------+
| Table | Create Table                                                                     |
+-------+----------------------------------------------------------------------------------+
| b     | CREATE TABLE `b` (
  `for_key` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1 |
+-------+----------------------------------------------------------------------------------+

INSERT INTO a VALUES (1,10);
Query OK, 1 row affected (0.005 sec)

INSERT INTO b VALUES (10);
Query OK, 1 row affected (0.004 sec)

INSERT INTO b VALUES (1);
Query OK, 1 row affected (0.004 sec)

SELECT * FROM b;
+---------+
| for_key |
+---------+
|      10 |
|       1 |
+---------+
</pre><p>From <a href="/kb/en/what-is-mariadb-105/">MariaDB 10.5</a></p>
<pre class="fixed">CREATE TABLE a(a_key INT primary key, not_key INT);

CREATE TABLE b(for_key INT REFERENCES a(not_key));
ERROR 1005 (HY000): Can't create table `test`.`b` 
  (errno: 150 &#34;Foreign key constraint is incorrectly formed&#34;)

CREATE TABLE c(for_key INT REFERENCES a(a_key));

SHOW CREATE TABLE c;
+-------+----------------------------------------------------------------------------------+
| Table | Create Table                                                                     |
+-------+----------------------------------------------------------------------------------+
| c     | CREATE TABLE `c` (
  `for_key` int(11) DEFAULT NULL,
  KEY `for_key` (`for_key`),
  CONSTRAINT `c_ibfk_1` FOREIGN KEY (`for_key`) REFERENCES `a` (`a_key`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 |
+-------+----------------------------------------------------------------------------------+

INSERT INTO a VALUES (1,10);
Query OK, 1 row affected (0.004 sec)

INSERT INTO c VALUES (10);
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails 
  (`test`.`c`, CONSTRAINT `c_ibfk_1` FOREIGN KEY (`for_key`) REFERENCES `a` (`a_key`))

INSERT INTO c VALUES (1);
Query OK, 1 row affected (0.004 sec)

SELECT * FROM c;
+---------+
| for_key |
+---------+
|       1 |
+---------+
</pre><h2 class="anchored_heading" id="see-also">See Also</h2>
<ul start="1"><li><a href="https://blog.mariadb.org/mariadb-innodb-foreign-key-constraint-errors/">MariaDB: InnoDB foreign key constraint errors</a>, a post in the MariaDB blog</li></ul>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/foreign-keys/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/foreign-keys/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/explain/">
                        ← EXPLAIN
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/optimization-and-indexes/">
                        ↑ Optimization and Indexes ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/ignored-indexes/">
                        Ignored Indexes →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="4259" data-comments-url="/kb/en/foreign-keys/+comments"
         data-reply-url="/kb/en/foreign-keys/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/optimization-and-indexes/">
                    ↑ Optimization and Indexes ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/the-essentials-of-an-index/">
                            <span class="pull-right not_primary"></span>
                            The Essentials of an Index
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/getting-started-with-indexes/">
                            
                            Getting Started with Indexes
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/create-index/">
                            <span class="pull-right not_primary"></span>
                            CREATE INDEX
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/drop-index/">
                            <span class="pull-right not_primary"></span>
                            DROP INDEX
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/show-index/">
                            <span class="pull-right not_primary"></span>
                            SHOW INDEX
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/full-text-indexes/">
                            
                            Full-Text Indexes
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/analyze-table/">
                            <span class="pull-right not_primary"></span>
                            ANALYZE TABLE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/building-the-best-index-for-a-given-select/">
                            
                            Building the best INDEX for a given SELECT
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/compound-composite-indexes/">
                            
                            Compound (Composite) Indexes
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/explain/">
                            <span class="pull-right not_primary"></span>
                            EXPLAIN
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>Foreign Keys</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/ignored-indexes/">
                            
                            Ignored Indexes
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/index-statistics/">
                            
                            Index Statistics
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/latitudelongitude-indexing/">
                            
                            Latitude/Longitude Indexing
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/primary-keys-with-nullable-columns/">
                            
                            Primary Keys with Nullable Columns
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/show-explain/">
                            <span class="pull-right not_primary"></span>
                            SHOW EXPLAIN
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/spatial-index/">
                            <span class="pull-right not_primary"></span>
                            SPATIAL INDEX
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/storage-engine-index-types/">
                            
                            Storage Engine Index Types
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>