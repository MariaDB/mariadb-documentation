<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>How to Quickly Insert Data Into MariaDB - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="How to Quickly Insert Data Into MariaDB - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/how-to-quickly-insert-data-into-mariadb/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/how-to-quickly-insert-data-into-mariadb/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/how-to-quickly-insert-data-into-mariadb/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/replication-cluster-multi-master/">High Availability &amp; Performance Tuning</a>
    

    
    » <a class="crumb" href="/kb/en/optimization-and-tuning/">Optimization and Tuning</a>
    

    
    » <a class="crumb" href="/kb/en/query-optimizations/">Query Optimizations</a>
    


    » <a class="node_link crumb" href="/kb/en/how-to-quickly-insert-data-into-mariadb/">How to Quickly Insert Data Into MariaDB</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/how-to-quickly-insert-data-into-mariadb/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>How to Quickly Insert Data Into MariaDB - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/how-to-quickly-insert-data-into-mariadb/+r/126112/">126112</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-7">
<a href="/kb/user/id/7" title="Michael Widenius">Michael Widenius</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2023-05-23 21:10">2023-05-23 21:10</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;

This article describes different techniques for inserting data quickly into MariaDB.

== Background

When inserting new data into MariaDB, the things that take time are:
(in order of importance):

* Syncing data to disk (as part of the end of transactions)
* Adding new keys. The larger the index, the more time it takes to keep keys
  updated.
* Checking against foreign keys (if they exist).
* Adding rows to the storage engine.
* Sending data to the server.

The following describes the different techniques (again, in order of
importance) you can use to quickly insert data into a table.

== Disabling Keys

You can temporarily disable updating of non unique indexes. This is mostly
useful when there are zero (or very few) rows in the table into which you are
inserting data.

&lt;&lt;code&gt;&gt;
ALTER TABLE table_name DISABLE KEYS;
BEGIN;
... inserting data with INSERT or LOAD DATA ....
COMMIT;
ALTER TABLE table_name ENABLE KEYS;
&lt;&lt;/code&gt;&gt;

In many storage engines (at least MyISAM and Aria),
##ENABLE KEYS## works by scanning through the row data and collecting keys,
sorting them, and then creating the index blocks. This is an order of magnitude
faster than creating the index one row at a time and it also uses less key
buffer memory.

&lt;&lt;style class=&#34;bluebox&#34;&gt;&gt;
**Note:** When you insert into an **empty table** with [[insert|INSERT]] or
[[load-data-infile|LOAD DATA]], MariaDB **automatically** does an
[[alter-table|DISABLE KEYS]] before and an [[alter-table|ENABLE KEYS]]
afterwards.
&lt;&lt;/style&gt;&gt;

When inserting big amounts of data, integrity checks are sensibly time-consuming. It is possible to disable the ##UNIQUE## indexes and the [[foreign-keys|foreign keys]] checks using the [[server-system-variables#unique_checks|unique_checks]] and the [[server-system-variables#foreign_key_checks|foreign_key_checks]] system variables:

&lt;&lt;code&gt;&gt;
SET @@session.unique_checks = 0;
SET @@session.foreign_key_checks = 0;
&lt;&lt;/code&gt;&gt;

For InnoDB tables, the [[auto_increment-handling-in-innodb|AUTO_INCREMENT lock mode]] can be temporarily set to 2, which is the fastest setting:

&lt;&lt;code&gt;&gt;
SET @@global.innodb_autoinc_lock_mode = 2;
&lt;&lt;/code&gt;&gt;

Also, if the table has [[triggers|INSERT triggers]] or [[virtual-columns|PERSISTENT]] columns, you may want to drop them, insert all data, and recreate them.

== Loading Text Files

The **fastest way** to insert data into MariaDB is through the
[[load-data-infile|LOAD DATA INFILE]] command.

The simplest form of the command is:

&lt;&lt;sql&gt;&gt;
LOAD DATA INFILE &#39;file_name&#39; INTO TABLE table_name;
&lt;&lt;/sql&gt;&gt;

You can also read a file locally on the machine where the client is running by
using:

&lt;&lt;sql&gt;&gt;
LOAD DATA LOCAL INFILE &#39;file_name&#39; INTO TABLE table_name;
&lt;&lt;/sql&gt;&gt;

This is not as fast as reading the file on the server side, but the difference
is not that big.

##LOAD DATA INFILE## is very fast because:

# there is no parsing of SQL.
# data is read in big blocks.
# if the table is empty at the beginning of the operation, all non unique
  indexes are disabled during the operation.
# the engine is told to cache rows first and then insert them in big blocks (At
  least MyISAM and Aria support this).
# for empty tables, some transactional engines (like Aria) do not log the
  inserted data in the transaction log because one can rollback the operation
  by just doing a [[truncate-table|TRUNCATE]] on the table.

Because of the above speed advantages there are many cases, when you need to
insert **many** rows at a time, where it may be faster to create a file
locally, add the rows there, and then use ##LOAD DATA INFILE## to load them;
compared to using ##INSERT## to insert the rows.

You will also get [[progress-reporting|progress reporting]] for
##LOAD DATA INFILE##.

=== mariadb-import

You can import many files in parallel with [[mariadb-import]] (##mysqlimport## before MariaDB 10.5). For example:

&lt;&lt;sql&gt;&gt;
mariadb-import --use-threads=10 database text-file-name [text-file-name...]
&lt;&lt;/sql&gt;&gt;

Internally [[mariadb-import]] uses [[load-data-infile|LOAD DATA INFILE]] to read
in the data.

== Inserting Data with INSERT Statements

=== Using Big Transactions

When doing many inserts in a row, you should wrap them with ##BEGIN / END## to
avoid doing a full transaction (which includes a disk sync) for every row. For
example, doing a begin/end every 1000 inserts will speed up your inserts by
almost 1000 times.

&lt;&lt;sql&gt;&gt;
BEGIN;
INSERT ...
INSERT ...
END;
BEGIN;
INSERT ...
INSERT ...
END;
...
&lt;&lt;/sql&gt;&gt;

The reason why you may want to have many ##BEGIN/END## statements instead of
just one is that the former will use up less transaction log space.

=== Multi-Value Inserts

You can insert many rows at once with multi-value row inserts:

&lt;&lt;sql&gt;&gt;
INSERT INTO table_name values(1,&#34;row 1&#34;),(2, &#34;row 2&#34;),...;
&lt;&lt;/sql&gt;&gt;

The limit for how much data you can have in one statement is controlled by the
[[server-system-variables/#max_allowed_packet|max_allowed_packet]] server variable.

== Inserting Data Into Several Tables at Once

If you need to insert data into several tables at once, the best way to do so
is to enable multi-row statements and send many inserts to the server at once:

&lt;&lt;sql&gt;&gt;
INSERT INTO table_name_1 (auto_increment_key, data) VALUES (NULL,&#34;row 1&#34;);
INSERT INTO table_name_2 (auto_increment, reference, data) values (NULL, LAST_INSERT_ID(), &#34;row 2&#34;);
&lt;&lt;/sql&gt;&gt;

[[last_insert_id|LAST_INSERT_ID()]] is a function that returns the last
##auto_increment## value inserted.

By default, the command line ##mariadb## client will send the above as
multiple statements.

To test this in the ##mariadb## client you have to do:

&lt;&lt;code&gt;&gt;
delimiter ;;
select 1; select 2;;
delimiter ;
&lt;&lt;/code&gt;&gt;

&lt;&lt;style class=&#34;bluebox&#34;&gt;&gt;
**Note:** for multi-query statements to work, your client must specify the
##CLIENT_MULTI_STATEMENTS## flag to ##mysql_real_connect()##.
&lt;&lt;/style&gt;&gt;

== Server Variables That Can be Used to Tune Insert Speed

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Option                     |= Description
| [[innodb-system-variables#innodb_buffer_pool_size|innodb_buffer_pool_size]] | Increase this if you have many indexes in InnoDB/XtraDB tables |
| [[myisam-system-variables#key_buffer_size|key_buffer_size]]         | Increase this if you have many indexes in MyISAM tables |
| [[server-system-variables#max_allowed_packet|max_allowed_packet]]      | Increase this to allow bigger multi-insert statements|
| [[server-system-variables#read_buffer_size|read_buffer_size]]          | Read block size when reading a file with ##LOAD DATA## |
&lt;&lt;/style&gt;&gt;

See [[server-system-variables|Server System Variables]] for the full list of server
variables.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>