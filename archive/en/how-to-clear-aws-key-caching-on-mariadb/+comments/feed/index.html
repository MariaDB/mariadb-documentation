<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>MariaDB Knowledge Base Comments for: how to clear AWS key caching on Mariadb.</title><link>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/feed/</link><description></description><atom:link href="https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/feed/" rel="self"></atom:link><language>en-us</language><lastBuildDate>Mon, 28 Apr 2025 12:13:13 +0000</lastBuildDate><item><title>Re: how to clear AWS key caching on Mariadb.</title><link>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/5621</link><description>&lt;p&gt;Thank you for the explaination.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">tg mai</dc:creator><guid>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/5621</guid></item><item><title>Re: how to clear AWS key caching on Mariadb.</title><link>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/5619</link><description>&lt;p&gt;If you use key id = 2, and you change it to key id = 3, in alter table
then you would not need  aws-kms-key.2.&amp;lt;whatever&amp;gt;&lt;/p&gt;
&lt;p&gt;But you can't remove *all* keys, and this is not what I meant. There must be some aws-kms-key.&amp;lt;id&amp;gt;.&amp;lt;version&amp;gt;,  for the key ids and versions that are still in use. Because these files contain the encrypted keys, which AWS KMS would decrypt at startup.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Vladislav Vaintroub</dc:creator><guid>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/5619</guid></item><item><title>Re: how to clear AWS key caching on Mariadb.</title><link>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/5618</link><description>&lt;p&gt;Thank you for the advice, I tried the alter table and it works. So this approach is more of a manual process, I was also looking at the innodb_encryption_rotate_key_age but don't know how to force test this feature, do you happen to know?&lt;/p&gt;
&lt;p&gt;You mentioned the "aws-kms-key.&amp;lt;id&amp;gt;.&amp;lt;version&amp;gt;" ... I was testing deletion of these keys and I was not able to bring up MariaDB service. Do you how to fix this? beside having a backup "aws-kms-key.&amp;lt;id&amp;gt;.&amp;lt;version&amp;gt;" key?&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">tg mai</dc:creator><guid>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/5618</guid></item><item><title>Re: how to clear AWS key caching on Mariadb.</title><link>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/5617</link><description>&lt;p&gt;Instead of rotating keys, use new ones, i.e do&lt;/p&gt;
&lt;p&gt;ALTER TABLE ... encryption_key_id=&amp;lt;new_id&amp;gt;&lt;/p&gt;
&lt;p&gt;Rotating is asynchronous, and for a while (we do not know when exactly this "while" ends) the pages are encrypted using old key versions.
ALTER TABLE is synchronous, and when it finishes, you data is encrypted using the new_key_id.&lt;/p&gt;
&lt;p&gt;In the data directory, AWS keys are stored as "aws-kms-key.&amp;lt;id&amp;gt;.&amp;lt;version&amp;gt;". You can remove the one for &amp;lt;id&amp;gt;s that you do not use anymore.&lt;/p&gt;
&lt;p&gt;Attention  - some things require to have KEY_ID=1 . innodb redo log is such a thing, if you encrypt it.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Vladislav Vaintroub</dc:creator><guid>https://mariadb.com/kb/en/how-to-clear-aws-key-caching-on-mariadb/+comments/5617</guid></item></channel></rss>