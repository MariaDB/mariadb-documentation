<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>System Troubleshooting MariaDB ColumnStore - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="System Troubleshooting MariaDB ColumnStore" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/system-troubleshooting-mariadb-columnstore/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Troubleshooting utilities, logging, database files, install and startup problems" />

    <meta name="description" content="Troubleshooting utilities, logging, database files, install and startup problems" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/system-troubleshooting-mariadb-columnstore/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/system-troubleshooting-mariadb-columnstore/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a>
    

    
    » <a class="crumb" href="/kb/en/columnstore-troubleshooting/">ColumnStore Troubleshooting</a>
    


    » <a class="node_link crumb" href="/kb/en/system-troubleshooting-mariadb-columnstore/">System Troubleshooting MariaDB ColumnStore</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/system-troubleshooting-mariadb-columnstore/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/system-troubleshooting-mariadb-columnstore/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/system-troubleshooting-mariadb-columnstore/+flag"
                data-flag-url="/kb/en/system-troubleshooting-mariadb-columnstore/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/system-troubleshooting-mariadb-columnstore/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2016-05-23 20:55">8 years, 11 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2021-10-08 17:24">3 years, 6 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/system-troubleshooting-mariadb-columnstore/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/system-troubleshooting-mariadb-columnstore/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/system-troubleshooting-mariadb-columnstore/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/system-troubleshooting-mariadb-columnstore/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>System Troubleshooting MariaDB ColumnStore</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents standalone">    <ol class="toc">

        <li class=""><a href="#mariadb-columnstore-alias-commands" title="MariaDB ColumnStore alias commands">MariaDB ColumnStore alias commands</a></li>

        <li class=""><a href="#mariadb-columnstore-support-report-tool" title="MariaDB ColumnStore Support Report tool">MariaDB ColumnStore Support Report tool</a></li>

        <li class=""><a href="#mariadb-columnstore-logging" title="MariaDB ColumnStore logging">MariaDB ColumnStore logging</a>        <ol class="toc">

            <li class=""><a href="#mariadb-columnstore-log-files-and-what-goes-in-them" title="MariaDB ColumnStore log files and what goes in them">MariaDB ColumnStore log files and what goes in them</a></li>

            <li class=""><a href="#mariadb-columnstore-log-files-and-how-to-setup" title="MariaDB ColumnStore log files and how to setup">MariaDB ColumnStore log files and how to setup</a></li>

            <li class=""><a href="#process-stdoutstderr-logging" title="Process STDOUT/STDERR logging">Process STDOUT/STDERR logging</a>        </ol>
</li>

        <li class=""><a href="#crash-trace-files" title="Crash trace files">Crash trace files</a></li>

        <li class=""><a href="#enabledisable-core-files" title="Enable/Disable Core Files">Enable/Disable Core Files</a></li>

        <li class=""><a href="#mariadb-columnstore-database-files" title="MariaDB ColumnStore database files">MariaDB ColumnStore database files</a></li>

        <li class=""><a href="#mariadb-columnstore-utilities" title="MariaDB ColumnStore utilities">MariaDB ColumnStore utilities</a></li>

        <li class=""><a href="#tables-locks-and-clearing" title="Tables locks and clearing">Tables locks and clearing</a>        <ol class="toc">

            <li class=""><a href="#viewtablelock-and-cleartablelock" title="viewtablelock and cleartablelock">viewtablelock and cleartablelock</a></li>

            <li class=""><a href="#restart-dmlproc" title="Restart DMLProc">Restart DMLProc</a></li>

            <li class=""><a href="#delete-the-tablelock-file" title="delete the tablelock file">delete the tablelock file</a>        </ol>
</li>

        <li class=""><a href="#multi-node-install-problems-and-how-to-diagnose" title="Multi-node install problems and how to diagnose">Multi-node install problems and how to diagnose</a></li>

        <li class=""><a href="#add-module-install-problems-and-how-to-diagnose" title="Add Module install problems and how to diagnose">Add Module install problems and how to diagnose</a></li>

        <li class=""><a href="#postconfigure-install-problems-and-how-to-diagnose" title="postConfigure install problems and how to diagnose">postConfigure install problems and how to diagnose</a></li>

        <li class=""><a href="#startsystem-problems-and-how-to-diagnose" title="startSystem problems and how to diagnose">startSystem problems and how to diagnose</a></li>

        <li class=""><a href="#system-in-dbrm-read-only-mode" title="System in DBRM Read-Only Mode">System in DBRM Read-Only Mode</a></li>

        <li class=""><a href="#non-root-system-primproc-process-fails-to-startup" title="Non-Root System, PrimProc Process fails to startup">Non-Root System, PrimProc Process fails to startup</a></li>

        <li class=""><a href="#create-table-error-error-occurred-when-calling-system-catalog" title="Create table error - Error occurred when calling system catalog">Create table error - Error occurred when calling system catalog</a></li>

        <li class=""><a href="#missing-mariadb-columnstore-function-or-engine" title="Missing MariaDB ColumnStore Function or Engine">Missing MariaDB ColumnStore Function or Engine</a></li>

        <li class=""><a href="#truncate-table-failure-with-error-of-columnstore-engine-id-different" title="Truncate Table Failure with error of Columnstore engine ID different">Truncate Table Failure with error of Columnstore engine ID different</a></li>

        <li class=""><a href="#mariadb-columnstore-process-restarting-due-to-allocating-to-much-memory" title="MariaDB ColumnStore Process Restarting due to Allocating to much memory">MariaDB ColumnStore Process Restarting due to Allocating to much memory</a></li>

        <li class=""><a href="#error-in-forking-cpimportbin-errno-12-cannot-allocate-memory" title="Error in forking cpimport.bin (errno-12); Cannot allocate memory">Error in forking cpimport.bin (errno-12); Cannot allocate memory</a></li>

        <li class=""><a href="#how-to-switch-primary-master-user-module" title="How to Switch Primary Master User Module">How to Switch Primary Master User Module</a></li>

        <li class=""><a href="#how-to-recover-when-system-when-dbroot-is-incorrectly-assigned-or-other-configuration-problem" title="How to Recover when  system when DBROOT is incorrectly assigned or other Configuration problem">How to Recover when  system when DBROOT is incorrectly assigned or other Configuration problem</a></li>

        <li class=""><a href="#query-failure-messagequeueclient-setup-unknown-name-or-service" title="Query failure MessageQueueClient :: setup (): unknown name or service">Query failure MessageQueueClient :: setup (): unknown name or service</a></li>

        <li class=""><a href="#replication-data-out-of-sync-causing-mysqld-to-not-start-and-the-system-to-not-startup" title="Replication Data out-of-sync causing mysqld to not start and the System to not startup.">Replication Data out-of-sync causing mysqld to not start and the System to not startup.</a></li>

        <li class=""><a href="#enablemysqlreplication-failure" title="enableMySQLReplication failure">enableMySQLReplication failure</a></li>

        <li class=""><a href="#problem-dropping-table-or-creating-table-an-existing-table" title="Problem Dropping table or Creating table an existing table">Problem Dropping table or Creating table an existing table</a>    </ol>
 </ol>
</li>
</div>
<h3 class="anchored_heading" id="mariadb-columnstore-alias-commands">MariaDB ColumnStore alias commands</h3>
<p>During the installation, these alias commands are defined and placed in the .bashrc file of the install user. 1.1 and later releases, the alias will reside in /etc/profile.d/columnstoreAlias.sh</p>
<p>This example is from a non-root install:</p>
<pre class="fixed">alias mcsmysql='/home/mariadb-user/mariadb/columnstore/mysql/bin/mysql --defaults-file=/home/mariadb-user/mariadb/columnstore/mysql/my.cnf -u root'
alias ma=/home/mariadb-user/mariadb/columnstore/bin/mcsadmin
alias mcsadmin=/home/mariadb-user/mariadb/columnstore/bin/mcsadmin
alias cpimport=/home/mariadb-user/mariadb/columnstore/bin/cpimport
alias home='cd /home/mariadb-user/mariadb/columnstore'
alias log='cd /var/log/mariadb/columnstore/'
alias dbrm='cd /home/mariadb-user/mariadb/columnstore/data1/systemFiles/dbrm'
alias module='cat /home/mariadb-user/mariadb/columnstore/local/module'

mcsmysql - Access the MariaDB ColumnStore MySQL Console
ma and mcsadmin - Access the MariaDB ColumnStore Admin Console
cpimport - short-cut to run the Bulk Load Process, cpimport
home - cd to MariaDB ColumnStore home directory
log - cd to MariaDB ColumnStore log directory
dbrm - cd to MariaDB ColumnStore DBRM file directory
module - outputs the MariaDB ColumnStore local mode name, like 'pm1'
</pre><h3 class="anchored_heading" id="mariadb-columnstore-support-report-tool">MariaDB ColumnStore Support Report tool</h3>
<p>This tool can be executed by users, called "columnstoreSupport", that will generated a report that contains the log files and other system data that is used by MariaDB personnel to help diagnose system related issues and errors within the MariaDB ColumnStore Product.</p>
<p>Here is how to run it:</p>
<p>On a single server:</p>
<pre class="fixed">/usr/local/mariadb/columnstore/bin/columnstoreSupport -a -bl
</pre><p>On a multi-node combo server, run on pm1</p>
<pre class="fixed">/usr/local/mariadb/columnstore/bin/columnstoreSupport -a -bl -p 'user-password'
</pre><p>On a multi-node separate server, run on um1</p>
<pre class="fixed">/usr/local/mariadb/columnstore/bin/columnstoreSupport -a -bl -p 'user-password'
</pre><p>NOTE: If ssh-keys are setup, enter the work 'ssh' for user-password. If no ssh-keys, then enter the Unix User password that is used to ssh login to the system.</p>
<p>NOTE: If there is a MariaDB/MySQL root user password setup for the mysql console, you will need to add that password into the ColumnStores my.cnf file.</p>
<p>When password is not set in the my.cnf, this error will be reported:</p>
<pre class="fixed">NOTE: MariaDB Columnstore root user password is set
NOTE: No password provide on command line or found uncommented in my.cnf
</pre><p>Add this line to the my.cnf file</p>
<pre class="fixed">password='root-password'
</pre><p>Here is an example of it getting run the the report that is generated:</p>
<pre class="fixed">/usr/local/mariadb/columnstore/bin/columnstoreSupport -a
Get software report data for pm1
Get config report data for pm1
Get log report data for pm1
Get log config data for pm1
Get hardware report data for pm1
Get resource report data for pm1
Get dbms report data for pm1

Columnstore Support Script Successfully completed, files located in columnstoreSupportReport.tar.gz
</pre><p>columnstoreSupportReport.tar.gz is what you would provide to MariaDB personnel or attach to a JIRA.</p>
<p>This is what the report consist of:</p>
<p>1. Compressed log files from each module : pm1_logReport.tar.gz
    a. This is the directory /var/log/mariadb/columnstore from pm1 which will contain:</p>
<ul start="1"><li>system logs for ColumnStore, debug, info, err, warning, and critical
</li><li>the alarm logs, alarm.log and activealarmLog
</li><li>UI command log, uiCommands.log, which are commands entered into
            mcsadmin
</li></ul>
<p>2. Config report from each module: pm1_configReport.txt. NOTE: on a single server
    system, pm1 report will contain more configuration data. On a multi-node seperate
    system um1 report will contain more data</p>
<ul start="1"><li>/etc/tstab
</li><li>Server processes - ps command info and top
</li><li>System network information
</li><li>System configuration information including storage
</li><li>System status information at the time the report was run
</li><li>System configuration file, Columnstore.xml
</li></ul>
<p>3. Hardware report for each module: pm1_hardwareReport.txt</p>
<ul start="1"><li>OS version
</li><li>CPU information
</li><li>Memory information
</li><li>Storage mount information
</li><li>Ip address information, ifconfig
</li></ul>
<p>4. Resource report for each module:  pm1_resourceReport.txt</p>
<ul start="1"><li>Shared memory
</li><li>Disk usage
</li><li>DBRM files
</li><li>Active table locks
</li><li>BRM extent map
</li></ul>
<p>5. Software report for each module: pm1_softwareReport.txt</p>
<ul start="1"><li>MariaDB ColumnStore software version
</li></ul>
<p>6. DBMR report, from the front-end modules: um1_dbmsReport.txt</p>
<ul start="1"><li>MariaDB version
</li><li>System catalog and tables
</li><li>MariaDB Columnstore usernames
</li><li>MariaDB ColumnStore variables
</li><li>MariaDB ColumnStore configuration file, my.cnf
</li><li>List of active queries at the time the report was run 
</li></ul>
<p>7. MariaDB ColumnStore MySQL log file: um1_mysqllogReport.tar.gz</p>
<h3 class="anchored_heading" id="mariadb-columnstore-logging">MariaDB ColumnStore logging</h3>
<p>MariaDB ColumnStore utilizes the install system logging tool, whether it's syslog, rsyslog, or syslog-ng.
The logs are located in /var/log/mariadb/columnstore. There are these 5 logs:</p>
<ul start="1"><li>crit.log
</li><li>err.log
</li><li>warning.log
</li><li>info.log
</li><li>debug.log
</li></ul>
<p>log format:</p>
<p>timestamp   hostname   process name[pid]  time | session id | txn id | thread id | logging level  subsystem_id message</p>
<div class="cstm-style darkheader-nospace-borders"><table><tr><th>log part</th><th>Description</th></tr>
<tr><td><code> timestamp</code></td><td>Format mmm dd hh24:mm:ss</td></tr>
<tr><td><code>hostname</code></td><td>hostname of the logging server</td></tr>
<tr><td><code>processname[pid]:</code></td><td>The Name of the Process (example: ProcessMonitor) followed by the pid enclosed into []</td></tr>
<tr><td><code>time</code></td><td>execution time for this step in seconds.</td></tr>
<tr><td><code>session id</code></td><td>Session ID. Thread number in the processlist. If N/A than value is 0.</td></tr>
<tr><td><code>txn id</code></td><td>MariaDB Transaction ID</td></tr>
<tr><td><code>thread id</code></td><td>Thread ID</td></tr>
<tr><td><code>logging level </code></td><td>D = Debug I = Info W = Warning E = Error C = Critical</td></tr>
<tr><td><code>subsystem id</code></td><td>1=ddljoblist 2=ddlpackage 3=dmlpackage 4=execplan 5=joblist 6=resultset 7=mcsadmin 8=oamcpp 9=ServerMonitor 10=traphandler 11=alarmmanager 12=configcpp 13=loggingcpp 14=messageqcpp 15=DDLProc 16=ExeMgr 17=ProcessManager 18=ProcessMonitor 19=writeengine 20=DMLProc 21=dmlpackageproc 22=threadpool 23=ddlpackageproc 24=dbcon 25=DiskManager 26=RouteMsg 27=SQLBuffMgr 28=PrimProc 29=controllernode 30=workernode 31=messagequeue 32=writeengineserver 33=writeenginesplit 34=cpimport.bin 35=IDBFile</td></tr>
<tr><td><code>message</code></td><td>logging message</td></tr>
</table>
</div><p>We also utilize the log rotate tool and by default we are configured to keep 7 days of log files. They are stored in /var/log/mariadb/columnstore/archive.</p>
<p>The MariaDB ColumnStore logrotate file is located in</p>
<p>/etc/logrotate.d/columnstore</p>
<p>Also in the /var/log/mariadb/columnstore directory, there are a few other logs that are kept:</p>
<ul start="1"><li>activeAlarms – List of active alarms currently set on the system
</li><li>alarm.log – list of all the alarms and associated clear alarms
</li><li>mcsadmin.log – list of the mcsadmin commands entered
</li></ul>
<p>The MariaDB ColumnStore process corefiles would be stored in /var/log/mariadb/columnstore/corefiles, that is if core file dumping is enabled on the system.</p>
<h4 class="anchored_heading" id="mariadb-columnstore-log-files-and-what-goes-in-them">MariaDB ColumnStore log files and what goes in them</h4>
<ul start="1"><li>Crit, err, and warning used to log problems by a MariaDB ColumnStore Process.
</li><li>Info will have logs showing high level actions that are going on in the system. During a stop/startsystem,
it will show the high level commands of the process/modules being stopped and started. The bulk-load (cpimport) tool logs is high level actions there also.
</li><li>Debug will have the lower level actions from the MariaDB ColumnStore Processes, which will include queries. 
</li></ul>
<p>The MariaDB Server will be logged here.</p>
<p>MariaDB ColumnStore-MySQL logs are stored here:</p>
<pre class="fixed">/usr/local/mariadb/columnstore/mysql/db/’server-name’.err
</pre><p>NOTE: Other informational log files will be written to the log directory as well as the Temporary Directory from MariaDB ColumnStore process during certain operations. So you will see a few other logs show up in the log directory besides these.</p>
<p>Temporary Directory for root installs is located in /tmp/columnstore/tmp/filles/
Temporary Directory for non-root installs is located in $HOME/.tmp</p>
<h4 class="anchored_heading" id="mariadb-columnstore-log-files-and-how-to-setup">MariaDB ColumnStore log files and how to setup</h4>
<p>The MariaDB ColumnStore log files setup is done as part of the post-install/postConfigure installation process. If some some reason the MariaDB ColumnStore log files aren't being generated or the log-rotation is not working, then there might have been some install/setup error that occurred.</p>
<p>Run the following command to get the logging setup:</p>
<p>Root install:</p>
<pre class="fixed">/usr/local/mariadb/columnstore/bin/syslogSetup.sh install
</pre><p>Non-root install, run as root user. The below example is assuming 'mysql' as the non-root user.</p>
<pre class="fixed">export COLUMNSTORE_INSTALL_DIR=/home/mysql/mariadb/columnstore
export LD_LIBRARY_PATH=:/home/mysql/mariadb/columnstore/lib:/home/mysql/mariadb/columnstore/mysql/lib:/home/mysql/mariadb/columnstore/lib:/home/mysql/mariadb/columnstore/mysql/lib
/home/mysql/mariadb/columnstore/bin/syslogSetup.sh --installdir=/home/mysql/mariadb/columnstore --user=mysql install
</pre><p>To test the logs, run the following and check the directory</p>
<pre class="fixed"># mcsadmin getlogconfig

# ls -ltr /var/log/mariadb/columnstore

// want to see if any of these logs are now showing up

# ls -ltr
total 172
-rwxr-xr-x 1 syslog adm 398 Oct 12 18:27 warning.log
-rwxr-xr-x 1 syslog adm 398 Oct 12 18:27 err.log
-rwxrwxrwx 1 syslog adm 8100 Oct 12 18:27 info.log
-rwxrwxrwx 1 syslog adm 139975 Oct 12 18:27 debug.log
</pre><p>If so, then logging is now working...</p>
<h4 class="anchored_heading" id="process-stdoutstderr-logging">Process STDOUT/STDERR logging</h4>
<p>MariaDB ColumnStore Processes have built in STDOUT/STDERR logging that can be enabled. This could be used for additional debugging of issues. This is enabled on a Process by Process Level.
Here is an example of how to enable and disable. In this example, locate the Process to enable, like DDLProc. Then enter the Process name and Module-type on the 'setprocessconfig' command.</p>
<p>NOTE: run from PM1</p>
<pre class="fixed">mcsadmin&gt; getprocessconfig
getprocessconfig   Tue Sep 26 19:21:14 2017

Process Configuration

Process #1 Configuration information
ProcessName = ProcessMonitor
ModuleType = ChildExtOAMModule
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/ProcMon
BootLaunch = 0
LaunchID = 1
RunType = LOADSHARE
LogFile = off

Process #2 Configuration information
ProcessName = ProcessManager
ModuleType = ParentOAMModule
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/ProcMgr
BootLaunch = 1
LaunchID = 2
RunType = ACTIVE_STANDBY
LogFile = off

Process #3 Configuration information
ProcessName = DBRMControllerNode
ModuleType = ParentOAMModule
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/controllernode
ProcessArg1 = /home/mariadb-user/mariadb/columnstore/bin/controllernode
ProcessArg2 = fg
BootLaunch = 2
LaunchID = 4
DepModuleName1 = @
DepProcessName1 = ProcessManager
RunType = SIMPLEX
LogFile = off

Process #4 Configuration information
ProcessName = ServerMonitor
ModuleType = ChildOAMModule
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/ServerMonitor
ProcessArg1 = /home/mariadb-user/mariadb/columnstore/bin/ServerMonitor
BootLaunch = 2
LaunchID = 6
RunType = LOADSHARE
LogFile = off

Process #5 Configuration information
ProcessName = DBRMWorkerNode
ModuleType = ChildExtOAMModule
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/workernode
ProcessArg1 = /home/mariadb-user/mariadb/columnstore/bin/workernode
ProcessArg2 = DBRM_Worker
ProcessArg3 = fg
BootLaunch = 2
LaunchID = 7
RunType = LOADSHARE
LogFile = off

Process #6 Configuration information
ProcessName = DecomSvr
ModuleType = pm
ProcessLocation = //home/mariadb-user/mariadb/columnstore/bin/DecomSvr
BootLaunch = 2
LaunchID = 15
RunType = LOADSHARE
LogFile = off

Process #7 Configuration information
ProcessName = PrimProc
ModuleType = pm
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/PrimProc
BootLaunch = 2
LaunchID = 20
RunType = LOADSHARE
LogFile = off

Process #8 Configuration information
ProcessName = ExeMgr
ModuleType = pm
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/ExeMgr
BootLaunch = 2
LaunchID = 30
DepModuleName1 = pm*
DepProcessName1 = PrimProc
RunType = LOADSHARE
LogFile = off

Process #9 Configuration information
ProcessName = WriteEngineServer
ModuleType = pm
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/WriteEngineServer
BootLaunch = 2
LaunchID = 40
RunType = LOADSHARE
LogFile = off

Process #10 Configuration information
ProcessName = DDLProc
ModuleType = pm
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/DDLProc
BootLaunch = 2
LaunchID = 50
DepModuleName1 = pm*
DepProcessName1 = WriteEngineServer
DepModuleName2 = *
DepProcessName2 = DBRMWorkerNode
DepModuleName3 = *
DepProcessName3 = ExeMgr
RunType = SIMPLEX
LogFile = off

Process #11 Configuration information
ProcessName = DMLProc
ModuleType = pm
ProcessLocation = /home/mariadb-user/mariadb/columnstore/bin/DMLProc
BootLaunch = 2
LaunchID = 51
DepModuleName1 = pm*
DepProcessName1 = WriteEngineServer
DepModuleName2 = *
DepProcessName2 = DBRMWorkerNode
DepModuleName3 = @
DepProcessName3 = DDLProc
RunType = SIMPLEX
LogFile = off

Process #12 Configuration information
ProcessName = mysqld
ModuleType = pm
ProcessLocation = /home/mariadb-user/mariadb/columnstore/mysql/libexec/mysqld
BootLaunch = 0
LaunchID = 100
RunType = LOADSHARE
LogFile = off

mcsadmin&gt; setprocessconfig DDLProc pm LogFile on
setprocessconfig   Tue Sep 26 19:22:00 2017

   Successfully set LogFile = on

mcsadmin&gt; shutdownsystem y
shutdownsystem   Tue Sep 26 19:23:59 2017

This command stops the processing of applications on all Modules within the MariaDB ColumnStore System

   Checking for active transactions

   Stopping System...
   Successful stop of System 

   Shutting Down System...
   Successful shutdown of System 

mcsadmin&gt; startsystem
startsystem   Tue Sep 26 19:24:36 2017
startSystem command, 'columnstore' service is down, sending command to
start the 'columnstore' service on all modules


   System being started, please wait..................
   Successful start of System 

mcsadmin&gt; 
</pre><p>In the log directory, there will be the following 2 files. So all the STDOUT/STDERR from the process will be logged here</p>
<pre class="fixed">pwd
/var/log/mariadb/columnstore

ll DDLProc.*
-rw-r--r-- 1 mariadb-user mariadb-user  0 Sep 26 19:25 DDLProc.err
-rw-r--r-- 1 mariadb-user mariadb-user 34 Sep 26 19:25 DDLProc.out
</pre><p>To Disable, just set the LogFile setting back to off and do the shutdown/startsystem</p>
<pre class="fixed">setprocessconfig DDLProc pm LogFile off
</pre><h3 class="anchored_heading" id="crash-trace-files">Crash trace files</h3>
<p>MariaDB ColumnStore 1.0.13 / 1.1.3 onwards includes a special crash handler which will log details of a crash from the main UM and PM daemons. These can be found in:</p>
<pre class="fixed">/var/log/mariadb/columnstore/trace
</pre><p>The filenames will be in the form `&lt;processName&gt;.&lt;processID&gt;.log`. These are similar to the crash traces that can be found in the MariaDB server log files if MariaDB server crashes.</p>
<h3 class="anchored_heading" id="enabledisable-core-files">Enable/Disable Core Files</h3>
<p>Since core files are very large (1gb) and can take up a lot of disk space, Core File Generating for MariaDB ColumnStore platform processes is defaulted to disable. </p>
<p>The location of the MariaDB ColumnStore Process corefiles get placed here:</p>
<p>/var/log/mariadb/columnstore/corefiles/</p>
<p>You can redirect the location to another disk with more space by using a soft-link.</p>
<ul start="1"><li>Enable from pm1
</li></ul>
<pre class="fixed"># ma shutdownsystem
# /usr/local/mariadb/columnstore/bin/setConfig Installation CoreFileFlag y
# ma startsystem
</pre><ul start="1"><li>Disable from pm1
</li></ul>
<pre class="fixed"># ma shutdownsystem
# /usr/local/mariadb/columnstore/bin/setConfig Installation CoreFileFlag n
# ma startsystem
</pre><h3 class="anchored_heading" id="mariadb-columnstore-database-files">MariaDB ColumnStore database files</h3>
<p>The MariaDB ColumnStore has 3 sets of database files. These files are also always backed up and restored together as part of the backup and restore process.</p>
<ul start="1"><li>MariaDB ColumnStore-MySQL schemes - /usr/local/mariadb/columnstore/mysql/db/*
</li><li>MariaDB ColumnStore Database - /usr/local/mariadb/columnstore/dataX/000.dir
</li><li>MariaDB ColumnStore DBRM files - /usr/local/mariadb/columnstore/data1/systemFiles/dbrm/*
</li></ul>
<p>MariaDB ColumnStore Database: The X represents the DBroot ID #. DBroot is the file directory containing the meta-data. We generally assign 1 DBroot per Performance Module. This DBroot can be pointing to local disk storage area or mounted to external disk. So for a single-server setup, we would have ‘data1’ as the dbroot. If we had a system will 2 Performance modules, then we would have ‘data1’ on PM1 and ‘data2’ on PM2.</p>
<p>MariaDB ColumnStore DBRM files: This is where the Extent Map and Versioning files are located. These make up the DBRM files. There are 3 copies of the files that are keep, one is the current active set and the other 2 are the backup. The current active copy file name is located in this file:</p>
<pre class="fixed">/usr/local/mariadb/columnstore/data1/systemFiles/dbrm/BRM_saves_current
</pre><p>The Extent Map is loaded into shared memory on each of the nodes during the start-system process time. The version in shared memory on the PM1 node is the main copy. Changes are applied to that version in memory. Then changes are made to the disk version that only exist on PM1 disk storage and a copy of those changes are sent out to the other nodes and their memory copies are updated.</p>
<p>NOTE: The following utility can be used to dump the internal memory copy of the Extent Map <code>/usr/local/mariadb/columnstore/bin/editem</code> : there are a few options with this command, -i dumps a raw copy and -d dumps a formatted copy</p>
<h3 class="anchored_heading" id="mariadb-columnstore-utilities">MariaDB ColumnStore utilities</h3>
<p>Here are a few of the common utilities that are used to view and troubleshoot issues. All of these commands are located in /usr/local/mariadb/columnstore/bin/</p>
<p>These are utilizes to be used to view or set system variables. They should be run on the Active OAM Parent Module, which generally is the Performance Module #1.</p>
<ul start="1"><li>editem – used to view the Extent Map in internal memory, discussed in previous section
</li><li>configxml.sh – used to get and set parameters from the system config file, ColumnStore.xml
<ul start="1"><li>./configxml.sh getconfig ExeMgr1 Port
</li><li>./configxml.sh setconfig ExeMgr1 Port 8601
</li></ul>
</li><li>dbrmctl – used to display are view or change the DBRM status
<ul start="1"><li>Example, display the current the dbrm status 
<ul start="1"><li>./dbrmctl status
</li></ul>
</li><li>Example, the dbrm might be in a readonly state, this would unlock
<ul start="1"><li>./dbrmctl resume
</li></ul>
</li></ul>
</li></ul>
<p>These are utilizes to be used to view or clear Database Table Locks. They should be run on the Active OAM Parent Module, which generally is the Performance Module #1.</p>
<ul start="1"><li>viewtablelock – will display what tables are locked. There might be times when a DML
command might fail and leave a table in a locked state. You can run this command to find
which tables are locked, and then use the ‘cleartablelock’ command
</li><li>cleartablelock – use to clear a table lock. As explained above, could be used to clear a lock on a table that was left set on a failed command
</li></ul>
<p>These are utilities that would be run on all nodes in the system</p>
<ul start="1"><li>clearShm – used to clear the shared internal memory, used at times after a system-shutdown command is do just to make sure the memory is cleared
</li></ul>
<h3 class="anchored_heading" id="tables-locks-and-clearing">Tables locks and clearing</h3>
<p>A Table lock might be left set due to come failure on processing a DML/DDL command. Normally this lock can be cleared with the utility mentioned above, cleartablelock. But in the case where it doesn't clear the lock, it can also be cleared by restarting the Active DMLProc on the system. This will cause DMLProc to perform the rollback processing that will clear any table locks. And as a third option when the first to doesn't work, there is a tablelock file that can be removed</p>
<h5 class="anchored_heading" id="viewtablelock-and-cleartablelock">viewtablelock and cleartablelock</h5>
<p>Run viewtablelock to get the list of table locks:</p>
<pre class="fixed"># /usr/local/mariadb/columnstore/bin/viewtablelock
</pre><p>Run cleartablelock with the table lock ID shown in the viewtablelock</p>
<pre class="fixed"># /usr/local/mariadb/columnstore/bin/cleartablelock XX
</pre><h5 class="anchored_heading" id="restart-dmlproc">Restart DMLProc</h5>
<p>1. run command to get the Active DMLProc</p>
<pre class="fixed"># mcsadmin getsystemi
</pre><p>2. Run the follow command that will restart the DMLProc</p>
<pre class="fixed"># mcsadmin restartProcess DMLProc xxx (xxx is probably um1 or pm1, based on the system)
</pre><p>When the status of DMLProc goes to ACTIVE from BUSY_INIT (meaning is performing rollbacks), then check to see if the lock still exist.</p>
<h5 class="anchored_heading" id="delete-the-tablelock-file">delete the tablelock file</h5>
<p>If the previous 2 commands didn't work, you can delete the tablelock file if it exists</p>
<p>This is done from PM1:</p>
<pre class="fixed"># cd /usr/local/mariadb/columnstore/data1/systemFiles/dbrm
# rm -f tablelock    // if it exist
# mcsadmin restartSystem y
</pre><h3 class="anchored_heading" id="multi-node-install-problems-and-how-to-diagnose">Multi-node install problems and how to diagnose</h3>
<p>Once you install the packages on the initial server, pm1, run post-install and postConfigure. </p>
<p>If it's failing in the remote server install section, go via the install logs in /tmp to see why the failure occurred. It could be related to these issues:</p>
<p>1. user password or ssh-keys not setup, failing to log in</p>
<p>2. Dependent package isn't installed on a remote server</p>
<p>3. Incompatible OS's between nodes, all have to be the same</p>
<p>If you get to the point where it says Starting system processes, but it seems to hang or not return. 
Here are some things to check:</p>
<p>1. Check the locale setting on all servers and make sure they are all the same</p>
<p>2. on pm1, create the alias if you haven't already</p>
<ol start="1"><li>. /usr/local/mariadb/columnstore/bin/columnstoreAlias
    then run following command and check the process status:
</li><li>mcsadmin getsysteminfo
    check if ProcMon is ACTIVE on all configured servers, if not, check the log files on the asscouiated
    server to see what error ProcMon is reporting. Also make sure the ProcMgr is ACTIVE on pm1.
</li></ol>
<p>    logs are located in:</p>
<p>    /var/log/mariadb/columnstore</p>
<p>generally when ProcMon/ProcMgr isn't active, it's because one of these issues:</p>
<p>1. if external storage, an pm /etc/fstab isnt setup</p>
<p>2. message issue between the servers that is causing ProcMon's and ProcMgr to fail to communicate. Make sure all server firewalls are disable along with SElinux. </p>
<h3 class="anchored_heading" id="add-module-install-problems-and-how-to-diagnose">Add Module install problems and how to diagnose</h3>
<p>There are a number of reasons why an addModule command might fail, missing dependent packages, password or ssh key is not setup, etc. Here are some things to investigate when this 'mcsadmin' command does fail.</p>
<p>1. Check the log files on the local node where the command is running. Generally an log in the error, warning, or critical log will be reported when a failure occurs.</p>
<p>2. Depending on how far the addModule command got, another log will be generated in /tmp. Look for a log file with binary_installer, user/performance_installer. This will echo back the installer script the commands it runs, so it would flag an issue in there.</p>
<p>3. Also make sure you can log into the new server/instance from the local one. Not being able to log in would cause a failure.</p>
<p>4. Also depending on how far the command got, it might have added an entry in the system configuration file for the new module. So you will need to check that and if you were adding pm2 and it failed, then it shows up in the system configuration via the 'getsystemn'. You would then need to remove that module before trying the addModule command.</p>
<p>5. If your get the error return from the 'addModule' command if File Open error, that means it could locate the MariaDB ColumnStore rpm/deb/binary in the $HOME directory, i.e. /root for root user install. The logic takes the packages from here and pushes them to the new server.</p>
<h3 class="anchored_heading" id="postconfigure-install-problems-and-how-to-diagnose">postConfigure install problems and how to diagnose</h3>
<p>The installation script, postConfigure, is run at install and upgrade times. The first part of the script takes information from the user and setup the system configuration, which is updating the Columnstore.xml and the ProcessConfig.xml configuration files.</p>
<p>The second part of the script performs a remote install of all of the other servers in the system, which is for a multi-node install configuration. The installation of the remote nodes are done simultaneously and the remote install logs are placed in /tmp on 'pm1', i.e. "pm1_installer.log". The actual log file name will be different based on if you are doing an rpm, debian, or binary install. 
So if postConfigure reports that a failure occurred during the remote server install phase, you can look at these logs in /tmp. The main reasons why this might fail:</p>
<p>1. ssh access to the remote node from pm1 failed, password or ssh setup issues</p>
<p>2. A missing dependency package on the remote node</p>
<p>The third part of postConfigure is the starting up of the system, which consist of starting up of the 'columnstore' service script on each node. If a failure happens during this time frame, do the following to help determine the failure:</p>
<p>1. first, you might need to run this script to get the 'mcsadmin' alias command defined</p>
<pre class="fixed"># . ./usr/local/mariadb/columnstore/bin/aliasColumnstore
</pre><p>2. get the system statuses</p>
<pre class="fixed"># mcsadmin getsystemi
</pre><p>3. Here are some things that can point to you why the system didn't come up:
    a. Make sure that all ProcMon processes are active on all nodes. If they aren't, then here are some of the reasons why they might not be:
        i. Firewall is enabled on the 'pm1' node are the installing node, check that.
        ii. ProcMon might have run into another issues at startup, like failing to mount to an external disk.
            So check the log files on the remote server where ProcMon failed to go ACTIVE.
    b. If it reports a module status of FAILED, then check the log files from that module.</p>
<p>4. Also check the log files from the local 'pm1' module.</p>
<h3 class="anchored_heading" id="startsystem-problems-and-how-to-diagnose">startSystem problems and how to diagnose</h3>
<p>So this is assuming that the system has made it successfully though a postConfigure install or upgrade. At some point, you might need to do a stop or shutdownsystem for some maintenance or some other reason. And then do the startsystem. If any failures occur with the startSystem command, you can check the following:</p>
<p>1. get the system statuses</p>
<pre class="fixed"># mcsadmin getsystemi
</pre><p>2. Here are some things that can point to you why the system didn't come up:
    a. Make sure that all ProcMon processes are active on all nodes. If they aren't, then here are some of the reasons why they might not be:
        i. Firewall is enabled on the 'pm1' node are the installing node, check that.
        ii. ProcMon might have run into another issues at startup, like failing to mount to an external disk.
            So check the log files on the remote server where ProcMon failed to go ACTIVE.
    b. If any of the DBRM Processes, Controller or Worker nodes are in a FAILED state, the most likely reason for this the there is an issue with the DBRM files. These files are loaded from disk into shared-memory. This is load fails, it will mark the DBRM Process as FAILED. If this is the case, then please contact MariaDB Customer Support. The DBRM fails contain the Extent Map and other metadata related to the MariaDB Columnstore Database files.
    c. If it reports a module status of FAILED, then check the log files from that module.</p>
<p>3. Also check the log files from the local 'pm1' module.</p>
<h3 class="anchored_heading" id="system-in-dbrm-read-only-mode">System in DBRM Read-Only Mode</h3>
<p>The System can go into DBRM Read-Only Mode due to these conditions, a failure while doing a DDL/DML command, network problem between servers where the DBRM could get distributed to the other servers from Performance Module 1,  and some failover scenarios. It will be shown by the follow alarm.  This alarm along with all critical alarms will be displayed when user logs into the Columnstore Admin Console 'mcsadmin'.</p>
<p>AlarmID           = 31
Brief Description = DBRM_READ_ONLY
Alarm Severity    = CRITICAL
Time Issued       = Wed Sep 13 14:32:37 2017
Reporting Module  = pm1
Reporting Process = DBRMControllerNode
Reported Device   = System</p>
<p>If the system ever gets into DBRM Read-Only Mode, it is best resolved by do a restart system form the 'pm1' module:</p>
<pre class="fixed"># mcsadmin restartsystem y
</pre><p>DBRM Read-Only Mode means that changes cannot be made to the MariaDB ColumnStore Database while it is in this state. Queries can still be processed.</p>
<h3 class="anchored_heading" id="non-root-system-primproc-process-fails-to-startup">Non-Root System, PrimProc Process fails to startup</h3>
<p>For non-root systems, the user file settings is required to be set as shown in the Preparing Guide. So if you have a Non-Root install where it fails to start and the 'mcsadmin getsystemi' shows that the PrimProc Process is in a failed state.  Double check the user file settings on each node.</p>
<p><a href="https://mariadb.com/kb/en/library/preparing-for-columnstore-installation/#set-the-user-file-limits-by-root-user">https://mariadb.com/kb/en/library/preparing-for-columnstore-installation/#set-the-user-file-limits-by-root-user</a></p>
<h3 class="anchored_heading" id="create-table-error-error-occurred-when-calling-system-catalog">Create table error - Error occurred when calling system catalog</h3>
<p>If you are having a problem creating a table after an new install is performed and you get the error "Error occurred when calling system catalog", chances are the System Catalog didnt get created by postConfigure. The call to create happens at the very end of postConfigure, so it is possible that postConfigure didn't successfully complete or there was an error when trying to create it.</p>
<p>Run the following command from PM1 to create the System Catalog:</p>
<p>/usr/local/mariadb/columnstore/bin/dbbuilder 7</p>
<p>NOTE: This example is assuming it's a root user install</p>
<h3 class="anchored_heading" id="missing-mariadb-columnstore-function-or-engine">Missing MariaDB ColumnStore Function or Engine</h3>
<p>After new Install or Upgrade, a MariaDB ColumnStore Function or Engine type might be missing from the MariaDB Database. If this occurs, you can run the following procedure on each of the UMs or PMs with UM front-end modules on the system. This procedure should get all of the Functions and Engines created.</p>
<p>From Performance Module #1</p>
<pre class="fixed">mcsadmin shutdownsystem y
</pre><p>On all User Modules or Performance Modules with mysqld installed. This example assumes a root install in /usr/local/, run the following scripts</p>
<pre class="fixed">/usr/local/mariadb/columnstore/bin/post-mysqld-install
/usr/local/mariadb/columnstore/bin/post-mysql-install
</pre><p>From Performance Module #1</p>
<pre class="fixed">mcsadmin startsystem y
</pre><h3 class="anchored_heading" id="truncate-table-failure-with-error-of-columnstore-engine-id-different">Truncate Table Failure with error of Columnstore engine ID different</h3>
<p>This issue has been reported after a system was upgraded from 1.1.x to 1.2.x versions of MariaDB ColumnStore. If the truncate error occurs with the Columnstore engine ID being different, then the existing table would need to be dropped and recreated as a fix.</p>
<h3 class="anchored_heading" id="mariadb-columnstore-process-restarting-due-to-allocating-to-much-memory">MariaDB ColumnStore Process Restarting due to Allocating to much memory</h3>
<p>In the 1.2.2 and earlier releases, MariaDB ColumnStore Process like PrimProc, ExeMgr, or WriteEngineService  can automatically restart due to over allocation of memory.  PrimProc and WriteEngineService run on the Performance Module. ExeMgr runs on the User Module.</p>
<p>This can be caused by a few situations like these:</p>
<ul start="1"><li>Doing very large aggregates
</li><li>Spike memory usage when dealing with large result sets to buffer the rowgroups
</li></ul>
<p>This is a log that is reported for this issue. This example shows PrimProc using 95% of memory.
The next Log is reporting that it is restarting.</p>
<p>Feb  29 16:22:34 ip-192-168-1-112 ServerMonitor[1951]: 39.784588 |0|0|0| I 09 CAL0000: Memory Usage for Process:  PrimProc  : Memory Used  12296930  : % Used  95
Feb  29 16:23:00 ip-192-168-1-112 ProcessMonitor[1578]: 05.478658 |0|0|0| C 18 CAL0000: <strong>*</strong>MariaDB ColumnStore Process Restarting: PrimProc, old PID = 5667</p>
<p>When this issue is occurring on a system running 1.2.2 or earlier, this is a work-around that can be applied.</p>
<p>IMPORTANT: it is recommenced that you check with MariaDB ColumnStore support first on if this change should be made so it can be confirmed that this is the best work-around.</p>
<p>Work-around Process:</p>
<pre class="fixed">On pm1

# mcsadmin shutdownsystem y

So this will need to be done on all nodes, both User Modules and Performance Modules

1. install jemalloc package

Install jemalloc package(libjemalloc1 for Ubuntu 18, Centos 7 provides the jemalloc package via EPEL repository). After you install the package, find jemalloc shared object file path(LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libjemalloc.so.1 in Ubuntu 18)

2. Edit mariadb/columnstore/bin/run.sh

Then edit $install_dir/bin/run.sh using the patch. Please note that libjemalloc.so path must be changed according with your distribution.

--- /run.sh 2019-01-31 05:07:19.473718632 +0000
+++ /usr/local/mariadb/columnstore/bin/run.sh 2019-01-31 05:07:34.057051852 +0000
@@ -49,7 +49,7 @@
fi

while [ $keep_going -ne 0 ]; do
- $exename $args
+ LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libjemalloc.so.1 $exename $args
if [ -e ${lopt}/StopColumnstore ]; then
exit 0
fi

On pm1
&lt;&lt;code&gt;&gt;
# mcsadmin startsystem y
</pre><h3 class="anchored_heading" id="error-in-forking-cpimportbin-errno-12-cannot-allocate-memory">Error in forking cpimport.bin (errno-12); Cannot allocate memory</h3>
<p>This Error is an indication that ExeMgr on the User Module doesnt have enough local memory to run the Bulk Load Process cpimport.bin. So check for Process Memory allocation by other processes on the User Module when this error gets reported.</p>
<p>Here is one example of when this problem has been seen. The setting of innodb_buffer_pool_size in my.cnf is set too high. In general, it shouldn't be set any higher than 50GB or 25% of the total memory.</p>
<h3 class="anchored_heading" id="how-to-switch-primary-master-user-module">How to Switch Primary Master User Module</h3>
<p>The commands below will show how to make a different User Module the Master MySQL replication module.
There are some cases where User Module #2 make have become the Master during a failover scenario or some other case and you want to make User Module #1 the Master once again. These are the commands to do this.</p>
<p>First, check the System Status with the following command to see whether User Module #1 is disabled or not:</p>
<p>On pm1</p>
<pre class="fixed"># mcsadmin getsysteminfo
</pre><p>If User Module #1 is disabled, run to enable it:</p>
<pre class="fixed"># mcsadmin altersystem-enablemodule um1 y
</pre><p>Now run the commands to get User Module #1 as the Master. This is assuming User Module #2 is the current the Master:</p>
<pre class="fixed"># mcsadmin altersystem-disablemodule um2 y
# mcsadmin altersystem-enablemodule um2 y
</pre><h3 class="anchored_heading" id="how-to-recover-when-system-when-dbroot-is-incorrectly-assigned-or-other-configuration-problem">How to Recover when  system when DBROOT is incorrectly assigned or other Configuration problem</h3>
<p>There are times when the system gets into a state where it will not successfully Start due to a configuration problem. And since it will not start, the user can't get it to the point to where it can be fixed via 'mcsadmin'. So when that happen's, they the user will need to run 'postConfigure' to correct the issue.</p>
<p>Here is a couple of examples of a configuration issue that could cause this situation.</p>
<p>1. DBROOT 1 get reassigned to a different PM than PM1 when the system only has local storage, meaning DBOOT 1 is only on PM1.
2. UM or PM is disabled and the user wants to get it enabled.</p>
<p>Here is the process on how to recover. Run from PM1</p>
<pre class="fixed"># mcsadmin shutdownsystem y
</pre><p>Run 'postConfigure' based on the type of install it is, root or non root. Command line arguments will be different between the two. This example  shows for a root install.</p>
<pre class="fixed"># /usr/local/mariadb/columnstore/bin/postConfigure

// if ask to use old configuration, answer n
// If you get to the Module that is disabled and you want enabled, answer 'y' to the enable module prompt
// on each of the PM DBROOT prompts, enter the DBOOT number that goes to the PM
// When it completes the configuration part and ask for ssh password, enter 'exit' to exit postConfigure

# mcsadmin startsystem
</pre><h3 class="anchored_heading" id="query-failure-messagequeueclient-setup-unknown-name-or-service">Query failure MessageQueueClient :: setup (): unknown name or service</h3>
<p>Due to a known issue in MariaDB Columnstore 1.2.5 and earlier, if a User Module or a Performance Module on a combined server is removed, the ColumnStore.xml entry for the ExeMgr setting gets set to "unassigned". 
This setting will cause queries to fail especially when running multiple queries in parallel.</p>
<p>The work-around fix is to delete the ExeMgr entry from the Columnstore.xml file.</p>
<pre class="fixed">	&lt;ExeMgr8&gt;
		&lt;IPAddr&gt;unassigned&lt;/IPAddr&gt;
		&lt;Port&gt;8601&lt;/Port&gt;
		&lt;Module&gt;unassigned&lt;/Module&gt;
	&lt;/ExeMgr8&gt;
</pre><h3 class="anchored_heading" id="replication-data-out-of-sync-causing-mysqld-to-not-start-and-the-system-to-not-startup">Replication Data out-of-sync causing mysqld to not start and the System to not startup.</h3>
<p>In the case where the system fails to startup or the MariaDB ColumnStore server (mysqld) fails to startup and it isreporting an replication error on Drop, Rename, Move Table or View, this could mean that the Binary Logs on the Module, usually a Slave User Module are out of sync with the Database. An example would be when mysqld startups on User Module #2, a slave module, it will go through the Replication bin-logs and run commands to capture up with the Master DB. If it tried to Drop a Table or View that doesn't exist in the Slave Database, it will reported an error and shutdown. This is an indication that the Replication and maybe the Data itself is out-of-sync between the Master and the slave Modules, usually UM1 and UM2. It resolve the issue to where the UM2 slave mysqld will run, the following procedure needs to be execute to get the UMs back in-sync.</p>
<p>UM1: log into mcsmysql and purge the bin-logs providing todays date</p>
<pre class="fixed">mcsmysql
sql &gt; PURGE BINARY LOGS BEFORE '2013-04-21';
</pre><p>UM2: move the bin-log and relay-logs to a backup directory. Can delete, but best ti move instead</p>
<pre class="fixed">cd ../mariadb/columnstore/mysql/db

# mv mysql-bin.* /tmp/.
# mv relay-bin.* /tmp/.
</pre><p>Compare the InnoDB file (ibdata1) on UM1 to UM2 to make sure that file is insync. If it is different between the 2 UMs, then scp the one from UM1 to UM2.
XXX.XXX.XXX.XXX is UM1 IP Address.</p>
<p>ON UM2:</p>
<pre class="fixed">mv ibdata1 /tmp/.

# scp XXX.XXX.XXX.XXX:/usr/local/mariadb/columnstore/mysqld/db/ibdata1 .
</pre><p>At this point, lets try to restart the system</p>
<p>FROM PM1:</p>
<pre class="fixed"># mcsadmin
&gt; shutdownSystem y
&gt; startsystem
</pre><h3 class="anchored_heading" id="enablemysqlreplication-failure">enableMySQLReplication failure</h3>
<p>The Front-end Replication can be disabled and enabled via the 'mcsadmin' console. If the Replication stopped working between the User Modules, the user can run the enableMySQLReplication to get it setup and working.</p>
<pre class="fixed"># mcsadmin
&gt; enableMySQLReplication
Enter the 'User' Password or 'ssh' if configured with ssh-keys
Please enter: ssh
</pre><p>But in the case when this command fails, here is what to do to debug why it failed</p>
<pre class="fixed"># mcsadmin
&gt; enableMySQLReplication
Enter the 'User' Password or 'ssh' if configured with ssh-keys
Please enter: ssh

**** enableRep Failed : API Failure return in enableMySQLRep API
</pre><p>On User Module #1:</p>
<p>1. Check the Columnstore log files to see which step failed
2. There are also additional log files that scripts will update providing additional information. They are located on UM1 in /tmp/columnstore_tmp_files for root install and .tmp in the non-root user home directory.</p>
<h3 class="anchored_heading" id="problem-dropping-table-or-creating-table-an-existing-table">Problem Dropping table or Creating table an existing table</h3>
<p>Sometimes if the Table information between the front-end and the back-end get out-of-sync, the following errors will be reported not allowing the customer to drop or create the table</p>
<pre class="fixed">DROP TABLE TABLE1;
Error Code: 1815. Internal error: CAL0009: Drop table failed due to  IDB-2006: 'TABLE1' does not exist in Columnstore.
</pre><pre class="fixed">CREATE TABLE `TABLE1` (   `cover_key` int(10) unsigned DEFAULT NULL,   `count_num` bigint(20) unsigned DEFAULT NULL ) ENGINE=Columnstore DEFAULT CHARSET=latin1;
Error Code: 1050. Table 'TABLE1' already exists
</pre><p>This problem can be cleaned up by Dropping the table with RESTRICT option.</p>
<pre class="fixed">DROP TABLE TABLE1 RESTRICT;
</pre><p>Then the customer should be able to create the table at this point.</p>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/system-troubleshooting-mariadb-columnstore/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/system-troubleshooting-mariadb-columnstore/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/mariadb-columnstore-cluster-test-tool/">
                        ← MariaDB ColumnStore Cluster Test Tool
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/columnstore-troubleshooting/">
                        ↑ ColumnStore Troubleshooting ↑
                    </a>
                    </li>
                
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="5600" data-comments-url="/kb/en/system-troubleshooting-mariadb-columnstore/+comments"
         data-reply-url="/kb/en/system-troubleshooting-mariadb-columnstore/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/columnstore-troubleshooting/">
                    ↑ ColumnStore Troubleshooting ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/mariadb-columnstore-cluster-test-tool/">
                            <span class="pull-right not_primary"></span>
                            MariaDB ColumnStore Cluster Test Tool
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>System Troubleshooting MariaDB ColumnStore</span>
                        
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>