<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>MaxScale 24.08 Beta  KafkaCDC - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="MaxScale 24.08 Beta  KafkaCDC" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="KafkaCDC


KafkaCDC
Overview
Configuration
Parameters
bootstrap_servers
topic
enable_idempotence
timeout
gtid
server_id
match
exclude
cooperative_replication
send_schema
kafka..." />

    <meta name="description" content="KafkaCDC


KafkaCDC
Overview
Configuration
Parameters
bootstrap_servers
topic
enable_idempotence
timeout
gtid
server_id
match
exclude
cooperative_replication
send_schema
kafka..." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/maxscale/">MariaDB MaxScale</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-maxscale-24-08-beta/">MariaDB MaxScale 24.08 Beta</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-maxscale-24-08-beta-routers/">MaxScale 24.08 Beta Routers</a>
    


    » <a class="node_link crumb" href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/">MaxScale 24.08 Beta  KafkaCDC</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+flag"
                data-flag-url="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2024-08-29 22:08">3 weeks, 3 days ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2024-08-29 22:08">3 weeks, 3 days ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
        <dt>Source</dt>
        <dd><a href="https://github.com/mariadb-corporation/MaxScale/blob/24.08.0/Documentation/Routers/KafkaCDC.md">GitHub</a></dd>
        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>MaxScale 24.08 Beta  KafkaCDC</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <h1 id="kafkacdc">KafkaCDC</h1>
<div>
<ul>
<li><a href="#kafkacdc">KafkaCDC</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#parameters">Parameters</a><ul>
<li><a href="#bootstrap_servers">bootstrap_servers</a></li>
<li><a href="#topic">topic</a></li>
<li><a href="#enable_idempotence">enable_idempotence</a></li>
<li><a href="#timeout">timeout</a></li>
<li><a href="#gtid">gtid</a></li>
<li><a href="#server_id">server_id</a></li>
<li><a href="#match">match</a></li>
<li><a href="#exclude">exclude</a></li>
<li><a href="#cooperative_replication">cooperative_replication</a></li>
<li><a href="#send_schema">send_schema</a></li>
<li><a href="#kafka_ssl">kafka_ssl</a></li>
<li><a href="#kafka_ssl_ca">kafka_ssl_ca</a></li>
<li><a href="#kafka_ssl_cert">kafka_ssl_cert</a></li>
<li><a href="#kafka_ssl_key">kafka_ssl_key</a></li>
<li><a href="#kafka_sasl_user">kafka_sasl_user</a></li>
<li><a href="#kafka_sasl_password">kafka_sasl_password</a></li>
<li><a href="#kafka_sasl_mechanism">kafka_sasl_mechanism</a></li>
</ul>
</li>
<li><a href="#example-configuration">Example Configuration</a></li>
<li><a href="#limitations">Limitations</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="overview">Overview</h2>
<p>The KafkaCDC module reads data changes in MariaDB via replication and converts
them into JSON objects that are then streamed to a Kafka broker.</p>
<p>DDL events (<code>CREATE TABLE</code>, <code>ALTER TABLE</code>) are streamed as JSON objects in the
following format (example created by <code>CREATE TABLE test.t1(id INT)</code>):</p>
<div><pre><span></span><span>{</span>
  <span>"namespace"</span><span>:</span> <span>"MaxScaleChangeDataSchema.avro"</span><span>,</span>
  <span>"type"</span><span>:</span> <span>"record"</span><span>,</span>
  <span>"name"</span><span>:</span> <span>"ChangeRecord"</span><span>,</span>
  <span>"table"</span><span>:</span> <span>"t2"</span><span>,</span>              <span>// name of the table</span>
  <span>"database"</span><span>:</span> <span>"test"</span><span>,</span>         <span>// the database the table is in</span>
  <span>"version"</span><span>:</span> <span>1</span><span>,</span>               <span>// schema version, incremented when the table format changes</span>
  <span>"gtid"</span><span>:</span> <span>"0-3000-14"</span><span>,</span>        <span>// GTID that created the current version of the table</span>
  <span>"fields"</span><span>:</span> <span>[</span>
    <span>{</span>
      <span>"name"</span><span>:</span> <span>"domain"</span><span>,</span>       <span>// First part of the GTID</span>
      <span>"type"</span><span>:</span> <span>"int"</span>
    <span>},</span>
    <span>{</span>
      <span>"name"</span><span>:</span> <span>"server_id"</span><span>,</span>    <span>// Second part of the GTID</span>
      <span>"type"</span><span>:</span> <span>"int"</span>
    <span>},</span>
    <span>{</span>
      <span>"name"</span><span>:</span> <span>"sequence"</span><span>,</span>     <span>// Third part of the GTID</span>
      <span>"type"</span><span>:</span> <span>"int"</span>
    <span>},</span>
    <span>{</span>
      <span>"name"</span><span>:</span> <span>"event_number"</span><span>,</span> <span>// Sequence number of the event inside the GTID</span>
      <span>"type"</span><span>:</span> <span>"int"</span>
    <span>},</span>
    <span>{</span>
      <span>"name"</span><span>:</span> <span>"timestamp"</span><span>,</span>    <span>// UNIX timestamp when the event was created</span>
      <span>"type"</span><span>:</span> <span>"int"</span>
    <span>},</span>
    <span>{</span>
      <span>"name"</span><span>:</span> <span>"event_type"</span><span>,</span>   <span>// Event type</span>
      <span>"type"</span><span>:</span> <span>{</span>
        <span>"type"</span><span>:</span> <span>"enum"</span><span>,</span>
        <span>"name"</span><span>:</span> <span>"EVENT_TYPES"</span><span>,</span>
        <span>"symbols"</span><span>:</span> <span>[</span>
          <span>"insert"</span><span>,</span>           <span>// The row that was inserted</span>
          <span>"update_before"</span><span>,</span>    <span>// The row before it was updated</span>
          <span>"update_after"</span><span>,</span>     <span>// The row after it was updated</span>
          <span>"delete"</span>            <span>// The row that was deleted</span>
        <span>]</span>
      <span>}</span>
    <span>},</span>
    <span>{</span>
      <span>"name"</span><span>:</span> <span>"id"</span><span>,</span>           <span>// Field name</span>
      <span>"type"</span><span>:</span> <span>[</span>
        <span>"null"</span><span>,</span>
        <span>"long"</span>
      <span>],</span>
      <span>"real_type"</span><span>:</span> <span>"int"</span><span>,</span>     <span>// Field type</span>
      <span>"length"</span><span>:</span> <span>-</span><span>1</span><span>,</span>           <span>// Field length, if found</span>
      <span>"unsigned"</span><span>:</span> <span>false</span>       <span>// Whether the field is unsigned</span>
    <span>}</span>
  <span>]</span>
<span>}</span>
</pre></div>


<p>The <code>domain</code>, <code>server_id</code> and <code>sequence</code> fields contain the GTID that this event
belongs to. The <code>event_number</code> field is the sequence number of events inside the
transaction starting from 1. The <code>timestamp</code> field is the UNIX timestamp when
the event occurred. The <code>event_type</code> field contains the type of the event, one
of:</p>
<ul>
<li><code>insert</code>: the event is the data that was added to MariaDB</li>
<li><code>delete</code>: the event is the data that was removed from MariaDB</li>
<li><code>update_before</code>: the event contains the data before an update statement modified it</li>
<li><code>update_after</code>: the event contains the data after an update statement modified it</li>
</ul>
<p>All remaining fields contains data from the table. In the example event this
would be the fields <code>id</code> and <code>data</code>.</p>
<p>The sending of these schema objects is optional and can be disabled using
<code>send_schema=false</code>.</p>
<p>DML events (<code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>) are streamed as JSON objects that
follow the format specified in the DDL event. The objects are in the following
format (example created by <code>INSERT INTO test.t1 VALUES (1)</code>):</p>
<div><pre><span></span><span>{</span>
  <span>"domain"</span><span>:</span> <span>0</span><span>,</span>
  <span>"server_id"</span><span>:</span> <span>3000</span><span>,</span>
  <span>"sequence"</span><span>:</span> <span>20</span><span>,</span>
  <span>"event_number"</span><span>:</span> <span>1</span><span>,</span>
  <span>"timestamp"</span><span>:</span> <span>1580485945</span><span>,</span>
  <span>"event_type"</span><span>:</span> <span>"insert"</span><span>,</span>
  <span>"id"</span><span>:</span> <span>1</span><span>,</span>
  <span>"table_name"</span><span>:</span> <span>"t2"</span><span>,</span>
  <span>"table_schema"</span><span>:</span> <span>"test"</span>
<span>}</span>
</pre></div>


<p>The <code>table_name</code> and <code>table_schema</code> fields were added in MaxScale 2.5.3. These
contain the table name and schema the event targets.</p>
<p>The router stores table metadata in the MaxScale data directory. The
default value is <code>/var/lib/maxscale/&lt;service name&gt;</code>. If data for a table
is replicated before a DDL event for it is replicated, the CREATE TABLE
will be queried from the primary server.</p>
<p>During shutdown, the Kafka event queue is flushed. This can take up to 60
seconds if the network is slow or there are network problems.</p>
<h2 id="configuration">Configuration</h2>
<p>The <code>servers</code> parameter defines the set of servers where the data is replicated
from. The replication will be done from the first primary server that is found.</p>
<p>The <code>user</code> and <code>password</code> of the service will be used to connect to the
primary. This user requires the REPLICATION SLAVE grant.</p>
<p>The KafkaCDC service must not be configured to use listeners. If a listener is
configured, all attempts to start a session will fail.</p>
<h2 id="parameters">Parameters</h2>
<h3 id="bootstrap_servers"><code>bootstrap_servers</code></h3>
<p>The list of Kafka brokers to use in <code>host:port</code> format. Multiple values
can be separated with commas. This is a mandatory parameter.</p>
<h3 id="topic"><code>topic</code></h3>
<p>The Kafka topic where the replicated events will be sent. This is a
mandatory parameter.</p>
<h3 id="enable_idempotence"><code>enable_idempotence</code></h3>
<p>Enable idempotent producer mode. This feature requires Kafka version 0.11 or
newer to work and is disabled by default.</p>
<p>When enabled, the Kafka producer enters a strict mode which avoids event
duplication due to broker outages or other network errors. In HA scenarios where
there are more than two MaxScale instances, event duplication can still happen
as there is no synchronization between the MaxScale instances.</p>
<p>The Kafka C library,
<a href="https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md">librdkafka</a>,
describes the parameter as follows:</p>
<blockquote>
<p>When set to true, the producer will ensure that messages are successfully
produced exactly once and in the original produce order. The following
configuration properties are adjusted automatically (if not modified by the
user) when idempotence is enabled: max.in.flight.requests.per.connection=5 (must
be less than or equal to 5), retries=INT32_MAX (must be greater than 0),
acks=all, queuing.strategy=fifo.</p>
</blockquote>
<h3 id="timeout"><code>timeout</code></h3>
<p>The connection and read timeout for the replication stream. The default
value is 10 seconds.</p>
<h3 id="gtid"><code>gtid</code></h3>
<p>The initial GTID position from where the replication is started. By default the
replication is started from the beginning. The value of this parameter is only
used if no previously replicated events with GTID positions can be retrieved
from Kafka.</p>
<p>Starting in MaxScale 24.02, the special values <code>newest</code> and <code>oldest</code> can be
used:</p>
<ul>
<li>
<p><code>newest</code> uses the current value of <code>@@gtid_binlog_pos</code> as the GTID where the
  replication is started from.</p>
</li>
<li>
<p><code>oldest</code> uses the oldest binlog that's available in <code>SHOW BINARY LOGS</code> and
  then extracting the oldest GTID from it with <code>SHOW BINLOG EVENTS</code>.</p>
</li>
</ul>
<p>Once the replication has started and a GTID position has been recorded, this
parameter will be ignored. To reset the recorded GTID position, delete the
<code>current_gtid.txt</code> file located in <code>/var/lib/maxscale/&lt;SERVICE&gt;/</code> where
<code>&lt;SERVICE&gt;</code> is the name of the KafkaCDC service.</p>
<h3 id="server_id"><code>server_id</code></h3>
<p>The
<a href="https://mariadb.com/kb/en/replication-and-binary-log-system-variables/#server_id">server_id</a>
used when replicating from the primary in direct replication mode. The default
value is 1234. This parameter was added in MaxScale 2.5.7.</p>
<h3 id="match"><code>match</code></h3>
<ul>
<li><strong>Type</strong>: <a href="/kb/en/maxscale-24-08-beta-mariadb-maxscale-configuration-guide/#regular-expressions">regex</a></li>
<li><strong>Mandatory</strong>: No</li>
<li><strong>Dynamic</strong>: Yes</li>
</ul>
<p>Only include data from tables that match this pattern.</p>
<p>For example, if configured with <code>match=accounts[.].*</code>, only data from the
<code>accounts</code> database is sent to Kafka.</p>
<p>The pattern is matched against the combined database and table name separated by
a period. This means that the event for the table <code>t1</code> in the <code>test</code> database
would appear as <code>test.t1</code>. The behavior is the same even if the database or the
table name contains a period. This means that an event for the <code>test.table</code>
table in the <code>my.data</code> database would appear as <code>my.data.test.table</code>.</p>
<p>Here is an example configuration that only sends events for tables from the
<code>db1</code> database. The <code>accounts</code> and <code>users</code> tables in the <code>db1</code> database are
filtered out using the <code>exclude</code> parameter.</p>
<div><pre><span></span>[Kafka-CDC]
type=service
router=kafkacdc
servers=server1
user=maxuser
password=maxpwd
bootstrap_servers=127.0.0.1:9092
topic=my-cdc-topic
match=db1[.]
exclude=db1[.](accounts|users)
</pre></div>


<h3 id="exclude"><code>exclude</code></h3>
<ul>
<li><strong>Type</strong>: <a href="/kb/en/maxscale-24-08-beta-mariadb-maxscale-configuration-guide/#regular-expressions">regex</a></li>
<li><strong>Mandatory</strong>: No</li>
<li><strong>Dynamic</strong>: Yes</li>
</ul>
<p>Exclude data from tables that match this pattern.</p>
<p>For example, if configured with <code>exclude=mydb[.].*</code>, all data from the tables in
the <code>mydb</code> database is not sent to Kafka.</p>
<p>The pattern matching works the same way for both of the <code>exclude</code> and <code>match</code>
parameters. See <a href="#match"><code>match</code></a> for an explanation on how the patterns are
matched against the database and table names.</p>
<h3 id="cooperative_replication"><code>cooperative_replication</code></h3>
<p>Controls whether multiple instances cooperatively replicate from the same
cluster. This is a boolean parameter and is disabled by default. It was added in
MaxScale 6.0.</p>
<p>When this parameter is enabled and the monitor pointed to by the <code>cluster</code>
parameter supports cooperative monitoring (currently only <code>mariadbmon</code>), the
replication is only active if the monitor owns the cluster it is monitoring.</p>
<p>Whenever an instance that does not own the cluster gains ownership of the
cluster, the replication will continue from the latest GTID that was delivered
to Kafka.</p>
<p>This means that multiple MaxScale instances can replicate from the same set of
servers and the event is only processed once. This feature does not provide
exactly-once semantics for the Kafka event delivery. However, it does provide
high-availability for the <code>kafkacdc</code> instances which allows automated failover
between multiple MaxScale instances.</p>
<h3 id="send_schema"><code>send_schema</code></h3>
<ul>
<li><strong>Type</strong>: <a href="/kb/en/maxscale-24-08-beta-mariadb-maxscale-configuration-guide/#booleans">boolean</a></li>
<li><strong>Mandatory</strong>: No</li>
<li><strong>Dynamic</strong>: Yes</li>
<li><strong>Default</strong>: true</li>
</ul>
<p>Send JSON schema object into the stream whenever the table schema changes. These
events, as described <a href="#overview">here</a>, can be used to detect whenever the
format of the data being sent changes.</p>
<p>If this information in these schema change events is not needed or the code that
processes the Kafka stream can't handle them, they can be disabled with this
parameter.</p>
<h3 id="kafka_ssl"><code>kafka_ssl</code></h3>
<p>Enable SSL for Kafka connections. This is a boolean parameter and is disabled by
default.</p>
<h3 id="kafka_ssl_ca"><code>kafka_ssl_ca</code></h3>
<p>Path to the certificate authority file in PEM format. If this is not provided,
the default system certificates will be used.</p>
<h3 id="kafka_ssl_cert"><code>kafka_ssl_cert</code></h3>
<p>Path to the public certificate in PEM format.</p>
<p>The client must provide a certificate if the Kafka server performs authentication
of the client certificates. This feature is enabled by default in Kafka and is
controlled by
<a href="https://kafka.apache.org/documentation/#brokerconfigs_ssl.endpoint.identification.algorithm"><code>ssl.endpoint.identification.algorithm</code></a>.</p>
<p>If <code>kafka_ssl_cert</code> is provided, <code>kafka_ssl_key</code> must also be provided.</p>
<h3 id="kafka_ssl_key"><code>kafka_ssl_key</code></h3>
<p>Path to the private key in PEM format.</p>
<p>If <code>kafka_ssl_key</code> is provided, <code>kafka_ssl_cert</code> must also be provided.</p>
<h3 id="kafka_sasl_user"><code>kafka_sasl_user</code></h3>
<p>Username for SASL authentication.</p>
<p>If <code>kafka_sasl_user</code> is provided, <code>kafka_sasl_password</code> must also be provided.</p>
<h3 id="kafka_sasl_password"><code>kafka_sasl_password</code></h3>
<p>Password for SASL authentication.</p>
<p>If <code>kafka_sasl_password</code> is provided, <code>kafka_sasl_user</code> must also be provided.</p>
<h3 id="kafka_sasl_mechanism"><code>kafka_sasl_mechanism</code></h3>
<p>The SASL mechanism used. The default value is <code>PLAIN</code> which uses plaintext
authentication. It is recommended to enable SSL whenever plaintext
authentication is used.</p>
<p>Allowed values are:</p>
<ul>
<li><code>PLAIN</code></li>
<li><code>SCRAM-SHA-256</code></li>
<li><code>SCRAM-SHA-512</code></li>
</ul>
<p>The value that should be used depends on the SASL mechanism used by the
Kafka broker.</p>
<h2 id="example-configuration">Example Configuration</h2>
<p>The following configuration defines the minimal setup for streaming replication
events from MariaDB into Kafka as JSON:</p>
<div><pre><span></span># The server we're replicating from
[server1]
type=server
address=127.0.0.1
port=3306
protocol=MariaDBBackend

# The monitor for the server
[MariaDB-Monitor]
type=monitor
module=mariadbmon
servers=server1
user=maxuser
password=maxpwd
monitor_interval=5s

# The MariaDB-to-Kafka CDC service
[Kafka-CDC]
type=service
router=kafkacdc
servers=server1
user=maxuser
password=maxpwd
bootstrap_servers=127.0.0.1:9092
topic=my-cdc-topic
</pre></div>


<h2 id="limitations">Limitations</h2>
<ul>
<li>The KafkaCDC module provides at-least-once semantics for the generated
  events. This means that each replication event is delivered to kafka at least
  once but there can be duplicate events in case of failures.</li>
</ul>
    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-hintrouter/">
                        ← MaxScale 24.08 Beta  HintRouter
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/maxscale-24-08-beta-routers/">
                        ↑ MaxScale 24.08 Beta Routers ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkaimporter/">
                        MaxScale 24.08 Beta  KafkaImporter →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="15063" data-comments-url="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/+comments"
         data-reply-url="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkacdc/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/maxscale-24-08-beta-routers/">
                    ↑ MaxScale 24.08 Beta Routers ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-binlogrouter/">
                            
                            MaxScale 24.08 Beta   Binlogrouter
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-avrorouter/">
                            
                            MaxScale 24.08 Beta  Avrorouter
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-cat/">
                            
                            MaxScale 24.08 Beta  Cat
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-diff-router-for-comparing-servers/">
                            
                            MaxScale 24.08 Beta  Diff - router for comparing servers
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-hintrouter/">
                            
                            MaxScale 24.08 Beta  HintRouter
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>MaxScale 24.08 Beta  KafkaCDC</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-kafkaimporter/">
                            
                            MaxScale 24.08 Beta  KafkaImporter
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-mirror/">
                            
                            MaxScale 24.08 Beta  Mirror
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-readconnroute/">
                            
                            MaxScale 24.08 Beta  Readconnroute
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-readwritesplit/">
                            
                            MaxScale 24.08 Beta  Readwritesplit
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-schemarouter/">
                            
                            MaxScale 24.08 Beta  SchemaRouter
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2408-maxscale-2408-beta-smartrouter/">
                            
                            MaxScale 24.08 Beta  SmartRouter
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>