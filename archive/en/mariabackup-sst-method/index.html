<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>mariabackup SST Method - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="mariabackup SST Method" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariabackup-sst-method/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="The mariabackup SST method uses the Mariabackup utility for performing SSTs." />

    <meta name="description" content="The mariabackup SST method uses the Mariabackup utility for performing SSTs." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariabackup-sst-method/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariabackup-sst-method/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/replication-cluster-multi-master/">High Availability &amp; Performance Tuning</a>
    

    
    » <a class="crumb" href="/kb/en/galera-cluster/">MariaDB Galera Cluster</a>
    

    
    » <a class="crumb" href="/kb/en/state-snapshot-transfers-ssts-in-galera-cluster/">State Snapshot Transfers (SSTs) in Galera Cluster</a>
    


    » <a class="node_link crumb" href="/kb/en/mariabackup-sst-method/">mariabackup SST Method</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariabackup-sst-method/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariabackup-sst-method/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/mariabackup-sst-method/+flag"
                data-flag-url="/kb/en/mariabackup-sst-method/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariabackup-sst-method/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2018-12-21 00:56">6 years ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2024-05-03 02:13">8 months, 2 weeks ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/mariabackup-sst-method/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/mariabackup-sst-method/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/mariabackup-sst-method/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/mariabackup-sst-method/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    



    
    

<div class="well well-small box"><div><h5>Product Versions</h5></div><div>

        <ul id="product_chooser">
            
                <li class="mariadb_from_10_3_13">
                    <label><input type="checkbox" data-product-class="mariadb_from_10_3_13"
                            >MariaDB starting with 10.3.13</label>
                </li>
            
                <li class="mariadb_to_10_3_13">
                    <label><input type="checkbox" data-product-class="mariadb_to_10_3_13"
                            >MariaDB until 10.3.13</label>
                </li>
            
                <li class="mariadb_from_10_3_13">
                    <label><input type="checkbox" data-product-class="mariadb_from_10_3_13"
                            >MariaDB starting with 10.3.13</label>
                </li>
            
                <li class="mariadb_to_10_3_13">
                    <label><input type="checkbox" data-product-class="mariadb_to_10_3_13"
                            >MariaDB until 10.3.13</label>
                </li>
            
        </ul>
    
</div>
</div>





    

<div class="well well-small box"><div><h5>Parents</h5></div><div>

        <ul>
            
                <li><a href="/kb/en/state-snapshot-transfers-ssts-in-galera-cluster/">State Snapshot Transfers (SSTs) in Galera Cluster</a></li>
            
                <li><a href="/kb/en/mariadb-backup/">Mariabackup</a></li>
            
        </ul>
    
</div>
</div>



</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>mariabackup SST Method</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <p>The <code>mariabackup</code> SST method uses the <a href="/kb/en/backup-restore-and-import-clients-mariadb-backup/">Mariabackup</a> utility for performing SSTs. It is one of the methods that does not block the donor node. <a href="/kb/en/backup-restore-and-import-clients-mariadb-backup/">Mariabackup</a> was originally forked from <a href="/kb/en/backup-restore-and-import-clients-percona-xtrabackup/">Percona XtraBackup</a>, and similarly, the <code>mariabackup</code> SST method was originally forked from the <code><a href="/kb/en/xtrabackup-v2-sst-method/">xtrabackup-v2</a></code> SST method.</p>
<p>Note that if you use the <code>mariabackup</code> SST method, then you also need to have <code><a href="#socat-dependency">socat</a></code> installed on the server. This is needed to stream the backup from the donor node to the joiner node. This is a limitation that was inherited from the <code><a href="/kb/en/xtrabackup-v2-sst-method/">xtrabackup-v2</a></code> SST method.</p>
<div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#choosing-mariabackup-for-ssts" title="Choosing Mariabackup for SSTs">Choosing Mariabackup for SSTs</a></li>

    <li class=""><a href="#major-version-upgrades" title="Major version upgrades">Major version upgrades</a></li>

    <li class=""><a href="#authentication-and-privileges" title="Authentication and Privileges">Authentication and Privileges</a>    <ol class="toc">

        <li class=""><a href="#passwordless-authentication-unix-socket" title="Passwordless Authentication - Unix Socket">Passwordless Authentication - Unix Socket</a></li>

        <li class=""><a href="#passwordless-authentication-gssapi" title="Passwordless Authentication - GSSAPI">Passwordless Authentication - GSSAPI</a>    </ol>
</li>

    <li class=""><a href="#choosing-a-donor-node" title="Choosing a Donor Node">Choosing a Donor Node</a></li>

    <li class=""><a href="#socat-dependency" title="Socat Dependency">Socat Dependency</a>    <ol class="toc">

        <li class=""><a href="#installing-socat-on-rhelcentos" title="Installing Socat on RHEL/CentOS">Installing Socat on RHEL/CentOS</a>    </ol>
</li>

    <li class=""><a href="#tls" title="TLS">TLS</a>    <ol class="toc">

        <li class=""><a href="#tls-using-openssl-encryption-built-into-socat" title="TLS Using OpenSSL Encryption Built into Socat">TLS Using OpenSSL Encryption Built into Socat</a></li>

        <li class=""><a href="#tls-using-openssl-encryption-with-galera-compatible-certificates-and-keys" title="TLS Using OpenSSL Encryption with Galera-compatible Certificates and Keys">TLS Using OpenSSL Encryption with Galera-compatible Certificates and Keys</a>    </ol>
</li>

    <li class=""><a href="#logs" title="Logs">Logs</a>    <ol class="toc">

        <li class=""><a href="#logging-to-sst-logs" title="Logging to SST Logs">Logging to SST Logs</a></li>

        <li class=""><a href="#logging-to-syslog" title="Logging to Syslog">Logging to Syslog</a>    </ol>
</li>

    <li class=""><a href="#performing-ssts-with-ipv6-addresses" title="Performing SSTs with IPv6 Addresses">Performing SSTs with IPv6 Addresses</a></li>

    <li class=""><a href="#manual-sst-with-mariabackup" title="Manual SST with Mariabackup">Manual SST with Mariabackup</a></li>

    <li class=""><a href="#see-also" title="See Also">See Also</a> </ol>
</li>
</div>
<h2 class="anchored_heading" id="choosing-mariabackup-for-ssts">Choosing Mariabackup for SSTs</h2>
<p>To use the <code>mariabackup</code> SST method, you must set the <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_method">wsrep_sst_method=mariabackup</a></code> on both the donor and joiner node. It can be changed dynamically with <code><a href="/kb/en/set/#global-session">SET GLOBAL</a></code> on the node that you intend to be a SST donor. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">wsrep_sst_method</span><span class="o">=</span><span class="s1">&#39;mariabackup&#39;</span><span class="p">;</span>
</pre><p>It can be set in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up a node:</p>
<pre class="fixed"><span class="p">[</span><span class="n">mariadb</span><span class="p">]</span>
<span class="p">...</span>
<span class="n">wsrep_sst_method</span> <span class="o">=</span> <span class="n">mariabackup</span>
</pre><p>For an SST to work properly, the donor and joiner node must use the same SST method. Therefore, it is recommended to set <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_method">wsrep_sst_method</a></code> to the same value on all nodes, since any node will usually be a donor or joiner node at some point.</p>
<h2 class="anchored_heading" id="major-version-upgrades">Major version upgrades</h2>
<p>The InnoDB redo log format has been changed in <a href="/kb/en/what-is-mariadb-105/">MariaDB 10.5</a> and <a href="/kb/en/what-is-mariadb-108/">MariaDB 10.8</a> in a way that will not allow the crash recovery or the preparation of a backup from an older major version. Because of this, the <code>mariabackup</code> SST method cannot be used for some major version upgrades, unless you temporarily edit the <code>wsrep_sst_mariabackup</code> script so that the <code>--prepare</code> step on the newer-major-version joiner will be executed using the older-major-version <code>mariabackup</code> tool.</p>
<p>The default method <code>wsrep_sst_method=rsync</code> will work for major version upgrades; see <a href="https://jira.mariadb.org/browse/MDEV-27437">MDEV-27437</a>.</p>
<h2 class="anchored_heading" id="authentication-and-privileges">Authentication and Privileges</h2>
<p>To use the <code>mariabackup</code> SST method, <a href="/kb/en/backup-restore-and-import-clients-mariadb-backup/">Mariabackup</a> needs to be able to authenticate locally on the donor node, so that it can create a backup to stream to the joiner. You can tell the donor node what username and password to use by setting the <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_auth">wsrep_sst_auth</a></code> system variable. It can be changed dynamically with <code><a href="/kb/en/set/#global-session">SET GLOBAL</a></code> on the node that you intend to be a SST donor. For example:</p>
<pre class="fixed"><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">wsrep_sst_auth</span> <span class="o">=</span> <span class="s1">&#39;mariabackup:mypassword&#39;</span><span class="p">;</span>
</pre><p>It can also be set in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up a node:</p>
<pre class="fixed">[mariadb]
...
wsrep_sst_auth = mariabackup:mypassword
</pre><p>Some <a href="/kb/en/authentication-plugins/">authentication plugins</a> do not require a password. For example, the <code><a href="/kb/en/authentication-plugin-unix-socket/">unix_socket</a></code> and <code><a href="/kb/en/authentication-plugin-gssapi/">gssapi</a></code> authentication plugins do not require a password. If you are using a user account that does not require a password in order to log in, then you can just leave the password component of <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_auth">wsrep_sst_auth</a></code> empty. For example:</p>
<pre class="fixed">[mariadb]
...
wsrep_sst_auth = mariabackup:
</pre><p>The user account that performs the backup for the SST needs to have <a href="/kb/en/mariabackup-overview/#authentication-and-privileges">the same privileges as Mariabackup</a>, which are the <code>RELOAD</code> , <code>PROCESS</code>, <code>LOCK TABLES</code> and <code>BINLOG MONITOR</code> (or <code>REPLICATION CLIENT</code> for <a href="/kb/en/what-is-mariadb-104/">MariaDB 10.4</a> or earlier), <code>REPLICA MONITOR</code> (not required for <a href="/kb/en/what-is-mariadb-104/">MariaDB 10.4</a> or earlier) <a href="/kb/en/grant/#global-privileges">global privileges</a>. To be safe, you should ensure that these privileges are set on each node in your cluster.  <a href="/kb/en/backup-restore-and-import-clients-mariadb-backup/">Mariabackup</a> connects locally on the donor node to perform the backup, so the following user should be sufficient:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">&#39;mariabackup&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;mypassword&#39;</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="n">RELOAD</span><span class="p">,</span> <span class="n">PROCESS</span><span class="p">,</span> <span class="k">LOCK</span> <span class="n">TABLES</span><span class="p">,</span> <span class="n">BINLOG</span> <span class="n">MONITOR</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;mariabackup&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
</pre><h3 class="anchored_heading" id="passwordless-authentication-unix-socket">Passwordless Authentication - Unix Socket</h3>
<p>It is possible to use the <code><a href="/kb/en/authentication-plugin-unix-socket/">unix_socket</a></code> authentication plugin for the user account that performs SSTs. This would provide the benefit of not needing to configure a plain-text password in <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_auth">wsrep_sst_auth</a></code>.</p>
<p>The user account would have to have the same name as the operating system user account that is running the <code>mysqld</code> process. On many systems, this is the user account configured as the <code><a href="/kb/en/mysqld-options/#-user">user</a></code> option, and it tends to default to <code>mysql</code>.</p>
<p>For example, if the <code><a href="/kb/en/authentication-plugin-unix-socket/">unix_socket</a></code> authentication plugin is already installed, then you could execute the following to create the user account:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">&#39;mysql&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">IDENTIFIED</span> <span class="n">VIA</span> <span class="n">unix_socket</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="n">RELOAD</span><span class="p">,</span> <span class="n">PROCESS</span><span class="p">,</span> <span class="k">LOCK</span> <span class="n">TABLES</span><span class="p">,</span> <span class="n">REPLICATION</span> <span class="n">CLIENT</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;mysql&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
</pre><p>And then to configure <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_auth">wsrep_sst_auth</a></code>, you could set the following in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up a node:</p>
<pre class="fixed">[mariadb]
...
wsrep_sst_auth = mysql:
</pre><h3 class="anchored_heading" id="passwordless-authentication-gssapi">Passwordless Authentication - GSSAPI</h3>
<p>It is possible to use the <code><a href="/kb/en/authentication-plugin-gssapi/">gssapi</a></code> authentication plugin for the user account that performs SSTs. This would provide the benefit of not needing to configure a plain-text password in <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_auth">wsrep_sst_auth</a></code>.</p>
<p>The following steps would need to be done beforehand:</p>
<ul start="1"><li>You need a KDC running <a href="http://web.mit.edu/Kerberos/krb5-1.12/doc/index.html">MIT Kerberos</a> or <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview">Microsoft Active Directory</a>.
</li><li>You will need to <a href="/kb/en/authentication-plugin-gssapi/#creating-a-keytab-file-on-a-unix-server">create a keytab file</a> for the MariaDB server.
</li><li>You will need to <a href="/kb/en/authentication-plugin-gssapi/#installing-the-plugins-package">install the package</a> containing the <code><a href="/kb/en/authentication-plugin-gssapi/">gssapi</a></code> authentication plugin.
</li><li>You will need to <a href="/kb/en/authentication-plugin-gssapi/#installing-the-plugin">install the plugin</a> in MariaDB, so that the <code><a href="/kb/en/authentication-plugin-gssapi/">gssapi</a></code> authentication plugin is available to use.
</li><li>You will need to <a href="/kb/en/authentication-plugin-gssapi/#configuring-the-plugin">configure the plugin</a>.
</li><li>You will need to <a href="/kb/en/authentication-plugin-gssapi/#creating-users">create a user account</a> that authenticates with the <code><a href="/kb/en/authentication-plugin-gssapi/">gssapi</a></code> authentication plugin, so that the user account can be used for SSTs. This user account will need to correspond with a user account that exists on the backend KDC.
</li></ul>
<p>For example, you could execute the following to create the user account in MariaDB:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">&#39;mariabackup&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">IDENTIFIED</span> <span class="n">VIA</span> <span class="n">gssapi</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="n">RELOAD</span><span class="p">,</span> <span class="n">PROCESS</span><span class="p">,</span> <span class="k">LOCK</span> <span class="n">TABLES</span><span class="p">,</span> <span class="n">BINLOG</span> <span class="n">MONITOR</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;mariabackup&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
</pre><p>And then to configure <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_auth">wsrep_sst_auth</a></code>, you could set the following in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up a node:</p>
<pre class="fixed">[mariadb]
...
wsrep_sst_auth = mariabackup:
</pre><h2 class="anchored_heading" id="choosing-a-donor-node">Choosing a Donor Node</h2>
<p>When Mariabackup is used to create the backup for the SST on the donor node, Mariabackup briefly requires a system-wide lock at the end of the backup. In <a href="/kb/en/what-is-mariadb-103/">MariaDB 10.3</a> and before, this is done with <code><a href="/kb/en/flush/">FLUSH TABLES WITH READ LOCK</a></code>. In <a href="/kb/en/what-is-mariadb-104/">MariaDB 10.4</a> and later, this is done with <code><a href="/kb/en/backup-stage/">BACKUP STAGE BLOCK_COMMIT</a></code>.</p>
<p>If a specific node in your cluster is acting as the <em>primary</em> node by receiving all of the application's write traffic, then this node should not usually be used as the donor node, because the system-wide lock could interfere with the application. In this case, you can define one or more preferred donor nodes by setting the <code><a href="/kb/en/galera-cluster-system-variables/#wsrep_sst_donor">wsrep_sst_donor</a></code> system variable.</p>
<p>For example, let's say that we have a 5-node cluster with the nodes <code>node1</code>, <code>node2</code>,  <code>node3</code>, <code>node4</code>, and <code>node5</code>, and let's say that <code>node1</code> is acting as the <em>primary</em> node. The preferred donor nodes for <code>node2</code> could be configured by setting the following in a server <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a> prior to starting up a node:</p>
<pre class="fixed">[mariadb]
...
wsrep_sst_donor=node3,node4,node5,
</pre><p>The trailing comma tells the server to allow any other node as donor when the preferred donors are not available. Therefore, if <code>node1</code> is the only node left in the cluster, the trailing comma allows it to be used as the donor node.</p>
<h2 class="anchored_heading" id="socat-dependency">Socat Dependency</h2>
<p>During the SST process, the donor node uses <a href="http://www.dest-unreach.org/socat/doc/socat.html">socat</a> to stream the backup to the joiner node.  Then the joiner node prepares the backup before restoring it. The socat utility must be installed on both the donor node and the joiner node in order for this to work. Otherwise, the MariaDB error log will contain an error like:</p>
<pre class="fixed wrap">WSREP_SST: [ERROR] socat not found in path: /usr/sbin:/sbin:/usr//bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin (20180122 14:55:32.993)
</pre><h3 class="anchored_heading" id="installing-socat-on-rhelcentos">Installing Socat on RHEL/CentOS</h3>
<p>On RHEL/CentOS, <code>socat</code> can be installed from the <a href="https://fedoraproject.org/wiki/EPEL">Extra Packages for Enterprise Linux (EPEL)</a> repository.</p>
<h2 class="anchored_heading" id="tls">TLS</h2>
<p>This SST method supports two different TLS methods. The specific method can be selected by setting the <code>encrypt</code> option in the <code>[sst]</code> section of the MariaDB configuration file. The options are:</p>
<ul start="1"><li>TLS using OpenSSL encryption built into <code>socat</code> (<code>encrypt=2</code>)
</li><li>TLS using OpenSSL encryption with Galera-compatible certificates and keys (<code>encrypt=3</code>)
</li></ul>
<p>Note that <code>encrypt=1</code> refers to a TLS encryption method that has been deprecated and removed. <code>encrypt=4</code> refers to a TLS encryption method in <code>xtrabackup-v2</code> that has not yet been ported to <code>mariabackup</code>. See <a href="https://jira.mariadb.org/browse/MDEV-18050">MDEV-18050</a> about that.</p>
<h3 class="anchored_heading" id="tls-using-openssl-encryption-built-into-socat">TLS Using OpenSSL Encryption Built into Socat</h3>
<p>To generate keys compatible with this encryption method, you can follow <a href="http://www.dest-unreach.org/socat/doc/socat-openssltunnel.html">these directions</a>.</p>
<p>For example:</p>
<ul start="1"><li>First, generate the keys and certificates:
</li></ul>
<pre class="fixed">FILENAME=sst
openssl genrsa -out $FILENAME.key 1024
openssl req -new -key $FILENAME.key -x509 -days 3653 -out $FILENAME.crt
cat $FILENAME.key $FILENAME.crt &gt;$FILENAME.pem
chmod 600 $FILENAME.key $FILENAME.pem
</pre><ul start="1"><li>On some systems, you may also have to add dhparams to the certificate:
</li></ul>
<pre class="fixed">openssl dhparam -out dhparams.pem 2048
cat dhparams.pem &gt;&gt; sst.pem
</pre><ul start="1"><li>Then, copy the certificate and keys to all nodes in the cluster.
</li></ul>
<ul start="1"><li>Then, configure the following on all nodes in the cluster:
</li></ul>
<pre class="fixed">[sst]
encrypt=2
tca=/etc/my.cnf.d/certificates/sst.crt
tcert=/etc/my.cnf.d/certificates/sst.pem
</pre><p>But replace the paths with whatever is relevant on your system.</p>
<p>This should allow your SSTs to be encrypted.</p>
<h3 class="anchored_heading" id="tls-using-openssl-encryption-with-galera-compatible-certificates-and-keys">TLS Using OpenSSL Encryption with Galera-compatible Certificates and Keys</h3>
<p>To generate keys compatible with this encryption method, you can follow <a href="https://galeracluster.com/library/documentation/ssl-cert.html">these directions</a>.</p>
<p>For example:</p>
<ul start="1"><li>First, generate the keys and certificates:
</li></ul>
<pre class="fixed"># CA
openssl genrsa 2048 &gt; ca-key.pem
openssl req -new -x509 -nodes -days 365000 \
-key ca-key.pem -out ca-cert.pem
 
# server1
openssl req -newkey rsa:2048 -days 365000 \
-nodes -keyout server1-key.pem -out server1-req.pem
openssl rsa -in server1-key.pem -out server1-key.pem
openssl x509 -req -in server1-req.pem -days 365000 \
-CA ca-cert.pem -CAkey ca-key.pem -set_serial 01 \
-out server1-cert.pem
</pre><ul start="1"><li>Then, copy the certificate and keys to all nodes in the cluster.
</li></ul>
<ul start="1"><li>Then, configure the following on all nodes in the cluster:
</li></ul>
<pre class="fixed">[sst]
encrypt=3
tkey=/etc/my.cnf.d/certificates/server1-key.pem
tcert=/etc/my.cnf.d/certificates/server1-cert.pem
</pre><p>But replace the paths with whatever is relevant on your system.</p>
<p>This should allow your SSTs to be encrypted.</p>
<h2 class="anchored_heading" id="logs">Logs</h2>
<p>The <code>mariabackup</code> SST method has its own logging outside of the MariaDB Server logging.</p>
<h3 class="anchored_heading" id="logging-to-sst-logs">Logging to SST Logs</h3>
<div class="mariadb_from_10_3_13 mariadb from_10_3_13 product"><h5 class="product_title">MariaDB starting with <a href="/kb/en/mariadb-10313-release-notes/">10.3.13</a></h5><p>Starting with <a href="/kb/en/mariadb-10138-release-notes/">MariaDB 10.1.38</a>, <a href="/kb/en/mariadb-10222-release-notes/">MariaDB 10.2.22</a>, and <a href="/kb/en/mariadb-10313-release-notes/">MariaDB 10.3.13</a>, logging for <code>mariabackup</code> SSTs works the following way.</p>
<p>By default, on the donor node, it logs to <code>mariabackup.backup.log</code>. This log file is located in the <code><a href="/kb/en/server-system-variables/#datadir">datadir</a></code>.</p>
<p>By default, on the joiner node, it logs to <code>mariabackup.prepare.log</code> and <code>mariabackup.move.log</code> These log files are also located in the <code><a href="/kb/en/server-system-variables/#datadir">datadir</a></code>.</p>
<p>By default, before a new SST is started, existing <code>mariabackup</code> SST log files are compressed and moved to <code>/tmp/sst_log_archive</code>. This behavior can be disabled by setting <code>sst-log-archive=0</code> in the <code>[sst]</code> <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a>. Similarly, the archive directory can be changed by setting <code>sst-log-archive-dir</code>. For example:</p>
<pre class="fixed">[sst]
sst-log-archive=1
sst-log-archive-dir=/var/log/mysql/sst/
</pre><p>See <a href="https://jira.mariadb.org/browse/MDEV-17973">MDEV-17973</a> for more information.</p>
</div><div class="mariadb_to_10_3_13 mariadb to_10_3_13 product"><h5 class="product_title">MariaDB until <a href="/kb/en/mariadb-10313-release-notes/">10.3.13</a></h5><p>Prior to <a href="/kb/en/mariadb-10138-release-notes/">MariaDB 10.1.38</a>, <a href="/kb/en/mariadb-10222-release-notes/">MariaDB 10.2.22</a>, and <a href="/kb/en/mariadb-10313-release-notes/">MariaDB 10.3.13</a>, logging for <code>mariabackup</code> SSTs works the following way.</p>
<p>By default, on the donor node, it logs to <code>innobackup.backup.log</code>. This log file is located in the <code><a href="/kb/en/server-system-variables/#datadir">datadir</a></code>.</p>
<p>By default, on the joiner node, it logs to <code>innobackup.prepare.log</code> and <code>innobackup.move.log</code>. These log files are located in the <code>.sst</code> directory, which is a hidden directory inside the <code><a href="/kb/en/server-system-variables/#datadir">datadir</a></code>.</p>
<p>These log files are overwritten by each subsequent SST, so if an SST fails, it is best to copy them somewhere safe before starting another SST, so that the log files can be analyzed. </p>
</div><h3 class="anchored_heading" id="logging-to-syslog">Logging to Syslog</h3>
<p>You can redirect the SST logs to the syslog instead by setting the following in the <code>[sst]</code> <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a>:</p>
<pre class="fixed">[sst]
sst-syslog=1
</pre><p>You can also redirect the SST logs to the syslog by setting the following in the <code>[mysqld_safe]</code> <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a>:</p>
<pre class="fixed">[mysqld_safe]
syslog
</pre><h2 class="anchored_heading" id="performing-ssts-with-ipv6-addresses">Performing SSTs with IPv6 Addresses</h2>
<p>If you are performing Mariabackup SSTs with IPv6 addresses, then the <code>socat</code> utility needs to be passed the <code>pf=ip6</code> option. This can be done by setting the <code>sockopt</code> option in the <code>[sst]</code> <a href="/kb/en/configuring-mariadb-with-option-files/#option-groups">option group</a> in an <a href="/kb/en/configuring-mariadb-with-option-files/">option file</a>. For example:</p>
<pre class="fixed">[sst]
sockopt=&#34;,pf=ip6&#34;
</pre><p>See <a href="https://jira.mariadb.org/browse/MDEV-18797">MDEV-18797</a> for more information.</p>
<h2 class="anchored_heading" id="manual-sst-with-mariabackup">Manual SST with Mariabackup</h2>
<p>In some cases, if Galera Cluster's automatic SSTs repeatedly fail, then it can be helpful to perform a "manual SST". See the following page on how to do that:</p>
<ul start="1"><li><a href="/kb/en/manual-sst-of-galera-cluster-node-with-mariabackup/">Manual SST of Galera Cluster node with Mariabackup</a>
</li></ul>
<h2 class="anchored_heading" id="see-also">See Also</h2>
<ul start="1"><li><a href="https://www.percona.com/doc/percona-xtradb-cluster/5.7/manual/xtrabackup_sst.html">Percona XtraBackup SST Configuration</a>
</li><li><a href="https://www.percona.com/doc/percona-xtradb-cluster/5.7/security/encrypt-traffic.html#encrypt-sst">Encrypting PXC Traffic: 
ENCRYPTING SST TRAFFIC</a>
</li><li><a href="https://galeracluster.com/library/documentation/xtrabackup-options.html">XTRABACKUP PARAMETERS</a>
</li><li><a href="https://galeracluster.com/library/documentation/ssl-sst.html#ssl-xtrabackup">SSL FOR STATE SNAPSHOT TRANSFERS: ENABLING SSL FOR XTRABACKUP</a></li></ul>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/mariabackup-sst-method/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/mariabackup-sst-method/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/introduction-to-state-snapshot-transfers-ssts/">
                        ← Introduction to State Snapshot Transfers (SSTs)
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/state-snapshot-transfers-ssts-in-galera-cluster/">
                        ↑ State Snapshot Transfers (SSTs) in Galera Cluster ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/manual-sst-of-galera-cluster-node-with-mariabackup/">
                        Manual SST of Galera Cluster Node With Mariabackup →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="8281" data-comments-url="/kb/en/mariabackup-sst-method/+comments"
         data-reply-url="/kb/en/mariabackup-sst-method/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/state-snapshot-transfers-ssts-in-galera-cluster/">
                    ↑ State Snapshot Transfers (SSTs) in Galera Cluster ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/introduction-to-state-snapshot-transfers-ssts/">
                            
                            Introduction to State Snapshot Transfers (SSTs)
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>mariabackup SST Method</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/manual-sst-of-galera-cluster-node-with-mariabackup/">
                            
                            Manual SST of Galera Cluster Node With Mariabackup
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>