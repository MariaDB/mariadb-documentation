<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Using TLS/SSL with MariaDB Connector/J - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Using TLS/SSL with MariaDB Connector/J" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/using-tls-ssl-with-mariadb-java-connector/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="How to configure the MariaDB Java driver to support TLS/SSL" />

    <meta name="description" content="How to configure the MariaDB Java driver to support TLS/SSL" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/using-tls-ssl-with-mariadb-java-connector/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/using-tls-ssl-with-mariadb-java-connector/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/server-client-software/">Server &amp; Client Software</a>
    

    
    » <a class="crumb" href="/kb/en/client-libraries/">Client Libraries</a>
    

    
    » <a class="crumb" href="/kb/en/connectors/">Application Programming Interfaces</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-connector-j/">Java Connector</a>
    


    » <a class="node_link crumb" href="/kb/en/using-tls-ssl-with-mariadb-java-connector/">Using TLS/SSL with MariaDB Connector/J</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/using-tls-ssl-with-mariadb-java-connector/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/using-tls-ssl-with-mariadb-java-connector/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/using-tls-ssl-with-mariadb-java-connector/+flag"
                data-flag-url="/kb/en/using-tls-ssl-with-mariadb-java-connector/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/using-tls-ssl-with-mariadb-java-connector/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2017-05-11 14:26">6 years, 8 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2022-11-06 14:31">1 year, 3 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/using-tls-ssl-with-mariadb-java-connector/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/using-tls-ssl-with-mariadb-java-connector/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/using-tls-ssl-with-mariadb-java-connector/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/using-tls-ssl-with-mariadb-java-connector/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Using TLS/SSL with MariaDB Connector/J</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

 <li class=""><a href="#overview" title="Overview">Overview</a> <ol class="toc">

    <li class=""><a href="#server-configuration" title="Server configuration">Server configuration</a></li>

    <li class=""><a href="#tls-protocol-version-support" title="TLS Protocol Version Support">TLS Protocol Version Support</a></li>

    <li class=""><a href="#tls-protocol-version-selection" title="TLS Protocol Version Selection">TLS Protocol Version Selection</a></li>

    <li class=""><a href="#oracle-java-cryptographic-limitation" title="Oracle Java cryptographic limitation">Oracle Java cryptographic limitation</a> </ol>
</li>

 <li class=""><a href="#one-way-ssl-authentication" title="One way SSL authentication">One way SSL authentication</a> <ol class="toc">

    <li class=""><a href="#java-default-truststore" title="Java default truststore">Java default truststore</a></li>

    <li class=""><a href="#use-a-dedicated-truststore" title="Use a dedicated truststore">Use a dedicated truststore</a></li>

    <li class=""><a href="#provide-certificate-directly" title="Provide certificate directly">Provide certificate directly</a></li>

    <li class=""><a href="#handling-self-signed-certificates" title="Handling self-signed certificates">Handling self-signed certificates</a> </ol>
</li>

 <li class=""><a href="#mutual-2-way-authentication" title="Mutual (2-way) authentication">Mutual (2-way) authentication</a></li>

 <li class=""><a href="#troubleshooting" title="Troubleshooting">Troubleshooting</a> <ol class="toc">

    <li class=""><a href="#diffie-hellman-size-error" title="Diffie-Hellman size error">Diffie-Hellman size error</a></li>

    <li class=""><a href="#ssl-not-enabled-on-server" title="SSL not enabled on server">SSL not enabled on server</a></li>

    <li class=""><a href="#server-certificate-is-not-provided-to-client" title="Server certificate is not provided to client">Server certificate is not provided to client</a></li>

    <li class=""><a href="#javasqlsqlinvalidauthorizationspecexception-could-not-connect-access-denied-for-user" title="java.sql.SQLInvalidAuthorizationSpecException: Could not connect: Access denied for user">java.sql.SQLInvalidAuthorizationSpecException: Could not connect: Access denied for user</a> </ol>
</li>
</div>
<h1 class="anchored_heading" id="overview">Overview</h1>
<p>This document explains how to configure the MariaDB Java driver to support TLS/SSL. </p>
<p>Data can be encrypted during transfer using the Transport Layer Security (TLS) protocol. 
TLS/SSL permits transfer encryption, and optionally server and client identity validation.</p>
<div class="cstm-style bluebox"><p>The term SSL (Secure Sockets Layer) is often used interchangeably with TLS, although strictly-speaking the SSL protocol is the predecessor of TLS, and is not implemented as it is now considered insecure. </p>
</div><h2 class="anchored_heading" id="server-configuration">Server configuration</h2>
<p>To ensure that SSL is correctly configured on the server, the query "SELECT @@have_ssl;" must return YES. If not, please refer to the <a href="/kb/en/secure-connections/">server documentation</a>.</p>
<h2 class="anchored_heading" id="tls-protocol-version-support">TLS Protocol Version Support</h2>
<p>MariaDB Server can be built with different TLS and cryptography libraries that support different TLS protocol versions.</p>
<div class="cstm-style darkheader-nospace-borders centered"><table><tr><th>TLS Library</th><th>Supported TLS Protocol Versions</th></tr>
<tr><td>openSSL</td><td>TLSv1, TLSv1.1, TLSv1.2, TLSv1.3</td></tr>
<tr><td>wolfSSL</td><td>TLSv1, TLSv1.1, TLSv1.2, TLSv1.3</td></tr>
<tr><td>yaSSL</td><td>TLSv1, TLSv1.1</td></tr>
</table>
</div><p>See <a href="/kb/en/tls-and-cryptography-libraries-used-by-mariadb/">TLS and Cryptography Libraries Used by MariaDB</a> for information about which TLS libraries are used in each package.</p>
<p>See <a href="/kb/en/secure-connections-overview/#tls-protocol-version-support">Secure Connections Overview: TLS Protocol Version Support</a> for more information about which TLS protocol versions are supported by MariaDB Server.</p>
<h2 class="anchored_heading" id="tls-protocol-version-selection">TLS Protocol Version Selection</h2>
<p>During TLS/SSL negotiation, the client normally indicates the maximum level supported, but before 10.2, YaSSL doesn't recognize the TLSv1.2 flag and then doesn't fallback to theTLSv1.1 protocol.</p>
<p>If trying to connect with TLSv1.2 with a server before 10.2 using YaSSL, the connection will fail with the following exception :</p>
<ul start="1"><li>with MariaDB server : "Caused by: javax.net.ssl.SSLException: Unsupported record version Unknown-0.0"
</li><li>with MySQL server : "Caused by: javax.net.ssl.SSLHandshakeException: Remote host terminated the handshake"
</li></ul>
<p>The MariaDB Java driver by default uses java default supported protocols . 
If the servers are MariaDB on Unix or version &gt;= 10.2 , consider adding TLSv1.2 protocol.
This can be set using the "enabledSslProtocolSuites" option (example: enabledSslProtocolSuites=TLSv1,TLSv1.1,TLSv1.2).</p>
<p>In addition to the protocol, the driver relies on the Java default cipher list. 
The Java default enabled ciphers are <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/SunProviders.html#SupportedCipherSuites">listed here</a>.
JAVA allows cipher suites to be removed/excluded from use in the security policy using the Java system property "jdk.tls.disabledAlgorithms". 
The specific list of ciphers to be used can be set using the "enabledSslCipherSuites" driver option (example : "enabledSSLCipherSuites=TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,...")</p>
<h2 class="anchored_heading" id="oracle-java-cryptographic-limitation">Oracle Java cryptographic limitation</h2>
<p>Due to import regulations in some countries, the Java Oracle implementation provides a default cryptographic jurisdiction policy file that limits the strength of cryptographic algorithms. </p>
<p>Here are the maximum key sizes allowed by this "strong" version of the jurisdiction policy files:	</p>
<div class="cstm-style darkheader-nospace-borders centered"><table><tr><th>Algorithm</th><th>Maximum Keysize</th></tr>
<tr><td>DES</td><td>64</td></tr>
<tr><td>DESede</td><td>*</td></tr>
<tr><td>RC2</td><td>128</td></tr>
<tr><td>RC4</td><td>128</td></tr>
<tr><td>RC5</td><td>128</td></tr>
<tr><td>RSA</td><td>*</td></tr>
</table>
</div><p>If stronger algorithms are needed (for example, AES with 256-bit keys), the JCE Unlimited Strength Jurisdiction Policy Files must be obtained and installed in the JDK/JRE to remove those limitation.</p>
<p>It is strongly recommended, if permissible under local regulations,  to have JCE installed.</p>
<h1 class="anchored_heading" id="one-way-ssl-authentication">One way SSL authentication</h1>
<p>By default, the driver can be configured to use SSL, even if the user used for authentication is not set to use SSL, but the recommendation is to use a user created with "REQUIRE SSL". See <a href="/kb/en/create-user/">CREATE USER</a> for more details.</p>
<p>Example;</p>
<pre class="fixed">CREATE USER 'myUser'@'%' IDENTIFIED BY 'MyPwd';
GRANT ALL ON db_name.* TO 'myUser'@'%' REQUIRE SSL;
</pre><p>The "useSSL" option must be enabled to indicate to the driver to connect using SSL.</p>
<p>Testing can be done with the trustServerCertificate=true option to validate encryption (NOT TO BE USED IN PRODUCTION!)</p>
<pre>
try (Connection con = DriverManager.getConnection("jdbc:mariadb://localhost/myDb?user=myUser&amp;password=MyPwd"
		+ "&amp;useSSL=true&amp;trustServerCertificate=true")) {
	try (Statement stmt = con.createStatement()) {
		stmt.execute("select 1");
	}
}
</pre>
<p>The connection will then be encrypted. </p>
<p>If the trustServerCertificate option is not set, an exception "unable to find valid certification path to requested target" will be thrown.
If the server doesn't support SSL, an exception "Trying to connect with ssl, but ssl not enabled in the server" will be thrown.</p>
<p>The Java system property "-Djavax.net.debug=all" permits logging all TLS exchanges.</p>
<p>To validate the server identity, server root certificates and intermediate certificates must be provided to the driver.
There are several ways to configure this:</p>
<ul start="1"><li>use the java default truststore in JKS format (or PKCS12 using java 9)
</li><li>use a dedicated truststore in JKS format (or PKCS12 using java 9)
</li><li>provide the certificate 
</li></ul>
<div class="cstm-style bluebox"><p>Java has a default truststore that contains well-known CAs including Let's Encrypt (since java 8u101), VeriSign, Entrust, and GTE CyberTrust.trusted Certificate Authorities (CA).</p>
<p>If the server certificate is signed using a certificate chain using a root CA known in java default truststore, no additional step is required. </p>
</div><p>Using self signed certificates has some specificities. </p>
<h2 class="anchored_heading" id="java-default-truststore">Java default truststore</h2>
<p>Java trustStore is a file that contains certificates of trusted SSL servers, or of Certificate Authorities trusted to identify servers. Truststore can be protected by a password. </p>
<p>The Java search order for locating the trust store is:</p>
<ol start="1"><li>system property "javax.net.ssl.trustStore"
</li><li>$JAVA_HOME/lib/security/jssecacerts 
</li><li>$JAVA_HOME/lib/security/cacerts (shipped by default)
</li></ol>
<p>To add a certificate from a CA not included in the truststore, locate the default truststore on your system. The default truststore is located in the $JAVA_HOME/jre/lib/security/cacerts.</p>
<pre>
//copy the java truststore to jssecacerts
cp $JAVA_HOME/jre/lib/security/cacerts $JAVA_HOME/jre/lib/security/jssecacerts
//add your certificat to truststore
keytool -importcert -file myCA-root.cer -alias myCA -keystore /usr/java/default/jre/lib/security/jssecacerts -storepass changeit
</pre>
<p>with our previous example, the "trustServerCertificate" option can then be removed</p>
<pre>
try (Connection con = DriverManager.getConnection("jdbc:mariadb://localhost/myDb?user=myUser&amp;password=MyPwd&amp;useSSL=true")) {
	try (Statement stmt = con.createStatement()) {
		stmt.execute("select 1");
	}
}
</pre>
<h2 class="anchored_heading" id="use-a-dedicated-truststore">Use a dedicated truststore</h2>
<p>If not using the alternative jssecacerts trustStore, there are 2 choices: </p>
<ul start="1"><li>use Java system properties "javax.net.ssl.trustStore" to define your specific trustStore. Be careful, as this trustore will completely replace the default cacerts/jssecacerts, and only the certificates imported will be trusted!
</li><li>indicate to the driver the location of the dedicated trustore using "trustStore" option and if needed "trustStorePassword".
</li></ul>
<p>The dedicated trustore can be generated using this command :</p>
<pre>
   //Import the root certificate and create the truststore
   //You will be prompted to confirm that the root certificate is trustworthy. Be sure to verify that the certificate is genuine before you import it.
   keytool -importcert -keystore myTrustStore.jks -alias myCA-root -storepass myTrustPwd -file myCA-root.cer
   
   //Import the intermediate certificate into the truststore created in Step 1:   
   keytool -importcert -keystore myTrustStore.jks -alias myCA-intermediate -storepass myTrustPwd -file myCA-intermediate.cer   
</pre>
<p>with our previous example, trustServerCertificate can then be removed:</p>
<pre>
try (Connection con = DriverManager.getConnection("jdbc:mariadb://localhost/myDb?user=myUser&amp;password=MyPwd&amp;trustStore=/pathToTrustStore/myTrustStore.jks&amp;trustStorePassword=mypwd")) {
	try (Statement stmt = con.createStatement()) {
		stmt.execute("select 1");
	}
}
</pre>
<h2 class="anchored_heading" id="provide-certificate-directly">Provide certificate directly</h2>
<p>The "serverSslCert" option permits setting the certificate location.
The location can be used in one of 3 forms: </p>
<ul start="1"><li>serverSslCert=/path/to/cert.pem (full path to certificate)
</li><li>serverSslCert=classpath:relative/cert.pem (relative to current classpath)
</li><li>or as verbatim DER-encoded certificate string "------BEGING CERTIFICATE-----..." .
</li></ul>
<p>Example :</p>
<pre>
try (Connection con = DriverManager.getConnection("jdbc:mariadb://localhost/myDb?user=myUser&amp;password=MyPwd&amp;serverSslCert=/path/to/cert.pem)) {
	try (Statement stmt = con.createStatement()) {
		stmt.execute("select 1");
	}
}
</pre>
<h2 class="anchored_heading" id="handling-self-signed-certificates">Handling self-signed certificates</h2>
<p>Using self-signed certificates, you will not only have to register the root and intermediates certificates, but each individual certificate of each server!
So if using more than one server, each self-signed certificate must be registered. </p>
<p>Import the test certificate into the truststore:</p>
<pre>
    keytool -importcert -keystore my.truststore -alias server1 -storepass trustChangeMe -file server1.cer
</pre>
<h1 class="anchored_heading" id="mutual-2-way-authentication">Mutual (2-way) authentication</h1>
<p>Mutual SSL authentication or certificate based mutual authentication refers to two parties authenticating each other through verifying the provided digital certificate so that both parties are assured of the others' identity.</p>
<p>To enable mutual authentication, the user must be created with "REQUIRE X509" so the server asks the driver for client certificates. See <a href="/kb/en/create-user/">CREATE USER</a> for more details.</p>
<p>Example:</p>
<pre class="fixed">CREATE USER 'myUser'@'%' IDENTIFIED BY 'MyPwd';
GRANT ALL ON db_name.* TO 'myUser'@'%' REQUIRE X509;
</pre><p><strong>If the user is not set with REQUIRE X509, only one way authentication will be done</strong></p>
<p>The client (driver) must then have its own certificate too (and related private key).
If the driver doesn't provide a certificate, and the user used to connect is defined with "REQUIRE X509", the server will then return a basic "Access denied for user".
Check how the user is defined with "select SSL_TYPE, SSL_CIPHER, X509_ISSUER, X509_SUBJECT FROM mysql.user u where u.User = '&lt;myUser&gt;'".</p>
<p>Java stores this client certificate and private key in a keyStore file.
A keystore file is similar to trustore, in fact trustore and keystore are often the same file. </p>
<p>Example of generating a keystore in JKS format : </p>
<pre>
  # generate a keystore with the client cert &amp; key
  openssl pkcs12 \
    -export \
    -in "${clientCertFile}" \
    -inkey "${clientKeyFile}" \
    -out "${tmpKeystoreFile}" \
    -name "mariadbAlias" \
    -passout pass:kspass

  # convert PKSC12 to JKS
  keytool \
    -importkeystore \
    -deststorepass kspass \
    -destkeypass kspass \
    -destkeystore "${clientKeystoreFile}" \
    -srckeystore ${tmpKeystoreFile} \
    -srcstoretype PKCS12 \
    -srcstorepass kspass \
    -alias "mariadbAlias"
</pre>
<p>Like truststore, the Java default keystore can be used, then no additional option is needed, or a dedicated keystore by using the "keyStore" option to indicate location and the "keyStorePassword" option to indicate the keystore password.
In JKS keystore, an additional password for a specific key may have been set. The "keyPassword" option permits setting this password.</p>
<h1 class="anchored_heading" id="troubleshooting">Troubleshooting</h1>
<h2 class="anchored_heading" id="diffie-hellman-size-error">Diffie-Hellman size error</h2>
<p>If using Java 7, the Diffie-Hellman (DH) prime size is limited to 1024 (JDK-6521495). Java has some artificial restriction that restricts size: Java 7 max size is 1024, Java 8 is 2048, Java 9 will be 8192.
Java 7 with extended support has a 2048 limit.</p>
<h2 class="anchored_heading" id="ssl-not-enabled-on-server">SSL not enabled on server</h2>
<p>If the following error occurs: "java.sql.SQLException: Trying to connect with ssl, but ssl not enabled in the server", SSL is not enabled on the server-side. 
Since the "useSSL=true" option is set, the connection failed. 
Execute "show variables like '%ssl%';" on the server-side to identify the SSL issue. </p>
<h2 class="anchored_heading" id="server-certificate-is-not-provided-to-client">Server certificate is not provided to client</h2>
<p>When the driver tries to connect using SSL, but no certificate is provided, or the "trustServerCertificate=true" option is not set, the driver will fail with the following exception "Caused by: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target"</p>
<p>Solution: 
- not recommended: set the "trustServerCertificate=true" option.
- add the server certificate to the driver (see documentation above).</p>
<h2 class="anchored_heading" id="javasqlsqlinvalidauthorizationspecexception-could-not-connect-access-denied-for-user">java.sql.SQLInvalidAuthorizationSpecException: Could not connect: Access denied for user</h2>
<p>This can occur for a number of reasons:</p>
<ul start="1"><li>The user / password is incorrect.
</li><li>Some SSL options have been set on the user (can be checked using "select SSL_TYPE, SSL_CIPHER, X509_ISSUER, X509_SUBJECT FROM mysql.user u where u.User = '&lt;myUser&gt;';) and the connection attempt doesn't meet those requirements.</li></ul>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/using-tls-ssl-with-mariadb-java-connector/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/using-tls-ssl-with-mariadb-java-connector/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/option-batchmultisend-description/">
                        ← Option batchMultiSend Description
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/connector-java/">
                        ↑ Java Connector ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/pool-datasource-implementation/">
                        Pool Datasource Implementation →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="6601" data-comments-url="/kb/en/using-tls-ssl-with-mariadb-java-connector/+comments"
         data-reply-url="/kb/en/using-tls-ssl-with-mariadb-java-connector/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/connector-java/">
                    ↑ Java Connector ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/about-mariadb-connector-j/">
                            
                            About MariaDB Connector/J
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/installing-mariadb-connectorj/">
                            
                            Installing MariaDB Connector/J
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/java-connector-using-gradle/">
                            
                            Java Connector Using Gradle
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/java-connector-using-maven/">
                            
                            Java Connector Using Maven
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/failover-and-high-availability-with-mariadb-connector-j/">
                            
                            Failover and High availability with MariaDB Connector/J
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/option-batchmultisend-description/">
                            
                            Option batchMultiSend Description
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>Using TLS/SSL with MariaDB Connector/J</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/pool-datasource-implementation/">
                            
                            Pool Datasource Implementation
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/gssapi-authentication-with-mariadb-connector-j/">
                            
                            GSSAPI Authentication with MariaDB Connector/J
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-connector-j-releases/">
                            
                            List of MariaDB Connector/J Releases
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-connector-j-release-notes/">
                            
                            MariaDB Connector/J Release Notes
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-connector-j-changelogs/">
                            
                            MariaDB Connector/J Changelogs
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/failover-and-high-availability-with-mariadb-connector-j-for-2x-driver/">
                            
                            Failover and High availability with MariaDB Connector/J for 2.x driver
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>