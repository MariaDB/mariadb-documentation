<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>MariaDB Knowledge Base Comments for: GROUP BY trick has been optimized away</title><link>https://mariadb.com/kb/en/group-by-trick-has-been-optimized-away/+comments/feed/</link><description></description><atom:link href="https://mariadb.com/kb/en/group-by-trick-has-been-optimized-away/+comments/feed/" rel="self"></atom:link><language>en-us</language><lastBuildDate>Mon, 19 Aug 2024 09:42:55 +0000</lastBuildDate><item><title>Re: GROUP BY trick has been optimized away</title><link>https://mariadb.com/kb/en/group-by-trick-has-been-optimized-away/+comments/349</link><description>&lt;p&gt;Perhaps this query will satisfy your needs.&lt;/p&gt;
&lt;p&gt;Tested lightly so don't depend on it without further examination.&lt;/p&gt;
&lt;pre class="fixed"&gt;SELECT state, city, population, num_cities FROM us JOIN
    (SELECT state, MAX(population) population, COUNT(*) num_cities 
    FROM us GROUP BY state ) p USING(state,population)
    ORDER BY  state;
&lt;/pre&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Brian Evans</dc:creator><guid>https://mariadb.com/kb/en/group-by-trick-has-been-optimized-away/+comments/349</guid></item><item><title>Re: GROUP BY trick has been optimized away</title><link>https://mariadb.com/kb/en/group-by-trick-has-been-optimized-away/+comments/344</link><description>&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;You might probably switch to the old behavior for a while by setting optimizer_switch='derived_merge=off' (or optimizer_switch='derived_merge=off,derived_with_keys=off', depending on the structure of your table) in your session or globally in the config file; but really, you are just playing with fire, and most likely it won't be long before you get the problem again, possibly without such luck as noticing it in time. &lt;/p&gt;
&lt;p&gt;While MySQL definition might not say anything about Los Angeles being bigger than Adelanto, it is perfectly clear about the type of queries that you use, and says explicitly that behavior here is undefined: &lt;/p&gt;
&lt;p&gt;&lt;a href="http://dev.mysql.com/doc/refman/5.5/en/group-by-hidden-columns.html"&gt;http://dev.mysql.com/doc/refman/5.5/en/group-by-hidden-columns.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;"MySQL extends the use of GROUP BY so that the select list can refer to nonaggregated columns not named in the GROUP BY clause. This means that the preceding query is legal in MySQL. You can use this feature to get better performance by avoiding unnecessary column sorting and grouping. However, this is useful primarily when all values in each nonaggregated column not named in the GROUP BY are the same for each group. The server is free to choose any value from each group, so unless they are the same, the values chosen are indeterminate. Furthermore, the selection of values from each group cannot be influenced by adding an ORDER BY clause. Sorting of the result set occurs after values have been chosen, and ORDER BY does not affect which values the server chooses."&lt;/p&gt;
&lt;p&gt;There is nothing that suggests that your subquery trick should make the difference and assure the deterministic result you are hoping for. &lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Elena Stepanova</dc:creator><guid>https://mariadb.com/kb/en/group-by-trick-has-been-optimized-away/+comments/344</guid></item></channel></rss>