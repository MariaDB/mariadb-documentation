<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Setting Up a LAMP Stack with Docker Compose - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Setting Up a LAMP Stack with Docker Compose - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/setting-up-a-lamp-stack-with-docker-compose/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/setting-up-a-lamp-stack-with-docker-compose/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/setting-up-a-lamp-stack-with-docker-compose/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/getting-installing-and-upgrading-mariadb/">Getting, Installing, and Upgrading MariaDB</a>
    

    
    » <a class="crumb" href="/kb/en/binary-packages/">MariaDB Binary Packages</a>
    

    
    » <a class="crumb" href="/kb/en/automated-mariadb-deployment-and-administration/">Automated MariaDB Deployment and Administration</a>
    

    
    » <a class="crumb" href="/kb/en/docker-and-mariadb/">MariaDB Containers</a>
    


    » <a class="node_link crumb" href="/kb/en/setting-up-a-lamp-stack-with-docker-compose/">Setting Up a LAMP Stack with Docker Compose</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/setting-up-a-lamp-stack-with-docker-compose/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Setting Up a LAMP Stack with Docker Compose - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/setting-up-a-lamp-stack-with-docker-compose/+r/107689/">107689</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-125">
<a href="/kb/user/id/125" title="Federico Razzoli">Federico Razzoli</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2021-06-19 14:47">2021-06-19 14:47</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">Docker Compose is a tool that allows one to declare which Docker containers should run, and which relationships should exist between them. It follows the **infrastructure as code** approach, just like most automation software and Docker itself.

For information about installing Docker Compose, see [[https://docs.docker.com/compose/install/|Install Docker Compose]] in Docker documentation.


&lt;&lt;toc&gt;&gt;


== The ##docker-compose.yml## File

When using Docker Compose, the Docker infrastructure must be described in a YAML file called ##docker-compose.yml##.

Let&#39;s see an example:

&lt;&lt;code&gt;&gt;
version: &#34;3&#34;

services:
  web:
    image: &#34;apache:${PHP_VERSION}&#34;
    restart: &#39;always&#39;
    depends_on:
      - mariadb
    restart: &#39;always&#39;
    ports:
      - &#39;8080:80&#39;
    links:
      - mariadb
  mariadb:
    image: &#34;mariadb:${MARIADB_VERSION}&#34;
    restart: &#39;always&#39;
    volumes: 
      - &#34;/var/lib/mysql/data:${MARIADB_DATA_DIR}&#34;
      - &#34;/var/lib/mysql/logs:${MARIADB_LOG_DIR}&#34;
      - /var/docker/mariadb/conf:/etc/mysql
    environment:
      MYSQL_ROOT_PASSWORD: &#34;${MYSQL_ROOT_PASSWORD}&#34;
      MYSQL_DATABASE: &#34;${MYSQL_DATABASE}&#34;
      MYSQL_USER: &#34;${MYSQL_USER}&#34;
      MYSQL_PASSWORD: &#34;${MYSQL_PASSWORD}&#34;
&lt;&lt;/code&gt;&gt;

In the first line we declare that we are using version 3 of the Docker compose language.

Then we have the list of services, namely the ##web## and the ##mariadb## services.

Let&#39;s see the properties of the services:
* ##port## maps the 8080 container port to the 80 host system port. This is very useful for a development environment, but not in production, because it allows us to connect our browser to the containerized web server. Normally there is no need to connect to MariaDB from the host system.
* ##links## declares that this container must be able to connect ##mariadb##. The hostname is the container name.
* ##depends_on## declares that ##mariadb## needs to start before ##web##. This is because we cannot do anything with our application until MariaDB is ready to accept connections.
* ##restart: always## declares that the containers must restart if they crash.
* ##volumes## creates volumes for the container if it is set in a service definition, or a volume that can be used by any container if it is set globally, at the same level as ##services##. Volumes are directories in the host system that can be accessed by any number of containers. This allows destroying a container without losing data.
* ##environment## sets environment variables inside the container. This is important because in setting these variables we set the MariaDB root credentials for the container.


=== About Volumes

It is good practice to create volumes for:

* The [[server-system-variables#datadir|data directory]], so we don&#39;t lose data when a container is created or replaced, perhaps to upgrade MariaDB.
* The directory where we put all the logs, if it is not the datadir.
* The directory containing all configuration files (for development environments), so we can edit those files with the editor installed in the host system. Normally no editor is installed in containers. In production we don&#39;t need to do this, because we can copy files from a repository located in the host system to the containers.

Note that Docker Compose variables are just placeholders for values. Compose does not support assignment, conditionals or loops.


=== Using Variables

In the above example you can see several variables, like ##${MARIADB_VERSION}##. Before executing the file, Docker Compose will replace this syntax with the ##MARIADB_VERSION## variable.

Variables allow making Docker Compose files more re-usable: in this case, we can use any MariaDB image version without modifying the Docker Compose file.

The most common way to pass variables is to write them into a file. This has the benefit of allowing us to version the variable file along with the Docker Compose file. It uses the same syntax you would use in BASH:

&lt;&lt;code&gt;&gt;
PHP_VERSION=8.0
MARIADB_VERSION=10.5
...
&lt;&lt;/code&gt;&gt;

For bigger setups, it could make sense to use different environment files for different services. To do so, we need to specify the file to use in the Compose file:

&lt;&lt;code&gt;&gt;
services:
  web:
    env_file:
      - web-variables.env
...
&lt;&lt;/code&gt;&gt;


== Docker Compose Commands

Docker Compose is operated using ##docker-compose##. Here we&#39;ll see the most common commands. For more commands and for more information about the commands mentioned here, see the documentation.

Docker Compose assumes that the Composer file is located in the current directory and it&#39;s called ##docker-compose.yml##. To use a different file, the ##-f &lt;filename&gt;## parameter must be specified.

To pull the necessary images:

&lt;&lt;code&gt;&gt;
docker-compose pull
&lt;&lt;/code&gt;&gt;

Containers described in the Compose file can be created in several ways.

To create them only if they do not exist:

&lt;&lt;code&gt;&gt;
docker-compose up --no-recreate
&lt;&lt;/code&gt;&gt;

To create them if they do not exist and recreate them if their image or configuration have changed:

&lt;&lt;code&gt;&gt;
docker-compose up
&lt;&lt;/code&gt;&gt;

To recreate containers in all cases:

&lt;&lt;code&gt;&gt;
docker-compose up --force-recreate
&lt;&lt;/code&gt;&gt;

Normally ##docker-compose up## starts the containers. To create them without starting them, add the ##--no-start## option.

To restart containers without recreating them:

&lt;&lt;code&gt;&gt;
docker-compose restart
&lt;&lt;/code&gt;&gt;

To kill a container by sending it a ##SIGKILL##:

&lt;&lt;code&gt;&gt;
docker-compose kill &lt;service&gt;
&lt;&lt;/code&gt;&gt;

To instantly remove a running container:

&lt;&lt;code&gt;&gt;
docker-compose rm -f &lt;serice&gt;
&lt;&lt;/code&gt;&gt;

To tear down all containers created by the current Compose file:

&lt;&lt;code&gt;&gt;
docker-compose down
&lt;&lt;/code&gt;&gt;


== Docker Compose Resources and References

* [[https://docs.docker.com/compose/|Overview of Docker Compose]] in the Docker documentation.
* [[https://docs.docker.com/compose/compose-file/|Compose file]] in the Docker documentation.
* [[https://github.com/docker/compose|Docker Compose]] on GitHub.

Further information about the concepts explained in this page can be found in Docker documentation:

* [[https://docs.docker.com/compose/environment-variables/|Environment variables in Compose]].
* [[https://docs.docker.com/compose/reference/overview/|Overview of docker-compose CLI]].
* [[https://docs.docker.com/compose/reference/|Compose command-line reference]].


---- 
Content initially contributed by [[https://vettabase.com/|Vettabase Ltd]].</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>