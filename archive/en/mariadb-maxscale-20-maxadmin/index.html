<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title> Maxadmin - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content=" Maxadmin" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariadb-maxscale-20-maxadmin/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Maxadmin
The Maxscale Administrative &amp; Monitoring Client Application

Overview
Configuring MariaDB MaxScale for MaxAdmin
Running MaxAdmin
Working With Administration Interface..." />

    <meta name="description" content="Maxadmin
The Maxscale Administrative &amp; Monitoring Client Application

Overview
Configuring MariaDB MaxScale for MaxAdmin
Running MaxAdmin
Working With Administration Interface..." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-maxscale-20-maxadmin/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-maxscale-20-maxadmin/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/maxscale/">MariaDB MaxScale</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-maxscale-mariadb-maxscale-20/">MariaDB MaxScale 2.0</a>
    

    
    » <a class="crumb" href="/kb/en/maxscale-20-reference/">MaxScale 2.0 Reference</a>
    


    » <a class="node_link crumb" href="/kb/en/mariadb-maxscale-20-maxadmin/"> Maxadmin</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-20-maxadmin/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-20-maxadmin/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/mariadb-maxscale-20-maxadmin/+flag"
                data-flag-url="/kb/en/mariadb-maxscale-20-maxadmin/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-20-maxadmin/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2016-10-03 15:32">6 years, 8 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2016-10-05 16:29">6 years, 8 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/mariadb-maxscale-20-maxadmin/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
        <dt>Source</dt>
        <dd><a href="https://github.com/mariadb-corporation/MaxScale/blob/2.0.6/Documentation/Reference/MaxAdmin.md">GitHub</a></dd>
        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/mariadb-maxscale-20-maxadmin/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/mariadb-maxscale-20-maxadmin/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/mariadb-maxscale-20-maxadmin/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1> Maxadmin</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <h1 id="maxadmin">Maxadmin</h1>
<h1 id="the-maxscale-administrative-monitoring-client-application">The Maxscale Administrative &amp; Monitoring Client Application</h1>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#configuring">Configuring MariaDB MaxScale for MaxAdmin</a></li>
<li><a href="#running">Running MaxAdmin</a></li>
<li><a href="#interface">Working With Administration Interface Users</a></li>
<li><a href="#help">Getting Help</a></li>
<li><a href="#services">Working with Services</a></li>
<li><a href="#servers">Working with Servers</a></li>
<li><a href="#sessions">Working with Sessions</a></li>
<li><a href="#dcbs">Descriptor Control Blocks</a></li>
<li><a href="#filters">Working with Filters</a></li>
<li><a href="#monitors">Working with Monitors</a></li>
<li><a href="#statuscommands">MariaDB MaxScale Status Commands</a></li>
<li><a href="#admincommands">Administration Commands</a></li>
<li><a href="#tuning">Tuning MariaDB MaxScale</a></li>
</ul>
<p><a name="overview"></a></p>
<h1 id="overview">Overview</h1>
<p>MaxAdmin is a simple client interface that can be used to interact with the MariaDB MaxScale server, it allows the display of internal MariaDB MaxScale statistics, status and control of MariaDB MaxScale operations.</p>
<p>MaxAdmin supports</p>
<ul>
<li>
<p>Interactive user sessions</p>
</li>
<li>
<p>Execution of one-off commands via command line arguments</p>
</li>
<li>
<p>Execution of command scripts</p>
</li>
</ul>
<p><a name="configuring"></a></p>
<h1 id="configuring-mariadb-maxscale-for-maxadmin">Configuring MariaDB MaxScale for MaxAdmin</h1>
<p>In order to be able to use MaxAdmin, MariaDB MaxScale must be configured for it.</p>
<p>There are two ways MaxAdmin can connect to to MaxScale.</p>
<ul>
<li>Using a Unix domain socket.</li>
<li>Using a hostname and port.</li>
</ul>
<p>The first alternative is introduced in MaxScale 2.0 and is the secure and
recommended way. The second alternative is available for backward compatibility,
but is <em>insecure</em> and <strong>deprecated</strong> and <em>will be removed in a future version of
MaxScale</em>.</p>
<p>An example configuration looks as follows:</p>
<div><pre><span></span>[MaxAdmin]
type=service
router=cli

[MaxAdmin Unix Listener]
type=listener
service=MaxAdmin
protocol=maxscaled
socket=default

[MaxAdmin Inet Listener]
type=listener
service=MaxAdmin
protocol=maxscaled
address=localhost
port=6603
</pre></div>


<p>In the configuration above, two listeners are created; one listening on the default
Unix domain socket and one listening on the default port.</p>
<p>Which approach is used has other implications than just how the communication between
MaxAdmin and MariaDB MaxScale is handled. In the former case, the authorization is
based upon the Linux identity and in the latter case on explicitly created user
accounts that have <strong>no</strong> relationship to the Linux accounts.</p>
<p>Note that if the socket path or port are changed, then MaxAdmin has to be invoked
with <code>-S</code> or <code>-P</code> respectively.</p>
<p><a name="running"></a></p>
<h1 id="running-maxadmin">Running MaxAdmin</h1>
<p>Depending on whether MariaDB MaxScale has been configured to use Unix domain sockets
or internet sockets, MaxAdmin needs to be invoked slightly differently.</p>
<p>If Unix domain sockets are used, then MaxAdmin needs no additional arguments:</p>
<pre><code>alice@host$ maxadmin
MaxAdmin&gt;
</code></pre>
<p>The above implies that the Linux user <em>alice</em> has been enabled to use MaxAdmin.</p>
<p>If internet sockets are used, then either the host, port, user or password has
to be specified explicitly:</p>
<pre><code>alice@host$ maxadmin -u maxscale-admin
Password:
MaxScale&gt;
</code></pre>
<p>If Unix domain sockets are used, then initially only <code>root</code> has access. MaxAdmin
usage can subsequently be enabled for other Linux users.</p>
<p>The MaxAdmin client application may be run in two different modes, either as an interactive command shell for executing commands against MariaDB MaxScale or by passing commands on the MaxAdmin command line itself.</p>
<p><a name="interface"></a></p>
<h1 id="working-with-administration-interface-users">Working With Administration Interface Users</h1>
<h2 id="what-users-have-been-defined">What Users Have Been Defined?</h2>
<p>In order to see the Linux users for whom MaxAdmin usage has been enabled and
any explicitly created accounts, use the command <em>show users</em>.</p>
<pre><code>MaxScale&gt; show users
Enabled Linux accounts (secure)    : alice, bob, cecil
Created network accounts (insecure): maxscale-admin
MaxScale&gt;
</code></pre>
<p>Please note that <code>root</code> will not be shown.</p>
<h2 id="enabling-a-linux-account">Enabling a Linux account</h2>
<p>To enable MaxAdmin usage for a particular Linux account, use the command <em>enable account</em>.
This command is passed a user name, which should be the same as that of an existing Linux user.</p>
<pre><code>MaxScale&gt; enable account bob
</code></pre>
<p>Note that it is not checked that the provided name indeed corresponds to an existing
Linux account, so it is possible to enable an account that does not exist yet.</p>
<p>Note also that it is possible to enable a Linux account irrespective of how MaxAdmin
has connected to MariaDB MaxScale. That is, the command is not restricted to MaxAdmin
users connecting over a Unix domain socket.</p>
<h2 id="disabling-a-linux-account">Disabling a Linux account</h2>
<p>To disable MaxAdmin usage for a particular Linux account, use the command <em>disable account</em>.
This command is passed a user name, which should be a Linux user for whom MaxAdmin usage
earlier has been enabled.</p>
<pre><code>MaxScale&gt; disable account bob
</code></pre>
<p>Note also that it is possible to disable a Linux account irrespective of how MaxAdmin
has connected to MariaDB MaxScale. That is, the command is not restricted to MaxAdmin
users connecting over a Unix domain socket.</p>
<p>Note that it is possible to disable the current user, but that will only affect the
next attempt to use MaxAdmin. <code>root</code> cannot be removed.</p>
<h2 id="add-a-new-user">Add A New User</h2>
<p>To add a new MaxAdmin user to be used when MaxAdmin connects over an internet socket,
use the command <em>add user</em>. This command is passed a user name and a password.</p>
<pre><code>MaxScale&gt; add user maxscale-admin secretpwd
User maxscale-admin has been successfully added.
MaxScale&gt;
</code></pre>
<p>Note that there is no difference in rights between an enabled Linux account and an
explicitly created user.</p>
<h2 id="delete-a-user">Delete A User</h2>
<p>To remove a user the command <em>remove user</em> is used and it is invoked with the
username and password.</p>
<pre><code>MaxScale&gt; remove user maxscale-admin secretpwd
User maxscale-admin has been successfully removed.
MaxScale&gt;
</code></pre>
<p>Note that it is possible to remove the current user, but that will only affect the
next attempt to use MaxAdmin.</p>
<h1 id="command-line-switches">Command Line Switches</h1>
<p>The MaxAdmin command accepts a number of switches</p>
<table>
  <tbody><tr>
    <td>Switch</td>
    <td>Long Option</td>
    <td>Description</td>
  </tr>
  <tr>
    <td>-S socket path</td>
    <td>--socket=...</td>
    <td>The UNIX domain socket path that MaxAdmin will use to connect to the MariaDB MaxScale server. If no -S option is given then the default socket path /tmp/maxadmin.sock will be used.</td>
  </tr>
  <tr>
    <td>-u user</td>
    <td>--user=...</td>
    <td>Sets the username that will be used for the MaxScale connection. If no -u option is passed on the MaxAdmin command line then the default username of ‘admin’ will be used.</td>
  </tr>
  <tr>
    <td>-p password</td>
    <td>--password=...</td>
    <td>Sets the user password that will be used. If no -p option is passed on the command line then MaxAdmin will prompt for interactive entry of the password.</td>
  </tr>
  <tr>
    <td>-h hostname</td>
    <td>--hostname=...</td>
    <td>The hostname of the MaxScale server to connect to. If no -h option is passed on the command line then MaxAdmin will attempt to connect to the host ‘localhost’.</td>
  </tr>
  <tr>
    <td>-P port</td>
    <td>--port=...</td>
    <td>The port that MaxAdmin will use to connect to the MaxScale server. if no -P option is given then the default port of 6603 will be used.</td>
  </tr>
  <tr>
    <td>-?</td>
    <td>--help</td>
    <td>Print usage information regarding MaxAdmin</td>
  </tr>
  <tr>
    <td>-v</td>
    <td>--version</td>
    <td>Print the maxadmin version information and exit</td>
  </tr>
</tbody></table>

<p>When a switch takes a value, this may either be as the next argument on the command line or maybe as part of the switch itself, e.g. -S path and -Spath are treated in the same way.</p>
<h2 id="interactive-operation">Interactive Operation</h2>
<p>If no arguments other than the command line switches are passed to MaxAdmin it will enter its interactive mode of operation. Users will be prompted to enter commands with a <strong>MaxScale&gt;</strong> prompt. The commands themselves are documented in the sections later in this document. A help system is available that will give some minimal details of the commands available.</p>
<p>Command history is available on platforms that support the libedit library. This allows the use of the up and down arrow keys to recall previous commands that have been executed by MaxAdmin. The default edit mode for the history is to emulate the vi commands, the behavior of libedit may however be customized using the .editrc file. To obtain the history of commands that have been executed use the inbuilt history command.</p>
<p>In interactive mode it is possible to execute a set of commands stored in an external file by using the source command. The command takes the argument of a filename which should contain a set of MariaDB MaxScale commands, one per line. These will be executed in the order they appear in the file.</p>
<h2 id="command-line-operation">Command Line Operation</h2>
<p>MaxAdmin can also be used to execute commands that are passed on the command line, e.g.</p>
<pre><code>-bash-4.1$ maxadmin -S /tmp/maxadmin.sock list services
Password:
Services.
--------------------------+----------------------+--------+---------------
Service Name              | Router Module        | #Users | Total Sessions
--------------------------+----------------------+--------+---------------
Test Service              | readconnroute        |      1 |     1
Split Service             | readwritesplit       |      1 |     1
Filter Service            | readconnroute        |      1 |     1
QLA Service               | readconnroute        |      1 |     1
Debug Service             | debugcli             |      1 |     1
CLI                       | cli                  |      2 |    27
--------------------------+----------------------+--------+---------------
-bash-4.1$
</code></pre>
<p>The single command is executed and MaxAdmin then terminates. If the -p option is not given then MaxAdmin will prompt for a password. If a MariaDB MaxScale command requires an argument which contains whitespace, for example a service name, that name should be quoted. The quotes will be preserved and used in the execution of the MariaDB MaxScale command.</p>
<pre><code>-bash-4.1$ maxadmin show service "QLA Service"
    Password:
    Service 0x70c6a0
            Service:                QLA Service
            Router:                 readconnroute (0x7ffff0f7ae60)
            Number of router sessions:      0
            Current no. of router sessions: 0
            Number of queries forwarded:    0
            Started:                Wed Jun 25 10:08:23 2014
            Backend databases
                    127.0.0.1:3309  Protocol: MySQLBackend
                    127.0.0.1:3308  Protocol: MySQLBackend
                    127.0.0.1:3307  Protocol: MySQLBackend
                    127.0.0.1:3306  Protocol: MySQLBackend
            Users data:             0x724340
            Total connections:      1
            Currently connected:    1
    -bash-4.1$
</code></pre>
<p>Command files may be executed by either calling MaxAdmin with the name of the file that contains the commands</p>
<pre><code>maxadmin listall.ms
</code></pre>
<p>Or by using the #! mechanism to make the command file executable from the shell. To do this add a line at the start of your command file that contains the #! directive with the path of the MaxAdmin executable. Command options may also be given in this line. For example to create a script file that runs a set of list commands</p>
<pre><code>#!/usr/local/bin/maxadmin
list modules
list servers
list services
list listeners
list dcbs
list sessions
list filters
</code></pre>
<p>Then simply set this file to have execute permissions and it may be run like any other command in the Linux shell.</p>
<h2 id="the-maxadmin-file">The .maxadmin file</h2>
<p>MaxAdmin supports a mechanism to set defaults for the command line switches via a file in the home directory of the user. If a file named <code>.maxadmin</code> exists, it will be read and parameters set according to the entries in that file.</p>
<p>This mechanism can be used to provide defaults to the command line options. If a command line option is provided, it will still override the value in the <code>.maxadmin</code> file.</p>
<p>The parameters than can be set are:
   * <code>1.4</code>: <em>hostname</em>, <em>port</em>, <em>user</em> and <em>passwd</em>
   * <code>2.0.0</code> and <code>2.0.1</code>: <em>socket</em>
   * <code>2.0.2</code> onwards: <em>socket</em>, <em>hostname</em>, <em>port</em>, <em>user</em> and <em>passwd</em> (and as synonym <em>password</em>)</p>
<p>An example of a <code>.maxadmin</code> file that will alter the default socket path is:</p>
<pre><code>socket=/somepath/maxadmin.socket
</code></pre>
<p>Note that if in <code>2.0.2</code> or later, a value for <em>socket</em> as well as any of the internet socket related options, such as <em>hostname</em>, is provided in <code>.maxadmin</code>, then <em>socket</em> takes precedense. In that case, provide at least one internet socket related option on the command line to force MaxAdmin to use an internet socket and thus the internet socket related options from <code>.maxadmin</code>.</p>
<p>The <code>.maxadmin</code> file may  be made read only to protect any passwords written to that file.</p>
<p><a name="help"></a></p>
<h1 id="getting-help">Getting Help</h1>
<p>A help system is available that describes the commands available via the administration interface. To obtain a list of all commands available simply type the command help.</p>
<pre><code>MaxScale&gt; help
Available commands:
    add user
    clear server
    disable [heartbeat|log|root]
    enable [heartbeat|log|root]
    list [clients|dcbs|filters|listeners|modules|monitors|services|servers|sessions]
    reload [config|dbusers]
    remove user
    restart [monitor|service]
    set server
    show [dcbs|dcb|dbusers|epoll|filter|filters|modules|monitor|monitors|server|servers|services|service|session|sessions|users]
    shutdown [maxscale|monitor|service]

Type help command to see details of each command.
Where commands require names as arguments and these names contain
whitespace either the \ character may be used to escape the whitespace
or the name may be enclosed in double quotes ".
MaxScale&gt;
</code></pre>
<p>To see more detail on a particular command, and a list of the sub commands of the command, type help followed by the command name.</p>
<pre><code>MaxScale&gt; help list
Available options to the list command:
    clients    List all the client connections to MaxScale
    dcbs       List all the DCBs active within MaxScale
    filters    List all the filters defined within MaxScale
    listeners  List all the listeners defined within MaxScale
    modules    List all currently loaded modules
    monitors   List all monitors
    services   List all the services defined within MaxScale
    servers    List all the servers defined within MaxScale
    sessions   List all the active sessions within MaxScale
MaxScale&gt;
</code></pre>
<p><a name="services"></a></p>
<h1 id="working-with-services">Working With Services</h1>
<p>A service is a very important concept in MariaDB MaxScale as it defines the mechanism by which clients interact with MariaDB MaxScale and can attached to the backend databases. A number of commands exist that allow interaction with the services.</p>
<h2 id="what-services-are-available">What Services Are Available?</h2>
<p>The <em>list services</em> command can be used to discover what services are currently available within your MariaDB MaxScale configuration.</p>
<pre><code>MaxScale&gt; list services
Services.
--------------------------+----------------------+--------+---------------
Service Name              | Router Module        | #Users | Total Sessions
--------------------------+----------------------+--------+---------------
Test Service              | readconnroute        |      1 |     1
Split Service             | readwritesplit       |      1 |     1
Filter Service            | readconnroute        |      1 |     1
QLA Service               | readconnroute        |      1 |     1
Debug Service             | debugcli             |      1 |     1
CLI                       | cli                  |      2 |    24
--------------------------+----------------------+--------+---------------
MaxScale&gt;
</code></pre>
<p>In order to determine which ports services are using then the <em>list listeners</em> command can be used.</p>
<pre><code>MaxScale&gt; list listeners
Listeners.
---------------------+--------------------+-----------------+-------+--------
Service Name         | Protocol Module    | Address         | Port  | State
---------------------+--------------------+-----------------+-------+--------
Test Service         | MySQLClient        | *               |  4006 | Running
Split Service        | MySQLClient        | *               |  4007 | Running
Filter Service       | MySQLClient        | *               |  4008 | Running
QLA Service          | MySQLClient        | *               |  4009 | Running
Debug Service        | telnetd            | localhost       |  4242 | Running
CLI                  | maxscaled          | localhost       |  6603 | Running
---------------------+--------------------+-----------------+-------+--------
MaxScale&gt;
</code></pre>
<h2 id="see-service-details">See Service Details</h2>
<p>It is possible to see the details of an individual service using the <em>show service</em> command. This command should be passed the name of the service you wish to examine as an argument. Where a service name contains spaces characters there should either be escaped or the name placed in quotes.</p>
<pre><code>MaxScale&gt; show service "QLA Service"
Service 0x70c6a0
    Service:                                QLA Service
    Router:                         readconnroute (0x7ffff0f7ae60)
    Number of router sessions:      0
    Current no. of router sessions: 0
    Number of queries forwarded:    0
    Started:                                Wed Jun 25 10:08:23 2014
    Backend databases
            127.0.0.1:3309  Protocol: MySQLBackend
            127.0.0.1:3308  Protocol: MySQLBackend
            127.0.0.1:3307  Protocol: MySQLBackend
            127.0.0.1:3306  Protocol: MySQLBackend
    Users data:                             0x724340
    Total connections:                      1
    Currently connected:                    1
MaxScale&gt;
</code></pre>
<p>This allows the set of backend servers defined by the service to be seen along with the service statistics and other information.</p>
<h2 id="examining-service-users">Examining Service Users</h2>
<p>MariaDB MaxScale provides an authentication model by which the client application authenticates with MariaDB MaxScale using the credentials they would normally use to with the database itself. MariaDB MaxScale loads the user data from one of the backend databases defined for the service. The <em>show dbusers</em> command can be used to examine the user data held by MariaDB MaxScale.</p>
<pre><code>MaxScale&gt; show dbusers "Filter Service"
User names: pappo@%, rana@%, new_control@%, new_nuovo@%, uno@192.168.56.1, nuovo@192.168.56.1, pesce@%, tryme@192.168.1.199, repluser@%, seven@%, due@%, pippo@%, mmm@%, daka@127.0.0.1, timour@%, ivan@%, prova@%, changeme@127.0.0.1, uno@%, massimiliano@127.0.0.1, massim@127.0.0.1, massi@127.0.0.1, masssi@127.0.0.1, pappo@127.0.0.1, rana@127.0.0.1, newadded@127.0.0.1, newaded@127.0.0.1, pesce@127.0.0.1, repluser@127.0.0.1, seven@127.0.0.1, pippo@127.0.0.1, due@127.0.0.1, nopwd@127.0.0.1, timour@127.0.0.1, controlla@192.168.56.1, ivan@127.0.0.1, ppp@127.0.0.1, daka@%, nuovo@127.0.0.1, uno@127.0.0.1, repluser@192.168.56.1, havoc@%, tekka@192.168.1.19, due@192.168.56.1, qwerty@127.0.0.1, massimiliano@%, massi@%, massim@%
MaxScale&gt;
</code></pre>
<h2 id="reloading-service-user-data">Reloading Service User Data</h2>
<p>MariaDB MaxScale will automatically reload user data if there are failed authentication requests from client applications. This reloading is rate limited and triggered by missing entries in the MariaDB MaxScale table. If a user is removed from the backend database user table it will not trigger removal from the MariaDB MaxScale internal table. The reload dbusers command can be used to force the reloading of the user table within MariaDB MaxScale.</p>
<pre><code>MaxScale&gt; reload dbusers "Split Service"
Loaded 34 database users for service Split Service.
MaxScale&gt;
</code></pre>
<h2 id="stopping-a-service">Stopping A Service</h2>
<p>It is possible to stop a service from accepting new connections by using the <em>shutdown service</em> command. This will not affect the connections that are already in place for a service, but will stop any new connections from being accepted.</p>
<pre><code>MaxScale&gt; shutdown service "Split Service"
MaxScale&gt;
</code></pre>
<h2 id="restart-a-stopped-service">Restart A Stopped Service</h2>
<p>A stopped service may be restarted by using the <em>restart service</em> command.</p>
<pre><code>MaxScale&gt; restart service "Split Service"
MaxScale&gt;
</code></pre>
<p><a name="servers"></a></p>
<h1 id="working-with-servers">Working With Servers</h1>
<p>The server represents each of the instances of MySQL or MariaDB that a service may use.</p>
<h2 id="what-servers-are-configured">What Servers Are Configured?</h2>
<p>The command <em>list servers</em> can be used to display a list of all the servers configured within MariaDB MaxScale.</p>
<pre><code>MaxScale&gt; list servers
Servers.
-------------------+-----------------+-------+----------------------+------------
Server             | Address         | Port  | Status               | Connections
-------------------+-----------------+-------+----------------------+------------
server1            | 127.0.0.1       |  3306 | Running              |    0
server2            | 127.0.0.1       |  3307 | Master, Running      |    0
server3            | 127.0.0.1       |  3308 | Running              |    0
server4            | 127.0.0.1       |  3309 | Slave, Running       |    0
-------------------+-----------------+-------+----------------------+------------
MaxScale&gt;
</code></pre>
<h2 id="server-details">Server Details</h2>
<p>It is possible to see more details regarding a given server using the <em>show server</em> command.</p>
<pre><code>MaxScale&gt; show server server2
Server 0x70d460 (server2)
    Server:                         127.0.0.1
    Status:                         Master, Running
    Protocol:                       MySQLBackend
    Port:                           3307
    Server Version:                 5.5.25-MariaDB-log
    Node Id:                        124
    Number of connections:          0
    Current no. of conns:           0
    Current no. of operations:      0
MaxScale&gt;
</code></pre>
<p>If the server has a non-zero value set for the server configuration item "persistpoolmax",
then additional information will be shown:</p>
<pre><code>    Persistent pool size:            1
    Persistent measured pool size:   1
    Persistent pool max size:        10
    Persistent max time (secs):      3660
</code></pre>
<p>The distinction between pool size and measured pool size is that the first is a
counter that is updated when operations affect the persistent connections pool,
whereas the measured size is the result of checking how many persistent connections
are currently in the pool. It can be slightly different, since any expired
connections are removed during the check.</p>
<h2 id="setting-the-state-of-a-server">Setting The State Of A Server</h2>
<p>MariaDB MaxScale maintains a number of status bits for each server that is configured, these status bits are normally maintained by the monitors, there are two commands in the user interface that are used to manually maintain these bits also; the <em>set server</em> and <em>clear server</em> commands.</p>
<p>The status bit that can be controlled are</p>
<table>
  <tbody><tr>
    <td>Bit Name</td>
    <td>Description</td>
  </tr>
  <tr>
    <td>running</td>
    <td>The server is responding to requests, accepting connections and executing database commands</td>
  </tr>
  <tr>
    <td>master</td>
    <td>The server is a master in a replication setup or should be considered as a destination for database updates.</td>
  </tr>
  <tr>
    <td>slave</td>
    <td>The server is a replication slave or is considered as a read only database.</td>
  </tr>
  <tr>
    <td>synced</td>
    <td>The server is a fully fledged member of a Galera cluster</td>
  </tr>
  <tr>
    <td>maintenance</td>
    <td>The server is in maintenance mode. In this mode no new connections will be established to the server. The monitors will also not monitor servers that are in maintenance mode.</td>
  </tr>
  <tr>
    <td>stale</td>
    <td>The server is a stale master server. Read [MySQL Monitor](/kb/en/mariadb-maxscale-20-mysql-monitor/) documentation for more details.</td>
  </tr>
</tbody></table>

<p>All status bits, with the exception of the maintenance bit, will be set by the monitors that are monitoring the server. If manual control is required the monitor should be stopped.</p>
<pre><code>MaxScale&gt; set server server3 maintenance
MaxScale&gt; clear server server3 maintenance
MaxScale&gt;
</code></pre>
<h2 id="viewing-the-persistent-pool-of-dcb">Viewing the persistent pool of DCB</h2>
<p>The DCBs that are in the pool for a particular server can be displayed (in the
format described below in the DCB section) with a command like:</p>
<pre><code>MaxScale&gt; show persistent server1
</code></pre>
<p><a name="sessions"></a></p>
<h1 id="working-with-sessions">Working With Sessions</h1>
<p>The MariaDB MaxScale session represents the state within MariaDB MaxScale. Sessions are dynamic entities and not named in the configuration file, this means that sessions can not be easily named within the user interface. The sessions are referenced using ID values, these are actually memory address, however the important thing is that no two session have the same ID.</p>
<h2 id="what-sessions-are-active-in-mariadb-maxscale">What Sessions Are Active in MariaDB MaxScale?</h2>
<p>There are a number of ways to find out what sessions are active, the most comprehensive being the <em>list sessions</em> command.</p>
<pre><code>MaxScale&gt; list sessions
Sessions.
-----------------+-----------------+----------------+--------------------------
Session          | Client          | Service        | State
-----------------+-----------------+----------------+--------------------------
0x7267a0         | 127.0.0.1       | CLI            | Session ready for routing
0x726340         |                 | CLI            | Listener Session
0x725720         |                 | Debug Service  | Listener Session
0x724720         |                 | QLA Service    | Listener Session
0x72a750         |                 | Filter Service | Listener Session
0x709500         |                 | Split Service  | Listener Session
0x7092d0         |                 | Test Service   | Listener Session
-----------------+-----------------+----------------+--------------------------
MaxScale&gt;
</code></pre>
<p>This lists all the sessions for both user connections and for the service listeners.</p>
<p>The <em>list clients</em> command will give just the subset of sessions that originate from a client connection.</p>
<pre><code>MaxScale&gt; list clients
Client Connections
-----------------+------------+----------------------+------------
 Client          | DCB        | Service              | Session
-----------------+------------+----------------------+------------
 127.0.0.1       |   0x7274b0 | CLI                  |   0x727700
 127.0.0.1       |   0x727900 | QLA Service          |   0x727da0
-----------------+------------+----------------------+------------
MaxScale&gt;
</code></pre>
<h2 id="display-session-details">Display Session Details</h2>
<p>Once the session ID has been determined using one of the above method it is possible to determine more detail regarding a session by using the <em>show session</em> command.</p>
<pre><code>MaxScale&gt; show session 0x727da0
Session 0x727da0
    State:                  Session ready for routing
    Service:                QLA Service (0x70d6a0)
    Client DCB:             0x727900
    Client Address:         127.0.0.1
    Connected:              Wed Jun 25 15:27:21 2014
MaxScale&gt;
</code></pre>
<p><a name="dcbs"></a></p>
<h1 id="descriptor-control-blocks">Descriptor Control Blocks</h1>
<p>The Descriptor Control Block or DCB is a very important entity within MariaDB MaxScale, it represents the state of each connection within MariaDB MaxScale. A DCB is allocated for every connection from a client, every network listener and every connection to a backend database. Statistics for each of these connections are maintained within these DCB’s.</p>
<p>As with session above the DCB’s are not named and are therefore referred to by the use of a unique ID, the memory address of the DCB.</p>
<h2 id="finding-dcbs">Finding DCB’s</h2>
<p>There are several ways to determine what DCB’s are active within a MariaDB MaxScale server, the most straightforward being the <em>list dcbs</em> command.</p>
<pre><code>MaxScale&gt; list dcbs
Descriptor Control Blocks
------------+----------------------------+----------------------+----------
 DCB        | State                      | Service              | Remote
------------+----------------------------+----------------------+----------
   0x667170 | DCB for listening socket   | Test Service         |
   0x71a350 | DCB for listening socket   | Split Service        |
   0x724b40 | DCB for listening socket   | Filter Service       |
   0x7250d0 | DCB for listening socket   | QLA Service          |
   0x725740 | DCB for listening socket   | Debug Service        |
   0x726740 | DCB for listening socket   | CLI                  |
   0x7274b0 | DCB in the polling loop    | CLI                  | 127.0.0.1
   0x727900 | DCB in the polling loop    | QLA Service          | 127.0.0.1
   0x72e880 | DCB in the polling loop    | QLA Service          |
------------+----------------------------+----------------------+----------
MaxScale&gt;
</code></pre>
<p>A MariaDB MaxScale server that has activity on it will however have many more DCB’s than in the example above, making it hard to find the DCB that you require. The DCB ID is also included in a number of other command outputs, depending on the information you have it may be easier to use other methods to locate a particular DCB.</p>
<h2 id="dcb-of-a-client-connection">DCB Of A Client Connection</h2>
<p>To find the DCB for a particular client connection it may be best to start with the list clients command and then look at each DCB for a particular client address to determine the one of interest.</p>
<h2 id="dcb-details">DCB Details</h2>
<p>The details of an individual DCB can be obtained by use of the <em>show dcb</em> command</p>
<pre><code>MaxScale&gt; show dcb 0x727900
DCB: 0x727900
    DCB state:              DCB in the polling loop
    Username:               somename
    Protocol:               MySQLBackend
    Server Status:          Master, running
    Role:                   Request Handler
    Connected to:           127.0.0.1
    Owning Session:         0x727da0
    Statistics:
            No. of Reads:                   4
            No. of Writes:                  3
            No. of Buffered Writes:         0
            No. of Accepts:                 0
            No. of High Water Events:       0
            No. of Low Water Events:        0
            Added to persistent pool:       Jun 24 09:09:56
MaxScale&gt;
</code></pre>
<p>The information Username, Protocol, Server Status are not
always relevant, and will not be shown when they are null.
The time the DCB was added to the persistent pool is only shown
for a DCB that is in a persistent pool.</p>
<p><a name="filters"></a></p>
<h1 id="working-with-filters">Working with Filters</h1>
<p>Filters allow the request contents and result sets from a database to be modified for a client connection, pipelines of filters can be created between the client connection and MariaDB MaxScale router modules.</p>
<h2 id="what-filters-are-configured">What Filters Are Configured?</h2>
<p>Filters are configured in the configuration file for MariaDB MaxScale, they are given names and may be included in the definition of a service. The <em>list filters</em> command can be used to determine which filters are defined.</p>
<pre><code>MaxScale&gt; list filters
Filters
--------------------+-----------------+----------------------------------------
Filter              | Module          | Options
--------------------+-----------------+----------------------------------------
counter             | testfilter      |
QLA                 | qlafilter       | /tmp/QueryLog
Replicate           | tee             |
QLA_BLR             | qlafilter       | /tmp/QueryLog.blr0
regex               | regexfilter     |
MySQL5.1            | regexfilter     |
top10               | topfilter       |
--------------------+-----------------+----------------------------------------
MaxScale&gt;
</code></pre>
<h2 id="retrieve-details-of-a-filter-configuration">Retrieve Details Of A Filter Configuration</h2>
<p>The command <em>show filter</em> can be used to display information related to a particular filter.</p>
<pre><code>MaxScale&gt; show filter QLA
Filter 0x719460 (QLA)
    Module: qlafilter
    Options:        /tmp/QueryLog
            Limit logging to connections from       127.0.0.1
            Include queries that match              select.*from.*user.*where
MaxScale&gt;
</code></pre>
<h2 id="filter-usage">Filter Usage</h2>
<p>The <em>show session</em> command will include details for each of the filters in use within a session.  First use <em>list sessions</em> or <em>list clients</em> to find the session of interest and then run the <em>show session</em> command</p>
<pre><code>MaxScale&gt; list clients
Client Connections
-----------------+------------+----------------------+------------
 Client          | DCB        | Service              | Session
-----------------+------------+----------------------+------------
 127.0.0.1       |   0x7361a0 | Split Service        |   0x736680
 127.0.0.1       |   0x737ec0 | Plumbing             |   0x7382b0
 127.0.0.1       |   0x73ab20 | DigitalOcean         |   0x73ad90
 127.0.0.1       |   0x7219e0 | CLI                  |   0x721bd0
-----------------+------------+----------------------+------------
MaxScale&gt; show session 0x736680
Session 0x736680
    State:                  Session ready for routing
    Service:                Split Service (0x719f60)
    Client DCB:             0x7361a0
    Client Address:         127.0.0.1
    Connected:              Thu Jun 26 10:10:44 2014
    Filter: top10
            Report size                     10
            Logging to file /tmp/Query.top10.1.
            Current Top 10:
            1 place:
                    Execution time: 23.826 seconds
                    SQL: select sum(salary), year(from_date) from salaries s, (select distinct year(from_date) as y1 from salaries) y where (makedate(y.y1, 1) between s.from_date and s.to_date) group by y.y1 ("1988-08-01?
            2 place:
                    Execution time: 5.251 seconds
                    SQL: select d.dept_name as "Department", y.y1 as "Year", count(*) as "Count" from departments d, dept_emp de, (select distinct year(from_date) as y1 from dept_emp order by 1) y where d.dept_no = de.dept_no and (makedate(y.y1, 1) between de.from_date and de.to_date) group by y.y1, d.dept_name order by 1, 2
            3 place:
                    Execution time: 2.903 seconds
                    SQL: select year(now()) - year(birth_date) as age, gender, avg(salary) as "Average Salary" from employees e, salaries s where e.emp_no = s.emp_no and ("1988-08-01"  between from_date AND to_date) group by year(now()) - year(birth_date), gender order by 1,2
            4 place:
                    Execution time: 2.138 seconds
                    SQL: select dept_name as "Department", sum(salary) / 12 as "Salary Bill" from employees e, departments d, dept_emp de, salaries s where e.emp_no = de.emp_no and de.dept_no = d.dept_no and ("1988-08-01"  between de.from_date AND de.to_date) and ("1988-08-01"  between s.from_date AND s.to_date) and s.emp_no = e.emp_no group by dept_name order by 1
            5 place:
                    Execution time: 0.839 seconds
                    SQL: select dept_name as "Department", avg(year(now()) - year(birth_date)) as "Average Age", gender from employees e, departments d, dept_emp de where e.emp_no = de.emp_no and de.dept_no = d.dept_no and ("1988-08-01"  between from_date AND to_date) group by dept_name, gender
            6 place:
                    Execution time: 0.662 seconds
                    SQL: select year(hire_date) as "Hired", d.dept_name, count(*) as "Count" from employees e, departments d, dept_emp de where de.emp_no = e.emp_no and de.dept_no = d.dept_no group by d.dept_name, year(hire_date)
            7 place:
                    Execution time: 0.286 seconds
                    SQL: select moves.n_depts As "No. of Departments", count(moves.emp_no) as "No. of Employees" from (select de1.emp_no as emp_no, count(de1.emp_no) as n_depts from dept_emp de1 group by de1.emp_no) as moves group by moves.n_depts order by 1
            8 place:
                    Execution time: 0.248 seconds
                    SQL: select year(now()) - year(birth_date) as age, gender, count(*) as "Count" from employees group by year(now()) - year(birth_date), gender order by 1,2@
            9 place:
                    Execution time: 0.182 seconds
                    SQL: select year(hire_date) as "Hired", count(*) as "Count" from employees group by year(hire_date)
            10 place:
                    Execution time: 0.169 seconds
                    SQL: select year(hire_date) - year(birth_date) as "Age", count(*) as Count from employees group by year(hire_date) - year(birth_date) order by 1
MaxScale&gt;
</code></pre>
<p>The data displayed varies from filter to filter, the example above is the top filter. This filter prints a report of the current top queries at the time the show session command is run.</p>
<p><a name="monitors"></a></p>
<h1 id="working-with-monitors">Working With Monitors</h1>
<p>Monitors are used to monitor the state of databases within MariaDB MaxScale in order to supply information to other modules, specifically the routers within MariaDB MaxScale.</p>
<h2 id="what-monitors-are-running">What Monitors Are Running?</h2>
<p>To see what monitors are running within MariaDB MaxScale use the <em>list monitors</em> command.</p>
<pre><code>MaxScale&gt; list monitors
+----------------------+---------------------
| Monitor              | Status
+----------------------+---------------------
| MySQL Monitor        | Running
+----------------------+---------------------
MaxScale&gt;
</code></pre>
<h2 id="details-of-a-particular-monitor">Details Of A Particular Monitor</h2>
<p>To see the details of a particular monitor use the <em>show monitor</em> command.</p>
<pre><code>MaxScale&gt; show monitor "MySQL Monitor"
Monitor: 0x71c370
    Name:           MySQL Monitor
    Monitor running
    Sampling interval:      10000 milliseconds
    MaxScale MonitorId:     24209641
    Replication lag:        disabled
    Monitored servers:      127.0.0.1:3306, 127.0.0.1:3307, 127.0.0.1:3308, 127.0.0.1:3309
MaxScale&gt;
</code></pre>
<h2 id="controlling-replication-heartbeat">Controlling Replication Heartbeat</h2>
<p>Some monitors provide a replication heartbeat mechanism that monitors the delay for data that is replicated from a master to slaves in a tree structured replication environment. This can be enabled or disabled using the commands <em>enable heartbeat</em> and <em>disable heartbeat</em>.</p>
<pre><code>MaxScale&gt; disable heartbeat "MySQL Monitor"
MaxScale&gt; enable heartbeat "MySQL Monitor"
MaxScale&gt;
</code></pre>
<p>Please note that changes made via this interface will not persist across restarts of MariaDB MaxScale. To make a permanent change edit the maxscale.cnf file.</p>
<p>Enabling the replication heartbeat mechanism will add the display of heartbeat information in the show server output</p>
<pre><code>MaxScale&gt; show server server4
Server 0x719800 (server4)
    Server:                 127.0.0.1
    Status:                 Slave, Running
    Protocol:               MySQLBackend
    Port:                   3309
    Server Version:         5.5.25-MariaDB-log
    Node Id:                4
    Number of connections:  0
    Current no. of conns:   0
MaxScale&gt; enable heartbeat "MySQL Monitor"
MaxScale&gt; show server server4
Server 0x719800 (server4)
    Server:                 127.0.0.1
    Status:                 Slave, Running
    Protocol:               MySQLBackend
    Port:                   3309
    Server Version:         5.5.25-MariaDB-log
    Node Id:                4
    Slave delay:            0
    Last Repl Heartbeat:    Thu Jun 26 17:04:58 2014
    Number of connections:  0
    Current no. of conns:   0
MaxScale&gt;
</code></pre>
<h2 id="shutting-down-a-monitor">Shutting Down A Monitor</h2>
<p>A monitor may be shutdown using the <em>shutdown monitor</em> command. This allows for manual control of the status of servers using the <em>set server</em> and <em>clear server</em> commands.</p>
<pre><code>MaxScale&gt; shutdown monitor "MySQL Monitor"
MaxScale&gt; list monitors
+----------------------+---------------------
| Monitor              | Status
+----------------------+---------------------
| MySQL Monitor        | Stopped
+----------------------+---------------------
MaxScale&gt;
</code></pre>
<h2 id="restarting-a-monitor">Restarting A Monitor</h2>
<p>A monitor that has been shutdown may be restarted using the <em>restart monitor</em> command.</p>
<pre><code>MaxScale&gt; restart monitor "MySQL Monitor"
MaxScale&gt; show monitor "MySQL Monitor"
Monitor: 0x71a310
    Name:           MySQL Monitor
    Monitor running
    Sampling interval:      10000 milliseconds
    MaxScale MonitorId:     24201552
    Replication lag:        enabled
    Monitored servers:      127.0.0.1:3306, 127.0.0.1:3307, 127.0.0.1:3308, 127.0.0.1:3309
MaxScale&gt;
</code></pre>
<p><a name="statuscommands"></a></p>
<h1 id="maxscale-status-commands">MaxScale Status Commands</h1>
<p>A number of commands exists that enable the internal MariaDB MaxScale status to be revealed, these commands give an insight to how MariaDB MaxScale is using resource internally and are used to allow the tuning process to take place.</p>
<h2 id="mariadb-maxscale-thread-usage">MariaDB MaxScale Thread Usage</h2>
<p>MariaDB MaxScale uses a number of threads, as defined in the MariaDB MaxScale configuration file, to execute the processing of requests received from clients and the handling of responses. The <em>show threads</em> command can be used to determine what each thread is currently being used for.</p>
<pre><code>MaxScale&gt; show threads
Polling Threads.
Historic Thread Load Average: 1.00.
Current Thread Load Average: 1.00.
15 Minute Average: 0.48, 5 Minute Average: 1.00, 1 Minute Average: 1.00
Pending event queue length averages:
15 Minute Average: 0.90, 5 Minute Average: 1.83, 1 Minute Average: 2.00
 ID | State      | # fds  | Descriptor       | Running  | Event
----+------------+--------+------------------+----------+---------------
  0 | Processing |      1 | 0xf55a70         | &lt;  100ms | IN|OUT
  1 | Processing |      1 | 0xf49ba0         | &lt;  100ms | IN|OUT
  2 | Processing |      1 | 0x7f54c0030d00   | &lt;  100ms | IN|OUT
MaxScale&gt;
</code></pre>
<p>The resultant output returns data as to the average thread utilization for the past minutes 5 minutes and 15 minutes. It also gives a table, with a row per thread that shows what DCB that thread is currently processing events for, the events it is processing and how long, to the nearest 100ms has been send processing these events.</p>
<h2 id="the-event-queue">The Event Queue</h2>
<p>At the core of MariaDB MaxScale is an event driven engine that is processing network events for the network connections between MariaDB MaxScale and client applications and MariaDB MaxScale and the backend servers. It is possible to see the event queue using the <em>show eventq</em> command. This will show the events currently being executed and those that are queued for execution.</p>
<pre><code>MaxScale&gt; show eventq
Event Queue.
DCB              | Status     | Processing Events  | Pending Events
-----------------+------------+--------------------+-------------------
0x1e22f10        | Processing | IN|OUT             |
MaxScale&gt;
</code></pre>
<p>The output of this command gives the DCB’s that are currently in the event queue, the events queued for that DCB, and events that are being processed for that DCB.</p>
<h2 id="the-housekeeper-tasks">The Housekeeper Tasks</h2>
<p>Internally MariaDB MaxScale has a housekeeper thread that is used to  perform periodic tasks, it is possible to use the command show tasks to see what tasks are outstanding within the housekeeper.</p>
<pre><code>MaxScale&gt; show tasks
Name                      | Type     | Frequency | Next Due
--------------------------+----------+-----------+-------------------------
Load Average              | Repeated | 10        | Wed Nov 19 15:10:51 2014
MaxScale&gt;
</code></pre>
<p><a name="admincommands"></a></p>
<h1 id="administration-commands">Administration Commands</h1>
<h2 id="what-modules-are-in-use">What Modules Are In use?</h2>
<p>In order to determine what modules are in use, and the version and status of those modules the <em>list modules</em> command can be used.</p>
<pre><code>MaxScale&gt; list modules
Modules.
----------------+-------------+---------+-------+-------------------------
Module Name     | Module Type | Version | API   | Status
----------------+-------------+---------+-------+-------------------------
tee             | Filter      | V1.0.0  | 1.1.0 | Alpha
qlafilter       | Filter      | V1.1.1  | 1.1.0 | Alpha
topfilter       | Filter      | V1.0.1  | 1.1.0 | Alpha
MySQLBackend    | Protocol    | V2.0.0  | 1.0.0 | Alpha
maxscaled       | Protocol    | V1.0.0  | 1.0.0 | Alpha
telnetd         | Protocol    | V1.0.1  | 1.0.0 | Alpha
MySQLClient     | Protocol    | V1.0.0  | 1.0.0 | Alpha
mysqlmon        | Monitor     | V1.2.0  | 1.0.0 | Alpha
readconnroute   | Router      | V1.0.2  | 1.0.0 | Alpha
readwritesplit  | Router      | V1.0.2  | 1.0.0 | Alpha
debugcli        | Router      | V1.1.1  | 1.0.0 | Alpha
cli             | Router      | V1.0.0  | 1.0.0 | Alpha
----------------+-------------+---------+-------+-------------------------
MaxScale&gt;
</code></pre>
<p>This command provides important version information for the module. Each module has two versions; the version of the module itself and the version of the module API that it supports. Also included in the output is the status of the module, this may be "In Development", “Alpha”, “Beta”, “GA” or “Experimental”.</p>
<h2 id="enabling-syslog-and-maxlog-logging">Enabling syslog and maxlog logging</h2>
<p>MariaDB MaxScale can log messages to syslog, to a log file or to both. The approach can be set in the config file, but can also be changed from maxadmin. Syslog logging is identified by <em>syslog</em> and file logging by <em>maxlog</em>.</p>
<pre><code>MaxScale&gt; enable syslog
MaxScale&gt; disable maxlog
</code></pre>
<p><strong>NOTE</strong> If you disable both, then you will see no messages at all.</p>
<h2 id="rotating-the-log-file">Rotating the log file</h2>
<p>MariaDB MaxScale logs messages to a log file in the log directory of MariaDB MaxScale. As the log file grows continuously, it is recommended to periodically rotate it. When rotated, the current log file will be closed and a new one with a new name opened. The log file name contain a sequence number, which is incremented each time the log is rotated.</p>
<p>There are two ways for rotating the log - <em>flush log maxscale</em> and <em>flush logs</em> - and the result is identical. The two alternatives are due to historical reasons; earlier MariaDB MaxScale had several different log files.</p>
<pre><code>MaxScale&gt; flush log maxscale
MaxScale&gt;
The flush logs command may be used to rotate all logs with a single command.
MaxScale&gt; flush logs
MaxScale&gt;
</code></pre>
<h2 id="change-mariadb-maxscale-logging-options">Change MariaDB MaxScale Logging Options</h2>
<p>From version 1.3 onwards, MariaDB MaxScale has a single log file where messages of various priority (aka severity) are logged. Consequently, you no longer enable or disable log files but log priorities. The priorities are the same as those of syslog and the ones that can be enabled or disabled are <em>debug</em>, <em>info</em>, <em>notice</em> and <em>warning</em>. <em>Error</em> and any more severe messages can not be disabled.</p>
<pre><code>MaxScale&gt; enable log-priority info
MaxScale&gt; disable log-priority notice
MaxScale&gt;
</code></pre>
<p>Please note that changes made via this interface will not persist across restarts of MariaDB MaxScale. To make a permanent change edit the maxscale.cnf file.</p>
<h2 id="reloading-the-configuration">Reloading The Configuration</h2>
<p>A command, <em>reload config</em>, is available that will cause MariaDB MaxScale to reload the maxscale.cnf configuration file.</p>
<h2 id="shutting-down-mariadb-maxscale">Shutting Down MariaDB MaxScale</h2>
<p>The MariaDB MaxScale server may be shutdown using the <em>shutdown maxscale</em> command.</p>
<p><a name="tuning"></a></p>
<h1 id="tuning-mariadb-maxscale">Tuning MariaDB MaxScale</h1>
<p>The way that MariaDB MaxScale does it’s polling is that each of the polling threads, as defined by the threads parameter in the configuration file, will call epoll_wait to obtain the events that are to be processed. The events are then added to a queue for execution. Any thread can read from this queue, not just the thread that added the event.</p>
<p>Once the thread has done an epoll call with no timeout it will either do an epoll_wait call with a timeout or it will take an event from the queue if there is one. These two new parameters affect this behavior.</p>
<p>The first parameter, which may be set by using the non_blocking_polls option in the configuration file, controls the number of epoll_wait calls that will be issued without a timeout before MariaDB MaxScale will make a call with a timeout value. The advantage of performing a call without a timeout is that the kernel treats this case as different and will not rescheduled the process in this case. If a timeout is passed then the system call will cause the MariaDB MaxScale thread to be put back in the scheduling queue and may result in lost CPU time to MariaDB MaxScale. Setting the value of this parameter too high will cause MariaDB MaxScale to consume a lot of CPU when there is infrequent work to be done. The default value of this parameter is 3.</p>
<p>This parameter may also be set via the maxadmin client using the command <em>set nbpolls &lt;number&gt;</em>.</p>
<p>The second parameter is the maximum sleep value that MariaDB MaxScale will pass to epoll_wait. What normally happens is that MariaDB MaxScale will do an epoll_wait call with a sleep value that is 10% of the maximum, each time the returns and there is no more work to be done MariaDB MaxScale will increase this percentage by 10%. This will continue until the maximum value is reached or until there is some work to be done. Once the thread finds some work to be done it will reset the sleep time it uses to 10% of the maximum.</p>
<p>The maximum sleep time is set in milliseconds and can be placed in the [maxscale] section of the configuration file with the poll_sleep parameter. Alternatively it may be set in the maxadmin client using the command <em>set pollsleep &lt;number&gt;</em>. The default value of this parameter is 1000.</p>
<p>Setting this value too high means that if a thread collects a large number of events and adds to the event queue, the other threads might not return from the epoll_wait calls they are running for some time resulting in less overall performance. Setting the sleep time too low will cause MariaDB MaxScale to wake up too often and consume CPU time when there is no work to be done.</p>
<p>The <em>show epoll</em> command can be used to see how often we actually poll with a timeout, the first two values output are significant. Also the "Number of wake with pending events" is a good measure. This is the count of the number of times a blocking call returned to find there was some work waiting from another thread. If the value is increasing rapidly reducing the maximum sleep value and increasing the number of non-blocking polls should help the situation.</p>
<pre><code>MaxScale&gt; show epoll
Number of epoll cycles:                     534
Number of epoll cycles with wait:   10447
Number of read events:                      35
Number of write events:                     1988
Number of error events:                     0
Number of hangup events:                    1
Number of accept events:                    3
Number of times no threads polling: 5
Current event queue length:         1
Maximum event queue length:         2
Number of DCBs with pending events: 0
Number of wakeups with pending queue:       0
No of poll completions with descriptors
    No. of descriptors      No. of poll completions.
     1                      534
     2                      0
     3                      0
     4                      0
     5                      0
     6                      0
     7                      0
     8                      0
     9                      0
    &gt;= 10                   0
MaxScale&gt;
</code></pre>
<p>If the "Number of DCBs with pending events" grows rapidly it is an indication that MariaDB MaxScale needs more threads to be able to keep up with the load it is under.</p>
<p>The <em>show threads</em> command can be used to see the historic average for the pending events queue, it gives 15 minute, 5 minute and 1 minute averages. The load average it displays is the event count per poll cycle data. An idea load is 1, in this case MariaDB MaxScale threads and fully occupied but nothing is waiting for threads to become available for processing.</p>
<p>The <em>show eventstats</em> command can be used to see statistics about how long events have been queued before processing takes place and also how long the events took to execute once they have been allocated a thread to run on.</p>
<pre><code>MaxScale&gt; show eventstats
Event statistics.
Maximum queue time:                  2600ms
Maximum execution time:              1600ms
Maximum event queue length:     3
Current event queue length:     3
               |    Number of events
Duration       | Queued     | Executed
---------------+------------+-----------
 &lt; 100ms       | 107        | 461
  100 -  200ms | 958        | 22830
  200 -  300ms | 20716      | 2545
  300 -  400ms | 3284       | 253
  400 -  500ms | 505        | 45
  500 -  600ms | 66         | 73
  600 -  700ms | 116        | 169
  700 -  800ms | 319        | 185
  800 -  900ms | 382        | 42
  900 - 1000ms | 95         | 31
 1000 - 1100ms | 63         | 7
 1100 - 1200ms | 18         | 4
 1200 - 1300ms | 8          | 2
 1300 - 1400ms | 6          | 0
 1400 - 1500ms | 1          | 1
 1500 - 1600ms | 3          | 1
 1600 - 1700ms | 2          | 1
 1700 - 1800ms | 2          | 0
 1800 - 1900ms | 0          | 0
 1900 - 2000ms | 1          | 0
 2000 - 2100ms | 0          | 0
 2100 - 2200ms | 0          | 0
 2200 - 2300ms | 0          | 0
 2300 - 2400ms | 0          | 0
 2400 - 2500ms | 0          | 0
 2500 - 2600ms | 0          | 0
 2600 - 2700ms | 1          | 0
 2700 - 2800ms | 0          | 0
 2800 - 2900ms | 0          | 0
 2900 - 3000ms | 0          | 0
 &gt; 3000ms      | 0          | 0
MaxScale&gt;
</code></pre>
<p>The statics are defined in 100ms buckets, with the count of the events that fell into that bucket being recorded.</p>
    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/mariadb-maxscale-20-maxadmin/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/mariadb-maxscale-20-maxadmin/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/mariadb-maxscale-20-how-errors-are-handled-in-mariadb-maxscale/">
                        ←  How errors are handled in MariaDB MaxScale
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/maxscale-20-reference/">
                        ↑ MaxScale 2.0 Reference ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/mariadb-maxscale-20-maxbinlogcheck/">
                         Maxbinlogcheck →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="5951" data-comments-url="/kb/en/mariadb-maxscale-20-maxadmin/+comments"
         data-reply-url="/kb/en/mariadb-maxscale-20-maxadmin/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/maxscale-20-reference/">
                    ↑ MaxScale 2.0 Reference ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-hint-syntax/">
                            
                             Hint Syntax
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-how-errors-are-handled-in-mariadb-maxscale/">
                            
                             How errors are handled in MariaDB MaxScale
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span> Maxadmin</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-maxbinlogcheck/">
                            
                             Maxbinlogcheck
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-maxscale-20-change-history/">
                            
                            MaxScale 2.0 Change History
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>