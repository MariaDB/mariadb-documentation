<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title> MariaDB MaxScale Administration Tutorial - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content=" MariaDB MaxScale Administration Tutorial" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="MariaDB MaxScale Administration Tutorial
The purpose of this tutorial is to introduce the MariaDB MaxScale Administrator
to a few of the common administration tasks. This is i..." />

    <meta name="description" content="MariaDB MaxScale Administration Tutorial
The purpose of this tutorial is to introduce the MariaDB MaxScale Administrator
to a few of the common administration tasks. This is i..." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/mariadb-maxscale-22-08/">MariaDB MaxScale 22.08</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-maxscale-2208-tutorials/">MaxScale 22.08 Tutorials</a>
    


    » <a class="node_link crumb" href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/"> MariaDB MaxScale Administration Tutorial</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+flag"
                data-flag-url="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2022-08-17 22:05">2 years, 4 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2022-08-17 22:05">2 years, 4 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
        <dt>Source</dt>
        <dd><a href="https://github.com/mariadb-corporation/MaxScale/blob/22.08.15/Documentation/Tutorials/Administration-Tutorial.md">GitHub</a></dd>
        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1> MariaDB MaxScale Administration Tutorial</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <h1 id="mariadb-maxscale-administration-tutorial">MariaDB MaxScale Administration Tutorial</h1>
<p>The purpose of this tutorial is to introduce the MariaDB MaxScale Administrator
to a few of the common administration tasks. This is intended to be an
introduction for administrators who are new to MariaDB MaxScale and not a
reference to all the tasks that may be performed.</p>
<div>
<ul>
<li><a href="#mariadb-maxscale-administration-tutorial">MariaDB MaxScale Administration Tutorial</a><ul>
<li><a href="#starting-and-stopping-mariadb-maxscale">Starting and Stopping MariaDB MaxScale</a><ul>
<li><a href="#additional-options-for-maxscale">Additional Options for MaxScale</a></li>
</ul>
</li>
<li><a href="#checking-the-status-of-the-mariadb-maxscale-services">Checking The Status Of The MariaDB MaxScale Services</a></li>
<li><a href="#what-clients-are-connected-to-mariadb-maxscale">What Clients Are Connected To MariaDB MaxScale</a></li>
<li><a href="#rotating-the-log-file">Rotating the Log File</a></li>
<li><a href="#taking-objects-temporarily-out-of-use">Taking Objects Temporarily Out of Use</a><ul>
<li><a href="#putting-servers-into-maintenance">Putting Servers into Maintenance</a></li>
</ul>
</li>
<li><a href="#stopping-and-starting-services">Stopping and Starting Services</a><ul>
<li><a href="#stopping-and-starting-monitors">Stopping and Starting Monitors</a></li>
</ul>
</li>
<li><a href="#runtime-configuration-modification">Runtime Configuration Modification</a><ul>
<li><a href="#core-parameter-configuration">Core Parameter Configuration</a></li>
<li><a href="#managing-servers">Managing Servers</a><ul>
<li><a href="#create-a-new-server">Create a new server</a></li>
<li><a href="#modify-a-server">Modify a Server</a></li>
<li><a href="#destroy-a-server">Destroy a Server</a></li>
<li><a href="#drain-a-server">Drain a Server</a></li>
</ul>
</li>
<li><a href="#managing-monitors">Managing Monitors</a><ul>
<li><a href="#create-a-new-monitor">Create a new Monitor</a></li>
<li><a href="#modify-a-monitor">Modify a Monitor</a></li>
<li><a href="#add-server-to-a-monitor">Add Server to a Monitor</a></li>
<li><a href="#remove-a-server-from-a-monitor">Remove a Server from a Monitor</a></li>
<li><a href="#destroy-a-monitor">Destroy a Monitor</a></li>
</ul>
</li>
<li><a href="#managing-services">Managing Services</a><ul>
<li><a href="#create-a-new-service">Create a New Service</a></li>
<li><a href="#modify-a-service">Modify a Service</a></li>
<li><a href="#add-servers-to-a-service">Add Servers to a Service</a></li>
<li><a href="#remove-servers-from-a-service">Remove Servers from a Service</a></li>
<li><a href="#change-the-filters-of-a-service">Change the Filters of a Service</a></li>
<li><a href="#destroy-a-service">Destroy a Service</a></li>
</ul>
</li>
<li><a href="#managing-filters">Managing Filters</a><ul>
<li><a href="#create-a-new-filter">Create a New Filter</a></li>
<li><a href="#destroy-a-filter">Destroy a Filter</a></li>
</ul>
</li>
<li><a href="#managing-listeners">Managing Listeners</a><ul>
<li><a href="#create-a-new-listener">Create a New Listener</a></li>
<li><a href="#destroy-a-listener">Destroy a Listener</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#managing-maxctrl-and-rest-api-users">Managing MaxCtrl and REST API Users</a><ul>
<li><a href="#create-a-new-maxctrl-user">Create a New MaxCtrl User</a></li>
<li><a href="#change-the-password-of-an-existing-user">Change the Password of an Existing User</a></li>
<li><a href="#remove-a-user">Remove a User</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="starting-and-stopping-mariadb-maxscale">Starting and Stopping MariaDB MaxScale</h2>
<p>MaxScale uses systemd for managing the process. This means that normal
<code>systemctl</code> commands can be used to start and stop MaxScale. To start MaxScale,
use <code>systemctl start maxscale</code>. To stop it, use <code>systemctl stop maxscale</code>.</p>
<p>The systemd service file for MaxScale is located in
<code>/lib/systemd/system/maxscale.service</code>.</p>
<h3 id="additional-options-for-maxscale">Additional Options for MaxScale</h3>
<p>Additional command line options and other systemd configuration options
can be given to MariaDB MaxScale by creating a drop-in file for the
service unit file. You can do this with the <code>systemctl edit maxscale.service</code>
command. For more information about systemd drop-in
files, refer to
<a href="https://www.freedesktop.org/software/systemd/man/systemctl.html">the systemctl man page</a>
and
<a href="https://www.freedesktop.org/software/systemd/man/systemd.unit.html">the systemd documentation</a>.</p>
<h2 id="checking-the-status-of-the-mariadb-maxscale-services">Checking The Status Of The MariaDB MaxScale Services</h2>
<p>It is possible to use the maxctrl command to obtain statistics about the
services that are running within MaxScale. The maxctrl command <code>list services</code>
will give very basic information regarding services. This command may be either
run in interactive mode or passed on the maxctrl command line.</p>
<div><pre><span></span>$ maxctrl list services
┌────────────────────────┬────────────────┬─────────────┬───────────────────┬────────────────────────────────────┐
│ Service                │ Router         │ Connections │ Total Connections │ Servers                            │
├────────────────────────┼────────────────┼─────────────┼───────────────────┼────────────────────────────────────┤
│ CLI                    │ cli            │ 1           │ 1                 │                                    │
├────────────────────────┼────────────────┼─────────────┼───────────────────┼────────────────────────────────────┤
│ RW-Split-Router        │ readwritesplit │ 1           │ 1                 │ server1, server2, server3, server4 │
├────────────────────────┼────────────────┼─────────────┼───────────────────┼────────────────────────────────────┤
│ RW-Split-Hint-Router   │ readwritesplit │ 1           │ 1                 │ server1, server2, server3, server4 │
├────────────────────────┼────────────────┼─────────────┼───────────────────┼────────────────────────────────────┤
│ SchemaRouter-Router    │ schemarouter   │ 1           │ 1                 │ server1, server2, server3, server4 │
├────────────────────────┼────────────────┼─────────────┼───────────────────┼────────────────────────────────────┤
│ Read-Connection-Router │ readconnroute  │ 1           │ 1                 │ server1                            │
└────────────────────────┴────────────────┴─────────────┴───────────────────┴────────────────────────────────────┘
</pre></div>


<p>Network listeners count as a user of the service, therefore there will always be
one user per network port in which the service listens. More details can be
obtained by using the "show service" command.</p>
<h2 id="what-clients-are-connected-to-mariadb-maxscale">What Clients Are Connected To MariaDB MaxScale</h2>
<p>To determine what client are currently connected to MariaDB MaxScale, you can
use the <code>list sessions</code> command within maxctrl. This will give you IP address
and the ID of the session for that connection. As with any maxctrl
command this can be passed on the command line or typed interactively in
maxctrl.</p>
<div><pre><span></span>$ maxctrl list sessions
┌────┬─────────┬──────────────────┬──────────────────────────┬──────┬─────────────────┐
│ Id │ User    │ Host             │ Connected                │ Idle │ Service         │
├────┼─────────┼──────────────────┼──────────────────────────┼──────┼─────────────────┤
│ 6  │ maxuser │ ::ffff:127.0.0.1 │ Thu Aug 27 10:39:16 2020 │ 4    │ RW-Split-Router │
└────┴─────────┴──────────────────┴──────────────────────────┴──────┴─────────────────┘
</pre></div>


<h2 id="rotating-the-log-file">Rotating the Log File</h2>
<p>MariaDB MaxScale logs messages of different priority into a single log file.
With the exception if error messages that are always logged, whether messages of
a particular priority should be logged or not can be enabled via the maxctrl
interface or in the configuration file. By default, MaxScale keeps on writing to
the same log file. To prevent the file from growing indefinitely, the
administrator must take action.</p>
<p>The name of the log file is maxscale.log. When the log is rotated, MaxScale
closes the current log file and opens a new one using the same name.</p>
<p>Log file rotation is achieved by use of the <code>rotate logs</code> command
in maxctrl.</p>
<div><pre><span></span>maxctrl rotate logs
</pre></div>


<p>As there currently is only the maxscale log, that is the only one that will be
rotated.</p>
<p>This may be integrated into the Linux <em>logrotate</em> mechanism by adding a
configuration file to the /etc/logrotate.d directory. If we assume we want to
rotate the log files once per month and wish to keep 5 log files worth of
history, the configuration file would look as follows.</p>
<div><pre><span></span>/var/log/maxscale/maxscale.log {
monthly
rotate 5
missingok
nocompress
sharedscripts
postrotate
\# run if maxscale is running
if test -n "`ps acx|grep maxscale`"; then
/usr/bin/maxctrl rotate logs
fi
endscript
}
</pre></div>


<p>MariaDB MaxScale will also rotate all of its log files if it receives the USR1
signal. Using this the logrotate configuration script can be rewritten as</p>
<div><pre><span></span>/var/log/maxscale/maxscale.log {
monthly
rotate 5
missingok
nocompress
sharedscripts
postrotate
kill -USR1 `cat /var/run/maxscale/maxscale.pid`
endscript
}
</pre></div>


<p>In older versions MaxScale renamed the log file, behavior which is not fully
compliant with the assumptions of logrotate and may lead to issues, depending on
the used logrotate configuration file. From version 2.1 onward, MaxScale will
not itself rename the log file, but when the log is rotated, MaxScale will
simply close and reopen the same log file. That will make the behavior fully
compliant with logrotate.</p>
<h2 id="taking-objects-temporarily-out-of-use">Taking Objects Temporarily Out of Use</h2>
<h3 id="putting-servers-into-maintenance">Putting Servers into Maintenance</h3>
<p>MariaDB MaxScale supports the concept of maintenance mode for servers within a
cluster, this allows for planned, temporary removal of a database from the
cluster within the need to change the MariaDB MaxScale configuration.</p>
<div><pre><span></span>maxctrl set server db-server-3 maintenance
</pre></div>


<p>To achieve the removal of a database server you can use the <code>set server</code> command
in maxctrl to set the maintenance mode flag for the server. This
may be done interactively within maxctrl or by passing the command on the
command line.</p>
<p>This will cause MariaDB MaxScale to stop routing any new requests to the server,
however if there are currently requests executing on the server these will not
be interrupted.</p>
<div><pre><span></span>maxctrl clear server db-server-3 maintenance
</pre></div>


<p>Clearing the maintenance mode for a server will bring it back into use. If
multiple MariaDB MaxScale instances are configured to use the node then
maintenance mode must be set within each MariaDB MaxScale instance.</p>
<h2 id="stopping-and-starting-services">Stopping and Starting Services</h2>
<div><pre><span></span>maxctrl stop service db-service
</pre></div>


<p>Services can be stopped to temporarily halt their use. Stopping a service will
cause it to stop accepting new connections until it is started. New connections
are not refused if the service is stopped and are queued instead. This means
that connecting clients will wait until the service is started again.</p>
<div><pre><span></span>maxctrl start service db-service
</pre></div>


<p>Starting a service will cause it to accept all queued connections that were
created while it was stopped.</p>
<h3 id="stopping-and-starting-monitors">Stopping and Starting Monitors</h3>
<div><pre><span></span>maxctrl stop monitor db-monitor
</pre></div>


<p>Stopping a monitor will cause it to stop monitoring the state of the servers
assigned to it. This is useful when the state of the servers is assigned
manually with <code>maxctrl set server</code>.</p>
<div><pre><span></span>maxctrl start monitor db-monitor
</pre></div>


<p>Starting a monitor will make it resume monitoring of the servers. Any manually
assigned states will be overwritten by the monitor.</p>
<h2 id="runtime-configuration-modification">Runtime Configuration Modification</h2>
<p>The MaxScale configuration can be changed at runtime by using the <code>create</code>,
<code>alter</code> and <code>destroy</code> commands of <code>maxctrl</code>. These commands either create,
modify or destroy objects (servers, services, monitors etc.) inside
MaxScale. The exact syntax for each of the commands and any additional options
that they take can be seen with <code>maxctrl --help &lt;command&gt;</code>.</p>
<p>Not all parameters can be modified at runtime. Refer to the module documentation
for more information on which parameters can be modified at runtime. If a
parameter cannot be modified at runtime, the object can be destroyed and
recreated in order to change it.</p>
<p>All runtime changes are persisted in files stored by default in
<code>/var/lib/maxscale/maxscale.cnf.d/</code>. This means that any changes done at runtime
persist through restarts. Any changes done to objects in the main configuration
file are ignored if a persisted entry is found for it.</p>
<p>For example, if the address of a server is modified with <code>maxctrl alter server
db-server-1 address 192.168.0.100</code>, the file
<code>/var/lib/maxscale/maxscale.cnf.d/db-server-1.cnf</code> is created with the complete
configuration for the object. To remove all runtime changes for all objects,
remove all files found in <code>/var/lib/maxscale/maxscale.cnf.d</code>.</p>
<h3 id="core-parameter-configuration">Core Parameter Configuration</h3>
<p>Modify global MaxScale parameters:</p>
<div><pre><span></span>maxctrl alter maxscale auth_connect_timeout 5s
</pre></div>


<p>Some global parameters cannot be modified at runtime.  Refer to the
<a href="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/">Configuration Guide</a> for a full list
of parameters that can be modified at runtime.</p>
<h3 id="managing-servers">Managing Servers</h3>
<h4 id="create-a-new-server">Create a new server</h4>
<div><pre><span></span>maxctrl create server db-server-1 192.168.0.100 3306
</pre></div>


<h4 id="modify-a-server">Modify a Server</h4>
<div><pre><span></span>maxctrl alter server db-server-1 port 3307
</pre></div>


<h4 id="destroy-a-server">Destroy a Server</h4>
<div><pre><span></span>maxctrl destroy server db-server-1
</pre></div>


<p>A server can only be destroyed if it is not used by any services or monitors. To
automatically remove the server from the services and monitors that use it, use
the <code>--force</code> flag.</p>
<h4 id="drain-a-server">Drain a Server</h4>
<div><pre><span></span>maxctrl set server db-server-1 drain
</pre></div>


<p>When a server is set into the <code>drain</code> state, no new connections to it are
created. Unlike to the <code>maintenance</code> state which immediately closes all
connections, the <code>drain</code> state allows existing connections to be gracefully
closed.</p>
<p>To remove the <code>drain</code> state, use <code>clear server</code> command:</p>
<div><pre><span></span>maxctrl clear server db-server-1 drain
</pre></div>


<p>Servers with the <code>Master</code> state cannot be drained. To drain them, first perform
a switchover to another node and then drain the server.</p>
<h3 id="managing-monitors">Managing Monitors</h3>
<h4 id="create-a-new-monitor">Create a new Monitor</h4>
<div><pre><span></span>maxctrl create monitor db-monitor mariadbmon user=db-user password=db-password
</pre></div>


<h4 id="modify-a-monitor">Modify a Monitor</h4>
<div><pre><span></span>maxctrl alter monitor db-monitor monitor_interval 1000
</pre></div>


<h4 id="add-server-to-a-monitor">Add Server to a Monitor</h4>
<div><pre><span></span>maxctrl link monitor db-monitor db-server-1
</pre></div>


<h4 id="remove-a-server-from-a-monitor">Remove a Server from a Monitor</h4>
<div><pre><span></span>maxctrl unlink monitor db-monitor db-server-1
</pre></div>


<h4 id="destroy-a-monitor">Destroy a Monitor</h4>
<div><pre><span></span>maxctrl destroy monitor db-monitor
</pre></div>


<p>A monitor can only be destroyed if it is not monitoring any servers. To
automatically remove the servers from the monitor, use the <code>--force</code> flag.</p>
<h3 id="managing-services">Managing Services</h3>
<h4 id="create-a-new-service">Create a New Service</h4>
<div><pre><span></span>maxctrl create service db-service readwritesplit user=db-user password=db-password
</pre></div>


<h4 id="modify-a-service">Modify a Service</h4>
<div><pre><span></span>maxctrl alter service db-service user new-db-user
</pre></div>


<h4 id="add-servers-to-a-service">Add Servers to a Service</h4>
<div><pre><span></span>maxctrl link service db-service db-server1
</pre></div>


<p>Any servers added to services will only be used by new sessions. Existing
sessions will use the servers that were available when they connected.</p>
<h4 id="remove-servers-from-a-service">Remove Servers from a Service</h4>
<div><pre><span></span>maxctrl unlink service db-service db-server1
</pre></div>


<p>Similarly to adding servers, removing servers from a service will only affect
new sessions. Existing sessions keep using the servers even if they are removed
from a service.</p>
<h4 id="change-the-filters-of-a-service">Change the Filters of a Service</h4>
<div><pre><span></span>maxctrl alter service-filters my-regexfilter my-qlafilter
</pre></div>


<p>The order of the filters is significant: the first filter will be the first to
receive the query. The new set of filters will only be used by new
sessions. Existing sessions will keep using the filters that were configured
when they connected.</p>
<h4 id="destroy-a-service">Destroy a Service</h4>
<div><pre><span></span>maxctrl destroy service db-service
</pre></div>


<p>The service can only be destroyed if it uses no servers or clusters and has no
listeners associated with it. To force destruction of a service even if it does
use servers or has listeners, use the <code>--force</code> flag. This will also destroy any
listeners associated with the service.</p>
<h3 id="managing-filters">Managing Filters</h3>
<h4 id="create-a-new-filter">Create a New Filter</h4>
<div><pre><span></span>maxctrl create filter regexfilter match=ENGINE=MyISAM replace=ENGINE=InnoDB
</pre></div>


<h4 id="destroy-a-filter">Destroy a Filter</h4>
<div><pre><span></span>maxctrl destroy filter my-regexfilter
</pre></div>


<p>A filter can only be destroyed if it is not used by any services. To
automatically remove the filter from all services using it, use the <code>--force</code>
flag.</p>
<p>Filters cannot be altered at runtime in MaxScale 2.5. To modify the parameters
of a filter, destroy it and recreate it with the modified parameters.</p>
<h3 id="managing-listeners">Managing Listeners</h3>
<h4 id="create-a-new-listener">Create a New Listener</h4>
<div><pre><span></span>maxctrl create listener db-listener db-service 4006
</pre></div>


<h4 id="destroy-a-listener">Destroy a Listener</h4>
<div><pre><span></span>maxctrl destroy listener db-listener
</pre></div>


<p>Destroying a listener will close the network socket and stop it from accepting
new connections. Existing connections that were created through it will keep
displaying it as the originating listener.</p>
<p>Listeners cannot be moved from one service to another. In order to do this, the
listener must be destroyed and then recreated with the new service.</p>
<h2 id="managing-maxctrl-and-rest-api-users">Managing MaxCtrl and REST API Users</h2>
<p>MaxCtrl uses the same credentials as the MaxScale REST API. These users can be
managed via MaxCtrl.</p>
<h3 id="create-a-new-maxctrl-user">Create a New MaxCtrl User</h3>
<div><pre><span></span>maxctrl create user basic-user basic-password
</pre></div>


<p>By default new users are only allowed to read data. To make the account an
administrative account, add the <code>--type=admin</code> option to the command:</p>
<div><pre><span></span>maxctrl create user admin-user admin-password --type=admin
</pre></div>


<p>Administrative accounts are allowed to use all MaxCtrl commands and modify any
parts of MaxScale.</p>
<h3 id="change-the-password-of-an-existing-user">Change the Password of an Existing User</h3>
<div><pre><span></span>maxctrl alter user admin-user new-admin-password
</pre></div>


<h3 id="remove-a-user">Remove a User</h3>
<div><pre><span></span>maxctrl destroy user basic-user
</pre></div>
    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/mariadb-maxscale-2208-filters/">
                        ←  Filters
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/maxscale-22-08-tutorials/">
                        ↑ MaxScale 22.08 Tutorials ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/mariadb-maxscale-2208-maxscale-and-xpand-tutorial/">
                         MaxScale and Xpand Tutorial →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="11649" data-comments-url="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/+comments"
         data-reply-url="/kb/en/mariadb-maxscale-2208-mariadb-maxscale-administration-tutorial/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/maxscale-22-08-tutorials/">
                    ↑ MaxScale 22.08 Tutorials ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-automatic-failover-with-mariadb-monitor/">
                            
                             Automatic Failover With MariaDB Monitor
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-avrorouter-tutorial/">
                            
                             Avrorouter Tutorial
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-configuring-servers/">
                            
                             Configuring Servers
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-configuring-the-galera-monitor/">
                            
                             Configuring the Galera Monitor
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-configuring-the-mariadb-monitor/">
                            
                             Configuring the MariaDB Monitor
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-configuring-the-xpand-monitor/">
                            
                             Configuring the Xpand Monitor
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-connection-routing-with-mariadb-maxscale/">
                            
                             Connection Routing with MariaDB MaxScale
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-encrypting-passwords/">
                            
                             Encrypting Passwords
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-filters/">
                            
                             Filters
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span> MariaDB MaxScale Administration Tutorial</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-maxscale-and-xpand-tutorial/">
                            
                             MaxScale and Xpand Tutorial
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-read-write-splitting-with-mariadb-maxscale/">
                            
                             Read-Write Splitting with MariaDB MaxScale
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-rest-api-tutorial/">
                            
                             REST API Tutorial
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-setting-up-mariadb-maxscale/">
                            
                             Setting up MariaDB MaxScale
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-simple-sharding-with-two-servers/">
                            
                             Simple Sharding with Two Servers
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208-using-maxgui-tutorial/">
                            
                             Using MaxGUI Tutorial
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>