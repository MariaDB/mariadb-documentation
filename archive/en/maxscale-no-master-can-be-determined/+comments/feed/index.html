<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>MariaDB Knowledge Base Comments for: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/feed/</link><description></description><atom:link href="https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/feed/" rel="self"></atom:link><language>en-us</language><lastBuildDate>Mon, 11 Nov 2024 13:54:34 +0000</lastBuildDate><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3664</link><description>&lt;p&gt;"flush logs" helped something: note "already monitored" was shown.
But nothing more was printed regarding re-execution of "add server server1 RWSplit-Service".&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3664</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3661</link><description>&lt;p&gt;With different monitor and service names / settings.&lt;/p&gt;
&lt;pre class="fixed"&gt;MaxScale&amp;gt; add server server1 MariaDB-Monitor RWSplit-Service
Could not add server 'server1' to object 'MariaDB-Monitor'. See error log for more details.
Could not add server 'server1' to object 'RWSplit-Service'. See error log for more details.
&lt;/pre&gt;&lt;p&gt;Where are the log files? I am running these in containers.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3661</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3612</link><description>&lt;p&gt;All are now in containers: maxscale and three mariadb servers.&lt;/p&gt;
&lt;p&gt;Three mariadb servers are in "Running" state again.&lt;/p&gt;
&lt;p&gt;So, maxscale seems to see those servers.
Next: how to connect to DB through the maxscale docker container?&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3612</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3611</link><description>&lt;p&gt;Trying with fresh installation. It seems that ports to containers are closed.
port 3306, mysql, checked with nmap -p 3306 127.17.0.2 --&amp;gt; "closed".&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3611</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3609</link><description>&lt;p&gt;When I try to connect to maxscale with mysql, following error happens,&lt;/p&gt;
&lt;p&gt;ERROR 1045 (28000): failed to create new session&lt;/p&gt;
&lt;p&gt;In logs:&lt;/p&gt;
&lt;pre class="fixed"&gt;Oct 23 08:33:57 mycomputer maxscale[4769]: [readwritesplit] Couldn't find suitable Master from 3 candidates.
Oct 23 08:33:57 mycomputer maxscale[4769]: Failed to create new router session for service 'RWSplit-Service'. See previous errors for more details.
&lt;/pre&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3609</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3606</link><description>&lt;p&gt;I reinstalled mariadb instances. Now with mariadb:10.3.10.&lt;/p&gt;
&lt;p&gt;I created also following "users" and grants for those. Also IP address 127.17.0.1 was added:&lt;/p&gt;
&lt;pre class="fixed"&gt;create user 'maxscale'@'127.17.0.1' identified by 'admin';
create user 'maxscale'@'%' identified by 'admin';
grant all privileges on *.* to 'maxscale'@'127.17.0.1' with grant option;
grant all privileges on *.* to 'maxscale'@'%' with grant option;
&lt;/pre&gt;&lt;p&gt;Still same kinds of problems.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3606</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3605</link><description>&lt;p&gt;There is following error mentioned in journalctl -xe:&lt;/p&gt;
&lt;pre class="fixed"&gt;Oct 19 15:59:40 mycomputer maxscale[31833]: MaxScale started with 2 worker threads, each with a stack size of 8388608 bytes.
Oct 19 15:59:40 mycomputer maxscale[31833]: [mariadbmon] Automatic rejoin was not attempted on server 'server2' even though it is a valid candidate. Will keep retrying with this message suppressed for all servers. Errors: 
                                             'server2' does not have a valid 'gtid_current_pos'.
&lt;/pre&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3605</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3603</link><description>&lt;p&gt;Hi! It is not galera cluster. It is MaxScale with Master Slave Slave (M-S-S) configuration. (M-S would be enough too.)
I have tried with readwritesplit and readconnroute.
There may be something basic missing. Grants given incorrectly? Something else missing / not executed?&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3603</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3602</link><description>&lt;p&gt;Is it a Galera cluster or a cluster with master-slave replication?&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Markus Mäkelä</dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3602</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3601</link><description>&lt;p&gt;Same happens also with readwritesplit.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3601</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3600</link><description>&lt;p&gt;In logs, maxscale otherwise starts up:&lt;/p&gt;
&lt;pre class="fixed"&gt;2018-10-18 07:59:45   info   : [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('maxscale', '127.0.0.1', 'mysql', 1, '4ACFE3202A5FF5CF467898FC58AAB1D615029441')
2018-10-18 07:59:45   info   : [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('maxscale', '10.144.114.162', 'mysql', 1, '4ACFE3202A5FF5CF467898FC58AAB1D615029441')
2018-10-18 07:59:45   notice : [MySQLAuth] [ReadService] Loaded 15 MySQL users for listener ReadListener.
2018-10-18 07:59:45   notice : Listening for connections at [::]:4307 with protocol MySQL
2018-10-18 07:59:45   info   : Started session [2] for ReadService service 
2018-10-18 07:59:45   notice : Service 'ReadService' started (2/3)
2018-10-18 07:59:45   notice : Listening for connections at [/tmp/maxadmin.sock]:0 with protocol MaxScale Admin
2018-10-18 07:59:45   info   : Started session [3] for CLI service 
2018-10-18 07:59:45   notice : Service 'CLI' started (3/3)
2018-10-18 07:59:45   notice : Started MaxScale log flusher.
2018-10-18 07:59:45   info   : [qc_sqlite] In-memory sqlite database successfully opened for thread 140506755454720.
2018-10-18 07:59:45   info   : [qc_sqlite] In-memory sqlite database successfully opened for thread 140506747062016.
2018-10-18 07:59:45   notice : Started REST API on [127.0.0.1]:8989
2018-10-18 07:59:45   info   : [qc_sqlite] In-memory sqlite database successfully opened for thread 140506730276608.
2018-10-18 07:59:45   info   : [qc_sqlite] In-memory sqlite database successfully opened for thread 140506738669312.
2018-10-18 07:59:45   notice : MaxScale started with 4 worker threads, each with a stack size of 8388608 bytes.
&lt;/pre&gt;&lt;p&gt;In other window:
No Master can be determined &lt;/p&gt;
&lt;p&gt;Tried to set as master, but it did not help.&lt;/p&gt;
&lt;p&gt;MaxScale&amp;gt; set server server1 master&lt;/p&gt;
&lt;p&gt;in logs:&lt;/p&gt;
&lt;pre class="fixed"&gt;2018-10-18 08:09:36   info   : (4) [cli] MaxAdmin: set server server1 master
2018-10-18 08:09:36   notice : Server changed state: server1[172.17.0.3:3306]: lost_master. [Master, Running] -&amp;gt; [Running]
&lt;/pre&gt;&lt;p&gt;All servers are in Running state (not as master / slave states):&lt;/p&gt;
&lt;pre class="fixed"&gt;MaxScale&amp;gt; list servers
Servers.
-------------------+-----------------+-------+-------------+--------------------
Server             | Address         | Port  | Connections | Status              
-------------------+-----------------+-------+-------------+--------------------
server1            | 172.17.0.3      |  3306 |           0 | Running
server2            | 172.17.0.4      |  3306 |           0 | Running
server3            | 172.17.0.5      |  3306 |           0 | Running
-------------------+-----------------+-------+-------------+--------------------


&lt;/pre&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3600</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3599</link><description>&lt;p&gt;All grants were tried to be given.
When maxscale is started, the error appears, "No Master can be determined".&lt;/p&gt;
&lt;pre class="fixed"&gt;systemctl status maxscale
● maxscale.service - MariaDB MaxScale Database Proxy
   Loaded: loaded (/lib/systemd/system/maxscale.service; disabled; vendor preset: enabled)
   Active: active (running) since to 2018-10-18 07:59:45 EEST; 6s ago
  Process: 8512 ExecStart=/usr/bin/maxscale (code=exited, status=0/SUCCESS)
  Process: 8508 ExecStartPre=/usr/bin/install -d /var/run/maxscale -o maxscale -g maxscale (code=exited, status=0/SUCCESS)
 Main PID: 8516 (maxscale)
    Tasks: 9
   Memory: 6.6M
      CPU: 144ms
   CGroup: /system.slice/maxscale.service
           └─8516 /usr/bin/maxscale

loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('cm', '172.17.0.2', NULL, 1, '...
loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('maxscale', '127.0.0.1', NULL, 1, '...
loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('maxscale', '127.0.0.%', NULL, 1, '...
loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('cm', '127.0.0.1', NULL, 1, '...
loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('maxscale', '&amp;lt;laptop_ip&amp;gt;', NULL, 1, '...
loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('myuser', '172.17.0.2', 'mysql', 0, '...
loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('maxscale', '172.17.0.2', 'mysql', 1, '...
loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('maxscale', '127.0.0.1', 'mysql', 1, '...
loka 18 07:59:45 mycomputer maxscale[8516]: [MySQLAuth] Added user: INSERT OR REPLACE INTO mysqlauth_users VALUES ('maxscale', '&amp;lt;laptop_ip&amp;gt;', 'mysql', 1, '
loka 18 07:59:45 mycomputer maxscale[8516]: [mariadbmon] No Master can be determined   
&lt;/pre&gt;&lt;p&gt;Following grants were given:&lt;/p&gt;
&lt;pre class="fixed"&gt;grant all privileges on *.* to 'maxscale'@'127.0.0.1' with grant option;

grant all privileges on *.* to 'maxscale'@'&amp;lt;laptop_ip&amp;gt;' with grant option;
&lt;/pre&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3599</guid></item><item><title>Re: MaxScale, "No Master can be determined"</title><link>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3598</link><description>&lt;p&gt;module=galeramon was in comments in maxscale.cnf.&lt;/p&gt;
&lt;p&gt;Trying to copy paste again:&lt;/p&gt;
&lt;pre class="fixed"&gt;
[maxscale]
threads=auto
log_trace=1

[server1]
type=server
address=172.17.0.3
port=3306
protocol=MariaDBBackend

[server2]
type=server
address=172.17.0.4
port=3306
protocol=MariaDBBackend

[server3]
type=server
address=172.17.0.5
port=3306
protocol=MariaDBBackend

[WriteService]
type=service
router=readconnroute
router_options=master
servers=server1,server2,server3
user=maxscale
passwd=paswd

[ReadService]
type=service
router=readconnroute
router_options=slave
servers=server1,server2,server3
user=maxscale
passwd=paswd

[WriteListener]
type=listener
service=WriteService
protocol=MariaDBClient
port=4306
## socket=/tmp/ClusterMaster

[ReadListener]
type=listener
service=ReadService
protocol=MariaDBClient
#protocol=MySQLClient
port=4307

[ReplicationMonitor]
type=monitor
module=mariadbmon
servers=server1,server2,server3
user=maxscale
passwd=paswd
monitor_interval=1000

[CLI]
type=service
router=cli

[CLIListener]
type=listener
service=CLI
protocol=maxscaled
socket=default

&lt;/pre&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sam </dc:creator><guid>https://mariadb.com/kb/en/maxscale-no-master-can-be-determined/+comments/3598</guid></item></channel></rss>