<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>MaxScale Troubleshooting - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="MaxScale Troubleshooting" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/maxscale-troubleshooting/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Troubleshooting tips for all MaxScale versions." />

    <meta name="description" content="Troubleshooting tips for all MaxScale versions." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/maxscale-troubleshooting/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/maxscale-troubleshooting/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/maxscale/">MariaDB MaxScale</a>
    


    » <a class="node_link crumb" href="/kb/en/maxscale-troubleshooting/">MaxScale Troubleshooting</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/maxscale-troubleshooting/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/maxscale-troubleshooting/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/maxscale-troubleshooting/+flag"
                data-flag-url="/kb/en/maxscale-troubleshooting/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/maxscale-troubleshooting/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2018-03-05 07:52">5 years, 10 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2023-12-11 07:54">1 month, 1 week ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/maxscale-troubleshooting/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/maxscale-troubleshooting/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/maxscale-troubleshooting/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/maxscale-troubleshooting/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    



    
    

<div class="well well-small box"><div><h5>Product Versions</h5></div><div>

        <ul id="product_chooser">
            
                <li class="maxscale_from_22_08_4">
                    <label><input type="checkbox" data-product-class="maxscale_from_22_08_4"
                            >MaxScale starting with 22.08.4</label>
                </li>
            
                <li class="maxscale_from_22_08_4">
                    <label><input type="checkbox" data-product-class="maxscale_from_22_08_4"
                            >MaxScale starting with 22.08.4</label>
                </li>
            
                <li class="maxscale_from_22_08_0">
                    <label><input type="checkbox" data-product-class="maxscale_from_22_08_0"
                            >MaxScale starting with 22.08.0</label>
                </li>
            
                <li class="maxscale_from_6_4_5">
                    <label><input type="checkbox" data-product-class="maxscale_from_6_4_5"
                            >MaxScale starting with 6.4.5</label>
                </li>
            
                <li class="maxscale_from_22_08_0">
                    <label><input type="checkbox" data-product-class="maxscale_from_22_08_0"
                            >MaxScale starting with 22.08.0</label>
                </li>
            
                <li class="maxscale_from_6_4_5">
                    <label><input type="checkbox" data-product-class="maxscale_from_6_4_5"
                            >MaxScale starting with 6.4.5</label>
                </li>
            
        </ul>
    
</div>
</div>






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>MaxScale Troubleshooting</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

 <li class="maxscale_from_22_08_4"><a href="#systemd-watchdog-kills-maxscale" title="SystemD Watchdog Kills MaxScale">SystemD Watchdog Kills MaxScale</a></li>

 <li class="maxscale_from_22_08_4"><a href="#high-memory-usage" title="High Memory Usage">High Memory Usage</a> <ol class="toc">

    <li class="maxscale_from_22_08_4"><a href="#profiling-memory-usage" title="Profiling Memory Usage">Profiling Memory Usage</a>    <ol class="toc">

        <li class="maxscale_from_22_08_4"><a href="#debug-binaries" title="Debug Binaries">Debug Binaries</a></li>

        <li class="maxscale_from_22_08_4"><a href="#profiling-release-mode-binaries" title="Profiling Release Mode Binaries">Profiling Release Mode Binaries</a></li>

        <li class="maxscale_from_22_08_4"><a href="#valgrind" title="Valgrind">Valgrind</a>    </ol>
 </ol>
</li>

 <li class="maxscale_from_22_08_4"><a href="#authentication-errors" title="Authentication Errors">Authentication Errors</a> <ol class="toc">

    <li class="maxscale_from_22_08_4"><a href="#access-denied" title="Access Denied">Access Denied</a>    <ol class="toc">

        <li class="maxscale_from_22_08_4"><a href="#verifying-that-a-user-is-allowed-to-connect" title="Verifying that a user is allowed to connect">Verifying that a user is allowed to connect</a></li>

        <li class="maxscale_from_22_08_4"><a href="#checking-maxscale-has-correct-grants" title="Checking MaxScale has correct grants">Checking MaxScale has correct grants</a>        <ol class="toc">

            <li class="maxscale_from_22_08_4"><a href="#service-grants" title="Service Grants">Service Grants</a></li>

            <li class="maxscale_from_22_08_4"><a href="#monitor-grants" title="Monitor Grants">Monitor Grants</a>        </ol>
    </ol>
</li>

    <li class="maxscale_from_22_08_4"><a href="#other-errors" title="Other Errors">Other Errors</a></li>

    <li class="maxscale_from_22_08_4"><a href="#access-denied-errors-for-user-root" title="Access denied errors for user root!">Access denied errors for user root!</a></li>

    <li class="maxscale_from_22_08_4"><a href="#access-denied-on-databasestables-containing-underscores" title="Access denied on databases/tables containing underscores">Access denied on databases/tables containing underscores</a> </ol>
</li>

 <li class="maxscale_from_22_08_4"><a href="#system-errors" title="System Errors">System Errors</a> <ol class="toc">

    <li class="maxscale_from_22_08_4"><a href="#failed-to-write-message-11-resource-temporarily-unavailable" title="Failed to write message: 11, Resource temporarily unavailable">Failed to write message: 11, Resource temporarily unavailable</a></li>

    <li class="maxscale_from_22_08_4"><a href="#error-23-too-many-open-files" title="Error 23: Too many open files">Error 23: Too many open files</a>    <ol class="toc">

        <li class="maxscale_from_22_08_4"><a href="#systemd" title="Systemd">Systemd</a>    </ol>
 </ol>
</li>

 <li class="maxscale_from_22_08_4"><a href="#maxctrl" title="MaxCtrl">MaxCtrl</a> <ol class="toc">

    <li class="maxscale_from_22_08_4"><a href="#error-enoent-no-such-file-or-directory-uv_cwd" title="Error: ENOENT: no such file or directory, uv_cwd">Error: ENOENT: no such file or directory, uv_cwd</a></li>

    <li class="maxscale_from_22_08_4"><a href="#pkg-error-reading-from-file" title="Pkg: Error reading from file.">Pkg: Error reading from file.</a> </ol>
</li>

 <li class="maxscale_from_22_08_4"><a href="#binlogrouter" title="Binlogrouter">Binlogrouter</a> <ol class="toc">

    <li class="maxscale_from_22_08_4"><a href="#commands-not-working" title="Commands not Working">Commands not Working</a> </ol>
</li>

 <li class="maxscale_from_22_08_4"><a href="#maxscale-cdc-avrorouter" title="MaxScale CDC: Avrorouter">MaxScale CDC: Avrorouter</a> <ol class="toc">

    <li class="maxscale_from_22_08_4"><a href="#resetting-conversion-state" title="Resetting conversion state">Resetting conversion state</a></li>

    <li class="maxscale_from_22_08_4"><a href="#binlog-files-are-not-found" title="Binlog files are not found">Binlog files are not found</a></li>

    <li class="maxscale_from_22_08_4"><a href="#access-denied-to-cdc-interface" title="Access denied to CDC interface">Access denied to CDC interface</a> </ol>
</li>

 <li class="maxscale_from_22_08_4"><a href="#coredumps-are-not-being-generated" title="Coredumps Are Not Being Generated">Coredumps Are Not Being Generated</a></li>
</div>
<h1 class="anchored_heading" id="systemd-watchdog-kills-maxscale">SystemD Watchdog Kills MaxScale</h1>
<p>This can occur if a reverse DNS name lookup takes a long time. To disable reverse name lookups of client IPs to client hostnames, add <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#skip_name_resolve">skip_name_resolve=true</a> under the <code>[maxscale]</code> section.</p>
<h1 class="anchored_heading" id="high-memory-usage">High Memory Usage</h1>
<div class="maxscale_from_22_08_4 maxscale from_22_08_4 product"><h5 class="product_title">MaxScale starting with 22.08.4</h5><p>The default value of writeq_high_water was lowered to 64KiB to reduce excessive memory usage. This change should result in a net decrease in memory usage and possibly a small improvement in performance.</p>
</div><p>Set <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#writeq_high_water">writeq_high_water</a> and <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#writeq_low_water">writeq_low_water</a> to lower values, for example <code>writeq_high_water=512</code> and <code>writeq_low_water=128</code>. The default is to buffer a maximum of 16MB in memory before network throttling begins which under intensive loads can result in a large amount of memory being used per client.</p>
<p>The query classifier cache in MaxScale by default takes up to 15% of memory to cache query classification data. This value can be lowered using the <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#query_classifier_cache_size">query_classifier_cache_size</a> parameter.</p>
<p>The <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#retain_last_statements">retain_last_statements</a> and <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#session_trace">session_trace</a> debugging parameters can cause memory usage to increase. Disabling them under intensive loads is recommended if they are not needed. Note that the <code>maxctrl list queries</code> requires that <code>retain_last_statements=1</code> is set.</p>
<h2 class="anchored_heading" id="profiling-memory-usage">Profiling Memory Usage</h2>
<p>Profiling the memory usage can be useful for finding out why MaxScale appears to use more memory than it should. It is especially helpful for analyzing OOM situations or other cases where the memory grows linearly and causes problems.</p>
<p>To profile the memory usage of MaxScale, there are multiple options. The following sections describe the methods that are available.</p>
<p>If a problem in memory usage is identified and it appears to be due to a bug in MaxScale, please open a new bug report on the <a href="https://jira.mariadb.org/browse/MXS">MariaDB Jira under the MaxScale project</a>. Remember to include all the profiling and leak check reports along with the MaxScale version number and the configuration file with all password and other sensitive information removed. </p>
<h3 class="anchored_heading" id="debug-binaries">Debug Binaries</h3>
<p>The easiest option is to install the MaxScale debug binaries which are built with <a href="https://github.com/google/sanitizers/wiki/AddressSanitizer">AddressSanitizer</a> and <a href="https://github.com/google/sanitizers/wiki/AddressSanitizerLeakSanitizer">LeakSanitizer</a> enabled. These are low-impact instrumentation tools that detect memory access errors as well as memory leaks.</p>
<p>Once installed, make sure that the <code>maxlog</code> parameter is not disabled and then start MaxScale. Let it run until the memory usage grows beyond normal limits and then shut MaxScale down with <code>systemctl stop maxscale.service</code>. The MaxScale log should contain a verbose explanation of where memory leaks occurred, if any were found.</p>
<h3 class="anchored_heading" id="profiling-release-mode-binaries">Profiling Release Mode Binaries</h3>
<p>The instructions on the <a href="/kb/en/profiling-memory-usage/">profiling-memory-usage</a> page that are for the MariaDB server also apply to MaxScale. The following modifications to the commands must be done in order for them to work with MaxScale.</p>
<ul start="1"><li>Replace <code>/usr/sbin/mariadbd</code> with <code>/usr/bin/maxscale</code>
</li><li>Replace <code>/var/lib/mysql/</code> with <code>/var/log/maxscale/</code>
</li><li>Replace <code>pidof mariadbd</code> with <code>pidof maxscale</code>
</li><li>Replace <code>mariadb.service</code> with <code>maxscale.service</code>
</li></ul>
<h3 class="anchored_heading" id="valgrind">Valgrind</h3>
<p>Valgrind can be used to analyze memory usage problems but usually it is left as the last resort due to the heavy performance penalty that it incurs. However, the use of Valgrind is simple as it is widely available and can be used with existing MaxScale binaries.</p>
<p>To use <code>valgrind</code> for memory leak detection, edit the systemd service file with <code>systemctl edit maxscale.service</code> and add the following values to it:</p>
<pre class="fixed">[Service]
ExecStart=valgrind --leak-check=full /usr/bin/maxscale -d
Type=simple
</pre><p>Then restart the MaxScale process with <code>systemctl restart maxscale.service</code>. Once the memory problem is confirmed, stop the MaxScale process with <code>systemctl stop maxscale.service</code>. Valgrind will print the leak report into the system journal that can be viewed with <code>journalctl -u maxscale</code>.</p>
<h1 class="anchored_heading" id="authentication-errors">Authentication Errors</h1>
<h2 class="anchored_heading" id="access-denied"><code>Access Denied</code></h2>
<p>If you are receiving authentication errors like this:</p>
<pre>
ERROR 1045 (28000): Access denied for user 'bob'@'office' (using password: YES)
</pre>
<p>Make sure you create users for both <code>'bob'@'office'</code> and <code>'bob'@'maxscale'</code>. The host <code>'office'</code> is where the client is attempting to connect from and <code>'maxscale'</code> is the host where MaxScale is installed.</p>
<p>If you do not want to create a second set of users, you can enable <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#proxy_protocol">proxy_protocol</a> in MaxScale and configure the MariaDB server to <a href="https://mariadb.com/kb/en/server-system-variables/#proxy_protocol_networks">allow proxied connections</a> from the MaxScale host.</p>
<h3 class="anchored_heading" id="verifying-that-a-user-is-allowed-to-connect">Verifying that a user is allowed to connect</h3>
<ul start="1"><li>MaxScale connection
<ol start="1"><li>SSH to the server where MaxScale is installed
</li><li>Connect to MariaDB
</li><li>Check output of <a href="/kb/en/show-grants/"><code>SHOW GRANTS</code></a>
</li></ol>
</li></ul>
<ul start="1"><li>Client connection
<ol start="1"><li>SSH to theserver where client is connecting from
</li><li>Connect to MariaDB
</li><li>Check output of <a href="/kb/en/show-grants/"><code>SHOW GRANTS</code></a>
</li></ol>
</li></ul>
<h3 class="anchored_heading" id="checking-maxscale-has-correct-grants">Checking MaxScale has correct grants</h3>
<h4 class="anchored_heading" id="service-grants">Service Grants</h4>
<p>Make sure that the MaxScale services have a user configured and that it has the correct grants. Refer to <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-authentication-modules/#required-grants">the MariaDB protocol documentation</a> on what grants are required for services.</p>
<h4 class="anchored_heading" id="monitor-grants">Monitor Grants</h4>
<p>The monitor user requires different grants than the service user and each monitor type requires different grants.</p>
<ul start="1"><li><a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-monitor/#required-grants">Asynchronous MariaDB replication with mariadbmon</a>
</li></ul>
<ul start="1"><li><a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-galera-monitor/#required-grants">Galera clusters with galeramon</a>
</li></ul>
<ul start="1"><li><a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-xpand-monitor/#required-grants">Xpand replication</a>
</li></ul>
<h2 class="anchored_heading" id="other-errors">Other Errors</h2>
<p>For all authentication and permission related errors, add <code>debug=enable-statement-logging</code> under the <code>[maxscale]</code> section of your MaxScale configuration file. This will cause all SQL statements to be logged on the notice level which will help you figure out what the problem is.</p>
<h2 class="anchored_heading" id="access-denied-errors-for-user-root">Access denied errors for user root!</h2>
<p>If you want to connect as root, you'll need to add <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#enable_root_user">enable_root_user=true</a> to the service.</p>
<h2 class="anchored_heading" id="access-denied-on-databasestables-containing-underscores">Access denied on databases/tables containing underscores</h2>
<p>There seems to be a bug for databases containing underscores. Connect as root and use "SHOW GRANTS FOR user".</p>
<div style="margin-left:2em"><p> GRANT SELECT ON `my\_database`.* TO 'user'@'%' &lt;-- bad</p>
</div>
<div style="margin-left:2em"><p> GRANT SELECT ON `my_database`.* TO 'user'@'%' &lt;-- good</p>
</div>
<p>If you got a grant containing a escaped underscore, you can add the <a href="https://mariadb.com/kb/en/mariadb-maxscale-2208-mariadb-maxscale-configuration-guide/#strip_db_esc">strip_db_esc=true</a> parameter to the service to automatically strip escape characters or just replace the grant with a unescaped one.</p>
<h1 class="anchored_heading" id="system-errors">System Errors</h1>
<h2 class="anchored_heading" id="failed-to-write-message-11-resource-temporarily-unavailable"><code>Failed to write message: 11, Resource temporarily unavailable</code></h2>
<div class="maxscale_from_22_08_0 maxscale from_22_08_0 product"><h5 class="product_title">MaxScale starting with 22.08.0</h5><p> MaxScale 22.08 no longer uses pipes for internal communication. This means that this error is never logged and the pipe size no longer needs to be adjusted.</p>
</div><div class="maxscale_from_6_4_5 maxscale from_6_4_5 product"><h5 class="product_title">MaxScale starting with 6.4.5</h5><p>Older MaxScale versions suffer from a bug (<a href="https://jira.mariadb.org/browse/MXS-4474">MXS-4474</a>) that caused messages in the queue to take up 4096 bytes of memory per message instead of the intended 24 bytes which translates to a maximum of 256 messages instead of the expected 43690 messages with a 1MiB pipe size. </p>
<p>Starting with MaxScale 6.4.5 and 2.5.25, the size is 24 bytes as expected which causes the maximum limit to be the expected 43690 messages. The problem still theoretically exists under extreme workloads where there are more than 43k concurrent clients but in practice the problem should almost never occur.</p>
</div><p>The MaxScale can log the <code>Failed to write message: 11, Resource temporarily unavailable</code> message under extremely intensive workloads (see <a href="https://jira.mariadb.org/browse/MXS-1983">MXS-1983</a> and <a href="https://jira.mariadb.org/browse/MXS-4474">MXS-4474</a>).</p>
<p>The first action to take when these messages are encountered is to upgrade your MaxScale installation to the latest version. Whenever this message is seen, it means that something is causing the internal message queue in MaxScale to fill up. More often than not it is a sign of a possible bug in MaxScale and most likely has been fixed in the most recent release of MaxScale.  </p>
<p>If this is still seen even after upgrading to the latest release, the pipe buffer size can be increased from the default 1MB to a higher value to prevent the problem from occurring. At least 8MB is recommended and should be increased until the message stops appearing.</p>
<p>To set the pipe buffer size, execute the following command.</p>
<pre>
sudo sysctl -w fs.pipe-max-size=8388608
</pre>
<p>If after all these actions you still see these warnings, please open a bug report on the MariaDB Jira under the MaxScale project.</p>
<h2 class="anchored_heading" id="error-23-too-many-open-files">Error 23: Too many open files</h2>
<p>This is a common error when system limits for open files is too low. The fix to this is to increase the limits.</p>
<h3 class="anchored_heading" id="systemd">Systemd</h3>
<p>Edit or add <code>LimitNOFILE=&lt;number of files&gt;</code> under the <code>[Service]</code> section in <code>/usr/lib/systemd/system/maxscale.service</code>.</p>
<h1 class="anchored_heading" id="maxctrl">MaxCtrl</h1>
<h2 class="anchored_heading" id="error-enoent-no-such-file-or-directory-uv_cwd"><code>Error: ENOENT: no such file or directory, uv_cwd</code></h2>
<p>If MaxCtrl fails to start and throws the following error, it means that the current working directory no longer exists. Moving into a directory that does exist fixes the problem.</p>
<pre class="fixed">pkg/prelude/bootstrap.js:1872
      throw error;
      ^

Error: ENOENT: no such file or directory, uv_cwd
1) If you want to compile the package/file into executable, please pay attention to compilation warnings and specify a literal in 'require' call. 2) If you don't want to compile the package/file into executable and want to 'require' it from filesystem (likely plugin), specify an absolute path in 'require' call using process.cwd() or process.execPath.
    at Object.wrappedCwd [as cwd] (internal/bootstrap/switches/does_own_process_state.js:130:28)
    at /snapshot/maxctrl/node_modules/yargs/build/index.cjs:1:59463
    at Argv (/snapshot/maxctrl/node_modules/yargs/index.cjs:12:16)
    at Object.&lt;anonymous&gt; (/snapshot/maxctrl/node_modules/yargs/index.cjs:7:1)
    at Module._compile (pkg/prelude/bootstrap.js:1926:22)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1114:10)
    at Module.load (internal/modules/cjs/loader.js:950:32)
    at Function.Module._load (internal/modules/cjs/loader.js:790:12)
    at Module.require (internal/modules/cjs/loader.js:974:19)
    at Module.require (pkg/prelude/bootstrap.js:1851:31) {
  errno: -2,
  code: 'ENOENT',
  syscall: 'uv_cwd',
  pkg: true
}
</pre><h2 class="anchored_heading" id="pkg-error-reading-from-file"><code>Pkg: Error reading from file.</code></h2>
<p>If MaxCtrl fails to start and throws this error, it most likely means that the <code>maxctrl</code> executable has been stripped of symbols. To fix this problem, reinstall the MaxScale package.</p>
<h1 class="anchored_heading" id="binlogrouter">Binlogrouter</h1>
<h2 class="anchored_heading" id="commands-not-working">Commands not Working</h2>
<p>Make sure you are connecting on the port where the binlogrouter is listening. A common mistake is to connect to a readwritesplit or readconnroute port and execute the replication configuration commands there.</p>
<h1 class="anchored_heading" id="maxscale-cdc-avrorouter">MaxScale CDC: Avrorouter</h1>
<p>For most problems, resetting the conversion state is the solution. If the conversion repeatedly stops at a certain point, please <a href="https://jira.mariadb.org/browse/MXS">open a bug report</a>.</p>
<h2 class="anchored_heading" id="resetting-conversion-state">Resetting conversion state</h2>
<ul start="1"><li>Stop MaxScale
</li><li>Remove the <code>avro.index</code> and <code>avro-conversion.ini</code> files along with any generated <code>.avro</code> files from the director where the Avro files are stored
</li><li>Start MaxScale
</li></ul>
<h2 class="anchored_heading" id="binlog-files-are-not-found">Binlog files are not found</h2>
<p>Make sure the <code>start_index</code> parameter is set to the lowest binlog file number. For example, to start from <code>mariadb-bin-000005</code>, set <code>start_index=5</code>.</p>
<h2 class="anchored_heading" id="access-denied-to-cdc-interface">Access denied to CDC interface</h2>
<p>Create the user with <code>maxadmin call command cdc add_user &lt;service name&gt; &lt;user&gt; &lt;password&gt;</code> or <code>maxctrl call command cdc add_user &lt;service name&gt; &lt;user&gt; &lt;password&gt;</code>.</p>
<h1 class="anchored_heading" id="coredumps-are-not-being-generated">Coredumps Are Not Being Generated</h1>
<p>Check that <code>sysctl kernel.core_pattern</code> is set to forward coredupms to systemd-coredump:</p>
<pre class="fixed">sysctl -w kernel.core_pattern='|/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %e'
</pre><p>Also make sure that SystemD is configured to allow coredumps. In <span class="external_image">External images are disabled</span> suitable size limits must be set as they are set to zero by default.</p>
<pre class="fixed">$ cat /etc/systemd/coredump.conf
#  This file is part of systemd.
#
#  systemd is free software; you can redistribute it and/or modify it
#  under the terms of the GNU Lesser General Public License as published by
#  the Free Software Foundation; either version 2.1 of the License, or
#  (at your option) any later version.
#
# Entries in this file show the compile time defaults.
# You can change settings by editing this file.
# Defaults can be restored by simply deleting this file.
#
# See coredump.conf(5) for details.

[Coredump]
Storage=external
Compress=yes
ProcessSizeMax=1G
ExternalSizeMax=1G
JournalSizeMax=1G
#MaxUse=
#KeepFree=
</pre><p>Read the MariaDB documentation for <a href="/kb/en/enabling-core-dumps/">enabling-core-dumps</a> and <a href="/kb/en/how-to-produce-a-full-stack-trace-for-mysqld/">how-to-produce-a-full-stack-trace-for-mysqld</a>. Most of the operating system level documentation applies to MaxScale as well except that MaxScale is always run as a SystemD service and it only supports Linux as the platform.</p>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/maxscale-troubleshooting/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/maxscale-troubleshooting/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                
                    <li><a href="/kb/en/maxscale/">
                        ↑ MariaDB MaxScale ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/mariadb-maxscale-23-08/">
                        MariaDB MaxScale 23.08 →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="7466" data-comments-url="/kb/en/maxscale-troubleshooting/+comments"
         data-reply-url="/kb/en/maxscale-troubleshooting/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/maxscale/">
                    ↑ MariaDB MaxScale ↑
                </a>
                </li>
            
            
                
                    <li class="active">
                        <span>MaxScale Troubleshooting</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-23-08/">
                            <span class="pull-right not_primary"></span>
                            MariaDB MaxScale 23.08
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-23-02/">
                            
                            MariaDB MaxScale 23.02
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-2208/">
                            <span class="pull-right not_primary"></span>
                            MariaDB MaxScale 22.08
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-6/">
                            
                            MariaDB MaxScale 6
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-25/">
                            
                            MariaDB MaxScale 2.5
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-24/">
                            
                            MariaDB MaxScale 2.4
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-14/">
                            
                            MariaDB MaxScale 1.4
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-mariadb-maxscale-20/">
                            
                            MariaDB MaxScale 2.0
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-mariadb-maxscale-21/">
                            
                            MariaDB MaxScale 2.1
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-mariadb-maxscale-22/">
                            
                            MariaDB MaxScale 2.2
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-mariadb-maxscale-23/">
                            
                            MariaDB MaxScale 2.3
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>