<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>GET_LOCK - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="GET_LOCK" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/get_lock/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Obtain LOCK." />

    <meta name="description" content="Obtain LOCK." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/get_lock/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/get_lock/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/using-mariadb-server/">Using MariaDB Server</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements-structure/">SQL Statements &amp; Structure</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements/">SQL Statements</a>
    

    
    » <a class="crumb" href="/kb/en/built-in-functions/">Built-in Functions</a>
    

    
    » <a class="crumb" href="/kb/en/secondary-functions/">Secondary Functions</a>
    

    
    » <a class="crumb" href="/kb/en/miscellaneous-functions/">Miscellaneous Functions</a>
    


    » <a class="node_link crumb" href="/kb/en/get_lock/">GET_LOCK</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/get_lock/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/get_lock/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/get_lock/+flag"
                data-flag-url="/kb/en/get_lock/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/get_lock/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2010-08-24 18:28">12 years, 10 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2023-05-29 19:32">4 weeks, 1 day ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/get_lock/+license/">GPLv2 fill_help_tables.sql</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/get_lock/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/get_lock/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/get_lock/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    
        

<div class="well well-small box"><div><h5>Localized Versions</h5></div><div>

        <ul>
            
            <li><a href="/kb/it/get_lock/">GET_LOCK</a> [it]</li>
            
            <li><a href="/kb/fr/get_lock/">GET_LOCK</a> [fr]</li>
            
        </ul>
        
</div>
</div>

    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>GET_LOCK</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <h2 class="anchored_heading" id="syntax">Syntax</h2>
<pre class="fixed">GET_LOCK(str,timeout)
</pre><div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#syntax" title="Syntax">Syntax</a></li>

    <li class=""><a href="#description" title="Description">Description</a></li>

    <li class=""><a href="#examples" title="Examples">Examples</a></li>

    <li class=""><a href="#see-also" title="See Also">See Also</a> </ol>
</li>
</div>
<h2 class="anchored_heading" id="description">Description</h2>
<p>Tries to obtain a lock with a name given by the string <code>str</code>, using a timeout of <code>timeout</code> seconds. Returns <code>1</code> if the lock was obtained successfully, <code>0</code> if the attempt timed out (for example, because another client has previously locked the name), or  <code>NULL</code> if an error occurred (such as running out of memory or the thread was killed with <a href="mariadb-admin_kill">mariadb-admin kill</a>).</p>
<p>A lock is released with <a href="/kb/en/release_lock/">RELEASE_LOCK()</a>, when the connection terminates (either normally or abnormally). A connection can hold multiple locks at the same time, so a lock that is no longer needed needs to be explicitly released.</p>
<p>The <a href="/kb/en/is_free_lock/">IS_FREE_LOCK</a> function returns whether a specified lock a free or not, and the <a href="/kb/en/is_used_lock/">IS_USED_LOCK</a> whether the function is in use or not.</p>
<p>Locks obtained with <code>GET_LOCK()</code> do not interact with transactions. That is, committing a transaction does not release any such locks obtained during the transaction.</p>
<p>It is also possible to recursively set the same lock. If a lock with the same name is set <code>n</code> times, it needs to be released <code>n</code> times as well. </p>
<p><code>str</code> is case insensitive for <code>GET_LOCK()</code> and related functions. If <code>str</code> is an empty string or <code>NULL</code>, <code>GET_LOCK()</code> returns <code>NULL</code> and does nothing. <code>timeout</code> supports microseconds.</p>
<p>If the <a href="/kb/en/metadata-lock-info/">metadata_lock_info</a> plugin is installed, locks acquired with this function are visible in the <a href="/kb/en/information_schema/">Information Schema</a> <a href="/kb/en/information-schema-metadata_lock_info-table/">METADATA_LOCK_INFO</a> table.</p>
<p>This function can be used to implement application locks or to simulate record locks. Names are locked on a server-wide basis. If a name has been locked by one client, <code>GET_LOCK()</code> blocks any request by another client for a lock with the same name. This allows clients that agree on a given lock name to use the name to perform cooperative advisory locking. But be aware that it also allows a client that is not among the set of cooperating clients to lock a name, either inadvertently or deliberately, and thus prevent any of the cooperating clients from locking that name. One way to reduce the likelihood of this is to use lock names that are database-specific or application-specific. For example, use lock names of the form <code>db_name.str</code> or <code>app_name.str</code>.</p>
<p>Statements using the <code>GET_LOCK</code> function are <a href="/kb/en/unsafe-statements-for-statement-based-replication/">not safe for statement-based replication</a>.</p>
<p>The patch to permit multiple locks was <a href="http://kostja-osipov.livejournal.com/46410.html">contributed by Konstantin "Kostja" Osipov</a> (<a href="https://jira.mariadb.org/browse/MDEV-3917">MDEV-3917</a>).</p>
<h2 class="anchored_heading" id="examples">Examples</h2>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span> <span class="n">IS_FREE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">),</span> <span class="n">IS_USED_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
<span class="o">|</span> <span class="n">IS_FREE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">IS_USED_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
<span class="o">|</span>                     <span class="mi">0</span> <span class="o">|</span>                    <span class="mi">46</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>

<span class="k">SELECT</span> <span class="n">IS_FREE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">),</span> <span class="n">IS_USED_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
<span class="o">|</span> <span class="n">IS_FREE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">IS_USED_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
<span class="o">|</span>                     <span class="mi">1</span> <span class="o">|</span>                  <span class="k">NULL</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
</pre><p>Multiple locks can be held:</p>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span> <span class="n">IS_FREE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">),</span> <span class="n">IS_FREE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
<span class="o">|</span> <span class="n">IS_FREE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">IS_FREE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
<span class="o">|</span>                     <span class="mi">0</span> <span class="o">|</span>                     <span class="mi">0</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>

<span class="k">SELECT</span> <span class="n">RELEASE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">),</span> <span class="n">RELEASE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
<span class="o">|</span> <span class="n">RELEASE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock1&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">RELEASE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock2&#39;</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
<span class="o">|</span>                     <span class="mi">1</span> <span class="o">|</span>                     <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+-----------------------+</span>
</pre><p>It is possible to hold the same lock recursively. This example is viewed using the <a href="/kb/en/metadata-lock-info/">metadata_lock_info</a> plugin:</p>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock3&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock3&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock3&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock3&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>

<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">METADATA_LOCK_INFO</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+---------------------+---------------+-----------+--------------+------------+</span>
<span class="o">|</span> <span class="n">THREAD_ID</span> <span class="o">|</span> <span class="n">LOCK_MODE</span>           <span class="o">|</span> <span class="n">LOCK_DURATION</span> <span class="o">|</span> <span class="n">LOCK_TYPE</span> <span class="o">|</span> <span class="n">TABLE_SCHEMA</span> <span class="o">|</span> <span class="k">TABLE_NAME</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+---------------------+---------------+-----------+--------------+------------+</span>
<span class="o">|</span>        <span class="mi">46</span> <span class="o">|</span> <span class="n">MDL_SHARED_NO_WRITE</span> <span class="o">|</span> <span class="k">NULL</span>          <span class="o">|</span> <span class="k">User</span> <span class="k">lock</span> <span class="o">|</span> <span class="n">lock3</span>        <span class="o">|</span>            <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+---------------------+---------------+-----------+--------------+------------+</span>

<span class="k">SELECT</span> <span class="n">RELEASE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock3&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span> <span class="n">RELEASE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock3&#39;</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span>                     <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">METADATA_LOCK_INFO</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+---------------------+---------------+-----------+--------------+------------+</span>
<span class="o">|</span> <span class="n">THREAD_ID</span> <span class="o">|</span> <span class="n">LOCK_MODE</span>           <span class="o">|</span> <span class="n">LOCK_DURATION</span> <span class="o">|</span> <span class="n">LOCK_TYPE</span> <span class="o">|</span> <span class="n">TABLE_SCHEMA</span> <span class="o">|</span> <span class="k">TABLE_NAME</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+---------------------+---------------+-----------+--------------+------------+</span>
<span class="o">|</span>        <span class="mi">46</span> <span class="o">|</span> <span class="n">MDL_SHARED_NO_WRITE</span> <span class="o">|</span> <span class="k">NULL</span>          <span class="o">|</span> <span class="k">User</span> <span class="k">lock</span> <span class="o">|</span> <span class="n">lock3</span>        <span class="o">|</span>            <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+---------------------+---------------+-----------+--------------+------------+</span>

<span class="k">SELECT</span> <span class="n">RELEASE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock3&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span> <span class="n">RELEASE_LOCK</span><span class="p">(</span><span class="s1">&#39;lock3&#39;</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span>                     <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>

<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">METADATA_LOCK_INFO</span><span class="p">;</span>
<span class="n">Empty</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="n">sec</span><span class="p">)</span>
</pre><p>Timeout example: Connection 1:</p>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock4&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock4&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
</pre><p>Connection 2:</p>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock4&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</pre><p>After 10 seconds...</p>
<pre class="fixed"><span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock4&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">0</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
</pre><p>Deadlocks are automatically detected and resolved. Connection 1:</p>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock5&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> 
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock5&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
</pre><p>Connection 2:</p>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock6&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock6&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
</pre><p>Connection 1:</p>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock6&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> 
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock6&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span>                    <span class="mi">0</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
</pre><p>Connection 2:</p>
<pre class="fixed"><span class="k">SELECT</span> <span class="n">GET_LOCK</span><span class="p">(</span><span class="s1">&#39;lock5&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="n">ERROR</span> <span class="mi">1213</span> <span class="p">(</span><span class="mi">40001</span><span class="p">):</span> <span class="n">Deadlock</span> <span class="k">found</span> <span class="k">when</span> <span class="n">trying</span> <span class="k">to</span> <span class="k">get</span> <span class="k">lock</span><span class="p">;</span> <span class="n">try</span> <span class="n">restarting</span> <span class="n">transaction</span>
</pre><h2 class="anchored_heading" id="see-also">See Also</h2>
<ul start="1"><li><a href="/kb/en/release_lock/">RELEASE_LOCK</a>
</li><li><a href="/kb/en/is_free_lock/">IS_FREE_LOCK</a>
</li><li><a href="/kb/en/is_used_lock/">IS_USED_LOCK</a>
</li><li><a href="/kb/en/release_all_locks/">RELEASE_ALL_LOCKS</a></li></ul>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/get_lock/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/get_lock/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                
                    <li><a href="/kb/en/miscellaneous-functions/">
                        ↑ Miscellaneous Functions ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/inet6_aton/">
                        INET6_ATON →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="833" data-comments-url="/kb/en/get_lock/+comments"
         data-reply-url="/kb/en/get_lock/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/miscellaneous-functions/">
                    ↑ Miscellaneous Functions ↑
                </a>
                </li>
            
            
                
                    <li class="active">
                        <span>GET_LOCK</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/inet6_aton/">
                            
                            INET6_ATON
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/inet6_ntoa/">
                            
                            INET6_NTOA
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/inet_aton/">
                            
                            INET_ATON
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/inet_ntoa/">
                            
                            INET_NTOA
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/is_free_lock/">
                            
                            IS_FREE_LOCK
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/is_ipv4/">
                            
                            IS_IPV4
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/is_ipv4_compat/">
                            
                            IS_IPV4_COMPAT
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/is_ipv4_mapped/">
                            
                            IS_IPV4_MAPPED
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/is_ipv6/">
                            
                            IS_IPV6
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/is_used_lock/">
                            
                            IS_USED_LOCK
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/master_gtid_wait/">
                            
                            MASTER_GTID_WAIT
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/master_pos_wait/">
                            
                            MASTER_POS_WAIT
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/name_const/">
                            
                            NAME_CONST
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/release_all_locks/">
                            
                            RELEASE_ALL_LOCKS
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/release_lock/">
                            
                            RELEASE_LOCK
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/sleep/">
                            
                            SLEEP
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/sys_guid/">
                            
                            SYS_GUID
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/uuid/">
                            
                            UUID
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/uuid_short/">
                            
                            UUID_SHORT
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/values-value/">
                            
                            VALUES / VALUE
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>