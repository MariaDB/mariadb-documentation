<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title> Data archiving with Mqfilter and Tee filters - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content=" Data archiving with Mqfilter and Tee filters" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Data archiving with Mqfilter and Tee filters
This tutorial gives a quick look into how you can combine various filters to create 
systems for archiving data for analysis. The ..." />

    <meta name="description" content="Data archiving with Mqfilter and Tee filters
This tutorial gives a quick look into how you can combine various filters to create 
systems for archiving data for analysis. The ..." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/maxscale/">MariaDB MaxScale</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-maxscale-mariadb-maxscale-20/">MariaDB MaxScale 2.0</a>
    

    
    » <a class="crumb" href="/kb/en/maxscale-20-tutorials/">MaxScale 2.0 Tutorials</a>
    


    » <a class="node_link crumb" href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/"> Data archiving with Mqfilter and Tee filters</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+flag"
                data-flag-url="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2016-10-03 15:32">6 years, 8 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2016-10-03 15:32">6 years, 8 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
        <dt>Source</dt>
        <dd><a href="https://github.com/mariadb-corporation/MaxScale/blob/2.0.6/Documentation/Tutorials/RabbitMQ-And-Tee-Archiving.md">GitHub</a></dd>
        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1> Data archiving with Mqfilter and Tee filters</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <h1 id="data-archiving-with-mqfilter-and-tee-filters">Data archiving with Mqfilter and Tee filters</h1>
<p>This tutorial gives a quick look into how you can combine various filters to create 
systems for archiving data for analysis. The aim of this tutorial is to show
what can be done with MariaDB MaxScale's filters rather than demonstrate a proven method
of archiving data. For this tutorial you will need two MariaDB/MySQL servers, one for
archiving the data and one for actual use, a RabbitMQ server and a MariaDB MaxScale server.
For testing purposes some of these can locate on the same server but for actual
use, an HA solution is recommended.</p>
<p><img src="https://raw.githubusercontent.com/mariadb-corporation/MaxScale/2.0.6/Documentation/Tutorials/images/rabbit-and-tee.png"></p>
<p>The use case for this tutorial is a production system with one main server where all
queries are routed and an archive server where only INSERT, UPDATE and DELETE statements
are routed. The queries routed to the archive servers are also transformed into a canonical
format and sent to a RabbitMQ broker for analysis. This setup allows us to control what we
send to the server and could possibly allow us to filter out DELETE statements completely,
making the archive server a true archive of all data.</p>
<h2 id="setting-up-mariadb-maxscale">Setting up MariaDB MaxScale</h2>
<p>The installation of MariaDB MaxScale is covered in the Installation chapter of the <a href="/kb/en/mariadb-maxscale-20-setting-up-mariadb-maxscale/">MariaDB MaxScale Tutorial</a>.</p>
<h2 id="setting-up-the-mariadbmysql-servers">Setting up the MariaDB/MySQL servers</h2>
<p>Since the archive server will not replicate from the main server, we don't need to
set up replication between the two. The only thing we need to do is to create the
users we will use for monitoring and authentication.</p>
<p>The process of creating monitoring and authentication users for MariaDB MaxScale is described 
in the Creating Database Users section of the <a href="/kb/en/mariadb-maxscale-20-setting-up-mariadb-maxscale/">MariaDB MaxScale Tutorial</a>.</p>
<h2 id="setting-up-rabbitmq-server">Setting up RabbitMQ server</h2>
<p>To set up the RabbitMQ server, follow the instructions for your OS on the <a href="https://www.rabbitmq.com/download.html">RabbitMQ website</a>.
Useful documentation about access rights can be found on the <a href="https://www.rabbitmq.com/access-control.html">Access Control</a>
page and for UNIX systems the <a href="https://www.rabbitmq.com/man/rabbitmqctl.1.man.html"><code>rabbitmqctl</code> manpage</a>
has all the needed commands to manage your installation of RabbitMQ.</p>
<p>For this tutorial, we will use a RabbitMQ server installed on a CentOS 7 from
the RPM packages. Since CentOS 7 doesn't have the RabbitMQ server in the default
repositories, we will need two extra repositories: The EPEL repository and the Erlang repository.</p>
<ul>
<li><a href="https://fedoraproject.org/wiki/EPEL">EPEL repositories</a></li>
<li><a href="https://www.erlang-solutions.com/resources/download.html">Erlang repositories</a></li>
</ul>
<p>First we need the EPEL and Erlang repositories for CentOS 7 after which we will install the RabbitMQ server:</p>
<div><pre><span></span>sudo yum -y install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
sudo yum -y install http://packages.erlang-solutions.com/erlang-solutions-1.0-1.noarch.rpm
sudo yum -y install https://www.rabbitmq.com/releases/rabbitmq-server/v3.5.6/rabbitmq-server-3.5.6-1.noarch.rpm
</pre></div>


<p>Next step is to start the RabbitMQ server and configure it.</p>
<div><pre><span></span>sudo systemctl start rabbitmq-server
</pre></div>


<p>We need to create the <code>msguser</code> account which we will use to relay the messages
to the broker. This can be done with the <code>rabbitmqctl</code> command.</p>
<div><pre><span></span>sudo rabbitmqctl add_user "msguser" "msgpwd"
sudo rabbitmqctl set_permissions "msguser" ".*" ".*" ".*"
</pre></div>


<p>This creates the <code>msguser</code> account with <code>msgpwd</code> as the password and grants read, write and configurations
permissions on the default virtual host <code>/</code>.</p>
<h2 id="configuration-file-creation">Configuration file creation</h2>
<p>The final step before testing is the creation of the maxscale.cnf file. We start off by adding the two
servers to the configuration file.</p>
<div><pre><span></span>[production-1]
type=server
address=192.168.0.200
port=3306
protocol=MySQLBackend

[archive-1]
type=server
address=192.168.0.201
port=3000
protocol=MySQLBackend
</pre></div>


<p>After we have defined the <code>production-1</code> and <code>archive-1</code> servers, we need a monitor
module for those servers. This module will detect if connectivity to the servers
is lost and notify MariaDB MaxScale of the changed server states.</p>
<div><pre><span></span>[MySQL Monitor]
type=monitor
module=mysqlmon
servers=production-1, archive-1
user=maxuser
passwd=maxpwd
monitor_interval=5000
</pre></div>


<p>The monitor will use the user <code>maxuser</code> with the password <code>maxpwd</code> to connect to
the servers and query them for their state. In the <code>servers</code> parameter we have
listed both of the <code>production-1</code> and <code>archive-1</code> servers. All objects in the
MariaDB MaxScale configuration file are referred by their section names. Here the section
names of the servers are used in the <code>servers</code> parameter. The <code>monitor_interval</code>
parameter controls how often the monitor will poll the servers for status. For
this tutorial, we've set it to 5000 milliseconds.</p>
<p>Next we configure the Production and Archive services. The Production service will
be the main access point to the system.</p>
<div><pre><span></span>[Production]
type=service
router=readconnroute
servers=production-1
user=maxuser
passwd=maxpwd
filters=Tee

[Archive]
type=service
router=readconnroute
servers=archive-1
user=maxuser
passwd=maxpwd
filters=MQ Filter
</pre></div>


<p>The <code>filters</code> parameters for the services refer to the filters we will be creating next.
The Production service will use the Tee filter to duplicate INSERT, UPDATE and DELETE
statements to the Archive service. The statements passed to the Archive service will
use the MQ Filter to send the canonical versions of the statements to the RabbitMQ broker.
The Production service will use the <code>production-1</code> server and the Archive service will
use the <code>archive-1</code> server. Both services user the <code>maxuser</code> user with the <code>maxpwd</code> password.</p>
<p>Next we will configure the listeners for these two services.</p>
<div><pre><span></span>[Production Listener]
type=listener
service=Production
protocol=MySQLClient
port=4000

[Archive Listener]
type=listener
service=Archive
protocol=MySQLClient
port=4001
</pre></div>


<p>The <code>port</code> parameter controls which port the listener will listen on and where the client
connections should be made. The <code>service</code> parameter tells which listener belongs to which
service.</p>
<p>After the services and their listeners are configured we will configure the two filters we'll use. We
begin with the Tee filter.</p>
<div><pre><span></span>[Tee]
type=filter
module=tee
service=Archive
match=\(insert\)\|\(update\)\|\(delete\)
</pre></div>


<p>The <code>service</code> parameter controls which service we want to duplicate the statements to.
This needs to be set to the section name of the archive service: <code>Archive</code>. The <code>match</code>
parameter is a regular expression which, if matched, cause the statement to be duplicated.
Here we will want a regular expression which will match the INSERT, UPDATE and DELETE
statements.</p>
<p>After the Tee filter is configured, we will configure the Mqfilter to communicate with
the RabbitMQ server we've set up.</p>
<div><pre><span></span>[MQ Filter]
type=filter
module=mqfilter
hostname=192.168.0.201
port=5672
username=msguser
password=msgpwd
exchange=msg-ex-1
queue=msg-queue-1
key=MaxScale
</pre></div>


<p>The <code>hostname</code> is the address and the <code>port</code> is the port of the RabbitMQ server. For
<code>username</code> and <code>password</code> we will use the <code>msguser</code> and <code>msgpwd</code> credentials we
created earlier. The <code>exchange</code> is the name of the RabbitMQ exchange we're using and
the <code>key</code> is the key used for all the sent messages. The messages will be stored
in the <code>mxs-queue-1</code> queue.</p>
<p>The last thing to add is the administration interface.</p>
<div><pre><span></span>[MaxAdmin Service]
type=service
router=cli

[MaxAdmin Listener]
type=listener
service=MaxAdmin Service
protocol=maxscaled
socket=default
</pre></div>


<p>Now we have created the MariaDB MaxScale configuration file and all we need to do is to save
it in <code>/etc/maxscale.cnf</code>, start MariaDB MaxScale and test that it works. The testing will
be done in the next section.</p>
<p>Here is the complete configuration file.</p>
<div><pre><span></span># The production and archive servers
[production-1]
type=server
address=192.168.0.200
port=3306
protocol=MySQLBackend

[archive-1]
type=server
address=192.168.0.201
port=3000
protocol=MySQLBackend

# MySQL server monitor
[MySQL Monitor]
type=monitor
module=mysqlmon
servers=production-1, archive-1
user=maxuser
passwd=maxpwd
monitor_interval=5000

# Production service
[Production]
type=service
router=readconnroute
servers=production-1
user=maxuser
passwd=maxpwd
filters=Tee

# Archive service
[Archive]
type=service
router=readconnroute
servers=archive-1
user=maxuser
passwd=maxpwd
filters=MQ Filter

# Listeners for the services
[Production Listener]
type=listener
service=Production
protocol=MySQLClient
port=4000

[Archive Listener]
type=listener
service=Archive
protocol=MySQLClient
port=4001

# Tee filter to duplicate insert, update and delete
# statements to the archive server
[Tee]
type=filter
module=tee
service=Archive
match=\(insert\)\|\(update\)\|\(delete\)

# Mqfilter to log the canonical versions of the archive
# server queries to a RabbitMQ broker
[MQ Filter]
type=filter
module=mqfilter
hostname=192.168.0.201
port=5672
username=msguser
password=msgpwd
exchange=msg-ex-1
queue=msg-queue-1
key=MaxScale

# Administration interface setup
[MaxAdmin Service]
type=service
router=cli

[MaxAdmin Listener]
type=listener
service=MaxAdmin Service
protocol=maxscaled
port=6603
</pre></div>


<h2 id="testing-the-setup">Testing the setup</h2>
<p>Now that we have created the configuration file, prepared the RabbitMQ server
and the database servers we can start testing the setup. We do that by starting
MariaDB MaxScale:</p>
<div><pre><span></span>sudo systemctl start maxscale
</pre></div>


<p>We can see the state of the two servers with MaxAdmin:</p>
<div><pre><span></span>maxadmin list servers

Servers.
-------------------+-----------------+-------+-------------+--------------------
Server             | Address         | Port  | Connections | Status              
-------------------+-----------------+-------+-------------+--------------------
production-1       | 192.168.0.200   |  3306 |           0 | Running
archive-1          | 192.168.0.201   |  3000 |           0 | Running
-------------------+-----------------+-------+-------------+--------------------
</pre></div>


<p>We can also check the queue status on the RabbitMQ server:</p>
<div><pre><span></span>sudo rabbitmqctl list_queues

Listing queues ...
</pre></div>


<p>If we create a connection on the Production service on port 4000 and execute
a set of data modifying statements we should see an equal number of statements
being sent to the RabbitMQ server:</p>
<div><pre><span></span>MariaDB [(none)]&gt; insert into test.t1 values(1);
Query OK, 1 row affected (0.09 sec)

MariaDB [(none)]&gt; insert into test.t1 values(2);
Query OK, 1 row affected (0.07 sec)

MariaDB [(none)]&gt; update test.t1 set id = 0;
Query OK, 2 rows affected (0.05 sec)
Rows matched: 2  Changed: 2  Warnings: 0
</pre></div>


<p>On the RabbitMQ server we can see the new queue <code>msg-queue-1</code> with three new messages in it.</p>
<div><pre><span></span>sudo rabbitmqctl list_queues

Listing queues ...
msg-queue-1 3
</pre></div>


<p>We can also see the data on the archive server:</p>
<div><pre><span></span>MariaDB [(none)]&gt; select * from test.t1;
+------+
| id   |
+------+
|    0 |
|    0 |
+------+
2 rows in set (0.00 sec)
</pre></div>


<p>To read the data from the RabbitMQ, we can use the RabbitMQ Consumer tool
included in the MariaDB MaxScale source. For a tutorial on how to use this tool,
please read <a href="/kb/en/mariadb-maxscale-20-rabbitmq-consumer-client/">RabbitMQ Consumer Client</a>.</p>
    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/mariadb-maxscale-20-connection-routing-with-mysql-replication/">
                        ←  Connection Routing with MySQL Replication
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/maxscale-20-tutorials/">
                        ↑ MaxScale 2.0 Tutorials ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/5948/">
                         Filters →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="5988" data-comments-url="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/+comments"
         data-reply-url="/kb/en/mariadb-maxscale-20-data-archiving-with-mqfilter-and-tee-filters/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/maxscale-20-tutorials/">
                    ↑ MaxScale 2.0 Tutorials ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-avrorouter-tutorial/">
                            
                             Avrorouter Tutorial
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-connection-routing-with-mysql-replication/">
                            
                             Connection Routing with MySQL Replication
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span> Data archiving with Mqfilter and Tee filters</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/5948/">
                            
                             Filters
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-mariadb-maxscale-administration-tutorial/">
                            
                             MariaDB MaxScale Administration Tutorial
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-mariadb-maxscale-as-a-binlog-server/">
                            
                             MariaDB MaxScale as a Binlog Server
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-mariadb-maxscale-nagios-plugins-for-nagios-351/">
                            
                             MariaDB MaxScale Nagios plugins, for Nagios 3.5.1
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-maxinfo-plugin/">
                            
                             MaxInfo Plugin
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-mysql-cluster-setup-and-mariadb-maxscale-configuration/">
                            
                             MySQL Cluster setup and MariaDB MaxScale configuration
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-rabbit-mq-setup-and-mariadb-maxscale-integration/">
                            
                             Rabbit MQ setup and MariaDB MaxScale Integration
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-readwrite-splitting-with-galera-cluster/">
                            
                             Read/Write Splitting with Galera Cluster
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-readwrite-splitting-with-mysql-replication/">
                            
                             Read/Write Splitting with MySQL Replication
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-setting-up-mariadb-maxscale/">
                            
                             Setting up MariaDB MaxScale
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-simple-sharding-with-two-servers/">
                            
                            MaxScale 2.0 Simple Sharding with Two Servers
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-maxscale-20-maxscale-connection-routing-with-galera-cluster/">
                            
                            MaxScale Connection Routing with Galera Cluster
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>