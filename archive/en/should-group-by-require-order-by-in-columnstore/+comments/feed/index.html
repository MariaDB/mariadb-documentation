<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>MariaDB Knowledge Base Comments for: Should GROUP BY require ORDER BY in columnstore?</title><link>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/feed/</link><description></description><atom:link href="https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/feed/" rel="self"></atom:link><language>en-us</language><lastBuildDate>Mon, 21 Oct 2024 13:58:40 +0000</lastBuildDate><item><title>Re: Should GROUP BY require ORDER BY in columnstore?</title><link>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/3227</link><description>&lt;p&gt;Thanks Andrew,
I had originally tested this as one query.  I should have pasted in this query,
&lt;/p&gt;&lt;pre class="fixed"&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DAY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timestamp_&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;FORMAT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;SUM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numeric_val&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;FORMAT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;AVG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numeric_val&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
    &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;cs1&lt;/span&gt;
    &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;timestamp_&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;2017-09-01 00:00:00&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="n"&gt;timestamp_&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;2017-10-01 00:00:00&amp;#39;&lt;/span&gt;
       &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;228091&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;228231&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;228233&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;227867&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;228216&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;228241&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;GROUP&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="k"&gt;DAY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timestamp_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;ASC&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;
 I separated it hoping to get past the max_length_for_sort_data problem.  This query executes if the columns 'Total' and 'Average' are not formatted.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Mike Thibodeau</dc:creator><guid>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/3227</guid></item><item><title>Re: Should GROUP BY require ORDER BY in columnstore?</title><link>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/3225</link><description>&lt;p&gt;In this particular case the GROUP BY wouldn't order because it is within a subquery. But the MCOL ticket has it without the subquery so we will investigate ASAP.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://jira.mariadb.org/browse/MCOL-643"&gt;MCOL-643&lt;/a&gt; is semi-related. You need to set it max_length_for_sort_data high in ColumnStore for now. The reason is too complex to explain here. But we are working with the MariaDB Server team on a solution for this right now.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Andrew Hutchings</dc:creator><guid>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/3225</guid></item><item><title>Re: Should GROUP BY require ORDER BY in columnstore?</title><link>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/3224</link><description>&lt;p&gt;Thanks Andrew,&lt;/p&gt;
&lt;p&gt;I have created &lt;a href="https://jira.mariadb.org/browse/MCOL-1180"&gt;MCOL-1180&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Also, seems like this may be related to &lt;a href="https://jira.mariadb.org/browse/MCOL-643"&gt;MCOL-643&lt;/a&gt;.  If you wrap the SUM or AVG function with a FORMAT function in the test case you get the error message:
&lt;/p&gt;&lt;pre class="fixed"&gt; Error Code: 1815
Internal error: IDB-2015: Sorting length exceeded. Session variable max_length_for_sort_data needs to be set higher.
&lt;/pre&gt;
&lt;p&gt;I found this to be the case even if I put the main query in a derived table.  The query will execute if &lt;code class="fixed" style="white-space:pre-wrap"&gt;max_length_for_sort_data&lt;/code&gt; is set to 3M but will fail with the default of 1024.&lt;/p&gt;
&lt;pre class="fixed"&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="o"&gt;`&lt;/span&gt;&lt;span class="k"&gt;Day&lt;/span&gt;&lt;span class="o"&gt;`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FORMAT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Total&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;FORMAT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Average&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
    &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DAY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timestamp_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Day&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;SUM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numeric_val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="n"&gt;Total&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;AVG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numeric_val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="n"&gt;Average&lt;/span&gt; 
                &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;cs1&lt;/span&gt;
                &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;timestamp_&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;2017-09-01 00:00:00&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="n"&gt;timestamp_&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;2017-10-01 00:00:00&amp;#39;&lt;/span&gt;
                  &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;228091&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;228231&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;228233&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;227867&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;228216&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;228241&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                  &lt;span class="k"&gt;GROUP&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="k"&gt;DAY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timestamp_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;ASC&lt;/span&gt;                
           &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; 
      &lt;span class="k"&gt;ORDER&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="o"&gt;`&lt;/span&gt;&lt;span class="k"&gt;Day&lt;/span&gt;&lt;span class="o"&gt;`&lt;/span&gt;
&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Mike Thibodeau</dc:creator><guid>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/3224</guid></item><item><title>Re: Should GROUP BY require ORDER BY in columnstore?</title><link>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/3223</link><description>&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;That behaviour does not sound correct. Can you please file a bug, preferably with a test case, at:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://jira.mariadb.org/projects/MCOL/"&gt;https://jira.mariadb.org/projects/MCOL/&lt;/a&gt;&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Andrew Hutchings</dc:creator><guid>https://mariadb.com/kb/en/should-group-by-require-order-by-in-columnstore/+comments/3223</guid></item></channel></rss>