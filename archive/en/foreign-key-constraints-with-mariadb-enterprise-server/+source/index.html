<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>FOREIGN KEY Constraints with MariaDB Enterprise Server - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="FOREIGN KEY Constraints with MariaDB Enterprise Server - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/foreign-key-constraints-with-mariadb-enterprise-server/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/foreign-key-constraints-with-mariadb-enterprise-server/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/foreign-key-constraints-with-mariadb-enterprise-server/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/using-mariadb-server/">Using MariaDB Server</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements-structure/">SQL Statements &amp; Structure</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements/">SQL Statements</a>
    

    
    » <a class="crumb" href="/kb/en/data-manipulation/">Data Manipulation</a>
    

    
    » <a class="crumb" href="/kb/en/server-constraints/">Server Constraints</a>
    


    » <a class="node_link crumb" href="/kb/en/foreign-key-constraints-with-mariadb-enterprise-server/">FOREIGN KEY Constraints with MariaDB Enterprise Server</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/foreign-key-constraints-with-mariadb-enterprise-server/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>FOREIGN KEY Constraints with MariaDB Enterprise Server - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/foreign-key-constraints-with-mariadb-enterprise-server/+r/151076/">151076</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-16293">
<a href="/kb/user/id/16293" title="Shwetha CM">Shwetha CM</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2025-04-30 08:46">2025-04-30 08:46</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt; 

= Overview
MariaDB Enterprise Server supports ##FOREIGN KEY## constraints to define referential constraints between InnoDB tables:

Referential constraints allow the database to automatically ensure that each row in the child table is associated with a valid row in the parent table

If the row in the parent table changes, Enterprise Server can block the change to protect child rows, or Enterprise Server can propagate the change to the child rows

= Term Definitions
&lt;&lt;style class=&#34;darkheader-nospace-borders left&#34;&gt;&gt;
|= Term |= Definition |
| parent table  | A table that has a foreign key. |
| child table  | A table that is referenced by a foreign key. |

&lt;&lt;/style&gt;&gt;

= Uses Cases for Foreign Keys
Foreign keys allow the database to handle certain types of referential constraint checks, so that the application does not have to handle them. As a consequence, application logic can be simplified.

Some example use cases are described below.

== Managing Accounts Use Case

Many different applications have account management features. Foreign keys can be used to simplify certain aspects of managing accounts, such as:

* If an account is deleted, foreign keys can be used to automatically delete data associated with the account.
* If an account is deleted, foreign keys can be used to automatically disassociate its data, so that it is no longer associated with any account.
* If an account&#39;s user name or user ID is updated, foreign keys can be used to automatically associate its data with the new user name or user ID.

== Managing Store Inventory Use Case

Foreign keys can also be used to simplify certain aspects of managing a store inventory, such as:

* If a product is deleted, foreign keys can be used to automatically delete data associated with the product, such as reviews and images.
* If a product&#39;s name is changed, foreign keys can be used to automatically associate the new name with the product&#39;s other data.
* If a customer purchases a product, foreign keys can be used to associate the order with the product.
* If a customer reviews a product, foreign keys can be used to associate the review with the product.

= Operating on InnoDB Tables with Foreign Keys
When an InnoDB table has a foreign key or when it is referenced by a foreign key, InnoDB performs a referential constraint check when certain types of operations try to write to the table. The specific details depend on whether the table is a parent table or a child table.

== Operating on a Parent Table
When an InnoDB table has a foreign key, it is known as a parent table. InnoDB performs referential constraint checks for the following operations on parent tables:

[[update|UPDATE]]

[[delete|DELETE]]

When InnoDB performs a referential constraint check, the outcome depends on several factors. The following table describes the details:

&lt;&lt;style class=&#34;darkheader-nospace-borders left&#34;&gt;&gt;
|= Operation |= Result of Constraint Check |= Action |= Consequence|
| [[update|UPDATE]]  |InnoDB finds corresponding rows in the child table |ON UPDATE RESTRICT |\\• Fails with [[e1451|ER_ROW_IS_REFERENCED_2]] error code |
| [[update|UPDATE]]  | InnoDB finds corresponding rows in the child table |ON UPDATE NO ACTION |\\•. Fails with [[e1451|ER_ROW_IS_REFERENCED_2]]  error code |
| [[update|UPDATE]] | InnoDB finds corresponding rows in the child table | ON UPDATE CASCADE| • Success. \\• Row in the parent table is updated. \\• Corresponding rows in the child table are also updated with the new foreign key value. If the child table has an update trigger, the trigger will not be executed for the update. |
| [[update|UPDATE]] | InnoDB finds corresponding rows in the child table | ON UPDATE SET NULL| • Success. \\• Row in the parent table is updated. \\• Corresponding rows in the child table are also updated with NULL. If the child table has an update trigger, the trigger will not be executed for the update. |
| [[update|UPDATE]] | InnoDB does not find any corresponding rows in the child table |NA | • Success.\\• Row in the parent table is updated |
|[[delete|DELETE]] |InnoDB finds corresponding rows in the child table |ON DELETE RESTRICT | • Fails with [[e1451|ER_ROW_IS_REFERENCED_2]]  error code |
|[[delete|DELETE]] |InnoDB finds corresponding rows in the child table |ON DELETE NO ACTION |• Fails with [[e1451|ER_ROW_IS_REFERENCED_2]]  error code |
|[[delete|DELETE]] |InnoDB finds corresponding rows in the child table |ON DELETE CASCADE | • Success. \\• Row in the parent table is deleted. \\• Corresponding rows in the child table are also deleted. If the child table has a delete trigger, the trigger will not be executed for the delete.|
|[[delete|DELETE]] |InnoDB finds rows in the child table for the row |ON DELETE SET NULL |• Success. \\• Row in the parent table is deleted. \\• Corresponding rows in the child table are updated with NULL. If the child table has an update trigger, the trigger will not be executed for the update. |
|[[delete|DELETE]] |InnoDB does not find any rows in the child table for the row |NA |• Success. \\• Row in the parent table is deleted |

&lt;&lt;/style&gt;&gt;

== Operating on a Child Table
When an InnoDB table is referenced by a foreign key, it is known as a child table. InnoDB performs referential constraint checks for the following operations on child tables:

[[insert|INSERT]]

[[update|UPDATE]]

[[drop-table|DROP TABLE]]

When InnoDB performs a referential constraint check, the outcome depends on several factors. The following table describes the details:

&lt;&lt;style class=&#34;dark heade-nospace-borders left&#34;&gt;&gt;
|= Operation |= Result of Constraint Check |= Consequence|
| [[insert|INSERT]]  | New foreign key value is present in parent table| Success |
| [[insert|INSERT]]  | New foreign key value is not present in parent table | Fails with ER_NO_REFERENCED_ROW_2 error code |
| [[insert|INSERT]] | New foreign key value is NULL | Success |
| [[update|UPDATE]]  | New foreign key value is present in parent table |Success |
| [[update|UPDATE]]  | New foreign key value is not present in parent table |Fails with [[e1452|ER_NO_REFERENCED_ROW_2]] error code |
| [[update|UPDATE]] | New foreign key value is NULL |Success |
| [[drop-table|DROP TABLE]] | Table is referenced by a foreign key |Fails with |[[e1452ER_NO_REFERENCED_ROW_2]] error code |
&lt;&lt;/style&gt;&gt;

= Creating InnoDB Tables with a Foreign Key Constraint
Let&#39;s create InnoDB tables with a foreign key constraint after confirming that the [[server-system-variables/#default_storage_engine|default storage engine]] is InnoDB:

1. Connect to the server using MariaDB Client:
&lt;&lt;code&gt;&gt;

$ mariadb --user=root
&lt;&lt;/code&gt;&gt;


2. Confirm that the default storage engine is InnoDB by checking the [[server-system-variables/#default_storage_engine|default_storage_engine system variable]] using the [[show-variables|SHOW SESSION VARIABLES]] statement:

&lt;&lt;code&gt;&gt;
SHOW SESSION VARIABLES
   LIKE &#39;default_storage_engine&#39;;

+------------------------+--------+
| Variable_name          | Value  |
+------------------------+--------+
| default_storage_engine | InnoDB |
+------------------------+--------+
&lt;&lt;/code&gt;&gt;


3. If the database does not exist, then create the database for the sequence and table using the [[create-database|CREATE DATABASE]] statement:
&lt;&lt;code&gt;&gt;

CREATE DATABASE hq_sales;
&lt;&lt;/code&gt;&gt;

4. Create the parent table using the [[create-table|CREATE TABLE]] statement:

&lt;&lt;code&gt;&gt;
CREATE TABLE hq_sales.customers (
   customer_id BIGINT AUTO_INCREMENT NOT NULL,
   customer_name VARCHAR(500) NOT NULL,
   customer_email VARCHAR(200),
   PRIMARY KEY(customer_id)
);
&lt;&lt;/code&gt;&gt;


5. Create the child table using the [[create-table|CREATE TABLE]] statement:

&lt;&lt;code&gt;&gt;
CREATE TABLE hq_sales.invoices (
   invoice_id BIGINT AUTO_INCREMENT NOT NULL,
   branch_id INT NOT NULL,
   customer_id BIGINT,
   invoice_date DATETIME(6),
   invoice_total DECIMAL(13, 2),
   payment_method ENUM(&#39;NONE&#39;, &#39;CASH&#39;, &#39;WIRE_TRANSFER&#39;, &#39;CREDIT_CARD&#39;, &#39;GIFT_CARD&#39;),
   PRIMARY KEY(invoice_id),
   CONSTRAINT fk_invoices_customers
      FOREIGN KEY (customer_id) REFERENCES hq_sales.customers (customer_id)
      ON DELETE RESTRICT
      ON UPDATE RESTRICT
);

&lt;&lt;/code&gt;&gt;

6. Insert some rows into the parent table using the [[insert|INSERT]] statement:

&lt;&lt;code&gt;&gt;
INSERT INTO hq_sales.customers (customer_id, name)
   VALUES
   (1, &#39;John Doe&#39;),
   (2, &#39;Jane Doe&#39;);

&lt;&lt;/code&gt;&gt;

7. Insert a row into the child table for each row in the parent table using the [[insert|INSERT]] statement:

&lt;&lt;code&gt;&gt;
INSERT INTO hq_sales.invoices
   (branch_id, customer_id, invoice_date, invoice_total, payment_method)
VALUES
   (1, 1, &#39;2020-05-10 12:35:10&#39;, 1087.23, &#39;CREDIT_CARD&#39;),
   (1, 2, &#39;2020-05-10 14:17:32&#39;, 1508.57, &#39;WIRE_TRANSFER&#39;);

&lt;&lt;/code&gt;&gt;

8. Attempt to delete a row from the parent table that has a corresponding row in the child table using the ##DELETE## statement:
&lt;&lt;code&gt;&gt;

DELETE FROM hq_sales.customers
   WHERE customer_id = 1;
&lt;&lt;/code&gt;&gt;
This will fail with the [[e1451|ER_ROW_IS_REFERENCED_2]] error code as explained in the Operating on a Parent Table section:

&lt;&lt;code&gt;&gt;
ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails
   (`hq_sales`.`invoices`, CONSTRAINT `fk_invoices_customers`
   FOREIGN KEY (`customer_id`) REFERENCES `customers` (`customer_id`))
&lt;&lt;/code&gt;&gt;

Attempt to insert a row into the child table for a non-existent row in the parent table using the INSERT statement:

&lt;&lt;code&gt;&gt;
INSERT INTO hq_sales.invoices
   (branch_id, customer_id, invoice_date, invoice_total, payment_method)
VALUES
   (1, 3, &#39;2020-05-10 14:25:16&#39;, 227.15, &#39;CASH&#39;);
&lt;&lt;/code&gt;&gt;

This will fail with the [[e1452|ER_NO_REFERENCED_ROW_2]] error code as explained in the Operating on a Child Table section:

&lt;&lt;code&gt;&gt;
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails
   (`hq_sales`.`invoices`, CONSTRAINT `fk_invoices_customers`
   FOREIGN KEY (`customer_id`) REFERENCES `customers` (`customer_id`))
&lt;&lt;/code&gt;&gt;

= Adding a Foreign Key Constraint to an InnoDB Table

Let&#39;s create InnoDB tables after confirming that the [[server-system-variables/#default_storage_engine|default storage engine]] is InnoDB, and then let&#39;s add a foreign key constraint between them:

1. Connect to the server using MariaDB Client:

&lt;&lt;code&gt;&gt;
$ mariadb --user=root
&lt;&lt;/code&gt;&gt;

2. Confirm that the default storage engine is InnoDB by checking the [[server-system-variables/#default_storage_engine|default_storage_engine system variable]] using the [[show-variables|SHOW SESSION VARIABLES]] statement:

&lt;&lt;code&gt;&gt;
SHOW SESSION VARIABLES
   LIKE &#39;default_storage_engine&#39;;

+------------------------+--------+
| Variable_name          | Value  |
+------------------------+--------+
| default_storage_engine | InnoDB |
+------------------------+--------+
&lt;&lt;/code&gt;&gt;

3. If the database does not exist, then create the database for the sequence and table using the [[create-database|CREATE DATABASE]] statement:

&lt;&lt;code&gt;&gt;
CREATE DATABASE hq_sales;
&lt;&lt;/code&gt;&gt;

4. Create the parent table using the [[create-table|CREATE TABLE]] statement:
&lt;&lt;code&gt;&gt;

CREATE TABLE hq_sales.customers (
   customer_id BIGINT AUTO_INCREMENT NOT NULL,
   customer_name VARCHAR(500) NOT NULL,
   customer_email VARCHAR(200),
   PRIMARY KEY(customer_id)
);

&lt;&lt;/code&gt;&gt;

5. Create the child table using the [[create-table|CREATE TABLE]] statement:

&lt;&lt;code&gt;&gt;
CREATE TABLE hq_sales.invoices (
   invoice_id BIGINT AUTO_INCREMENT NOT NULL,
   branch_id INT NOT NULL,
   customer_id BIGINT,
   invoice_date DATETIME(6),
   invoice_total DECIMAL(13, 2),
   payment_method ENUM(&#39;NONE&#39;, &#39;CASH&#39;, &#39;WIRE_TRANSFER&#39;, &#39;CREDIT_CARD&#39;, &#39;GIFT_CARD&#39;),
   PRIMARY KEY(invoice_id)
);
&lt;&lt;/code&gt;&gt;

6. Alter the child table to add the foreign key constraint using the [[alter-table|ALTER TABLE]] statement:

&lt;&lt;code&gt;&gt;
ALTER TABLE hq_sales.invoices ADD CONSTRAINT fk_invoices_customers
      FOREIGN KEY (customer_id) REFERENCES hq_sales.customers (customer_id)
      ON DELETE RESTRICT
      ON UPDATE RESTRICT;
&lt;&lt;/code&gt;&gt;

7. Insert some rows into the parent table using the [[insert|INSERT]]  statement:

&lt;&lt;code&gt;&gt;
INSERT INTO hq_sales.customers (customer_id, name)
   VALUES
   (1, &#39;John Doe&#39;),
   (2, &#39;Jane Doe&#39;);

&lt;&lt;/code&gt;&gt;

8. Insert a row into the child table for each row in the parent table using the [[insert|INSERT]] statement:

&lt;&lt;code&gt;&gt;
INSERT INTO hq_sales.invoices
   (branch_id, customer_id, invoice_date, invoice_total, payment_method)
VALUES
   (1, 1, &#39;2020-05-10 12:35:10&#39;, 1087.23, &#39;CREDIT_CARD&#39;),
   (1, 2, &#39;2020-05-10 14:17:32&#39;, 1508.57, &#39;WIRE_TRANSFER&#39;);
&lt;&lt;/code&gt;&gt;

9. Attempt to delete a row from the parent table that has a corresponding row in the child table using the [[delete|DELETE]] statement:

&lt;&lt;code&gt;&gt;
DELETE FROM hq_sales.customers
   WHERE customer_id = 1;

&lt;&lt;/code&gt;&gt;

This will fail with the [[e1451|ER_ROW_IS_REFERENCED_2]] error code as explained in the Operating on a Parent Table section:
&lt;&lt;code&gt;&gt;

ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails
   (`hq_sales`.`invoices`, CONSTRAINT `fk_invoices_customers`
   FOREIGN KEY (`customer_id`) REFERENCES `customers` (`customer_id`))
&lt;&lt;/code&gt;&gt;

10. Attempt to insert a row into the child table for a non-existent row in the parent table using the 
[[insert|INSERT]] statement:

&lt;&lt;code&gt;&gt;
INSERT INTO hq_sales.invoices
   (branch_id, customer_id, invoice_date, invoice_total, payment_method)
VALUES
   (1, 3, &#39;2020-05-10 14:25:16&#39;, 227.15, &#39;CASH&#39;);
&lt;&lt;/code&gt;&gt;

This will fail with the [[e1452|ER_NO_REFERENCED_ROW_2]] error code as explained in the Operating on a Child Table section:

&lt;&lt;code&gt;&gt;
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails
   (`hq_sales`.`invoices`, CONSTRAINT `fk_invoices_customers`
   FOREIGN KEY (`customer_id`) REFERENCES `customers` (`customer_id`))
&lt;&lt;/code&gt;&gt;

= Dropping a Foreign Key Constraint from an InnoDB Table

Let&#39;s drop the foreign key constraint from the child table created in the [[foreign-key-constraints-with-mariadb-enterprise-server/#creating-innodb-tables-with-a-foreign-key-constraint|Creating InnoDB Tables with a Foreign Key Constraint]] section:

1. Connect to the server using MariaDB Client:
&lt;&lt;code&gt;&gt;

$ mariadb --user=root
&lt;&lt;/code&gt;&gt;

2. Obtain the name of the foreign key constraint by querying the [[information-schema-table_constraints-table|information_schema.TABLE_CONSTRAINTS]] table:

&lt;&lt;code&gt;&gt;
SELECT CONSTRAINT_NAME
FROM information_schema.TABLE_CONSTRAINTS
WHERE TABLE_SCHEMA = &#39;hq_sales&#39;
AND TABLE_NAME = &#39;invoices&#39;
AND CONSTRAINT_TYPE = &#39;FOREIGN KEY&#39;;

&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
+-----------------------+
| CONSTRAINT_NAME       |
+-----------------------+
| fk_invoices_customers |
+-----------------------+

&lt;&lt;/code&gt;&gt;

3. Drop the foreign key constraint from the child table using the [[alter-table|ALTER TABLE]] statement:

&lt;&lt;code&gt;&gt;
ALTER TABLE hq_sales.invoices DROP FOREIGN KEY fk_invoices_customers;
&lt;&lt;/code&gt;&gt;

= Temporarily Disabling Foreign Key Constraint Checks

When performing bulk data loads, dropping a table, or rebuilding a table, it can improve performance to temporarily disable foreign key constraint checks. Foreign key constraint checks can be temporarily disabled by setting the session value for the ##foreign_key_checks## system variable. If foreign key constraint checks are temporarily disabled, then rows can be inserted that violate the constraint, so users must proceed with caution. This feature is most useful when you are loading a data set that is known to be valid.

Let&#39;s temporarily disable foreign key constraint checks, and then perform some tasks with the tables created in the [[foreign-key-constraints-with-mariadb-enterprise-server/#creating-innodb-tables-with-a-foreign-key-constraint|Creating InnoDB Tables with a Foreign Key Constraint]] section:

1. Connect to the server using MariaDB Client:
&lt;&lt;code&gt;&gt;

$ mariadb --user=root
&lt;&lt;/code&gt;&gt;

2. Temporarily disable foreign key constraint checks by setting the [[server-system-variables/#foreign_key_checks|foreign_key_checks]] system variable with the [[set-session|SET SESSION]] statement:

&lt;&lt;code&gt;&gt;
SET SESSION foreign_key_checks=OFF;
&lt;&lt;/code&gt;&gt;

3. If you want to test how to introduce inconsistencies, then attempt to delete a row from the parent table that has a corresponding row in the child table using the [[delete|DELETE]] statement:

&lt;&lt;code&gt;&gt;
DELETE FROM hq_sales.customers
   WHERE customer_id = 1;
&lt;&lt;/code&gt;&gt;

This operation would usually fail with the [[e1216|ER_NO_REFERENCED_ROW]] error code as explained in the Operating on a Parent Table section, but if foreign key constraint checks are disable, then it will succeed.

4. If you want to test how to introduce inconsistencies, then also attempt to insert a row into the child table for a non-existent row in the parent table using the [[insert|INSERT]] statement:

&lt;&lt;code&gt;&gt;
INSERT INTO hq_sales.invoices
   (branch_id, customer_id, invoice_date, invoice_total, payment_method)
VALUES
   (1, 3, &#39;2020-05-10 14:25:16&#39;, 227.15, &#39;CASH&#39;);
&lt;&lt;/code&gt;&gt;

This operation would usually fail with the [[e1452|ER_NO_REFERENCED_ROW_2]] error code as explained in the [[foreign-key-constraints-with-mariadb-enterprise-server/#operating-on-a-child-table|Operating on a Child Table]] section, but if foreign key constraint checks are disable, then it will succeed.

5. Re-enable foreign key constraint checks by setting the [[server-system-variables/#foreign_key_checks|foreign_key_checks]] system variable with the [[set-session|SET SESSION]] statement:
&lt;&lt;code&gt;&gt;

SET SESSION foreign_key_checks=ON;
&lt;&lt;/code&gt;&gt;

= Special Cases
== Foreign Key Constraint Namespace

When a foreign key constraint is created without a name, InnoDB implicitly gives it a name in the format:

&lt;&lt;code&gt;&gt;
&lt;table_name&gt;_ibfk_&lt;constraint_count&gt;
&lt;&lt;/code&gt;&gt;

If foreign key constraints are explicitly created with names in the same format, it is possible for collisions to occur during table renames. In that case, the [[server-system-variables/#log_error|MariaDB Error Log]] would contain messages like the following:

&lt;&lt;code&gt;&gt;
2021-06-16 11:50:39 139702710404864 [ERROR] InnoDB: Possible reasons:
2021-06-16 11:50:39 139702710404864 [ERROR] InnoDB: (1) Table rename would cause two FOREIGN KEY constraints to have the same internal name in case-insensitive comparison.
2021-06-16 11:50:39 139702710404864 [ERROR] InnoDB: (2) Table `test`.`t3` exists in the InnoDB internal data dictionary though MySQL is trying to rename table `test`.`t2b` to it. Have you deleted the .frm file and not used DROP TABLE?
2021-06-16 11:50:39 139702710404864 [ERROR] InnoDB: If table `test`.`t3` is a temporary table #sql..., then it can be that there are still queries running on the table, and it will be dropped automatically when the queries end. You can drop the orphaned table inside InnoDB by creating an InnoDB table with the same name in another database and copying the .frm file to the current database. Then MySQL thinks the table exists, and DROP TABLE will succeed.
&lt;&lt;/code&gt;&gt;

= Dependence on an Index

A foreign key constraint requires an index on the column. If a foreign key constraint is added to a column without an index, InnoDB will automatically create an index to enforce the foreign key constraint.

When the [[server-system-variables/#foreign_key_checks|foreign_key_checks]] system variable is disabled, it is possible to drop the index used by a foreign key constraint. When the [[server-system-variables/#foreign_key_checks|foreign_key_checks]] system variable is re-enabled, InnoDB will have no way to enforce the foreign key constraint, so all operations that could potentially violate the foreign key constraint will fail.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>