<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>InnoDB Online DDL Operations with the NOCOPY Alter Algorithm - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="InnoDB Online DDL Operations with the NOCOPY Alter Algorithm" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="These DDL operations can be done without copying the table with InnoDB." />

    <meta name="description" content="These DDL operations can be done without copying the table with InnoDB." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/innodb/">InnoDB</a>
    

    
    » <a class="crumb" href="/kb/en/innodb-online-ddl/">InnoDB Online DDL</a>
    


    » <a class="node_link crumb" href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/">InnoDB Online DDL Operations with the NOCOPY Alter Algorithm</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+flag"
                data-flag-url="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2019-04-22 23:04">5 years, 11 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2022-04-27 18:15">2 years, 11 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>InnoDB Online DDL Operations with the NOCOPY Alter Algorithm</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#supported-operations-by-inheritance" title="Supported Operations by Inheritance">Supported Operations by Inheritance</a></li>

    <li class=""><a href="#column-operations" title="Column Operations">Column Operations</a>    <ol class="toc">

        <li class=""><a href="#alter-table-add-column" title="ALTER TABLE ... ADD COLUMN">ALTER TABLE ... ADD COLUMN</a></li>

        <li class=""><a href="#alter-table-drop-column" title="ALTER TABLE ... DROP COLUMN">ALTER TABLE ... DROP COLUMN</a></li>

        <li class=""><a href="#alter-table-modify-column" title="ALTER TABLE ... MODIFY COLUMN">ALTER TABLE ... MODIFY COLUMN</a>        <ol class="toc">

            <li class=""><a href="#reordering-columns" title="Reordering Columns">Reordering Columns</a></li>

            <li class=""><a href="#changing-the-data-type-of-a-column" title="Changing the Data Type of a Column">Changing the Data Type of a Column</a></li>

            <li class=""><a href="#changing-a-column-to-null" title="Changing a Column to NULL">Changing a Column to NULL</a></li>

            <li class=""><a href="#changing-a-column-to-not-null" title="Changing a Column to NOT NULL">Changing a Column to NOT NULL</a></li>

            <li class=""><a href="#adding-a-new-enum-option" title="Adding a New ENUM Option">Adding a New ENUM Option</a></li>

            <li class=""><a href="#adding-a-new-set-option" title="Adding a New SET Option">Adding a New SET Option</a></li>

            <li class=""><a href="#removing-system-versioning-from-a-column" title="Removing System Versioning from a Column">Removing System Versioning from a Column</a>        </ol>
</li>

        <li class=""><a href="#alter-table-alter-column" title="ALTER TABLE ... ALTER COLUMN">ALTER TABLE ... ALTER COLUMN</a>        <ol class="toc">

            <li class=""><a href="#setting-a-columns-default-value" title="Setting a Column&#39;s Default Value">Setting a Column&#39;s Default Value</a></li>

            <li class=""><a href="#removing-a-columns-default-value" title="Removing a Column&#39;s Default Value">Removing a Column&#39;s Default Value</a>        </ol>
</li>

        <li class=""><a href="#alter-table-change-column" title="ALTER TABLE ... CHANGE COLUMN">ALTER TABLE ... CHANGE COLUMN</a>    </ol>
</li>

    <li class=""><a href="#index-operations" title="Index Operations">Index Operations</a>    <ol class="toc">

        <li class=""><a href="#alter-table-add-primary-key" title="ALTER TABLE ... ADD PRIMARY KEY">ALTER TABLE ... ADD PRIMARY KEY</a></li>

        <li class=""><a href="#alter-table-drop-primary-key" title="ALTER TABLE ... DROP PRIMARY KEY">ALTER TABLE ... DROP PRIMARY KEY</a></li>

        <li class=""><a href="#alter-table-add-index-and-create-index" title="ALTER TABLE ... ADD INDEX and CREATE INDEX">ALTER TABLE ... ADD INDEX and CREATE INDEX</a>        <ol class="toc">

            <li class=""><a href="#adding-a-plain-index" title="Adding a Plain Index">Adding a Plain Index</a></li>

            <li class=""><a href="#adding-a-fulltext-index" title="Adding a Fulltext Index">Adding a Fulltext Index</a></li>

            <li class=""><a href="#adding-a-spatial-index" title="Adding a Spatial Index">Adding a Spatial Index</a>        </ol>
</li>

        <li class=""><a href="#alter-table-drop-index-and-drop-index" title="ALTER TABLE ... DROP INDEX and DROP INDEX">ALTER TABLE ... DROP INDEX and DROP INDEX</a></li>

        <li class=""><a href="#alter-table-add-foreign-key" title="ALTER TABLE ... ADD FOREIGN KEY">ALTER TABLE ... ADD FOREIGN KEY</a></li>

        <li class=""><a href="#alter-table-drop-foreign-key" title="ALTER TABLE ... DROP FOREIGN KEY">ALTER TABLE ... DROP FOREIGN KEY</a>    </ol>
</li>

    <li class=""><a href="#table-operations" title="Table Operations">Table Operations</a>    <ol class="toc">

        <li class=""><a href="#alter-table-auto_increment" title="ALTER TABLE ... AUTO_INCREMENT=...">ALTER TABLE ... AUTO_INCREMENT=...</a></li>

        <li class=""><a href="#alter-table-row_format" title="ALTER TABLE ... ROW_FORMAT=...">ALTER TABLE ... ROW_FORMAT=...</a></li>

        <li class=""><a href="#alter-table-key_block_size" title="ALTER TABLE ... KEY_BLOCK_SIZE=...">ALTER TABLE ... KEY_BLOCK_SIZE=...</a></li>

        <li class=""><a href="#alter-table-page_compressed1-and-alter-table-page_compression_level" title="ALTER TABLE ... PAGE_COMPRESSED=1 and ALTER TABLE ... PAGE_COMPRESSION_LEVEL=...">ALTER TABLE ... PAGE_COMPRESSED=1 and ALTER TABLE ... PAGE_COMPRESSION_LEVEL=...</a></li>

        <li class=""><a href="#alter-table-drop-system-versioning" title="ALTER TABLE ... DROP SYSTEM VERSIONING">ALTER TABLE ... DROP SYSTEM VERSIONING</a></li>

        <li class=""><a href="#alter-table-drop-constraint" title="ALTER TABLE ... DROP CONSTRAINT">ALTER TABLE ... DROP CONSTRAINT</a></li>

        <li class=""><a href="#alter-table-force" title="ALTER TABLE ... FORCE">ALTER TABLE ... FORCE</a></li>

        <li class=""><a href="#alter-table-engineinnodb" title="ALTER TABLE ... ENGINE=InnoDB">ALTER TABLE ... ENGINE=InnoDB</a></li>

        <li class=""><a href="#optimize-table" title="OPTIMIZE TABLE ...">OPTIMIZE TABLE ...</a></li>

        <li class=""><a href="#alter-table-rename-to-and-rename-table" title="ALTER TABLE ... RENAME TO and RENAME TABLE ...">ALTER TABLE ... RENAME TO and RENAME TABLE ...</a>    </ol>
</li>

    <li class=""><a href="#limitations" title="Limitations">Limitations</a>    <ol class="toc">

        <li class=""><a href="#limitations-related-to-generated-virtual-and-persistentstored-columns" title="Limitations Related to Generated (Virtual and Persistent/Stored) Columns">Limitations Related to Generated (Virtual and Persistent/Stored) Columns</a>    </ol>
 </ol>
</li>
</div>
<h2 class="anchored_heading" id="supported-operations-by-inheritance">Supported Operations by Inheritance</h2>
<p>When the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause is set to <code>NOCOPY</code>, the supported operations are a superset of the operations that are supported when the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause is set to <code>INSTANT</code>.</p>
<p>Therefore, when the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause is set to <code>NOCOPY</code>, some operations are supported by inheritance. See the following additional pages for more information about these supported operations:</p>
<ul start="1"><li><a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/">InnoDB Online DDL Operations with ALGORITHM=INSTANT</a> 
</li></ul>
<h2 class="anchored_heading" id="column-operations">Column Operations</h2>
<h3 class="anchored_heading" id="alter-table-add-column"><code>ALTER TABLE ... ADD COLUMN</code></h3>
<p>In <a href="/kb/en/mariadb-1032-release-notes/">MariaDB 10.3.2</a> and later, InnoDB supports adding columns to a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-add-column">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... ADD COLUMN</a> for more information.</p>
<p>This applies to <a href="/kb/en/alter-table/#add-column">ALTER TABLE ... ADD COLUMN</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-drop-column"><code>ALTER TABLE ... DROP COLUMN</code></h3>
<p>In <a href="/kb/en/what-is-mariadb-104/">MariaDB 10.4</a> and later, InnoDB supports dropping columns from a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-drop-column">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... DROP COLUMN</a> for more information.</p>
<p>This applies to <a href="/kb/en/alter-table/#drop-column">ALTER TABLE ... DROP COLUMN</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-modify-column"><code>ALTER TABLE ... MODIFY COLUMN</code></h3>
<p>This applies to <a href="/kb/en/alter-table/#modify-column">ALTER TABLE ... MODIFY COLUMN</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h4 class="anchored_heading" id="reordering-columns">Reordering Columns</h4>
<p>In <a href="/kb/en/what-is-mariadb-104/">MariaDB 10.4</a> and later, InnoDB supports reordering columns within a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#reordering-columns">InnoDB Online DDL Operations with ALGORITHM=INSTANT: Reordering Columns</a> for more information.</p>
<h4 class="anchored_heading" id="changing-the-data-type-of-a-column">Changing the Data Type of a Column</h4>
<p>InnoDB does <strong>not</strong> support modifying a column's data type with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in most cases. There are a few exceptions in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#changing-the-data-type-of-a-column">InnoDB Online DDL Operations with ALGORITHM=INSTANT: Changing the Data Type of a Column</a> for more information.</p>
<h4 class="anchored_heading" id="changing-a-column-to-null">Changing a Column to NULL</h4>
<p>In <a href="/kb/en/mariadb-1043-release-notes/">MariaDB 10.4.3</a> and later, InnoDB supports modifying a column to allow <a href="/kb/en/create-table/#null-and-not-null">NULL</a> values with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#changing-a-column-to-null">InnoDB Online DDL Operations with ALGORITHM=INSTANT: Changing a Column to NULL</a> for more information.</p>
<h4 class="anchored_heading" id="changing-a-column-to-not-null">Changing a Column to NOT NULL</h4>
<p>InnoDB does <strong>not</strong> support modifying a column to <strong>not</strong> allow <a href="/kb/en/create-table/#null-and-not-null">NULL</a> values with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ROW_FORMAT</span><span class="o">=</span><span class="n">REDUNDANT</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">MODIFY</span> <span class="k">COLUMN</span> <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
<span class="n">ERROR</span> <span class="mi">1845</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span> <span class="k">for</span> <span class="n">this</span> <span class="k">operation</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">INPLACE</span>
</pre><h4 class="anchored_heading" id="adding-a-new-enum-option">Adding a New <code>ENUM</code> Option</h4>
<p>InnoDB supports adding a new <a href="/kb/en/enum/">ENUM</a> option to a column with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#adding-a-new-enum-option">InnoDB Online DDL Operations with ALGORITHM=INSTANT: Adding a New ENUM Option</a> for more information.</p>
<h4 class="anchored_heading" id="adding-a-new-set-option">Adding a New <code>SET</code> Option</h4>
<p>InnoDB supports adding a new <a href="/kb/en/set-data-type/">SET</a> option to a column with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#adding-a-new-set-option">InnoDB Online DDL Operations with ALGORITHM=INSTANT: Adding a New SET Option</a> for more information.</p>
<h4 class="anchored_heading" id="removing-system-versioning-from-a-column">Removing System Versioning from a Column</h4>
<p>In <a href="/kb/en/mariadb-1038-release-notes/">MariaDB 10.3.8</a> and later, InnoDB supports removing <a href="/kb/en/system-versioned-tables/">system versioning</a> from a column with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#removing-system-versioning-from-a-column">InnoDB Online DDL Operations with ALGORITHM=INSTANT: Removing System Versioning from a Column</a> for more information.</p>
<h3 class="anchored_heading" id="alter-table-alter-column"><code>ALTER TABLE ... ALTER COLUMN</code></h3>
<p>This applies to <a href="/kb/en/alter-table/#alter-column">ALTER TABLE ... ALTER COLUMN</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h4 class="anchored_heading" id="setting-a-columns-default-value">Setting a Column's Default Value</h4>
<p>InnoDB supports modifying a column's <a href="/kb/en/create-table/#default-column-option">DEFAULT</a> value with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#setting-a-columns-default-value">InnoDB Online DDL Operations with ALGORITHM=INSTANT: Setting a Column's Default Value</a> for more information.</p>
<h4 class="anchored_heading" id="removing-a-columns-default-value">Removing a Column's Default Value</h4>
<p>InnoDB supports removing a column's  <a href="/kb/en/create-table/#default-column-option">DEFAULT</a> value with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#removing-a-columns-default-value">InnoDB Online DDL Operations with ALGORITHM=INSTANT: Removing a Column's Default Value</a> for more information.</p>
<h3 class="anchored_heading" id="alter-table-change-column"><code>ALTER TABLE ... CHANGE COLUMN</code></h3>
<p>InnoDB supports renaming a column with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-change-column">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... CHANGE COLUMN</a> for more information.</p>
<p>This applies to <a href="/kb/en/alter-table/#change-column">ALTER TABLE ... CHANGE COLUMN</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h2 class="anchored_heading" id="index-operations">Index Operations</h2>
<h3 class="anchored_heading" id="alter-table-add-primary-key"><code>ALTER TABLE ... ADD PRIMARY KEY</code></h3>
<p>InnoDB does <strong>not</strong> support adding a primary key to a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">sql_mode</span><span class="o">=</span><span class="s1">&#39;STRICT_TRANS_TABLES&#39;</span><span class="p">;</span>
<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">ADD</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="n">ERROR</span> <span class="mi">1845</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span> <span class="k">for</span> <span class="n">this</span> <span class="k">operation</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">INPLACE</span>
</pre><p>This applies to <a href="/kb/en/alter-table/#add-primary-key">ALTER TABLE ... ADD PRIMARY KEY</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-drop-primary-key"><code>ALTER TABLE ... DROP PRIMARY KEY</code></h3>
<p>InnoDB does <strong>not</strong> support dropping a primary key with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">DROP</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">;</span>
<span class="n">ERROR</span> <span class="mi">1846</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span><span class="p">.</span> <span class="n">Reason</span><span class="p">:</span> <span class="n">Dropping</span> <span class="n">a</span> <span class="k">primary</span> <span class="k">key</span> <span class="k">is</span> <span class="k">not</span> <span class="n">allowed</span> <span class="k">without</span> <span class="n">also</span> <span class="n">adding</span> <span class="n">a</span> <span class="k">new</span> <span class="k">primary</span> <span class="k">key</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="k">COPY</span>
</pre><p>This applies to <a href="/kb/en/alter-table/#drop-primary-key">ALTER TABLE ... DROP PRIMARY KEY</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-add-index-and-create-index"><code>ALTER TABLE ... ADD INDEX</code> and <code>CREATE INDEX</code></h3>
<p>This applies to <a href="/kb/en/alter-table/#add-index">ALTER TABLE ... ADD INDEX</a> and <a href="/kb/en/create-index/">CREATE INDEX</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h4 class="anchored_heading" id="adding-a-plain-index">Adding a Plain Index</h4>
<p>InnoDB supports adding a plain index to a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>This operation supports the non-locking strategy. This strategy can be explicitly chosen by setting the <a href="/kb/en/alter-table/#lock">LOCK</a> clause to <code>NONE</code>. When this strategy is used, all concurrent DML is permitted.</p>
<p>For example, this succeeds:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">ADD</span> <span class="k">INDEX</span> <span class="n">b_index</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">009</span> <span class="n">sec</span><span class="p">)</span>
</pre><p>And this succeeds:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">b_index</span> <span class="k">ON</span> <span class="n">tab</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">009</span> <span class="n">sec</span><span class="p">)</span>
</pre><h4 class="anchored_heading" id="adding-a-fulltext-index">Adding a Fulltext Index</h4>
<p>InnoDB supports adding a <a href="/kb/en/full-text-indexes/">FULLTEXT</a> index to a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>However, there are some limitations, such as:</p>
<ul start="1"><li>Adding a <a href="/kb/en/full-text-indexes/">FULLTEXT</a> index to a table that does not have a user-defined <code>FTS_DOC_ID</code> column will require the table to be rebuilt once. When the table is rebuilt, the system adds a hidden <code>FTS_DOC_ID</code> column. This initial operation will have to be performed with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>INPLACE</code>.From that point forward, adding additional <a href="/kb/en/full-text-indexes/">FULLTEXT</a> indexes to the same table will not require the table to be rebuilt, and <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> can be set to <code>NOCOPY</code>.
</li></ul>
<ul start="1"><li>Only one <a href="/kb/en/full-text-indexes/">FULLTEXT</a> index may be added at a time when <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> is set to <code>NOCOPY</code>.
</li></ul>
<p>This operation supports a read-only locking strategy. This strategy can be explicitly chosen by setting the <a href="/kb/en/alter-table/#lock">LOCK</a> clause to <code>SHARED</code>. When this strategy is used, read-only concurrent DML is permitted. </p>
<p>For example, this succeeds, but the first operation requires the table to be rebuilt <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>INPLACE</code>, so that the hidden <code>FTS_DOC_ID</code> column can be added:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;INPLACE&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">ADD</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="n">b_index</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">043</span> <span class="n">sec</span><span class="p">)</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">ADD</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="n">c_index</span> <span class="p">(</span><span class="k">c</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">017</span> <span class="n">sec</span><span class="p">)</span>
</pre><p>And this succeeds in the same way as above:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;INPLACE&#39;</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="n">b_index</span> <span class="k">ON</span> <span class="n">tab</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">048</span> <span class="n">sec</span><span class="p">)</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="n">c_index</span> <span class="k">ON</span> <span class="n">tab</span> <span class="p">(</span><span class="k">c</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">016</span> <span class="n">sec</span><span class="p">)</span>
</pre><p>But this second command fails, because only one <a href="/kb/en/full-text-indexes/">FULLTEXT</a> index can be added at a time:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="n">d</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;INPLACE&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">ADD</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="n">b_index</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">041</span> <span class="n">sec</span><span class="p">)</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">ADD</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="n">c_index</span> <span class="p">(</span><span class="k">c</span><span class="p">),</span> <span class="k">ADD</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="n">d_index</span> <span class="p">(</span><span class="n">d</span><span class="p">);</span>
<span class="n">ERROR</span> <span class="mi">1846</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span><span class="p">.</span> <span class="n">Reason</span><span class="p">:</span> <span class="n">InnoDB</span> <span class="n">presently</span> <span class="n">supports</span> <span class="n">one</span> <span class="n">FULLTEXT</span> <span class="k">index</span> <span class="n">creation</span> <span class="k">at</span> <span class="n">a</span> <span class="n">time</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="k">COPY</span>
</pre><h4 class="anchored_heading" id="adding-a-spatial-index">Adding a Spatial Index</h4>
<p>InnoDB supports adding a <a href="/kb/en/spatial-index/">SPATIAL</a> index to a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>This operation supports a read-only locking strategy. This strategy can be explicitly chosen by setting the <a href="/kb/en/alter-table/#lock">LOCK</a> clause to <code>SHARED</code>. When this strategy is used, read-only concurrent DML is permitted. </p>
<p>For example, this succeeds:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="n">GEOMETRY</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">ADD</span> <span class="n">SPATIAL</span> <span class="k">INDEX</span> <span class="n">c_index</span> <span class="p">(</span><span class="k">c</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">005</span> <span class="n">sec</span><span class="p">)</span>
</pre><p>And this succeeds in the same way as above:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="n">GEOMETRY</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="n">SPATIAL</span> <span class="k">INDEX</span> <span class="n">c_index</span> <span class="k">ON</span> <span class="n">tab</span> <span class="p">(</span><span class="k">c</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">005</span> <span class="n">sec</span><span class="p">)</span>
</pre><h3 class="anchored_heading" id="alter-table-drop-index-and-drop-index"><code>ALTER TABLE ... DROP INDEX</code> and <code>DROP INDEX</code></h3>
<p>InnoDB supports dropping indexes from a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-drop-index-and-drop-index">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... DROP INDEX and DROP INDEX</a> for more information.</p>
<p>This applies to <a href="/kb/en/alter-table/#drop-index">ALTER TABLE ... DROP INDEX</a> and <a href="/kb/en/drop-index/">DROP INDEX</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-add-foreign-key"><code>ALTER TABLE ... ADD FOREIGN KEY</code></h3>
<p>InnoDB does supports adding foreign key constraints to a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>. In order to add a new foreign key constraint to a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>, the <a href="/kb/en/server-system-variables/#foreign_key_checks">foreign_key_checks</a> system variable needs to be set to <code>OFF</code>. If it is set to <code>ON</code>, then <code>ALGORITHM=COPY</code> is required.</p>
<p>This operation supports the non-locking strategy. This strategy can be explicitly chosen by setting the <a href="/kb/en/alter-table/#lock">LOCK</a> clause to <code>NONE</code>. When this strategy is used, all concurrent DML is permitted.</p>
<p>For example, this fails:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab1</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="n">d</span> <span class="nb">int</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab2</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab1</span> <span class="k">ADD</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="n">tab2_fk</span> <span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">tab2</span> <span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="n">ERROR</span> <span class="mi">1846</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span><span class="p">.</span> <span class="n">Reason</span><span class="p">:</span> <span class="n">Adding</span> <span class="k">foreign</span> <span class="n">keys</span> <span class="n">needs</span> <span class="n">foreign_key_checks</span><span class="o">=</span><span class="k">OFF</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="k">COPY</span>
</pre><p>But this succeeds:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab1</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="n">d</span> <span class="nb">int</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab2</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">foreign_key_checks</span><span class="o">=</span><span class="k">OFF</span><span class="p">;</span>
<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab1</span> <span class="k">ADD</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="n">tab2_fk</span> <span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">tab2</span> <span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">011</span> <span class="n">sec</span><span class="p">)</span>
</pre><p>This applies to <a href="/kb/en/alter-table/#add-foreign-key">ALTER TABLE ... ADD FOREIGN KEY</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-drop-foreign-key"><code>ALTER TABLE ... DROP FOREIGN KEY</code></h3>
<p>InnoDB supports dropping foreign key constraints from a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-drop-foreign-key">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... DROP FOREIGN KEY</a> for more information.</p>
<p>This applies to <a href="/kb/en/alter-table/#drop-foreign-key">ALTER TABLE ... DROP FOREIGN KEY</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h2 class="anchored_heading" id="table-operations">Table Operations</h2>
<h3 class="anchored_heading" id="alter-table-auto_increment"><code>ALTER TABLE ... AUTO_INCREMENT=...</code></h3>
<p>InnoDB supports changing a table's <a href="/kb/en/auto_increment/">AUTO_INCREMENT</a> value with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-auto_increment">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... AUTO_INCREMENT=...</a> for more information.</p>
<p>This applies to <a href="/kb/en/create-table/#auto_increment">ALTER TABLE ... AUTO_INCREMENT=...</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-row_format"><code>ALTER TABLE ... ROW_FORMAT=...</code></h3>
<p>InnoDB does <strong>not</strong> support changing a table's <a href="/kb/en/innodb-storage-formats/">row format</a> with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ROW_FORMAT</span><span class="o">=</span><span class="k">DYNAMIC</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="n">ROW_FORMAT</span><span class="o">=</span><span class="n">COMPRESSED</span><span class="p">;</span>
<span class="n">ERROR</span> <span class="mi">1846</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span><span class="p">.</span> <span class="n">Reason</span><span class="p">:</span> <span class="n">Changing</span> <span class="k">table</span> <span class="k">options</span> <span class="n">requires</span> <span class="n">the</span> <span class="k">table</span> <span class="k">to</span> <span class="n">be</span> <span class="n">rebuilt</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">INPLACE</span>
</pre><p>This applies to <a href="/kb/en/create-table/#row_format">ALTER TABLE ... ROW_FORMAT=...</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-key_block_size"><code>ALTER TABLE ... KEY_BLOCK_SIZE=...</code></h3>
<p>InnoDB does <strong>not</strong> support changing a table's <a href="/kb/en/innodb-storage-formats/#using-the-compressed-row-format">KEY_BLOCK_SIZE</a> with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ROW_FORMAT</span><span class="o">=</span><span class="n">COMPRESSED</span>
  <span class="n">KEY_BLOCK_SIZE</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="n">KEY_BLOCK_SIZE</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="n">ERROR</span> <span class="mi">1846</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span><span class="p">.</span> <span class="n">Reason</span><span class="p">:</span> <span class="n">Changing</span> <span class="k">table</span> <span class="k">options</span> <span class="n">requires</span> <span class="n">the</span> <span class="k">table</span> <span class="k">to</span> <span class="n">be</span> <span class="n">rebuilt</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">INPLACE</span>
</pre><p>This applies to <a href="/kb/en/create-table/#key_block_size">KEY_BLOCK_SIZE=...</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-page_compressed1-and-alter-table-page_compression_level"><code>ALTER TABLE ... PAGE_COMPRESSED=1</code> and <code>ALTER TABLE ... PAGE_COMPRESSION_LEVEL=...</code></h3>
<p>In <a href="/kb/en/mariadb-10310-release-notes/">MariaDB 10.3.10</a> and later, InnoDB supports setting a table's <a href="/kb/en/create-table/#page_compressed">PAGE_COMPRESSED</a> value to <code>1</code> with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>InnoDB does <strong>not</strong> support changing a table's <a href="/kb/en/create-table/#page_compressed">PAGE_COMPRESSED</a> value from <code>1</code> to <code>0</code> with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>In these versions, InnoDB also supports changing a table's <a href="/kb/en/create-table/#page_compression_level">PAGE_COMPRESSION_LEVEL</a> value with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause is set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-page_compressed1-and-alter-table-page_compression_level">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... PAGE_COMPRESSED=1 and ALTER TABLE ... PAGE_COMPRESSION_LEVEL=...</a> for more information.</p>
<p>This applies to <a href="/kb/en/create-table/#page_compressed">ALTER TABLE ... PAGE_COMPRESSED=...</a> and <a href="/kb/en/create-table/#page_compression_level">ALTER TABLE ... PAGE_COMPRESSION_LEVEL=...</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-drop-system-versioning"><code>ALTER TABLE ... DROP SYSTEM VERSIONING</code></h3>
<p>InnoDB does <strong>not</strong> support dropping <a href="/kb/en/system-versioned-tables/">system versioning</a> from a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">)</span> <span class="k">WITH</span> <span class="k">SYSTEM</span> <span class="n">VERSIONING</span><span class="p">;</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">DROP</span> <span class="k">SYSTEM</span> <span class="n">VERSIONING</span><span class="p">;</span>
<span class="n">ERROR</span> <span class="mi">1845</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span> <span class="k">for</span> <span class="n">this</span> <span class="k">operation</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">INPLACE</span>
</pre><p>This applies to <a href="/kb/en/alter-table/#drop-system-versioning">ALTER TABLE ... DROP SYSTEM VERSIONING</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-drop-constraint"><code>ALTER TABLE ... DROP CONSTRAINT</code></h3>
<p>In <a href="/kb/en/mariadb-1036-release-notes/">MariaDB 10.3.6</a> and later, InnoDB supports dropping a <a href="/kb/en/constraint/#check-constraints">CHECK</a> constraint from a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-drop-constraint">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... DROP CONSTRAINT</a> for more information.</p>
<p>This applies to <a href="/kb/en/alter-table/#drop-constraint">ALTER TABLE ... DROP CONSTRAINT</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-force"><code>ALTER TABLE ... FORCE</code></h3>
<p>InnoDB does <strong>not</strong> support forcing a table rebuild with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="k">FORCE</span><span class="p">;</span>
<span class="n">ERROR</span> <span class="mi">1845</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span> <span class="k">for</span> <span class="n">this</span> <span class="k">operation</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">INPLACE</span>
</pre><p>This applies to <a href="/kb/en/alter-table/#force">ALTER TABLE ... FORCE</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-engineinnodb"><code>ALTER TABLE ... ENGINE=InnoDB</code></h3>
<p>InnoDB does <strong>not</strong> support forcing a table rebuild with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span><span class="p">;</span>
<span class="n">ERROR</span> <span class="mi">1845</span> <span class="p">(</span><span class="mi">0</span><span class="n">A000</span><span class="p">):</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span> <span class="k">for</span> <span class="n">this</span> <span class="k">operation</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">INPLACE</span>
</pre><p>This applies to <a href="/kb/en/create-table/#storage-engine">ALTER TABLE ... ENGINE=InnoDB</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="optimize-table"><code>OPTIMIZE TABLE ...</code></h3>
<p>InnoDB does <strong>not</strong> support optimizing a table with with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code>.</p>
<p>For example:</p>
<pre class="fixed wrap"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="n">tab</span> <span class="p">(</span>
   <span class="n">a</span> <span class="nb">int</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
   <span class="n">b</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
   <span class="k">c</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">SHOW</span> <span class="k">GLOBAL</span> <span class="n">VARIABLES</span> <span class="k">WHERE</span> <span class="n">Variable_name</span> <span class="k">IN</span><span class="p">(</span><span class="s1">&#39;innodb_defragment&#39;</span><span class="p">,</span> <span class="s1">&#39;innodb_optimize_fulltext_only&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------+-------+</span>
<span class="o">|</span> <span class="n">Variable_name</span>                 <span class="o">|</span> <span class="n">Value</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+-------+</span>
<span class="o">|</span> <span class="n">innodb_defragment</span>             <span class="o">|</span> <span class="k">OFF</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">innodb_optimize_fulltext_only</span> <span class="o">|</span> <span class="k">OFF</span>   <span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------+-------+</span>
<span class="mi">2</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="n">sec</span><span class="p">)</span>

<span class="k">SET</span> <span class="k">SESSION</span> <span class="n">alter_algorithm</span><span class="o">=</span><span class="s1">&#39;NOCOPY&#39;</span><span class="p">;</span>
<span class="n">OPTIMIZE</span> <span class="k">TABLE</span> <span class="n">tab</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+----------+----------+-----------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="k">Table</span>   <span class="o">|</span> <span class="n">Op</span>       <span class="o">|</span> <span class="n">Msg_type</span> <span class="o">|</span> <span class="n">Msg_text</span>                                                                    <span class="o">|</span>
<span class="o">+</span><span class="c1">---------+----------+----------+-----------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">db1</span><span class="p">.</span><span class="n">tab</span> <span class="o">|</span> <span class="n">optimize</span> <span class="o">|</span> <span class="n">note</span>     <span class="o">|</span> <span class="k">Table</span> <span class="n">does</span> <span class="k">not</span> <span class="n">support</span> <span class="n">optimize</span><span class="p">,</span> <span class="n">doing</span> <span class="n">recreate</span> <span class="o">+</span> <span class="k">analyze</span> <span class="k">instead</span>           <span class="o">|</span>
<span class="o">|</span> <span class="n">db1</span><span class="p">.</span><span class="n">tab</span> <span class="o">|</span> <span class="n">optimize</span> <span class="o">|</span> <span class="n">error</span>    <span class="o">|</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">NOCOPY</span> <span class="k">is</span> <span class="k">not</span> <span class="n">supported</span> <span class="k">for</span> <span class="n">this</span> <span class="k">operation</span><span class="p">.</span> <span class="n">Try</span> <span class="n">ALGORITHM</span><span class="o">=</span><span class="n">INPLACE</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">db1</span><span class="p">.</span><span class="n">tab</span> <span class="o">|</span> <span class="n">optimize</span> <span class="o">|</span> <span class="n">status</span>   <span class="o">|</span> <span class="k">Operation</span> <span class="n">failed</span>                                                            <span class="o">|</span>
<span class="o">+</span><span class="c1">---------+----------+----------+-----------------------------------------------------------------------------+</span>
<span class="mi">3</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span><span class="p">,</span> <span class="mi">1</span> <span class="n">warning</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">002</span> <span class="n">sec</span><span class="p">)</span>
</pre><p>This applies to <a href="/kb/en/optimize-table/">OPTIMIZE TABLE</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h3 class="anchored_heading" id="alter-table-rename-to-and-rename-table"><code>ALTER TABLE ... RENAME TO</code> and <code>RENAME TABLE ...</code></h3>
<p>InnoDB supports renaming a table with <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> set to <code>NOCOPY</code> in the cases where the operation supports having the <a href="/kb/en/alter-table/#algorithm">ALGORITHM</a> clause set to <code>INSTANT</code>.</p>
<p>See <a href="/kb/en/innodb-online-ddl-operations-with-algorithminstant/#alter-table-rename-to-and-rename-table">InnoDB Online DDL Operations with ALGORITHM=INSTANT: ALTER TABLE ... RENAME TO and RENAME TABLE ...</a> for more information.</p>
<p>This applies to <a href="/kb/en/alter-table/#rename-to">ALTER TABLE ... RENAME TO</a> and <a href="/kb/en/rename-table/">RENAME TABLE</a> for <a href="/kb/en/innodb/">InnoDB</a> tables.</p>
<h2 class="anchored_heading" id="limitations">Limitations</h2>
<h3 class="anchored_heading" id="limitations-related-to-generated-virtual-and-persistentstored-columns">Limitations Related to Generated (Virtual and Persistent/Stored) Columns</h3>
<p><a href="/kb/en/generated-columns/">Generated columns</a> do not currently support online DDL for all of the same operations that are supported for "real" columns.</p>
<p>See <a href="/kb/en/generated-columns/#statement-support">Generated (Virtual and Persistent/Stored) Columns: Statement Support</a> for more information on the limitations.</p>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/innodb-online-ddl-operations-with-the-inplace-alter-algorithm/">
                        ← InnoDB Online DDL Operations with the INPLACE Alter Algorithm
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/innodb-online-ddl/">
                        ↑ InnoDB Online DDL ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/innodb-online-ddl-operations-with-the-instant-alter-algorithm/">
                        InnoDB Online DDL Operations with the INSTANT Alter Algorithm →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="8860" data-comments-url="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/+comments"
         data-reply-url="/kb/en/innodb-online-ddl-operations-with-the-nocopy-alter-algorithm/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/innodb-online-ddl/">
                    ↑ InnoDB Online DDL ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/innodb-online-ddl-overview/">
                            
                            InnoDB Online DDL Overview
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-online-ddl-operations-with-the-inplace-alter-algorithm/">
                            
                            InnoDB Online DDL Operations with the INPLACE Alter Algorithm
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>InnoDB Online DDL Operations with the NOCOPY Alter Algorithm</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb-online-ddl-operations-with-the-instant-alter-algorithm/">
                            
                            InnoDB Online DDL Operations with the INSTANT Alter Algorithm
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/instant-add-column-for-innodb/">
                            
                            Instant ADD COLUMN for InnoDB
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>