<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Buildbot Setup for Virtual Machines - Debian 7 &#34;wheezy&#34; - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Buildbot Setup for Virtual Machines - Debian 7 &#34;wheezy&#34;" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="
Base install
qemu-img create -f qcow2 /kvm/vms/vm-wheezy-amd64-serial.qcow2 10G
qemu-img create -f qcow2 /kvm/vms/vm-wheezy-i386-serial.qcow2 10G
Start each VM booting from t..." />

    <meta name="description" content="
Base install
qemu-img create -f qcow2 /kvm/vms/vm-wheezy-amd64-serial.qcow2 10G
qemu-img create -f qcow2 /kvm/vms/vm-wheezy-i386-serial.qcow2 10G
Start each VM booting from t..." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/training-tutorials/">Training &amp; Tutorials</a>
    

    
    » <a class="crumb" href="/kb/en/advanced-mariadb-articles/">Advanced MariaDB Articles</a>
    

    
    » <a class="crumb" href="/kb/en/development-articles/">Development Articles</a>
    

    
    » <a class="crumb" href="/kb/en/tools/">MariaDB Development Tools</a>
    

    
    » <a class="crumb" href="/kb/en/buildbot/">Buildbot</a>
    

    
    » <a class="crumb" href="/kb/en/buildbot-setup/">Buildbot Setup</a>
    

    
    » <a class="crumb" href="/kb/en/buildbot-setup-for-virtual-machines/">Buildbot Setup for Virtual Machines</a>
    

    
    » <a class="crumb" href="/kb/en/buildbot-setup-for-virtual-machines-debian/">Buildbot Setup for Virtual Machines - Debian</a>
    


    » <a class="node_link crumb" href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/">Buildbot Setup for Virtual Machines - Debian 7 &#34;wheezy&#34;</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+flag"
                data-flag-url="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2012-08-17 04:26">11 years, 5 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2013-12-05 21:31">10 years, 1 month ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    
        

<div class="well well-small box"><div><h5>Localized Versions</h5></div><div>

        <ul>
            
            <li><a href="/kb/it/buildbot-setup-for-virtual-machines-debian-7-wheezy/">Buildbot Setup for Virtual Machines - Debian 7 &#34;wheezy&#34;</a> [it]</li>
            
        </ul>
        
</div>
</div>

    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Buildbot Setup for Virtual Machines - Debian 7 &#34;wheezy&#34;</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#base-install" title="Base install">Base install</a></li>

    <li class=""><a href="#vms-for-building-debs" title="VMs for building .debs">VMs for building .debs</a></li>

    <li class=""><a href="#vms-for-install-testing" title="VMs for install testing.">VMs for install testing.</a></li>

    <li class=""><a href="#vms-for-mysql-upgrade-testing" title="VMs for MySQL upgrade testing">VMs for MySQL upgrade testing</a></li>

    <li class=""><a href="#vms-for-mariadb-upgrade-testing" title="VMs for MariaDB upgrade testing">VMs for MariaDB upgrade testing</a></li>

    <li class=""><a href="#add-key-to-known_hosts" title="Add Key to known_hosts">Add Key to known_hosts</a> </ol>
</li>
</div>
<h2 class="anchored_heading" id="base-install">Base install</h2>
<pre class="fixed">qemu-img create -f qcow2 /kvm/vms/vm-wheezy-amd64-serial.qcow2 10G
qemu-img create -f qcow2 /kvm/vms/vm-wheezy-i386-serial.qcow2 10G
</pre><p>Start each VM booting from the server install iso one at a time and perform
the following install steps:</p>
<pre class="fixed">kvm -m <span class="m">1024</span> -hda /kvm/vms/vm-wheezy-amd64-serial.qcow2 -cdrom /kvm/iso/debian-testing-amd64-CD-1.iso -redir tcp:2269::22 -boot d -smp <span class="m">2</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user
kvm -m <span class="m">1024</span> -hda /kvm/vms/vm-wheezy-i386-serial.qcow2  -cdrom /kvm/iso/debian-testing-i386-CD-1.iso  -redir tcp:2270::22 -boot d -smp <span class="m">2</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user
</pre><p>Once running you can connect to the VNC server from your local host with:</p>
<pre class="fixed">vncviewer -via <span class="si">${</span><span class="nv">remote</span><span class="p">-host</span><span class="si">}</span> localhost
</pre><p>Replace ${remote-host} with the host the vm is running on.</p>
<p><strong>Note:</strong> When you activate the install, vncviewer may disconnect with a complaint about the rect being too large. This is fine. Debian has just resized the vnc screen. Simply reconnect.</p>
<p>Install, picking default options mostly, with the following notes:</p>
<ul start="1"><li>Set the hostname to debian7-wheezy-amd64 or debian7-wheezy-i386
</li><li>When partitioning disks, choose "Guided - use entire disk" (we do not want LVM)
<ul start="1"><li>Partitioning Scheme: All files one partition
</li></ul>
</li><li>No additional CDs
</li><li>Set up network mirror
</li><li>Software Selection Screen
<ul start="1"><li>Uncheck "Debian desktop environment"
</li><li>Uncheck "Print server"
</li><li>Keep "SSH server" and "Standard system utilities"
</li></ul>
</li></ul>
<p>When the install is finished the installer will attempt to reboot and then fail. This is OK, just kill the kvm process on the host server.</p>
<p>Now that the VM is installed, it's time to configure it.
If you have the memory you can do the following simultaneously:</p>
<pre class="fixed">kvm -m <span class="m">1024</span> -hda /kvm/vms/vm-wheezy-amd64-serial.qcow2 -redir tcp:2269::22 -boot c -smp <span class="m">2</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user -nographic
kvm -m <span class="m">1024</span> -hda /kvm/vms/vm-wheezy-i386-serial.qcow2 -redir tcp:2270::22 -boot c -smp <span class="m">2</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user -nographic

ssh -p <span class="m">2269</span> localhost
<span class="c1"># edit /boot/grub/menu.lst and visudo, see below</span>

ssh -p <span class="m">2270</span> localhost
<span class="c1"># edit /boot/grub/menu.lst and visudo, see below</span>

ssh -t -p <span class="m">2269</span> localhost <span class="s2">&quot;mkdir -v .ssh&quot;</span>
ssh -t -p <span class="m">2270</span> localhost <span class="s2">&quot;mkdir -v .ssh&quot;</span>

scp -P <span class="m">2269</span> /kvm/vms/authorized_keys localhost:.ssh/
scp -P <span class="m">2270</span> /kvm/vms/authorized_keys localhost:.ssh/

<span class="nb">echo</span> <span class="s1">$&#39;Buildbot\n\n\n\n\ny&#39;</span> <span class="p">|</span> ssh -p <span class="m">2269</span> localhost <span class="s1">&#39;chmod -vR go-rwx .ssh; sudo adduser --disabled-password buildbot; sudo addgroup buildbot sudo; sudo mkdir ~buildbot/.ssh; sudo cp -vi .ssh/authorized_keys ~buildbot/.ssh/; sudo chown -vR buildbot:buildbot ~buildbot/.ssh; sudo chmod -vR go-rwx ~buildbot/.ssh&#39;</span>
<span class="nb">echo</span> <span class="s1">$&#39;Buildbot\n\n\n\n\ny&#39;</span> <span class="p">|</span> ssh -p <span class="m">2270</span> localhost <span class="s1">&#39;chmod -vR go-rwx .ssh; sudo adduser --disabled-password buildbot; sudo addgroup buildbot sudo; sudo mkdir ~buildbot/.ssh; sudo cp -vi .ssh/authorized_keys ~buildbot/.ssh/; sudo chown -vR buildbot:buildbot ~buildbot/.ssh; sudo chmod -vR go-rwx ~buildbot/.ssh&#39;</span>

scp -P <span class="m">2269</span> /kvm/vms/ttyS0.conf buildbot@localhost:
scp -P <span class="m">2270</span> /kvm/vms/ttyS0.conf buildbot@localhost:

ssh -p <span class="m">2269</span> buildbot@localhost <span class="s1">&#39;sudo cp -vi ttyS0.conf /etc/init/; rm -v ttyS0.conf; sudo shutdown -h now&#39;</span>
ssh -p <span class="m">2270</span> buildbot@localhost <span class="s1">&#39;sudo cp -vi ttyS0.conf /etc/init/; rm -v ttyS0.conf; sudo shutdown -h now&#39;</span>
</pre><p>Enabling passwordless sudo:</p>
<pre class="fixed">su -
vi /etc/apt/sources.list <span class="c1">#comment out the deb cdrom line</span>
apt-get update
apt-get install sudo vim tree
update-alternatives --config editor <span class="c1"># select vim.basic</span>
visudo <span class="c1"># comment out existing %sudo line and add: %sudo ALL=NOPASSWD: ALL</span>
usermod -a -G sudo <span class="si">${</span><span class="nv">username</span><span class="si">}</span>
</pre><p>Editing /boot/grub/menu.lst:</p>
<pre class="fixed">vi /etc/default/grub

<span class="c1"># Add/edit these entries:</span>
    <span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;console=tty0 console=ttyS0,115200n8&quot;</span>
    <span class="nv">GRUB_TERMINAL</span><span class="o">=</span><span class="s2">&quot;serial&quot;</span>
    <span class="nv">GRUB_SERIAL_COMMAND</span><span class="o">=</span><span class="s2">&quot;serial --unit=0 --speed=115200 --word=8 --parity=no --stop=1&quot;</span>

update-grub
<span class="c1"># exit back to the host server</span>
</pre><h2 class="anchored_heading" id="vms-for-building-debs">VMs for building .debs</h2>
<pre class="fixed"><span class="k">for</span> i in <span class="s1">&#39;/kvm/vms/vm-wheezy-amd64-serial.qcow2 2269 qemu64&#39;</span> <span class="s1">&#39;/kvm/vms/vm-wheezy-i386-serial.qcow2 2270 qemu64&#39;</span> <span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
  <span class="nb">set</span> <span class="nv">$i</span><span class="p">;</span> <span class="se">\</span>
  runvm --user<span class="o">=</span>buildbot --logfile<span class="o">=</span>kernel_<span class="nv">$2</span>.log --base-image<span class="o">=</span><span class="nv">$1</span> --port<span class="o">=</span><span class="nv">$2</span> --cpu<span class="o">=</span><span class="nv">$3</span> <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/serial/build/&#39;</span><span class="k">)</span><span class="s2">&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;= scp -P </span><span class="nv">$2</span><span class="s2"> -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no /kvm/boost_1_49_0.tar.gz buildbot@localhost:/dev/shm/&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get update&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get -y build-dep mysql-server-5.5&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get install -y devscripts hardening-wrapper fakeroot doxygen texlive-latex-base ghostscript libevent-dev libssl-dev zlib1g-dev libpam0g-dev libreadline-gplv2-dev autoconf automake automake1.9 dpatch ghostscript-x libfontenc1 libjpeg62 libltdl-dev libltdl7 libmail-sendmail-perl libxfont1 lmodern texlive-latex-base-doc ttf-dejavu ttf-dejavu-extra libaio-dev xfonts-encodings xfonts-utils libxml2-dev unixodbc-dev&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;cd /usr/local/src;sudo tar zxf /dev/shm/boost_1_49_0.tar.gz;cd /usr/local/include/;sudo ln -vs ../src/boost_1_49_0/boost .&quot;</span> <span class="p">;</span> <span class="se">\</span>
<span class="k">done</span>

</pre><h2 class="anchored_heading" id="vms-for-install-testing">VMs for install testing.</h2>
<p>See <a href="/kb/en/buildbot-setup-for-virtual-machines-general-principles/">Buildbot Setup for Virtual Machines - General Principles</a> for how to obtain <code>my.seed</code> and <code>sources.append</code>.</p>
<pre class="fixed"><span class="k">for</span> i in <span class="s1">&#39;/kvm/vms/vm-wheezy-amd64-serial.qcow2 2269 qemu64&#39;</span> <span class="s1">&#39;/kvm/vms/vm-wheezy-i386-serial.qcow2 2270 qemu64&#39;</span> <span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
  <span class="nb">set</span> <span class="nv">$i</span><span class="p">;</span> <span class="se">\</span>
  runvm --user<span class="o">=</span>buildbot --logfile<span class="o">=</span>kernel_<span class="nv">$2</span>.log --base-image<span class="o">=</span><span class="nv">$1</span> --port<span class="o">=</span><span class="nv">$2</span> --cpu<span class="o">=</span><span class="nv">$3</span> <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/serial/install/&#39;</span><span class="k">)</span><span class="s2">&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get update&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get install -y patch libaio1 debconf-utils unixodbc libxml2&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;= scp -P </span><span class="nv">$2</span><span class="s2"> /kvm/vms/my.seed /kvm/vms/sources.append buildbot@localhost:/tmp/&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo debconf-set-selections /tmp/my.seed&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo sh -c &#39;cat /tmp/sources.append &gt;&gt; /etc/apt/sources.list&#39;&quot;</span><span class="p">;</span> <span class="se">\</span>
<span class="k">done</span>
</pre><h2 class="anchored_heading" id="vms-for-mysql-upgrade-testing">VMs for MySQL upgrade testing</h2>
<p>2013-12-05 recreated the upgrade VMs, this time based off of the serial VM (which is better, maintenance-wise).</p>
<pre class="fixed"><span class="k">for</span> i in <span class="s1">&#39;/kvm/vms/vm-wheezy-amd64-serial.qcow2 2269 qemu64&#39;</span> <span class="s1">&#39;/kvm/vms/vm-wheezy-i386-serial.qcow2 2270 qemu64&#39;</span> <span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
  <span class="nb">set</span> <span class="nv">$i</span><span class="p">;</span> <span class="se">\</span>
  runvm --user<span class="o">=</span>buildbot --logfile<span class="o">=</span>kernel_<span class="nv">$2</span>.log --base-image<span class="o">=</span><span class="nv">$1</span> --port<span class="o">=</span><span class="nv">$2</span> --cpu<span class="o">=</span><span class="nv">$3</span> <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/serial/upgrade/&#39;</span><span class="k">)</span><span class="s2">&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get update&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get install -y patch libaio1 debconf-utils unixodbc libxml2&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;= scp -P </span><span class="nv">$2</span><span class="s2"> /kvm/vms/my.seed /kvm/vms/sources.append buildbot@localhost:/tmp/&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo debconf-set-selections /tmp/my.seed&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo sh -c &#39;cat /tmp/sources.append &gt;&gt; /etc/apt/sources.list&#39;&quot;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo DEBIAN_FRONTEND=noninteractive apt-get install -y libaio1 mysql-server-5.5&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;mysql -uroot -prootpass -e &quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;&#39;</span> <span class="p">;</span><span class="se">\</span>
<span class="k">done</span>
</pre><p>This was how the original upgrade VMs were created:</p>
<pre class="fixed"><span class="k">for</span> i in <span class="s1">&#39;/kvm/vms/vm-wheezy-amd64-install.qcow2 2269 qemu64&#39;</span> <span class="s1">&#39;/kvm/vms/vm-wheezy-i386-install.qcow2 2270 qemu64&#39;</span> <span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
  <span class="nb">set</span> <span class="nv">$i</span><span class="p">;</span> <span class="se">\</span>
  runvm --user<span class="o">=</span>buildbot --logfile<span class="o">=</span>kernel_<span class="nv">$2</span>.log --base-image<span class="o">=</span><span class="nv">$1</span> --port<span class="o">=</span><span class="nv">$2</span> --cpu<span class="o">=</span><span class="nv">$3</span> <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/install/upgrade/&#39;</span><span class="k">)</span><span class="s2">&quot;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo DEBIAN_FRONTEND=noninteractive apt-get install -y libaio1 mysql-server-5.5&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;mysql -uroot -prootpass -e &quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;&#39;</span> <span class="p">;</span><span class="se">\</span>
<span class="k">done</span>
</pre><h2 class="anchored_heading" id="vms-for-mariadb-upgrade-testing">VMs for MariaDB upgrade testing</h2>
<p> <em>The steps below are based on the Natty steps on <a href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/">Installing VM images for testing .deb upgrade between versions</a>.</em></p>
<pre class="fixed"><span class="k">for</span> i in <span class="s1">&#39;/kvm/vms/vm-wheezy-amd64-serial.qcow2 2269 qemu64&#39;</span> <span class="s1">&#39;/kvm/vms/vm-wheezy-i386-serial.qcow2 2270 qemu64&#39;</span> <span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
  <span class="nb">set</span> <span class="nv">$i</span><span class="p">;</span> <span class="se">\</span>
  runvm --user<span class="o">=</span>buildbot --logfile<span class="o">=</span>kernel_<span class="nv">$2</span>.log --base-image<span class="o">=</span><span class="nv">$1</span> --port<span class="o">=</span><span class="nv">$2</span> --cpu<span class="o">=</span><span class="nv">$3</span> <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/serial/upgrade2/&#39;</span><span class="k">)</span><span class="s2">&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;= scp -P </span><span class="nv">$2</span><span class="s2"> -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no /kvm/vms/mariadb-wheezy.list buildbot@localhost:/tmp/tmp.list&quot;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo mv -vi /tmp/tmp.list /etc/apt/sources.list.d/&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 1BB943DB&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo apt-get update&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo DEBIAN_FRONTEND=noninteractive apt-get install -y --allow-unauthenticated mariadb-server mariadb-server-5.5 mariadb-client mariadb-client-5.5 mariadb-test libmariadbclient-dev&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo apt-get -f install&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo mysqladmin -u root password &quot;rootpass&quot;&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo /etc/init.d/mysql restart&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;mysql -uroot -prootpass -e &quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo rm -v /etc/apt/sources.list.d/tmp.list&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo apt-get update&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo DEBIAN_FRONTEND=noninteractive apt-get install -y libaio1&#39;</span> <span class="se">\</span>
    <span class="s1">&#39;sudo DEBIAN_FRONTEND=noninteractive apt-get upgrade -y&#39;</span><span class="p">;</span> <span class="se">\</span>
<span class="k">done</span>
</pre><h2 class="anchored_heading" id="add-key-to-known_hosts">Add Key to known_hosts</h2>
<p>Do the following on each build host server to add the VMs to known_hosts.</p>
<pre class="fixed"><span class="c1"># wheezy-amd64</span>
cp -avi /kvm/vms/vm-wheezy-amd64-install.qcow2 /kvm/vms/vm-wheezy-amd64-test.qcow2
kvm -m <span class="m">1024</span> -hda /kvm/vms/vm-wheezy-amd64-test.qcow2 -redir tcp:2269::22 -boot c -smp <span class="m">2</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user -nographic
sudo su - buildbot
ssh -p <span class="m">2269</span> buildbot@localhost sudo shutdown -h now
rm -v /kvm/vms/vm-wheezy-amd64-test.qcow2

<span class="c1"># wheezy-i386</span>
cp -avi /kvm/vms/vm-wheezy-i386-install.qcow2 /kvm/vms/vm-wheezy-i386-test.qcow2
kvm -m <span class="m">1024</span> -hda /kvm/vms/vm-wheezy-i386-test.qcow2 -redir tcp:2270::22 -boot c -smp <span class="m">2</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user -nographic
sudo su - buildbot
ssh -p <span class="m">2270</span> buildbot@localhost sudo shutdown -h now
rm -v /kvm/vms/vm-wheezy-i386-test.qcow2
</pre>
    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                
                    <li><a href="/kb/en/buildbot-setup-for-virtual-machines-debian/">
                        ↑ Buildbot Setup for Virtual Machines - Debian ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/buildbot-setup-for-virtual-machines-debian-6-amd64/">
                        Buildbot Setup for Virtual Machines - Debian 6 amd64 →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="2895" data-comments-url="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/+comments"
         data-reply-url="/kb/en/buildbot-setup-for-virtual-machines-debian-7-wheezy/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/buildbot-setup-for-virtual-machines-debian/">
                    ↑ Buildbot Setup for Virtual Machines - Debian ↑
                </a>
                </li>
            
            
                
                    <li class="active">
                        <span>Buildbot Setup for Virtual Machines - Debian 7 &#34;wheezy&#34;</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/buildbot-setup-for-virtual-machines-debian-6-amd64/">
                            
                            Buildbot Setup for Virtual Machines - Debian 6 amd64
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/buildbot-setup-for-virtual-machines-debian-6-i386/">
                            
                            Buildbot Setup for Virtual Machines - Debian 6 i386
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/buildbot-setup-for-virtual-machines-debian-5-amd64/">
                            
                             Buildbot Setup for Virtual Machines - Debian 5 amd64
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/buildbot-setup-for-virtual-machines-debian-5-i386/">
                            
                            Buildbot Setup for Virtual Machines - Debian 5 i386
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/buildbot-setup-for-virtual-machines-debian-4-i386/">
                            
                            Buildbot Setup for Virtual Machines - Debian 4 i386
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/buildbot-setup-for-virtual-machines-debian-4-amd64/">
                            
                            Buildbot Setup for Virtual Machines - Debian 4 amd64
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>