<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>MariaDB 5.3.1 Changelog - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="MariaDB 5.3.1 Changelog - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariadb-531-changelog/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-531-changelog/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-531-changelog/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/mariadb-server-release-dates/">MariaDB Server Releases</a>
    

    
    » <a class="crumb" href="/kb/en/changelogs/">Changelogs</a>
    

    
    » <a class="crumb" href="/kb/en/changelogs-mariadb-53-series/">Changelogs - MariaDB 5.3 Series</a>
    


    » <a class="node_link crumb" href="/kb/en/mariadb-531-changelog/">MariaDB 5.3.1 Changelog</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/mariadb-531-changelog/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>MariaDB 5.3.1 Changelog - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/mariadb-531-changelog/+r/13795/">13795</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-1">
<a href="/kb/user/id/1" title="Bryan Alsdorf">Bryan Alsdorf</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2022-11-18 02:56">2022-11-18 02:56</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">[[http://downloads.askmonty.org/mariadb/5.3.1|Download]] | 
[[mariadb-531-release-notes|Release Notes]] | 
**Changelog** |
[[what-is-mariadb-53|Overview of 5.3]]

**Release date:** 10 Sep 2011

For the highlights of this release, see the
[[mariadb-531-release-notes|release notes]].

The revision number links will take you to the revision&#39;s page on Launchpad. On
Launchpad you can view more details of the revision and view diffs of the code
modified in that revision.

* maria53rev:3182
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-09-08 23:24:47 +0400&lt;&lt;/style&gt;&gt;
** lpbug#833600: Wrong result with view + outer join + uncorrelated subquery (non-semijoin) 
*** The bug was caused by outer join being incorrectly converted into inner because of 
    invalid return values of Item_direct_view_ref::not_null_tables().
*** Provided a correct Item_direct_view_ref::not_null_tables() function.
* maria53rev:3181 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-09-08 21:38:10 +0400&lt;&lt;/style&gt;&gt;
** Automerge.
*** maria53rev:3173.1.9
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-09-08 19:48:14 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#830993: Crash in end_read_record with derived table
***** Let join buffering code correctly take into account rowids needed 
      by DuplicateElimination when it is calculating minimum record sizes.
***** In JOIN_CACHE::write_record_data, added asserts that prevent us from 
      writing beyond the end of the buffer.
* maria53rev:3180 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-09-08 09:21:31 -0700&lt;&lt;/style&gt;&gt;
** Merge.
*** maria53rev:3156.1.1
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-15 23:18:36 -0700&lt;&lt;/style&gt;&gt;
**** Fixed LP bug #824463.
**** When merging a view / derived table the function SELECT_LEX::merge_subquery
     incorrectly updated the list SELECT_LEX::leaf_tables. Erroneously it
     appended the leaf_tables list of the merged object L and then removed the
     reference to the merged object T from the SELECT_LEX::leaf_tables list.
**** A correct implementation should insert the list L into the
     SELECT_LEX::leaf_tables list in place of the element of the list that 
     refers to T.
**** The bug could lead to wrong results or even crashes for queries with
      nested outer joins over views / derived tables.
* maria53rev:3179
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-09-07 20:39:47 +0200&lt;&lt;/style&gt;&gt;
** lpbug:839387 Assertion `(Item_result)i != TIME_RESULT&#39; failed with CASE + datetime
*** remove incorrect DBUG_ASSERT().
*** Fix incorrectly used cmp_item::get_comparator() in Item_func_case and Item_equal
* maria53rev:3178 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-09-06 20:59:29 +0400&lt;&lt;/style&gt;&gt;
** Merge
*** maria53rev:3173.1.8
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-09-06 20:52:36 +0400&lt;&lt;/style&gt;&gt;
**** Fix typo bug
*** maria53rev:3173.1.7
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-09-06 17:06:04 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#823930: Wrong result with semijoin materialization and blob fields
***** Make subquery_types_allow_materialization() detect a case where 
      create_tmp_table() would create a blob column which would make it 
      impossible to use materialization
***** Non-semi-join materialization worked because it detected that this case
      and felt back to use IN-&gt;EXISTS. Semi-join Materialization cannot easily
      fallback, so we have to detect this case early.
*** maria53rev:3173.1.6
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-09-05 20:51:37 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#834739: Wrong result with 3-way inner join, LooseScan,multipart keys  
***** Don&#39;t use join buffering for tables that are within ranges that are 
      covered by LooseScan strategy.
*** maria53rev:3173.1.5
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-09-05 19:28:22 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#834758: Wrong result with innner join, LooseScan, two-column IN() predicate
***** get_bound_sj_equalities() would produce incorrect bitmap when non-first 
      equality was bound, which resulted in invalid LooseScan plans.
*** maria53rev:3173.1.4
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Sun 2011-09-04 16:35:37 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#836532: Crash in Item_equal_fields_iterator::get_curr_field with semijoin+materialization
***** Item_in_subselect::inject_in_to_exists_cond() should not call 
      ((Item_cond*)join-&gt;conds)-&gt;argument_list()-&gt;concat(join-&gt;cond_equal-&gt;current_level)
      as that makes two lists share their tail, and the cond_equal list
      will end up containing non-Item_equal objects when substitute_for_best_equal_field()
      walks through join-&gt;conds and replaces all Item_equal objects with Item_func_eq objects.
***** So, instead of using List::concat(), manually copy entries from one list to another.
*** maria53rev:3173.1.3
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Sat 2011-09-03 17:05:05 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#834514: Assertion `!table || (!table-&gt;read_set || bitmap_is_set(...&#39; with aggregates
***** Make find_all_keys() not to rely on table-&gt;tmp_set remaining constant during execution
      quick_index_merge_select-&gt;reset() may change it.
*** maria53rev:3173.1.2
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-09-02 23:44:28 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#836507: Crash in setup_sj_materialization_part1() with semijoin+materialization
***** setup_sj_materialization() code failed to take into account that it can be that 
      the first [in join order ordering] table inside semi-join-materialization nest 
      is also an inner table wrt an outer join (that is embedded in the semi-join).  
      This can happen when all of the tables that are inside the semi-join but not inside
      the outer join are constant.
***** Made a trivial to not assume that table&#39;s embedding join nest is the semi-join 
      nest: instead, walk up the outer join nests until we reach the semi-join nest.
*** maria53rev:3173.1.1
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-09-02 22:43:35 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#836523: Crash in JOIN::get_partial_cost_and_fanout with semijoin+materialization 
***** Make JOIN::get_partial_cost_and_fanout() be able to handle join plans with 
      semi-join-materialization nests.
* maria53rev:3177 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-09-06 08:38:35 -0700&lt;&lt;/style&gt;&gt;
** Merge.
*** maria53rev:3169.1.1
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-09-06 07:17:39 -0700&lt;&lt;/style&gt;&gt;
**** Fixed LP bug #838633. 
**** For any query JOIN::optimize() should call the method
     SELECT::save_leaf_tables after the last transformation
     that utilizes the statement memory rather than the 
     execution memory.
* maria53rev:3176 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-09-05 10:14:48 +0300&lt;&lt;/style&gt;&gt;
** Merge lpbug#780386 5.2-&gt;5.3 (where other fix was present)
*** maria53rev:2732.44.28
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-09-05 09:29:49 +0300&lt;&lt;/style&gt;&gt;
**** Fix of lpbug#780386.
***** ALL subquery should return TRUE if subquery rowa set is empty independently
      of left part.  The problem was that Item_func_(eq,ne,gt,ge,lt,le) do not
      call execution of second argument if first is NULL no in this case subquery
      will not be executed and when Item_func_not_all calls any_value() of the
      subquery or aggregation function which report that there was rows. So for
      NULL &lt; ALL (SELECT...) result was FALSE instead of TRUE.
***** Fix is just swapping of arguments of Item_func_(eq,ne,gt,ge,lt,le) (with
      changing the operation if it is needed) so that result will be the same
      (for examole a &lt; b is equal to b &gt; a). This fix exploit the fact that
      first argument will be executed in any case.
* maria53rev:3175 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-09-05 08:28:08 +0300&lt;&lt;/style&gt;&gt;
** merge 5.2-&gt;5.3
*** maria53rev:2732.44.27
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-09-05 08:15:46 +0300&lt;&lt;/style&gt;&gt;
**** Fix pbxt suite to keep the same opti9misation it was before.
* maria53rev:3174
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Sat 2011-09-03 11:50:56 +0300&lt;&lt;/style&gt;&gt;
** Fixed lpbug:828514 &#34;Assertion `! is_set()&#39; failed in Diagnostics_area::set_ok_status with derived table + subquery + concurrent DML&#34;
* maria53rev:3173 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-09-02 15:36:02 +0300&lt;&lt;/style&gt;&gt;
** Merge of merge
*** maria53rev:3171.1.1 [merge]
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-09-02 15:10:10 +0300&lt;&lt;/style&gt;&gt;
**** Merge 5.2-&gt;5.3
* maria53rev:3172 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-09-02 14:32:48 +0400&lt;&lt;/style&gt;&gt;
** Merge
*** maria53rev:3167.1.2
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-29 21:54:16 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#836491: Crash in Item_field::Item_field from add_ref_to_table_cond() with semijoin+materialization
***** Let create_tmp_table set KEY_PART_INFO::fieldnr. It is needed in add_ref_to_table_cond(), and possibly other places.
*** maria53rev:3167.1.1
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-29 19:57:41 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#834534: Assertion `0&#39; failed in replace_where_subcondition with semijoin subquery in HAVING
***** The problem was that the code that made the check whether the subquery is an AND-part of the WHERE 
      clause didn&#39;t work correctly for nested subqueries. In particular, grand-child subquery in HAVING was 
      treated as if it was in the WHERE, which eventually caused an assert when replace_where_subcondition
      looked for the subquery predicate in the WHERE and couldn&#39;t find it there.
***** The fix: Removed implementation of &#34;thd_marker approach&#34;. thd-&gt;thd_marker was used to determine the 
      location of subquery predicate: setup_conds() would set accordingly it when making
      the&lt;&lt;code lang=text inline=false&gt;&gt;{where|on_expr}-&gt;fix_fields(...)&lt;&lt;/code&gt;&gt;call
      so that AND-parts of the WHERE/ON clauses can determine they are the AND-parts. 
      Item_cond_or::fix_fields(), Item_func::fix_fields(), Item_subselect::fix_fields (this one was missed),
      and all other items-that-contain-items had to reset thd-&gt;thd_marker before calling fix_fields() for 
      their children items, so that the children can see they are not AND-parts of WHERE/ON.
***** The &#34;thd_marker approach&#34; required that a lot of code in different locations maintains correct value of
      thd-&gt;thd_marker, so it was replaced with:
***** The new approach with mark_as_condition_AND_part does not keep context in thd-&gt;thd_marker. Instead, 
      setup_conds() now calls&lt;&lt;code lang=text inline=false&gt;&gt;{where|on_expr}-&gt;mark_as_condition_AND_part()&lt;&lt;/code&gt;&gt;
***** and implementations of that function make sure that: 
****** parts of AND-expressions get the mark_as_condition_AND_part() call
****** Item_in_subselect objects record that they are AND-parts of WHERE/ON
* maria53rev:3171
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-09-01 23:53:12 +0300&lt;&lt;/style&gt;&gt;
** Fix for lpbug:834492
** Analysis:
*** In the test query semi-join merges the inner-most subquery
    into the outer subquery, and the optimization of the merged
    subquery finds some new index access methods. Later the
    IN-EXISTS transformation is applied to the unmerged subquery.
    Since the optimizer is instructed to not consider
    materialization, it reoptimizes the plan in-place to take into
    account the new IN-EXISTS conditions. Just before reoptimization
    JOIN::choose_subquery_plan resets the query plan, which also
    resets the access methods found during the semi-join merge.
    Then reoptimization discovers there are no new access methods,
    but it leaves the query plan in its reset state. Later semi-join
    crashes because it assumes these access methods are present.
** Solution:
*** When reoptimizing in-place, reset the query plan only after new
    access methods were discovered. If no new access methods were
    discovered, leave the current plan as it was.
* maria53rev:3170
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-09-01 14:23:03 +0400&lt;&lt;/style&gt;&gt;
** sec_to_time() in the integer context was losing the sign of the result
* maria53rev:3169
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-29 18:16:18 +0300&lt;&lt;/style&gt;&gt;
** Updated crash-me for 5.3
* maria53rev:3168
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-29 18:14:14 +0300&lt;&lt;/style&gt;&gt;
** Added MariaDB executable comment syntax:  /*M!##### */
* maria53rev:3167
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Sat 2011-08-27 00:40:29 +0300&lt;&lt;/style&gt;&gt;
** Fix lpbug:827416
** Analysis:
*** Constant table optimization of the outer query finds that
    the right side of the equality is a constant that can
    be used for an eq_ref access to fetch one row from t1,
    and substitute t1 with a constant. Thus constant optimization
    triggers evaluation of the subquery during the optimize
    phase of the outer query.
*** The innermost subquery requires a plan with a temporary
    table because with InnoDB tables the exact count of rows
    is not known, and the empty tables cannot be optimzied
    way. JOIN::exec for the innermost subquery substitutes
    the subquery tables with a temporary table.
*** When EXPLAIN gets to print the tables in the innermost
    subquery, EXPLAIN needs to print the name of each table
    through the corresponding TABLE_LIST object. However,
    the temporary table created during execution doesn&#39;t
    have a corresponding TABLE_LIST, so we get a null
    pointer exception.
** Solution:
*** The solution is to forbid using expensive constant
    expressions for eq_ref access for contant table
    optimization. Notice that eq_ref with a subquery
    providing the value is still possible during regular
    execution.
* maria53rev:3166 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-23 15:51:47 +0300&lt;&lt;/style&gt;&gt;
** Automatic merge.
*** maria53rev:3164.1.2
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-23 15:39:15 +0300&lt;&lt;/style&gt;&gt;
**** Fixed lpbug:825018
***** Analysis:
****** During the first execution of the query through the stored
       procedure, the optimization phase calls
       substitute_for_best_equal_field(), which calls
       Item_in_optimizer::transform(). The latter replaces
       Item_in_subselect::left_expr with args[0] via assignment.
       In this test case args[0] is an Item_outer_ref which is
       created/deallocated for each re-execution. As a result,
       during the second execution Item_in_subselect::left_expr
       pointed to freed memory, which resulted in a crash.
***** Solution:
****** The solution is to use change_item_tree(), so that the
       origianal left expression is restored after each execution.
*** maria53rev:3164.1.1
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-23 00:00:13 +0300&lt;&lt;/style&gt;&gt;
**** Fix lpbug:825095
***** Analysis:
****** Partial matching is used even when there are no NULLs in
      a materialized subquery, as long as the left NOT IN operand
      may contain NULL values.
****** This case was not handled correctly in two different places.
      First, the implementation of parital matching did not clear
      the set of matching columns when the merge process advanced
      to the next row.
****** Second, there is no need to perform partial matching at all
      when the left operand has no NULLs.
***** Solution:
****** First fix subselect_rowid_merge_engine::partial_match() to
      properly cleanup the bitmap of matching keys when advancing
      to the next row.
****** Second, change subselect_partial_match_engine::exec() so
      that when the materialized subquery doesn&#39;t contain any
      NULLs, and the left operand of [NOT] IN doesn&#39;t contain
      NULLs either, the method returns without doing any
      unnecessary partial matching. The correct result in this
      case is in Item::in_value.
* maria53rev:3165
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-22 13:38:32 +0200&lt;&lt;/style&gt;&gt;
** lpbug:822760 Wrong result with view + invalid dates
* maria53rev:3164
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-08-19 21:02:05 -0700&lt;&lt;/style&gt;&gt;
** Fixed lpbug#826279.
*** When the WHERE/HAVING condition of a subquery has been transformed
    by the optimizer the pointer stored the &#39;where&#39;/&#39;having&#39; field 
    of the SELECT_LEX structure used for the subquery must be updated
    accordingly. Otherwise the pointer may refer to an invalid item.
    This can lead to the reported assertion failure for some queries
    with correlated subqueries   
* maria53rev:3163
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-08-17 14:10:32 +0300&lt;&lt;/style&gt;&gt;
** Fix lpbug:813473
*** The bug is a duplicate of MySQL&#39;s bug#11764086,
    however MySQL&#39;s fix is incomplete for MariaDB, so
    this fix is slightly different.
*** In addition, this patch renames
    Item_func_not_all::top_level() to is_top_level_item()
    to make it in line with the analogous methods of
    Item_in_optimizer, and Item_subselect.
*** Analysis:
**** It is possible to determine whether a predicate is
     NULL-rejecting only if it is a top-level one. However,
     this was not taken into account for Item_in_optimizer.
     As a result, a NOT IN predicate was erroneously
     considered as NULL-rejecting, and the NULL-complemented
     rows generated by the outer join were rejected before
     being checked by the NOT IN predicate.
*** Solution:
**** Change Item_in_optimizer to be considered as
     NULL-rejecting only if it a top-level predicate.
* maria53rev:3162
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-08-17 12:32:15 +0400&lt;&lt;/style&gt;&gt;
** field_conv.cc: added comments
   opt_range.cc: modified print_key() so that it doesn&#39;t do memory re-allocs when
   printing multipart keys over varchar columns. When it did, key printout in 
   debug trace was interrupted with my_malloc/free printouts.
* maria53rev:3161 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-08-17 12:02:02 +0400&lt;&lt;/style&gt;&gt;
** Merge
*** maria53rev:3155.1.2
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-08-17 11:57:01 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#826935 Assertion `!table || (!table-&gt;read_set || bitmap_is_set(table-&gt;read_set, field_index))&#39; failed
***** add_ref_to_table_cond() should not just overwrite pre_idx_push_select_cond
      with the contents tab-&gt;select_cond.
***** pre_idx_push_select_cond exists precisely for the reason that it may contain
      a condition that is a strict superset of what is in tab-&gt;select_cond. 
***** The fix is to inject generated equality into pre_idx_push_select_cond.
* maria53rev:3160
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 22:48:35 -0700&lt;&lt;/style&gt;&gt;
** Fixed lpbug#825035.
*** The value of maybe_null flag should be saved for the second execution
    of a prepared statement from SELECT that uses an outer join.
* maria53rev:3159 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 23:45:08 +0300&lt;&lt;/style&gt;&gt;
** Merge fix for small_blocksize.test
*** maria53rev:3157.1.1 [merge]
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 19:02:15 +0300&lt;&lt;/style&gt;&gt;
**** Merge with 5.2
* maria53rev:3158 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 21:54:48 +0400&lt;&lt;/style&gt;&gt;
** Merge
*** maria53rev:3155.1.1
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 21:42:25 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#818280: crash in do_copy_not_null() in maria-5.3 with semijoin
***** Make simplify_joins() set maybe_null=FALSE for tables that were on the 
      inner sides of inner joins and then were moved to the inner sides of semi-joins.
* maria53rev:3157 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 15:51:40 +0300&lt;&lt;/style&gt;&gt;
** Automatic merge with 5.2
*** maria53rev:2732.44.20
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 13:28:20 +0300&lt;&lt;/style&gt;&gt;
**** Fixed build failure in embedded library regarding that decrease_user_connections() was not declared
*** maria53rev:2732.44.19
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 13:06:07 +0300&lt;&lt;/style&gt;&gt;
**** If mysqld &lt;&lt;code&gt;&gt;--log-warnings=3&lt;&lt;/code&gt;&gt; or higher, then print all check and repair warnings for MyISAM tables to the log.
      This is useful when trying to find out why an automatic myisam repair failes.
*** maria53rev:2732.44.18
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-16 12:32:06 +0300&lt;&lt;/style&gt;&gt;
**** Fixed bug that MAX_USER_CONNECTIONS was not working properly in all situations (which could cause aborted connects)
      thd-&gt;user_connect is now handled in thd-&gt;clenup() which will ensure that it works in all context (including slaves).
      I added also some DBUG_ASSERT() to ensure that things are working correctly.
*** maria53rev:2732.44.17
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-15 23:53:55 +0300&lt;&lt;/style&gt;&gt;
**** Fixed recovery crash lpbug:814806 &#34;Unclean shutdown corrupted Aria table blocking startup&#34;
* maria53rev:3156 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-15 22:14:08 +0300&lt;&lt;/style&gt;&gt;
** Automatic merge with 5.2
*** maria53rev:2732.44.16 [merge]
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-15 20:42:29 +0300&lt;&lt;/style&gt;&gt;
**** Merge in bug fix from 5.1
*** maria53rev:2732.44.15
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-15 20:40:13 +0300&lt;&lt;/style&gt;&gt;
**** Increase server version
*** maria53rev:2732.44.14
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-15 16:39:53 +0300&lt;&lt;/style&gt;&gt;
**** Fixes bugs found by testcase for lpbug:815022 and lpbug:726374 &#34;ma_blockrec.c:3000: write_block_record: Assertion `cur_block[1].page_count == 0&#39; failed with a multi-index Aria workload&#34;
***** The issues were:
****** For some tables with a lot of not packed fields, we didn&#39;t allocate enough memory in head page which caused DBUG_ASSERT&#39;s
****** Removed wrong DBUG_ASSERT()
****** Fixed a problem with underflow() where it generates a key page where all keys didn&#39;t fit.
****** Max key length is now limited by block_size/3  (was block_size /2).  This is required for underflow() to work with packed keys.
*** maria53rev:2732.44.13 [merge]
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-08-12 15:51:05 +0300&lt;&lt;/style&gt;&gt;
**** Autmatic merge with 5.1
*** maria53rev:2732.44.12
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-08-10 22:44:39 +0300&lt;&lt;/style&gt;&gt;
**** Fixed lpbug:814054 &#39;Assertion `block-&gt;hash_link == hash_link &amp;&amp; hash_link-&gt;block == block&#39; in ma_pagecache.c:2275 with Aria&#39;
***** Replaced old DBUG_ASSERT with a new correct one + a comment.
*** maria53rev:2732.44.11
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-08-10 13:08:19 +0300&lt;&lt;/style&gt;&gt;
**** Fixes mybug#48972: mysqldump &lt;&lt;code&gt;&gt;--insert-ignore&lt;&lt;/code&gt;&gt; leaves set unique_checks=0.
      This fixes a bug that when you use mysqldump &lt;&lt;code&gt;&gt;--no-create-info&lt;&lt;/code&gt;&gt; to generate a dump that you want to merge with an existing table,
      you can get an innodb table with duplicated unique keys.
      Patch originally by Eric Bergen.
*** maria53rev:2732.44.10
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-08 14:53:52 +0300&lt;&lt;/style&gt;&gt;
**** Optimize mutex usage.
* maria53rev:3155
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-08-12 14:31:40 +0300&lt;&lt;/style&gt;&gt;
** Fixed test results after the tests adding.
* maria53rev:3154
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-08-12 13:54:41 +0300&lt;&lt;/style&gt;&gt;
** Early check of subquery cache hit rate added to limit its performance impact in the worst case.
* maria53rev:3153
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-08-12 11:39:29 +0300&lt;&lt;/style&gt;&gt;
** lpbug:781508: Take relevant test cases from MySQL 5.6 feature preview trees
*** Identified all test cases in the MySQL file subquery.inc that are
    not present in MariaDB. This patch adds the test cases that are:
**** not present in MySQL 5.5, and
**** already fixed in MariaDB 5.3
***The patch adds test cases for the following mysql-trunk bugs:
**** bug 12763207 - not a bug, mysql-trunk, added test case
**** mybug#50257    - not a bug, mysql-trunk, added test case
**** bug 11765699 - not a bug, mysql-trunk, added test case
**** bug 12616253 - not a bug, mysql-trunk, added test case
*** The comparison was based on the following version of
    mysql-trunk:&lt;&lt;code lang=text inline=false&gt;&gt;revno: 3350 [merge]
    committer: Marko Mäkelä &lt;marko.makela@oracle.com&gt;
    branch nick: mysql-trunk
    timestamp: Mon 2011-08-08 12:42:09 +0300
    message:
      Merge mysql-5.5 to mysql-trunk.&lt;&lt;/code&gt;&gt;
* maria53rev:3152
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-08-12 11:23:50 +0300&lt;&lt;/style&gt;&gt;
** Protect statistic variables of subquery cache.
* maria53rev:3151
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-08-11 22:34:41 -0700&lt;&lt;/style&gt;&gt;
** Added a test case for lpbug#823835 - a duplicate of lpbug:823189.
* maria53rev:3150
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-08-11 20:24:32 -0700&lt;&lt;/style&gt;&gt;
** Fixed lpbug#823189.
*** The method Item_ref::not_null_tables() returned incorrect bitmap
    for outer references to view columns. This could cause an invalid
    conversion of an outer join into an inner join that could lead
    to a wrong result set for a query with a correlated subquery over
    an outer join whose where condition had an outer reference to a view.
* maria53rev:3149
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-08-11 12:11:04 -0700&lt;&lt;/style&gt;&gt;
** Fixed lpbug#823826.
*** The method Item_func_isnull::update_used_tables() erroneously did not
    update cached values stored in the fields used_tables_cache and
    const_item_cache of the Item_func_isnull objects. As a result the
    Item_func_isnull::used_tables() returned wrong bitmaps and, as a
    consequence, push-down predicates could be attached to wrong tables.
* maria53rev:3148
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-09 18:34:26 +0300&lt;&lt;/style&gt;&gt;
** lpbug:781508: Take relevant test cases from MySQL 5.6 feature preview trees
*** Identified all test cases in the MySQL file subquery_mat.inc that are
    not present in MariaDB. In total found 8 test cases for the following
    MySQL bugs:
**** mybug#49630 - not a bug in MariaDB, added test case
**** mybug#52538 - not a bug in MariaDB, added test case (checked with VG)
**** mybug#53103 - not a bug in MariaDB, added test case
**** mybug#54511 - not a bug in MariaDB, added test case
**** mybug#56367 - not a bug in MariaDB, added test case
**** mybug#59833 - not a bug in MariaDB, added test case
**** bug 11852644 - not a bug in MariaDB, added test case
**** bug 12668294 - not a bug in MariaDB, added test case
*** All of these MySQL bugs are not present in MariaDB 5.3.
*** The comparison was based on the following version of
    mysql-trunk:&lt;&lt;code lang=text inline=false&gt;&gt;revno: 3350 [merge]
  committer: Marko Mäkelä &lt;marko.makela@oracle.com&gt;
  branch nick: mysql-trunk
  timestamp: Mon 2011-08-08 12:42:09 +0300
  message:
    Merge mysql-5.5 to mysql-trunk.&lt;&lt;/code&gt;&gt;
* maria53rev:3147
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-09 10:28:57 +0300&lt;&lt;/style&gt;&gt;
** Fix lpbug:817384
*** This bug is a special case of lpbug:813447.
*** Analysis:
**** Constant optimization finds that the condition t2.a = 1
     can be used to access the primary key of table &#39;t2&#39;. As
     a result both outer table t1,t2 are considered as constant
     when we reach the execution phase. At the same time, during
     constant optimization, the IN predicate is not evaluated
     because it is expensive.
**** When execution of the outer query reaches do_select(),
     control flow enter the branch:&lt;&lt;code lang=text inline=false&gt;&gt;if (join-&gt;table_count == join-&gt;const_tables)
     { ... }&lt;&lt;/code&gt;&gt;
**** This branch checks only the WHERE and HAVING clauses,
     but doesn&#39;t check the ON clauses of the query. Since the
     IN predicate was not evaluated during optimization, it is
     not evaluated at all, thus execution doesn&#39;t detect that
     the ON clause is FALSE.
*** Solution:
**** Similar to the patch for lpbug:813447, exclude system
     tables from constant substitution based on unique key
     lookups if there is an expensive ON condition on the
     inner table.
* maria53rev:3146
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-08 22:02:10 -0700&lt;&lt;/style&gt;&gt;
** Fixed lpbug#819716.
   Do not optimize derived table for the second time ever.
* maria53rev:3145 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-09 01:57:08 +0400&lt;&lt;/style&gt;&gt;
** Merge fix for lpbug#822134
*** maria53rev:3138.1.3
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Tue 2011-08-09 01:37:06 +0400&lt;&lt;/style&gt;&gt;
**** lpbug#822134: Invalid plan and wrong result set for Q20 from DBT3 benchmark set
***** create_ref_for_key() has the code that walks KEYUSE array and tries to use
      maximum number of keyparts for ref (and eq_ref and ref_or_null) access.
      When one constructs ref access for table that is inside a SJ-Materialization
      nest, it is not possible to use tables that are ouside the nest (because 
      materialization is performed before they have any &#34;current value&#34;).
      The bug was caused by this function not taking this into account.
* maria53rev:3144 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-08 23:12:34 +0400&lt;&lt;/style&gt;&gt;
** Merge
*** maria53rev:3141.1.1
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-08 22:37:53 +0400&lt;&lt;/style&gt;&gt;
**** Update test results for previous cset
* maria53rev:3143
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-08 18:40:41 +0200&lt;&lt;/style&gt;&gt;
** Fix long xtradb shutdown on Windows XP
*** The reason for the long shutdown is hanging in io threads. It appears
    that just closing completion port on XP does not necessarily signal 
    thread waiting in GetIOCompletionStatus() (even if this works fine
    on later Windows versions)
*** The fix is to wakeup background threads using PostQueuedCompletionStatus()
    with a special &#39;key&#39; parameter indicating shutdown.
* maria53rev:3142
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-08 18:01:33 +0200&lt;&lt;/style&gt;&gt;
** LPBUG#882689 - crash during startup on XP.
*** The reason for the crash is Innodb assertion after trying to load condition variables function
    dynamically and not finding them
*** The fix is to skip dynamic loading if srv_use_native_conditions is FALSE. srv_use_native_conditions 
    is derived from Windows version and would be FALSE on XP and TRUE on later Windows.
*** This is the same handling as in MySQL 5.. In Maria 5.3 srv_use_native_conditions check was 
    presumably  lost in the downporting.
* maria53rev:3141 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-08-05 22:07:06 +0400&lt;&lt;/style&gt;&gt;
** Merge
*** maria53rev:3138.1.2
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-08-05 22:01:49 +0400&lt;&lt;/style&gt;&gt;
**** Backport of:&lt;&lt;code lang=text inline=false&gt;&gt;revno: 2876.47.174
revision-id: jorgen.loland@oracle.com-20110519120355-qn7eprkad9jqwu5j
parent: mayank.prasad@oracle.com-20110518143645-bdxv4udzrmqsjmhq
committer: Jorgen Loland &lt;jorgen.loland@oracle.com&gt;
branch nick: mysql-trunk-11765831
timestamp: Thu 2011-05-19 14:03:55 +0200
message:
  BUG#11765831: &#39;RANGE ACCESS&#39; MAY INCORRECTLY FILTER 
                        AWAY QUALIFYING ROWS
.
  The problem was that the ranges created when OR&#39;ing two 
  conditions could be incorrect. Without the bugfix, 
  &#34;I &lt;&gt; 6 OR (I &lt;&gt; 8 AND J = 5)&#34; would create these ranges:
.
  &#34;NULL &lt; I &lt; 6&#34;,
  &#34;6 &lt;= I &lt;= 6 AND 5 &lt;= J &lt;= 5&#34;,
  &#34;6 &lt; I &lt; 8&#34;,
  &#34;8 &lt;= I &lt;= 8 AND 5 &lt;= J &lt;= 5&#34;,
  &#34;8 &lt; I&#34;
.
  While the correct ranges is
  &#34;NULL &lt; I &lt; 6&#34;,
  &#34;6 &lt;= I &lt;= 6 AND 5 &lt;= J &lt;= 5&#34;,
  &#34;6 &lt; I&#34;
.
  The problem occurs when key_or() ORs
  (1) &#34;NULL &lt; I &lt; 6, 6 &lt;= I &lt;= 6 AND 5 &lt;= J &lt;= 5, 6 &lt; I&#34; with 
  (2) &#34;8 &lt; I AND 5 &lt;= J &lt;= 5&#34;
.
  The reason for the bug is that in key_or(), SEL_ARG *tmp is 
  used to point to the range in (1) above that is merged with 
  (2) while key1 points to the root of the red-black tree of 
  (1). When merging (1) and (2), tmp refers to the &#34;6 &lt; I&#34; 
  part whereas the root is the &#34;6 &lt;= ... AND 5 &lt;= J &lt;= 5&#34; part. 
.
  key_or() decides that the tmp range needs to be split into
  &#34;6 &lt; I &lt; 8, 8 &lt;= I &lt;= 8, 8 &lt; I&#34;, in which next_key_part of the 
  second range should be that of tmp. However, next_key_part is
  set to key1-&gt;next_key_part (&#34;5 &lt;= J &lt;= 5&#34;) instead of 
  tmp-&gt;next_key_part (empty). Fixing this gives the correct but
  not optimal ranges:
  &#34;NULL &lt; I &lt; 6&#34;,
  &#34;6 &lt;= I &lt;= 6 AND 5 &lt;= J &lt;= 5&#34;,
  &#34;6 &lt; I &lt; 8&#34;,
  &#34;8 &lt;= I &lt;= 8&#34;,
  &#34;8 &lt; I&#34;
.
  A second problem can be seen above: key_or() may create 
  adjacent ranges that could be replaced with a single range. 
  Fixes for this is also included in the patch so that the range
  above becomes correct AND optimal:
  &#34;NULL &lt; I &lt; 6&#34;,
  &#34;6 &lt;= I &lt;= 6 AND 5 &lt;= J &lt;= 5&#34;,
  &#34;6 &lt; I&#34;
.
  Merging adjacent ranges like this gives a slightly lower cost 
  estimate for the range access.&lt;&lt;/code&gt;&gt;
*** maria53rev:3138.1.1
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-08-04 18:20:02 +0400&lt;&lt;/style&gt;&gt;
**** Backport of:&lt;&lt;code lang=text inline=false&gt;&gt;revno: 3363.3.16
revision-id: jorgen.loland@oracle.com-20110506132631-5wickj6dvrh1dpj6
parent: alexander.nozdrin@oracle.com-20110506132138-46459va9vcbd4nz0
committer: Jorgen Loland &lt;jorgen.loland@oracle.com&gt;
branch nick: mysql-trunk-11765831
timestamp: Fri 2011-05-06 15:26:31 +0200
message:
  BUG#11765831: &#39;RANGE ACCESS&#39; MAY INCORRECTLY FILTER
                AWAY QUALIFYING ROWS
.
  Preparation patch (does not include fix for the bug):
.
    - Extensively document key_or()
    - Remove tab indentations from key_or()
    - Minor code changes like using existing utility functions
      in key_or()&lt;&lt;/code&gt;&gt;
* maria53rev:3140
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-08-03 13:58:46 +0200&lt;&lt;/style&gt;&gt;
** Limit query length in error log to 64K, to avoid output of full blobs
* maria53rev:3139
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Wed 2011-08-03 13:42:53 +0200&lt;&lt;/style&gt;&gt;
** Enhance crash reporting. Fix 
*** lpbug#819711 : optimizer_switch must be reported on segfault
*** lpbug#820169:  Full query text must be reported on crash
* maria53rev:3138 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-01 11:05:30 +0200&lt;&lt;/style&gt;&gt;
** Automerge 5.2-&gt;5.3
*** maria53rev:2732.44.9
    &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Mon 2011-08-01 10:56:24 +0200&lt;&lt;/style&gt;&gt;
**** After-merge fix of result file (MARIA &lt;-&gt; Aria)
* maria53rev:3137 [merge]
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Sun 2011-07-31 22:59:55 +0200&lt;&lt;/style&gt;&gt;
** Automerge 5.2-&gt;5.3
* maria53rev:3136
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Fri 2011-07-29 17:09:16 -0700&lt;&lt;/style&gt;&gt;
** Fixed lpbug#817360.
*** This problem could be observed for queries with nested outer joins
    for which the not_exist optimization were applicable. 
    The problem was caused by the code of the patch for mybug#49322
    that erroneously forced the return to the previous nested loop
    level when the join algorithm successfully builds a partial record
    for an embedded outer to which the not_exist optimization could be
    applied.
*** Actually the immediate return to the previous nested loops level
    is correct only if this partial record is rejected by a predicate
    pushed down to one of the inner tables of this outer join. Otherwise
    attempts to find extensions of this record must be made.
* maria53rev:3135
  &lt;&lt;style style=&#34;color:gray;font-size:0.8em;font-style:italic;&#34;&gt;&gt;Thu 2011-07-28 17:10:29 +0300&lt;&lt;/style&gt;&gt;
** Subquery cache going on disk management fix: Do not go on disk if hit rate is not good.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>