<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>maxscale restart due to memory increase - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="maxscale restart due to memory increase - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/maxscale-restart-due-to-memory-increase/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/maxscale-restart-due-to-memory-increase/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/maxscale-restart-due-to-memory-increase/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/maxscale/">MariaDB MaxScale</a>
    


    » <a class="node_link crumb" href="/kb/en/maxscale-restart-due-to-memory-increase/">maxscale restart due to memory increase</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/maxscale-restart-due-to-memory-increase/">Return to question</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>maxscale restart due to memory increase - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/maxscale-restart-due-to-memory-increase/+r/138807/">138807</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-14463">
<a href="/kb/user/id/14463" title="정원 김">정원 김</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2024-04-17 05:51">2024-04-17 05:51</span></dd>
        </dl>
    </div>
    


    
        <textarea id="question_source" class="creole_source autogrow">Due to an increase in memory, maxscale automatically restarted and the DB connection was lost. This was the first time this had happened in over a year. The version of my maxscale is 2.4.8. I don&#39;t know what the problem is. Can you tell me about a case where this might happen?

DB Log



2023-10-24 11:09:04 5210330 [Warning] Aborted connection 5210330 to db: &#39;unconnected&#39; user: &#39;maxscale&#39; host: &#39;***.***.***.***&#39; (Got an error reading communication packets)

Application Log



2023-10-24 11:09:43,066 WARN  [org.jboss.jca.adapters.jdbc.local.LocalManagedConnectionFactory] (default task-1) IJ030027: Destroying connection that is not valid, due to the following exception: org.mariadb.jdbc.MariaDbConnection@369e5a07: java.sql.SQLNonTransientConnectionException: (conn=421684) unexpected end of stream, read 0 bytes from 4 (socket was closed by server)

Maxscale Log



2023-10-24 11:09:07   alert  : (421546) Fatal: MaxScale 2.4.8 received fatal signal 6. Commit ID: 5984af468c7c9aa01830bd82527cbbde28c90a44 System name: Linux Release string: NAME=&#34;CentOS Linux&#34;
2023-10-24 11:09:08   alert  : (421546) 
MariaDB MaxScale  /app/maxscale/logs/maxscale.log  Tue Oct 24 11:09:09 2023
2023-10-24 11:09:09   notice : syslog logging is enabled.
2023-10-24 11:09:09   notice : maxlog logging is enabled.
2023-10-24 11:09:09   notice : Using up to 37.73GiB of memory for query classifier cache
2023-10-24 11:09:09   notice : Working directory: /app/maxscale/logs
2023-10-24 11:09:09   notice : The collection of SQLite memory allocation statistics turned off.
2023-10-24 11:09:09   notice : Threading mode of SQLite set to Multi-thread.
2023-10-24 11:09:09   notice : MariaDB MaxScale 2.4.8 started (Commit: 5984af468c7c9aa01830bd82527cbbde28c90a44)
2023-10-24 11:09:09   notice : MaxScale is running in process 11444
2023-10-24 11:09:09   notice : Configuration file: /etc/maxscale.cnf
2023-10-24 11:09:09   notice : Log directory: /app/maxscale/logs
2023-10-24 11:09:09   notice : Data directory: /var/lib/maxscale
2023-10-24 11:09:09   notice : Module directory: /usr/lib64/maxscale
2023-10-24 11:09:09   notice : Service cache: /var/cache/maxscale
2023-10-24 11:09:09   notice : Worker message queue size: 1.00MiB
2023-10-24 11:09:09   notice : No query classifier specified, using default &#39;qc_sqlite&#39;.
2023-10-24 11:09:09   notice : Loaded module qc_sqlite: V1.0.0 from /usr/lib64/maxscale/libqc_sqlite.so
2023-10-24 11:09:09   notice : Query classification results are cached and reused. Memory used per thread: 965.81MiB
2023-10-24 11:09:09   notice : The systemd watchdog is Enabled. Internal timeout = 30s
2023-10-24 11:09:09   notice : Loading /etc/maxscale.cnf.
2023-10-24 11:09:09   notice : /etc/maxscale.cnf.d does not exist, not reading.
2023-10-24 11:09:09   notice : Loaded module maxscaled: V2.0.0 from /usr/lib64/maxscale/libmaxscaled.so
2023-10-24 11:09:09   warning: [cli] THE &#39;cli&#39; MODULE AND &#39;maxadmin&#39; ARE DEPRECATED: Use &#39;maxctrl&#39; instead
2023-10-24 11:09:09   notice : Loaded module cli: V1.0.0 from /usr/lib64/maxscale/libcli.so
2023-10-24 11:09:09   notice : Loaded module MariaDBClient: V1.1.0 from /usr/lib64/maxscale/libmariadbclient.so
2023-10-24 11:09:09   notice : [galeramon] Initialise the MySQL Galera Monitor module.
2023-10-24 11:09:09   notice : Loaded module galeramon: V2.0.0 from /usr/lib64/maxscale/libgaleramon.so
2023-10-24 11:09:09   notice : [readwritesplit] Initializing statement-based read/write split router module.
2023-10-24 11:09:09   notice : Loaded module readwritesplit: V1.1.0 from /usr/lib64/maxscale/libreadwritesplit.so
2023-10-24 11:09:09   notice : Loaded module MariaDBBackend: V2.0.0 from /usr/lib64/maxscale/libmariadbbackend.so
2023-10-24 11:09:09   notice : Loaded module mariadbbackendauth: V1.0.0 from /usr/lib64/maxscale/libmariadbbackendauth.so
2023-10-24 11:09:09   notice : Loaded module MaxAdminAuth: V2.1.0 from /usr/lib64/maxscale/libmaxadminauth.so
2023-10-24 11:09:09   notice : Loaded module mariadbauth: V1.1.0 from /usr/lib64/maxscale/libmariadbauth.so
2023-10-24 11:09:09   notice : Started REST API on [127.0.0.1]:8989
2023-10-24 11:09:09   notice : MaxScale started with 40 worker threads, each with a stack size of 8388608 bytes.
2023-10-24 11:09:09   notice : Starting a total of 2 services...
2023-10-24 11:09:09   notice : Server &#39;db01&#39; charset: utf8
2023-10-24 11:09:09   notice : Server &#39;db01&#39; version: 10.4.16-MariaDB-log
2023-10-24 11:09:09   warning: [MariaDBAuth] [Splitter-Service] User &#39;maxscale&#39; is missing the SHOW DATABASES privilege. This means that MaxScale cannot see all databases and authentication can fail.
2023-10-24 11:09:09   notice : Server &#39;db02&#39; charset: utf8
2023-10-24 11:09:09   notice : Server &#39;db02&#39; version: 10.4.16-MariaDB-log
2023-10-24 11:09:09   warning: [MariaDBAuth] [Splitter-Service] User &#39;maxscale&#39; is missing the SHOW DATABASES privilege. This means that MaxScale cannot see all databases and authentication can fail.
2023-10-24 11:09:09   notice : [MariaDBAuth] [Splitter-Service] Loaded 267 MySQL users for listener &#39;Splitter-Listener&#39; from server &#39;db01&#39; with checksum 0x3835117b.
2023-10-24 11:09:09   notice : Listening for connections at [0.0.0.0]:3306
2023-10-24 11:09:09   notice : Service &#39;Splitter-Service&#39; started (1/2)
2023-10-24 11:09:09   notice : Listening for connections at [/var/run/maxscale/maxadmin.sock]:0
2023-10-24 11:09:09   notice : Service &#39;MaxAdmin-Service&#39; started (2/2)
2023-10-24 11:09:09   notice : Journal file was created 690849 seconds ago. Maximum journal age is 28800 seconds.
2023-10-24 11:09:09   notice : Removing stale journal file for monitor &#39;Galera-Monitor&#39;.
2023-10-24 11:09:09   notice : Server changed state: db01[******.db01:4306]: new_master. [Running] -&gt; [Master, Synced, Running]
2023-10-24 11:09:09   notice : Server changed state: db02[******.db02:4306]: new_slave. [Running] -&gt; [Slave, Synced, Running]
2023-10-24 11:09:43   alert  : (49) Fatal: MaxScale 2.4.8 received fatal signal 6. Commit ID: 5984af468c7c9aa01830bd82527cbbde28c90a44 System name: Linux Release string: NAME=&#34;CentOS Linux&#34;</textarea>
    

    
        
            <h2>Answer</h2>
        
        <textarea id="answer_source" class="creole_source autogrow">MaxScale 2.4.8 is a relatively old release and the 2.4 series of MaxScale releases has reached EOL. I&#39;d recommend upgrading to a version of MaxScale that is still maintained.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>