<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Google Summer of Code 2021 - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Google Summer of Code 2021 - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/google-summer-of-code-2021/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/google-summer-of-code-2021/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/google-summer-of-code-2021/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/community/">The Community</a>
    

    
    » <a class="crumb" href="/kb/en/contributing-participating/">Contributing &amp; Participating</a>
    

    
    » <a class="crumb" href="/kb/en/google-summers-of-code/">Google Summers of Code</a>
    


    » <a class="node_link crumb" href="/kb/en/google-summer-of-code-2021/">Google Summer of Code 2021</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/google-summer-of-code-2021/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Google Summer of Code 2021 - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/google-summer-of-code-2021/+r/114271/">114271</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-1368">
<a href="/kb/user/id/1368" title="Ian Gilfillan">Ian Gilfillan</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2022-02-25 14:14">2022-02-25 14:14</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">This year we are again participating in the [[https://summerofcode.withgoogle.com/|Google Summer of Code]]. The [[https://www.mariadb.org|MariaDB Foundation]] believes we are making a better database that remains application compatible with MySQL. We also work on making LGPL connectors (currently [[mariadb-connector-c|C]], [[mariadb-connector-odbc|ODBC]], [[mariadb-connector-j|Java]], [[nodejs-connector|Node.js]]) and on [[galera|MariaDB Galera Cluster]], which allows you to scale your reads &amp; writes. And we have [[mariadb-columnstore|MariaDB ColumnStore]], which is a columnar storage engine, designed to process petabytes of data with real-time response to analytical queries.

&lt;&lt;toc&gt;&gt;

= Where to Start 
Please join us on [[irc-chat-servers-and-zulip-instance|Zulip]] to mingle with the community. You should also subscribe to [[https://launchpad.net/~maria-developers|maria-developers@lists.launchpad.net]] (this is the main list where we discuss development).

To improve your chances of being accepted, it is a good idea to submit a pull request with a bug fix to the server.

Also see the [[https://jira.mariadb.org/issues/?jql=status%20%3D%20Open%20AND%20resolution%20%3D%20Unresolved%20AND%20labels%20%3D%20beginner-friendly%20ORDER%20BY%20updated%20DESC|List of beginner friendly issues]] and [[https://jira.mariadb.org/issues/?jql=labels=gsoc21|issues labelled gsoc21]] from the MariaDB Issue Tracker.

= List of Tasks
&lt;&lt;style style=&#34;border-left: 1px solid grey; padding-left: 10px;&#34;&gt;&gt;
=== Support for GTID in mysqlbinlog

The mysqlbinlog client program needs to be updated to support GTID.

Here is a suggested list of things to be done:

 - The ##--start-position## and ##--stop-position## options should be able to take
   GTID positions; or maybe there should be new ##--start-gtid## and ##--stop-gtid##
   options. Like ##--start-gtid=0-1-100,1-2-200,2-1-1000##.

 - A GTID position means the point just _after_ that GTID. So starting from
   GTID 0-1-100 and stopping at GTID 0-1-200, the first GTID output will
   probably be 0-1-101 and the last one 0-1-200. Note that if some domain is
   not specified in the position, it means to start from the begining,
   respectively stop immediately in that domain.

 - Starting and stopping GTID should work both with local files, and with
   ##--read-from-remote-server##. For the latter, there are a couple of extra
   things that need doing in the master-slave protocol, see
   ##get_master_version_and_clock()## in ##sql/slave.cc##.

 - At the end of the dump, put these statements, to reduce the risk of those session variables incorrectly spilling into subsequent statements run in the same session:
&lt;&lt;sql&gt;&gt;
   SET session.server_id = @@global.server_id,
       session.gtid_domain_id=@@global.gtid_domain_id;
&lt;&lt;/sql&gt;&gt;
Probably some more things will come up during the work, but this looks like a
reasonable start.

|=Details:|MDEV-4989
|=Mentor:|Brandon Nesterenko 
----
=== Granted to PUBLIC

Implement the standard behavior for
&lt;&lt;sql&gt;&gt;
GRANT xxx TO PUBLIC;
REVOKE xxx FROM PUBLIC;
&lt;&lt;/sql&gt;&gt;
Also, this statement is supposed to work:
&lt;&lt;sql&gt;&gt;
SHOW GRANTS FOR PUBLIC;
&lt;&lt;/sql&gt;&gt;
And these should not
&lt;&lt;sql&gt;&gt;
CREATE ROLE PUBLIC;
DROP ROLE PUBLIC;
SET ROLE PUBLIC;
GRANT PUBLIC TO xxx;
REVOKE PUBLIC FROM xxx;
&lt;&lt;/sql&gt;&gt;
Note that
&lt;&lt;sql&gt;&gt;
SHOW GRANTS FOR xxx;
&lt;&lt;/sql&gt;&gt;
should not list roles and privileges granted to PUBLIC (unless granted to xxx too), but
&lt;&lt;sql&gt;&gt;
SHOW GRANTS;
&lt;&lt;/sql&gt;&gt;
should, arguably, list them.

|=Details:|MDEV-5215
|=Mentor:|Oleksandr Byelkin 
----
=== Control over memory allocated for SP/PS

SP/PS (Stored Procedures / Prepared Statements) allocates memory till the PS cache of SP will be destroyed. There is no way to see how many memory allocated and if it grows with each execution (first 2 execution can lead to new memory allocation but not more)

**Task minimum:**
Status variables which count the memory used/allocated for SP/PS by thread and/or for the server.

**Other ideas:**
* Automatic stop allocation in debugging version after second execution and call exception on attempt.
* Information schema by threads and SP/PS with information about allocated and used memory

Information can be collected in MEM_ROOTs of SP/PS. Storing info about status of mem_root before execution then checking after new allocated memory can be found.

MEM_ROOT can be changed to have debug mode which make it read only which can be switched on after second execution.

|=Details:|MDEV-14959
|=Mentor:|Oleksandr Byelkin 

----
===Add JSON_NORMALIZE function to normalize JSON values

Background is this question on stackexchange:

https://dba.stackexchange.com/questions/208481/mariadb-compare-json

The task is to provide a function that can be used to compare 2 json documents for equality, then name can be e.g JSON_NORMALIZE

JSON_COMPACT already takes care of removing spaces, but this is not sufficient.
Keys need to be (recursively) sorted , and if spaces are removed, then documents can be compared as binary strings.

|=Details:|MDEV-16375
|=Mentor:|Vicențiu Ciorbaru
----
===Add linear regression functions 

The following linear regression functions exist in a number of other DBMSs, such as Oracle, PostgreSQL:

&lt;&lt;code&gt;&gt;
    REGR_SLOPE
    REGR_INTERCEPT
    REGR_COUNT
    REGR_R2
    REGR_AVGX
    REGR_AVGY
    REGR_SXX
    REGR_SYY
    REGR_SXY
&lt;&lt;/code&gt;&gt;

Some have also been added to Columnstore.

|=Details:|MDEV-17467
|=Mentor:|Nikita Malyavin 
----
===Create utility to parse frm files and print their DDL

It would be useful if MariaDB had a utility that was able to parse frm files and print the DDL associated with the table.

For example, it would be useful for users who performed a partial backup with Mariabackup:

https://mariadb.com/kb/en/library/partial-backup-and-restore-with-mariabackup/

But they forgot to also backup the table DDL, so they can&#39;t restore the tables using the following process:

https://mariadb.com/kb/en/library/innodb-file-per-table-tablespaces/#importing-transportable-tablespaces-for-non-partitioned-tables

mysqlfrm is a tool that already exists that does similar things:

https://github.com/mysql/mysql-utilities/blob/master/scripts/mysqlfrm.py

But it doesn&#39;t seem very user-friendly. It needs to be able to contact the local MariaDB server, and it also needs to be able to spawn a server instance, and it seems to need to be able to create a bunch of files during this process. e.g.:

&lt;&lt;code&gt;&gt;
[ec2-user@ip-172-30-0-249 ~]$ cd /tmp
[ec2-user@ip-172-30-0-249 tmp]$ sudo mysqlfrm --server=root:@localhost:3306 /var/lib/mysql/db1/tab.frm --port=12345 --user=mysql
# Source on localhost: ... connected.
# Spawning server with --user=mysql.
# Starting the spawned server on port 12345 ... done.
# Reading .frm files
#
# Reading the tab.frm file.
#
# CREATE statement for /var/lib/mysql/db1/tab.frm:
#

CREATE TABLE `db1`.`tab` (
  `id` int(11) NOT NULL,
  `str` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1

#...done.
&lt;&lt;/code&gt;&gt;

|=Details:|MDEV-18827
|=Mentor:|Vicențiu Ciorbaru
----
===JSON_DETAILED output unnecessarily verbose 

JSON_DETAILED function (https://mariadb.com/kb/en/library/json_detailed/ ) is described as 

&lt;&lt;code&gt;&gt;
Represents JSON in the most understandable way emphasizing nested structures.
&lt;&lt;/code&gt;&gt;

We now got a use case for it: Optimizer Trace output.  Optimizer trace is too large to be copied in full, instead we use expressions like
&lt;&lt;code&gt;&gt;
select 
JSON_DETAILED(JSON_EXTRACT(trace, &#39;$**.analyzing_range_alternatives&#39;)) 
from INFORMATION_SCHEMA.OPTIMIZER_TRACE;
&lt;&lt;/code&gt;&gt;

Our experience is that ##JSON_DETAILED## has some room for improvement when it comes to the quality of automatic JSON formatting.

Example:
&lt;&lt;sql&gt;&gt;
source mdev19160-data.sql
mysql&gt; select JSON_DETAILED(JSON_EXTRACT(a, &#39;$**.analyzing_range_alternatives&#39;)) from t200\G
*************************** 1. row ***************************
JSON_DETAILED(JSON_EXTRACT(a, &#39;$**.analyzing_range_alternatives&#39;)): [

    {
        &#34;range_scan_alternatives&#34;: 
        [

            {
                &#34;index&#34;: &#34;a_b&#34;,
                &#34;ranges&#34;: 
                [
                    &#34;2 &lt;= a &lt;= 2 AND 4 &lt;= b &lt;= 4&#34;
                ],
                &#34;rowid_ordered&#34;: true,
                &#34;using_mrr&#34;: false,
                &#34;index_only&#34;: true,
                &#34;rows&#34;: 1,
                &#34;cost&#34;: 1.1752,
                &#34;chosen&#34;: true
            }
        ],
        &#34;analyzing_roworder_intersect&#34;: 
        {
            &#34;cause&#34;: &#34;too few roworder scans&#34;
        },
        &#34;analyzing_index_merge_union&#34;: 
        [
        ]
    }
]
&lt;&lt;/sql&gt;&gt;

Things to note:
* empty lines at the start (right before/after the &#34;range_scan_alternatives&#34;)
* ##&#34;analyzing_index_merge_union&#34;:[]## occupies 3 lines where one would be sufficient.
* the same goes for &#34;ranges&#34;

One can look at the JSON pretty-printer that is used by EXPLAIN FORMAT=JSON and optimizer trace.  It produces a better result (but it has room for improvement, too.)

Extra: in MySQL, the function is called JSON_PRETTY. We should add ability to use this name as an alias.

|=Details:|MDEV-19160
|=Mentor:|Vicențiu Ciorbaru
----
===Histograms: use JSON as on-disk format

Currently, histograms are stored as array of 1-byte bucket bounds (SINGLE_PREC_HB) or or 2-byte bucket bounds (DOUBLE_PREC_HB).

The table storing the histograms supports different histogram formats but limits them to 256 bytes (hist_size is tinyint).

&lt;&lt;sql&gt;&gt;
CREATE TABLE mysql.column_stats (
  min_value varbinary(255) DEFAULT NULL, 
  max_value varbinary(255) DEFAULT NULL, 
  ...
  hist_size tinyint unsigned, 
  hist_type enum(&#39;SINGLE_PREC_HB&#39;,&#39;DOUBLE_PREC_HB&#39;), 
  histogram varbinary(255), 
  ...
&lt;&lt;/sql&gt;&gt;

This prevents us from supporting other kinds of histograms.

The first low-hanging fruit would be to store the histogram bucket bounds precisely (like MySQL and PostgreSQL do, for example).

The idea of this MDEV is to switch to JSON as storage format for histograms.

If we do that, it will:
- Improve the histogram precision
- Allow the DBAs to examine the histograms
- Enable other histogram types to be collected/used.

h2. Milestone-1:

Let histogram_type have another possible value, tentative name &#34;JSON&#34;
when that is set, let ANALYZE TABLE syntax collect a JSON &#34;histogram&#34;
&lt;&lt;sql&gt;&gt;
  { &#34;hello&#34;:&#34;world&#34;}
&lt;&lt;/sql&gt;&gt;
that is, the following should work:

&lt;&lt;sql&gt;&gt;
set histogram_type=&#39;json&#39;;
analyze table t1 persisent for all;
select histogram from mysql.column_stats where table_name=&#39;t1&#39; ;
&lt;&lt;/sql&gt;&gt;
this should produce \{&#34;hello&#34;:&#34;world&#34;\}.

h2. Milestone-2: produce JSON with histogram(*).

(*)- the exact format is not specified, for now, print the bucket endpoints and produce output like this:

&lt;&lt;sql&gt;&gt;
[
  &#34;value1&#34;,
  &#34;value2&#34;,
  ...
]
&lt;&lt;/sql&gt;&gt;

Milestone-2, part#2: make mysql.column_stats.histogram a blob.

h2. Milestone-3: Parse the JSON back into an array
Figure out how to use the JSON parser. 
Parse the JSON data produced in Milestone-2 back.  For now, just print the parsed values to stderr.
(Additional input provided on Zulip re parsing valid/invalid JSON histograms)

h2. Milestone-4: Make the code support different kinds of Histograms
Currently, there&#39;s only one type of histogram.

smaller issue: histogram lookup functions assume the histogram stores fractions, not values.
bigger issue: memory allocation for histograms is de-coupled from reading the histograms. See alloc_statistics_for_table, read_histograms_for_table.

The histogram object lives in a data structure that is bzero&#39;ed first and then filled later (IIRC there was a bug (fixed) where the optimizer attempted to use bzero&#39;ed histogram)

Can histograms be collected or loaded in parallel by several threads? This was an (unintentional?) possibility but then it was disabled (see TABLE_STATISTICS_CB object and its use)

h3. Step #0: Make Histogram a real class
Here&#39;s the commit:
https://github.com/MariaDB/server/commit/3ac32917ab6c42a5a0f9ed817dd8d3c7e20ce34d

h3. Step 1:  Separate classes for binary and JSON histograms

Need to introduce
&lt;&lt;sql&gt;&gt;
class Histogram -- interface, no data members.
class Histogram_binary : public Histogram
class Histogram_json : public Histogram
&lt;&lt;/sql&gt;&gt;
and a factory function
&lt;&lt;sql&gt;&gt;
Histogram *create_histogram(Histogram_type)
&lt;&lt;/sql&gt;&gt;

for now, let Histogram_json::point_selectivity() and Histogram_json::range_selectivity() return 0.1 and 0.5, respectively.

h3. Step 2:  Demonstrate saving/loading of histograms
Now, the code already can: 
- collect a JSON histogram and save it.
- when loading a histogram, figure from ##histogram_type## column that this is JSON histogram being loaded, create Histogram_json and invoke the parse function.

Parse function at the moment only prints to stderr. 
However, we should catch parse errors and make sure they are reported to the client. 
The test may look like this:
&lt;&lt;sql&gt;&gt;
INSERT INTO mysql.column_stats VALUES(&#39;test&#39;,&#39;t1&#39;,&#39;column1&#39;, .... &#39;[invalid, json, data&#39;]);
FLUSH TABLES;
# this should print some descriptive test
--error NNNN
select * from test.t1;
&lt;&lt;/sql&gt;&gt;

h2. Milestone-5: Parse the JSON data into a structure that allows lookups.
The structure is 
&lt;&lt;sql&gt;&gt;
std::vector&lt;std::string&gt;
&lt;&lt;/sql&gt;&gt;
and it holds the data in KeyTupleFormat (See the comments for reasoning.  There was a suggestion to use ##in_vector## (This is what IN subqueries use) but it didn&#39;t work out)

h2. Milestone 5.1 (aka Milestone 44)
Make a function to estimate selectivity using the data structure specified in previous milestone.

h2. Make range_selectivity() accept key_range parameters.

(currently, they accept fractions, which is only suitable for binary histograms)
This means Histogram_binary will need to have access to min_value and max_value to compute the fractions.

|=Details:|MDEV-21130
|=Mentor:|Sergei Petrunia
----
===make my_vsnprintf to use gcc-compatible format extensions 

##my_vsnprintf()## is used internally in the server as a portable ##printf## replacement. And it&#39;s also exported to plugins as a service.

It supports a subset of ##printf## formats and three extensions:
* ##%`s## means that a string should be quoted like an ##`identifier`##
* ##%b## means that it&#39;s a binary string, not zero-terminated; printing won&#39;t stop at ##\0##, so one should always specify the field width (like ##%.100b##)
* ##%M## is used in error messages and prints the integer (errno) and the corresponding ##strerror()##  for it

gcc knows ##printf## formats and check whether actual arguments match the format string and issue a warning if they don&#39;t. Unfortunately there seems to be no easy way to teach gcc our extensions, so for now we have to disable ##printf## format checks.

An better approach would be to use gcc compatible format extensions, like Linux kernel does. We should migrate to a different syntax for our extensions
* ##%sI## to mean &#34;print as an identifier&#34;
* ##%sB## to mean &#34;print a binary string&#34;
* ##%uE## to mean &#34;print an errno&#34;
* ##%sT## to put a &#34;...&#34; as truncation indicator

old formats can still be supported or they can be removed and in the latter case the major version of the service should be increased to signal an incompatible change.

All error messages and all usages of ##my_vsnprintf## should be changed to use the new syntax and gcc ##printf## format checks should be enabled.

|=Details:|MDEV-21978
|=Mentor:|Sergei Golubchik
----
===Add JSON_EQUALS function to check JSON equality

JSON_CONTAINS can be used to test for JSON object equality in some cases, but we seem to lack a clear JSON_EQUALS function.

|=Details:|MDEV-23143
|=Mentor:|Vicențiu Ciorbaru
----
===Concurrent multi-reader, multi-writer buffer for IO_CACHE

IO_CACHE has basically three read/write modes: only read, only write, and a sequential read/write FIFO mode ##SEQ_READ_APPEND##.

While some performance-sensitive places, like replication slave thread, use SEQ_READ_APPEND, that may be a bottleneck. since reads and writes are sequential (and co-sequential i.e. reads and writes block each other).

The task is to implement a non-blocking mode  or multi-reader, multi-writer use-case through a concurrent ring buffer implementation.

h2. Possible approaches

h3. Lock-free n-consumer, m-producer ring buffer

This implementation requires limiting a number of simultaneous accessors and reserving slots for them.
Lock-free implementations can contain busy waits, but no locks, except when a number of consumers or producers is exceeded. This can be controlled by a semaphore with a capacity of a number of cores.
This is an ideal way, but can be an overhaul because of complicated busy loops and slot management. 
This is also hard because writes can be bigger than a buffer. See buffer excess.

h3. Simple rwlock-based non-blocking approach
The bottleneck basically occurs because SEQ_READ_APPEND blocks the whole time during buffer copy. 
We can avoid it by moving the pointers first, thus allocating a place for copying, and then make a copy from/to the buffer without a lock.
rwlock will be used to access the pointers, i.e. reads access IO_CACHE::end_of_file with read lock to make ensure the borders, but writers access it with write lock.

h2. Buffer excess
Excesses make things work sequential.
When the buffer is full, a separate write buffer is created. When the write buffer is full, a flush happens.
Flushes wait for all writers to finish first, then lock the write buffer for flushing.
The read buffer can be flushed in a more relaxed way: no need to need to lock for flushing, but we have to lock for buffer allocation and wait for all writers.
Waiting for writers can be done with another rwlock.

h2. Single-readerness
The real-world cases are mostly single-consumer, and it is essential for IO_CACHE: it is variable-lengthed, and has no underlying data format, 
so the reader always has to make at least two sequential reads (one to read size and another to read the body)

Single-readerness considerations can relax some conditions and ease the implementation

h2.  io_cache_reserve api
We can add a function to reserve the space to writing for the case of writing big objects (both bigger then the write cache
and smaller then the latter, but big enough to not fit to the external buffer), for the cases like copying one cache to another.

The function should return future-like object, since we have to notify IO_CACHE back that the writing is finished (to make flush for example)

|=Details:|MDEV-24676
|=Mentor:|Nikita Malyavin 
----
===Custom formatting of strings in MariaDB queries

Formatting more complex strings in a ##SELECT## statement can get awkward when there are many ##concat()##, ##format()##, etc calls involved.
It would be very cool and helpful to have a function that takes an input string and a formatting specification and returns string formatted using the rules the user passed in the specification.

A great example for such a function is the classic ##C printf## function, which, in this context, would look something like:

&lt;&lt;sql&gt;&gt;SELECT printf(&#39;%s %s, %s&#39;, first_name, last_name, job_title) from employees;&lt;&lt;/sql&gt;&gt;

But it doesn&#39;t necessarily need to look this way, an alternative syntax could be Python-ish, which would leverage the fact that the server already knows the datatype of each field used in the formatting scheme:

&lt;&lt;sql&gt;&gt;SELECT sformat(&#39;arg1: {}, arg2: {}&#39;, col1, col2) from table;&lt;&lt;/sql&gt;&gt;
In that syntax one passes formatting options within the curly braces:
&lt;&lt;sql&gt;&gt;
-- Print &#39;arg1: col1, arg2: col2&#39;  where col1 from table is of datetime type and should be printed as: &#39;Sunday November 2021&#39;
SELECT sformat(&#39;arg1: {%W %M %Y}, arg2: {}&#39;, col1, col2) from table;
&lt;&lt;/sql&gt;&gt;

Ideally, this new function should use, behind the scenes, the existing builtin formatting functions in MariaDB (e.g. ##date_format()##, ##format()##) and even future formatting functions (e.g. MySQL&#39;s  ##format_bytes()##, ##format_pico_time()##), so the syntax has to be designed in a smart way to accommodate easily future additions.

|=Details:|MDEV-25015
|=Mentor:|Sergei Golubchik

=== Add autocompletion capabilities to the MariaDB Jupyter kernel

As part of the [[https://jupyter-client.readthedocs.io/en/stable/messaging.html|Jupyter Messaging]] protocol, the Jupyter frontend sends a {{{complete_request}}} message to the MariaDB kernel when the user invokes the code completer in a Jupyter notebook.

This message is handled in the [[https://github.com/MariaDB/mariadb_kernel/blob/eadfbedbba93c0ea1146165580d86b050414e32a/mariadb_kernel/kernel.py#L111|do_complete]] function from the {{{MariaDBKernel}}} class.
In simpler words, whenever the user hits the key shortcut for code autocompletion in a notebook, the MariaDB kernel&#39;s do_complete function is called with a number of arguments that help the kernel understand what the user wants to autocomplete.

So the autocompletion infrastructure in the MariaDB kernel is already kindly provided by Jupyter, we only need to send back to Jupyter a list of suggestions based on the arguments that {{{do_complete}}} receives :-).

Ideally we should aim to enable at least database, table and column name completion and also SQL keyword completion.
But no worries, there are plenty of possibilities to extend the functionality even more if the accepted student turns out to be very productive :D

|=Details:|[[https://github.com/MariaDB/mariadb_kernel/issues/5|Project Issue]]
|=Mentor:|Robert Bindar

=== Implement interacting editing of result sets in the MariaDB Jupyter kernel

At this moment the MariaDB kernel is only capable of getting the results sets from the MariaDB client in {{{HTML}}} format and packing them in a Jupyter compatible format. Jupyter then displays them in notebooks like it would display Python Pandas dataframes.

Sure, the users can easily write {{{SQL}}} code to modify the content of a table like they would write in a classical command line database client.
But we want to go a bit further, we would love to have the capability to edit a result set returned by a {{{SELECT}}} statement (i.e. double click on table cells and edit) and have a button that users can press to generate a {{{SQL}}} statement that will update the content of the table via the MariaDB server.

Apart from interacting with the Jupyter frontend for providing this UI capability, we also have to implement a field integrity functionality so that we make sure users can&#39;t enter data that is not compatible with the datatype of the column as it is seen by the MariaDB server.

The project should start with a fair bit of research to understand how we can play with the [[https://jupyter-client.readthedocs.io/en/stable/messaging.html|Jupyter Messaging]]  protocol to create the UI functionality and also to check other Jupyter kernels and understand what&#39;s the right and best approach for tackling this.

|=Details:|[[https://github.com/MariaDB/mariadb_kernel/issues/12|Project Issue]]
|=Mentor:|Andreia Hendea

=== Make the MariaDB Jupyter kernel capable of dealing with huge SELECTs

Currently the MariaDB kernel doesn&#39;t impose any internal limits for the number of rows a user can {{{SELECT}}} in a notebook cell. Internally the kernel gets the result set from MariaDB and stores it in a pandas DataFrame, so users can use it with magic commands to chart data.

But this DataFrame is stored in memory, so if you {{{SELECT}}} a huge number of rows, say 500k or 1M, it&#39;s probably not a very good idea to create such a huge DataFrame.
We tested with 500k rows, and the DataFrame itself is not the biggest problem, it consumed around 500MB of memory. The problem is the amount of rows the browser needs to render, for 500k rows the browser tab with the notebook consumes around 2GB of memory, so the Jupyter frontend (JupyterLab, Jupyter Notebook) slows down considerably.

A potential solution is to introduce a two new config options which would specify:
* a limit for the number of rows the Jupyter notebook should render, a reasonable default value for this could 50 rows for instance ({{{display_max_rows}}})
* a limit for each {{{SELECT}}} statement, {{{limit_max_rows}}}, that the kernel would use to determine whether it should store the result set in memory in a DataFrame or store the result set on disk. A reasonable default value might be 100k rows.

The trickiest part of the project though is that, once the kernel writes a result set on disk, the charting magic commands need to detect that the data is not in memory, it is on disk, and they should find a smart mechanism for generating the chart from the disk data without loading the entire data in memory (which would defeat the whole purpose of the project). This might involve finding a new Python plotting library (instead of current matplotlib) that can accomplish the job.

|=Details:|[[https://github.com/MariaDB/mariadb_kernel/issues/9|Project Issue]]
|=Mentor:|Vlad Bogolin

&lt;&lt;/style&gt;&gt;
= Suggest a Task
Do you have an idea of your own, not listed above? Do let us know!</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>