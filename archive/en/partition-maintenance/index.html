<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Partition Maintenance - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Partition Maintenance" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/partition-maintenance/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="For time series (includes list of PARTITION uses)" />

    <meta name="description" content="For time series (includes list of PARTITION uses)" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/partition-maintenance/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/partition-maintenance/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/partitioning-tables/">Partitioning Tables</a>
    


    » <a class="node_link crumb" href="/kb/en/partition-maintenance/">Partition Maintenance</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/partition-maintenance/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/partition-maintenance/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/partition-maintenance/+flag"
                data-flag-url="/kb/en/partition-maintenance/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/partition-maintenance/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2016-06-09 11:53">8 years, 8 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2023-11-15 11:12">1 year, 2 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/partition-maintenance/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/partition-maintenance/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/partition-maintenance/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/partition-maintenance/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Partition Maintenance</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#preface" title="Preface">Preface</a></li>

    <li class=""><a href="#use-cases-for-partitioning" title="Use Cases for PARTITIONing">Use Cases for PARTITIONing</a></li>

    <li class=""><a href="#auto_increment-in-partition" title="AUTO_INCREMENT in PARTITION">AUTO_INCREMENT in PARTITION</a></li>

    <li class=""><a href="#partition-maintenance-for-the-time-series-case" title="PARTITION maintenance for the time-series case">PARTITION maintenance for the time-series case</a></li>

    <li class=""><a href="#high-level-view-of-the-code" title="High level view of the code">High level view of the code</a></li>

    <li class=""><a href="#why" title="Why?">Why?</a></li>

    <li class=""><a href="#when-to-do-the-alters" title="When to do the ALTERs?">When to do the ALTERs?</a></li>

    <li class=""><a href="#variants" title="Variants">Variants</a></li>

    <li class=""><a href="#detailed-code" title="Detailed code">Detailed code</a></li>

    <li class=""><a href="#postlog" title="Postlog">Postlog</a></li>

    <li class=""><a href="#see-also" title="See also">See also</a> </ol>
</li>
</div>
<h2 class="anchored_heading" id="preface">Preface</h2>
<p>This article covers</p>
<ul><li>PARTITIONing uses and non-uses
</li><li>How to Maintain a time-series PARTITIONed table
</li><li>AUTO_INCREMENT secrets
</li></ul>
<p>First, my Opinions on PARTITIONing</p>
<p>Taken from <a href="http://mysql.rjweb.org/doc.php/ricksrots">Rick's RoTs - Rules of Thumb</a></p>
<ul><li>#1: Don't use <a href="/kb/en/managing-mariadb-partitioning/">PARTITIONing</a> until you know how and why it will help.
</li><li>Don't use PARTITION unless you will have &gt;1M rows
</li><li>No more than 50 PARTITIONs on a table (open, show table status, etc, are impacted) (fixed in MySQL 5.6.6?; a better fix coming eventually in 5.7)
</li><li>PARTITION BY RANGE is the only useful method.
</li><li>SUBPARTITIONs are not useful.
</li><li>The partition field should not be the field first in any key.
</li><li>It is OK to have an <a href="/kb/en/auto_increment/">AUTO_INCREMENT</a> as the first part of a compound key, or in a non-UNIQUE index.
</li></ul>
<p>It is so tempting to believe that PARTITIONing will solve performance problems. But it is so often wrong.</p>
<p>PARTITIONing splits up one table into several smaller tables. But table size is rarely a performance issue. Instead, I/O time and indexes are the issues.</p>
<p>A common fallacy: "Partitioning will make my queries run faster". It won't. Ponder what it takes for a 'point query'. Without partitioning, but with an appropriate index, there is a BTree (the index) to drill down to find the desired row. For a billion rows, this might be 5 levels deep. With partitioning, first the partition is chosen and "opened", then a smaller BTree (of say 4 levels) is drilled down. Well, the savings of the shallower BTree is consumed by having to open the partition. Similarly, if you look at the disk blocks that need to be touched, and which of those are likely to be cached, you come to the conclusion that about the same number of disk hits is likely. Since disk hits are the main cost in a query, Partitioning does not gain any performance (at least for this typical case). The 2D case (below) gives the main contradiction to this discussion.</p>
<h2 class="anchored_heading" id="use-cases-for-partitioning">Use Cases for PARTITIONing</h2>
<p><strong>Use case #1 -- time series</strong>. Perhaps the most common use case where PARTITIONing shines is in a dataset where "old" data is periodically deleted from the table. RANGE PARTITIONing by day (or other unit of time) lets you do a nearly instantaneous DROP PARTITION plus REORGANIZE PARTITION instead of a much slower DELETE. Much of this blog is focused on this use case. This use case is also discussed in <a href="/kb/en/big-deletes/">Big DELETEs</a></p>
<p>The big win for Case #1: DROP PARTITION is a lot faster than DELETEing a lot of rows.</p>
<p><strong>Use case #2 -- 2-D index</strong>. INDEXes are inherently one-dimensional. If you need two "ranges" in the WHERE clause, try to migrate one of them to PARTITIONing.</p>
<p>Finding the nearest 10 pizza parlors on a map needs a 2D index. Partition pruning sort of gives a second dimension. See Latitude/Longitude Indexing
That uses PARTITION BY RANGE(latitude) together with PRIMARY KEY(longitude, ...)</p>
<p>The big win for Case #2: Scanning fewer rows.</p>
<p><strong>Use case #3 -- hot spot</strong>. This is a bit complicated to explain. Given this combination:</p>
<ul><li>A table's index is too big to be cached, but the index for one partition is cacheable, and
</li><li>The index is randomly accessed, and
</li><li>Data ingestion would normally be I/O bound due to updating the index
Partitioning can keep all the index "hot" in RAM, thereby avoiding a lot of I/O.
</li></ul>
<p>The big win for Case #3: Improving caching to decrease I/O to speed up operations.</p>
<h2 class="anchored_heading" id="auto_increment-in-partition">AUTO_INCREMENT in PARTITION</h2>
<ul><li>For <a href="/kb/en/auto_increment/">AUTO_INCREMENT</a> to work (in any table), it must be the first field in some index. Period. There are no other requirements on indexing it.
</li><li>Being the first field in some index lets the engine find the 'next' value when opening the table.
</li><li>AUTO_INCREMENT need not be UNIQUE. What you lose: prevention of explicitly inserting a duplicate id. (This is rarely needed, anyway.)
</li></ul>
<p>Examples (where id is AUTO_INCREMENT):</p>
<ul><li>PRIMARY KEY (...), INDEX(id)
</li><li>PRIMARY KEY (...), UNIQUE(id, partition_key) -- not useful
</li><li>INDEX(id), INDEX(...) (but no UNIQUE keys)
</li><li>PRIMARY KEY(id), ... -- works only if id is the partition key (not very useful)
</li></ul>
<h2 class="anchored_heading" id="partition-maintenance-for-the-time-series-case">PARTITION maintenance for the time-series case</h2>
<p>Let's focus on the maintenance task involved in Case #1, as described above.</p>
<p>You have a large table that is growing on one end and being pruned on the other. Examples include news, logs, and other transient information. PARTITION BY RANGE is an excellent vehicle for such a table.</p>
<ul><li>DROP PARTITION is much faster than DELETE. (This is the big reason for doing this flavor of partitioning.)
</li><li>Queries often limit themselves to 'recent' data, thereby taking advantage of "partition pruning".
</li></ul>
<p>Depending on the type of data, and how long before it expires, you might have daily or weekly or hourly (etc) partitions.</p>
<p>There is no simple SQL statement to "drop partitions older than 30 days" or "add a new partition for tomorrow". It would be tedious to do this by hand every day.</p>
<h2 class="anchored_heading" id="high-level-view-of-the-code">High level view of the code</h2>
<pre class="fixed"><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tbl</span>
    <span class="k">DROP</span> <span class="n">PARTITION</span> <span class="n">from20120314</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tbl</span>
    <span class="n">REORGANIZE</span> <span class="n">PARTITION</span> <span class="n">future</span> <span class="k">INTO</span> <span class="p">(</span>
        <span class="n">PARTITION</span> <span class="n">from20120415</span> <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="p">(</span><span class="n">TO_DAYS</span><span class="p">(</span><span class="s1">&#39;2012-04-16&#39;</span><span class="p">)),</span>
        <span class="n">PARTITION</span> <span class="n">future</span>     <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="k">MAXVALUE</span><span class="p">);</span>
</pre><p>After which you have...</p>
<pre class="fixed">    <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">tbl</span> <span class="p">(</span>
        <span class="n">dt</span> <span class="n">DATETIME</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>  <span class="c1">-- or DATE</span>
        <span class="p">...</span>
        <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(...,</span> <span class="n">dt</span><span class="p">),</span>
        <span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="p">(...,</span> <span class="n">dt</span><span class="p">),</span>
        <span class="p">...</span>
    <span class="p">)</span>
    <span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">RANGE</span> <span class="p">(</span><span class="n">TO_DAYS</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span> <span class="p">(</span>
        <span class="n">PARTITION</span> <span class="k">start</span>        <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">PARTITION</span> <span class="n">from20120315</span> <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="p">(</span><span class="n">TO_DAYS</span><span class="p">(</span><span class="s1">&#39;2012-03-16&#39;</span><span class="p">)),</span>
        <span class="n">PARTITION</span> <span class="n">from20120316</span> <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="p">(</span><span class="n">TO_DAYS</span><span class="p">(</span><span class="s1">&#39;2012-03-17&#39;</span><span class="p">)),</span>
        <span class="p">...</span>
        <span class="n">PARTITION</span> <span class="n">from20120414</span> <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="p">(</span><span class="n">TO_DAYS</span><span class="p">(</span><span class="s1">&#39;2012-04-15&#39;</span><span class="p">)),</span>
        <span class="n">PARTITION</span> <span class="n">from20120415</span> <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="p">(</span><span class="n">TO_DAYS</span><span class="p">(</span><span class="s1">&#39;2012-04-16&#39;</span><span class="p">)),</span>
        <span class="n">PARTITION</span> <span class="n">future</span>       <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="k">MAXVALUE</span>
    <span class="p">);</span>
</pre><h2 class="anchored_heading" id="why">Why?</h2>
<p>Perhaps you noticed some odd things in the example. Let me explain them.</p>
<ul><li>Partition naming: Make them useful.
</li><li>from20120415 ... 04-16: Note that the LESS THAN is the next day's date
</li><li>The "start" partition: See paragraph below.
</li><li>The "future" partition: This is normally empty, but it can catch overflows; more later.
</li><li>The range key (dt) must be included in any PRIMARY or UNIQUE key.
</li><li>The range key (dt) should be last in any keys it is in -- You have already "pruned" with it; it is almost useless in the index, especially at the beginning.
</li><li>DATETIME, etc -- I picked this datatype because it is typical for a time series. Newer MySQL versions allow TIMESTAMP. INT could be used; etc.
</li><li>There is an extra day (03-16 thru 04-16): The latest day is only partially full.
</li></ul>
<p>Why the bogus "start" partition? If an invalid datetime (Feb 31) were to be used, the datetime would turn into NULL. NULLs are put into the first partition. Since any SELECT could have an invalid date (yeah, this stretching things), the partition pruner always includes the first partition in the resulting set of partitions to search. So, if the SELECT must scan the first partition, it would be slightly more efficient if that partition were empty. Hence the bogus "start" partition. Longer discussion, by The Data Charmer
5.5 eliminates the bogus check, but only if you switch to a new syntax:</p>
<pre class="fixed">    PARTITION BY RANGE COLUMNS(dt) (
    PARTITION day_20100226 VALUES LESS THAN ('2010-02-27'), ...
</pre><p>More on the "future" partition. Sooner or later the cron/EVENT to add tomorrow's partition will fail to run. The worst that could happen is for tomorrow's data to be lost. The easiest way to prevent that is to have a partition ready to catch it, even if this partition is normally always empty.</p>
<p>Having the "future" partition makes the ADD PARTITION script a little more complex. Instead, it needs to take tomorrow's data from "future" and put it into a new partition. This is done with the REORGANIZE command shown. Normally nothing need be moved, and the ALTER takes virtually zero time.</p>
<h2 class="anchored_heading" id="when-to-do-the-alters">When to do the ALTERs?</h2>
<ul><li>DROP if the oldest partition is "too old".
</li><li>Add 'tomorrow' near the end of today, but don't try to add it twice.
</li><li>Do not count partitions -- there are two extra ones. Use the partition names or information_schema.PARTITIONS.PARTITION_DESCRIPTION.
</li><li>DROP/Add only once in the script. Rerun the script if you need more.
</li><li>Run the script more often than necessary. For daily partitions, run the script twice a day, or even hourly. Why? Automatic repair.
</li></ul>
<h2 class="anchored_heading" id="variants">Variants</h2>
<p>As I have said many times, in many places, BY RANGE is perhaps the only useful variant. And a time series is the most common use for PARTITIONing.</p>
<ul><li>(as discussed here) DATETIME/DATE with TO_DAYS()
</li><li>DATETIME/DATE with TO_DAYS(), but with 7-day intervals
</li><li>TIMESTAMP with TO_DAYS(). (version 5.1.43 or later)
</li><li>PARTITION BY RANGE COLUMNS(DATETIME) (5.5.0)
</li><li>PARTITION BY RANGE(TIMESTAMP) (version 5.5.15 / 5.6.3)
</li><li>PARTITION BY RANGE(TO_SECONDS()) (5.6.0)
</li><li>INT UNSIGNED with constants computed as unix timestamps.
</li><li>INT UNSIGNED with constants for some non-time-based series.
</li><li>MEDIUMINT UNSIGNED containing an "hour id": FLOOR(FROM_UNIXTIME(timestamp) / 3600)
</li><li>Months, Quarters, etc: Concoct a notation that works.
</li></ul>
<p>How many partitions?</p>
<ul><li>Under, say, 5 partitions -- you get very little of the benefits.
</li><li>Over, say, 50 partitions, and you hit inefficiencies elsewhere.
</li><li>Certain operations (SHOW TABLE STATUS, opening the table, etc) open every partition.
</li><li><a href="/kb/en/myisam/">MyISAM</a>, before version 5.6.6, would lock all partitions before pruning!
</li><li>Partition pruning does not happen on INSERTs (until Version 5.6.7), so INSERT needs to open all the partitions.
</li><li>A possible 2-partition use case: <a href="http://forums.mysql.com/read.php?24,633179,633179">http://forums.mysql.com/read.php?24,633179,633179</a>
</li><li>8192 partitions is a hard limit (1024 before <a href="/kb/en/mariadb-1004-release-notes/">MariaDB 10.0.4</a>).
</li><li>Before "native partitions" (5.7.6), each partition consumed a chunk of memory.
</li></ul>
<h2 class="anchored_heading" id="detailed-code">Detailed code</h2>
<p><a href="http://mysql.rjweb.org/demo_part_maint.pl.txt">Reference implementation, in Perl, with demo of daily partitions</a></p>
<p>The complexity of the code is in the discovery of the PARTITION names, especially of the oldest and the 'next'.</p>
<p>To run the demo,</p>
<ul><li>Install Perl and DBIx::DWIW (from CPAN).
</li><li>copy the txt file (link above) to demo_part_maint.pl
</li><li>execute perl demo_part_maint.pl to get the rest of the instructions
</li></ul>
<p>The program will generate and execute (when needed) either of these:</p>
<pre class="fixed">   <span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tbl</span> <span class="n">REORGANIZE</span> <span class="n">PARTITION</span>
        <span class="n">future</span>
   <span class="k">INTO</span> <span class="p">(</span>
        <span class="n">PARTITION</span> <span class="n">from20150606</span> <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="p">(</span><span class="mi">736121</span><span class="p">),</span>
        <span class="n">PARTITION</span> <span class="n">future</span> <span class="k">VALUES</span> <span class="k">LESS</span> <span class="k">THAN</span> <span class="k">MAXVALUE</span>
   <span class="p">)</span>

   <span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">tbl</span>
                    <span class="k">DROP</span> <span class="n">PARTITION</span> <span class="n">from20150603</span>
</pre><h2 class="anchored_heading" id="postlog">Postlog</h2>
<p>Original writing -- Oct, 2012; Use cases added: Oct, 2014; Refreshed: June, 2015; 8.0: Sep, 2016 </p>
<p><a href="http://mysql.rjweb.org/slides/Partition.pdf">Slides from Percona Amsterdam 2015</a></p>
<p>PARTITIONing requires at least MySQL 5.1</p>
<p>The tips in this document apply to MySQL, MariaDB, and Percona.</p>
<ul><li><a href="http://www.mysqlperformanceblog.com/2010/12/11/mysql-partitioning-can-save-you-or-kill-you/">More on PARTITIONing</a>
</li><li><a href="http://www.linkedin.com/groups/MySql-Horizontal-partitioning-ProsCons-78638.S.5861525157444595715?qid=0d54d3f9-21d7-43e8-9b75-dbc0270c7236&amp;trk=groups_guest_most_popular-0-b-ttl&amp;goback=%2Egmp_78638">LinkedIn discussion</a>
</li><li><a href="http://dba.stackexchange.com/questions/107408/why-not-partition">Why NOT Partition</a>
</li><li><a href="http://www.geoffmontee.com/automatically-dropping-old-partitions-in-mysql-and-mariadb-part-2/">Geoff Montee's Stored Proc</a>
</li></ul>
<p>Future (as envisioned in 2016):</p>
<ul><li>MySQL 5.7.6 has "native partitioning for InnoDB".
</li><li>FOREIGN KEY support, perhaps in a later 8.0.xx.
</li><li>"GLOBAL INDEX" -- this would avoid the need for putting the partition key in every unique index, but make DROP PARTITION costly. This will be farther into the future.
</li></ul>
<p>MySQL 8.0, released Sep, 2016, not yet GA)</p>
<ul><li>Only InnoDB tables can be partitioned -- MariaDB is likely to continue maintaining Partitioning on non-InnoDB tables, but Oracle is clearly not.
</li><li>Some of the problems having lots of partitions are lessened by the Data-Dictionary-in-a-table.
</li></ul>
<p>Native partitioning will give:</p>
<ul><li>This will improve performance slightly by combining two "handlers" into one.
</li><li>Decreased memory usage, especially when using a large number of partitions. 
</li></ul>
<h2 class="anchored_heading" id="see-also">See also</h2>
<p>Rick James graciously allowed us to use this article in the Knowledge Base.</p>
<p><a href="http://mysql.rjweb.org/">Rick James' site</a> has other useful tips, how-tos,
optimizations, and debugging tips.</p>
<p>
Original source: <a href="http://mysql.rjweb.org/doc.php/partitionmaint">http://mysql.rjweb.org/doc.php/partitionmaint</a></p>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/partition-maintenance/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/partition-maintenance/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/partition-pruning-and-selection/">
                        ← Partition Pruning and Selection
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/partitioning-tables/">
                        ↑ Partitioning Tables ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/partitioning-limitations/">
                        Partitioning Limitations →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="5700" data-comments-url="/kb/en/partition-maintenance/+comments"
         data-reply-url="/kb/en/partition-maintenance/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/partitioning-tables/">
                    ↑ Partitioning Tables ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/partitioning-overview/">
                            
                            Partitioning Overview
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/partitioning-types/">
                            
                            Partitioning Types
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/partition-pruning-and-selection/">
                            
                            Partition Pruning and Selection
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>Partition Maintenance</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/partitioning-limitations/">
                            
                            Partitioning Limitations
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/partitions-files/">
                            
                            Partitions Files
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/partitions-metadata/">
                            
                            Partitions Metadata
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/information-schema-partitions-table/">
                            <span class="pull-right not_primary"></span>
                            Information Schema PARTITIONS Table
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>