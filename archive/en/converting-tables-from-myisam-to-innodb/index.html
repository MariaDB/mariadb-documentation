<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Converting Tables from MyISAM to InnoDB - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Converting Tables from MyISAM to InnoDB" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/converting-tables-from-myisam-to-innodb/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Issues when converting tables from MyISAM to InnoDB." />

    <meta name="description" content="Issues when converting tables from MyISAM to InnoDB." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/converting-tables-from-myisam-to-innodb/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/converting-tables-from-myisam-to-innodb/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    


    » <a class="node_link crumb" href="/kb/en/converting-tables-from-myisam-to-innodb/">Converting Tables from MyISAM to InnoDB</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/converting-tables-from-myisam-to-innodb/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/converting-tables-from-myisam-to-innodb/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/converting-tables-from-myisam-to-innodb/+flag"
                data-flag-url="/kb/en/converting-tables-from-myisam-to-innodb/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/converting-tables-from-myisam-to-innodb/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2012-09-25 05:59">10 years, 9 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2018-04-25 08:14">5 years, 2 months ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/converting-tables-from-myisam-to-innodb/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/converting-tables-from-myisam-to-innodb/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/converting-tables-from-myisam-to-innodb/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/converting-tables-from-myisam-to-innodb/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    
        

<div class="well well-small box"><div><h5>Localized Versions</h5></div><div>

        <ul>
            
            <li><a href="/kb/it/converting-tables-from-myisam-to-innodb/">Convertire le tabelle da MyISAM a InnoDB</a> [it]</li>
            
            <li><a href="/kb/zh-cn/converting-tables-from-myisam-to-innodb/">将表从 MyISAM 转换为 InnoDB</a> [zh-cn]</li>
            
        </ul>
        
</div>
</div>

    





    

<div class="well well-small box"><div><h5>Parents</h5></div><div>

        <ul>
            
                <li><a href="/kb/en/mariadb-storage-engines/">Storage Engines</a></li>
            
                <li><a href="/kb/en/optimizing-tables/">Optimizing Tables</a></li>
            
        </ul>
    
</div>
</div>



</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Converting Tables from MyISAM to InnoDB</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#the-task" title="The task">The task</a></li>

    <li class=""><a href="#index-issues" title="INDEX Issues">INDEX Issues</a></li>

    <li class=""><a href="#non-index-issues" title="Non-INDEX Issues">Non-INDEX Issues</a></li>

    <li class=""><a href="#see-also" title="See Also">See Also</a> </ol>
</li>
</div>
<h2 class="anchored_heading" id="the-task">The task</h2>
<p>You have decided to change one or more tables from <a href="/kb/en/myisam/">MyISAM</a> to <a href="/kb/en/innodb/">InnoDB</a>. That should be
as simple as <code>ALTER TABLE foo ENGINE=InnoDB</code>. But you have heard that there might
be some subtle issues. </p>
<p>This describes possible issues that may arise and what to do about them. </p>
<p> <em>Recommendation.</em> One way to assist in searching for issues in is to do (at least in *nix)</p>
<pre class="fixed">mysqldump --no-data --all-databases &gt;schemas
egrep <span class="s1">&#39;CREATE|PRIMARY&#39;</span> schemas   <span class="c1"># Focusing on PRIMARY KEYs</span>
egrep <span class="s1">&#39;CREATE|FULLTEXT&#39;</span> schemas  <span class="c1"># Looking for FULLTEXT indexes</span>
egrep <span class="s1">&#39;CREATE|KEY&#39;</span> schemas       <span class="c1"># Looking for various combinations of indexes</span>
</pre><p>Understanding how the indexes work will help you better understand what might
run faster or slower in InnoDB. </p>
<h2 class="anchored_heading" id="index-issues">INDEX Issues</h2>
<p> <em>(Most of these Recommendations and some of these Facts have exceptions.)</em></p>
<p> <em>Fact.</em> Every InnoDB table has a PRIMARY KEY. If you do not provide one, then the
first non-NULL UNIQUE key is used. If that can't be done, then a 6-byte,
hidden, integer is provided. </p>
<p> <em>Recommendation.</em> Look for tables without a PRIMARY KEY. Explicitly specify a
PRIMARY KEY, even if it's an artificial AUTO_INCREMENT. This is not an absolute
requirement, but it is a stronger admonishment for InnoDB than for MyISAM. Some
day you may need to walk through the table; without an explicit PK, you can't
do it. </p>
<p> <em>Fact.</em> The fields of the PRIMARY KEY are included in each Secondary key. </p>
<ul start="1"><li>Check for redundant indexes with this in mind.
</li></ul>
<pre class="fixed indent1">PRIMARY KEY(id),
INDEX(b), -- effectively the same as INDEX(b, id)
INDEX(b, id) -- effectively the same as INDEX(b)
</pre><ul start="1" style="list-style: none"><li>(Keep one of the INDEXes, not both)
</li></ul>
<ul start="1"><li>Note subtle things like
</li></ul>
<pre class="fixed indent1">PRIMARY KEY(id),
UNIQUE(b), -- keep for uniqueness constraint
INDEX(b, id) -- DROP this one
</pre><ul start="1"><li>Also, since the PK and the data coexist:
</li></ul>
<pre class="fixed indent1">PRIMARY KEY(id),
INDEX(id, b) -- DROP this one; it adds almost nothing
</pre><p> <em>Contrast.</em> This feature of MyISAM is not available in InnoDB; the value of
'id' will start over at 1 for each different value of 'abc':</p>
<pre class="fixed">id INT UNSIGNED NOT NULL AUTO_INCREMENT,
PRIMARY KEY (abc, id)
</pre><p>A way to simulate the MyISAM 'feature' might be something like: What you want
is this, but it won't work because it is referencing the table twice:</p>
<pre class="fixed">INSERT INTO foo
    (other, id, ...)
    VALUES
    (123, (SELECT MAX(id)+1 FROM foo WHERE other = 123), ...);
</pre><p>Instead, you need some variant on this. (You may already have a BEGIN...COMMIT.)</p>
<pre class="fixed">BEGIN;
SELECT @id := MAX(id)+1 FROM foo WHERE other = 123 FOR UPDATE;
INSERT INTO foo
    (other, id, ...)
    VALUES
    (123, @id, ...);
COMMIT;
</pre><p>Having a transaction is mandatory to prevent another thread from grabbing the
same id. </p>
<p> <em>Recommendation.</em> Look for such PRIMARY KEYs. If you find such, ponder how
to change the design. There is no straightforward workaround. However, the
following may be ok. (Be sure that the datatype for id is big enough since it
won't start over.):</p>
<pre class="fixed">id INT UNSIGNED NOT NULL AUTO_INCREMENT,
PRIMARY KEY (abc, id),
UNIQUE(id)
</pre><p> <em>Recommendation.</em> Keep the PRIMARY KEY short. If you have Secondary keys,
remember that they include the fields of the PK. A long PK would make the
Secondary keys bulky. Well, maybe not <span>&mdash;</span> if the is a
lot of overlap in fields.  Example: <code>PRIMARY KEY(a,b,c), INDEX(c,b,a)</code>
<span>&mdash;</span> no extra bulk. </p>
<p> <em>Recommendation.</em> Check AUTO_INCREMENT sizes. </p>
<ul start="1"><li>BIGINT is almost never needed. It wastes at least 4 bytes per row (versus
  INT). 
</li><li>Always use UNSIGNED and NOT NULL. 
</li><li>MEDIUMINT UNSIGNED (16M max) might suffice instead of INT 
</li><li>Be sure to be pessimistic <span>&mdash;</span> it is painful to ALTER. 
</li></ul>
<p> <em>Contrast.</em> "Vertical Partitioning". This is where you artificially split a
table to move bulky columns (eg, a BLOB) into another, parallel, table. It is
beneficial in MyISAM to avoid stepping over the blob when you don't need to
read it. InnoDB stores BLOB and TEXT differently <span>&mdash;</span> 767
bytes are in the record, the rest is in some other block. So, it may (or may
not) be worth putting the tables back together. Caution: An InnoDB row is
limited to 8KB, and the 767 counts against that. </p>
<p> <em>Fact.</em> FULLTEXT (prior to <a href="/kb/en/mariadb-1005-release-notes/">MariaDB 10.0.5</a>) and SPATIAL indexes are not available in InnoDB. Note that MyISAM and InnoDB <a href="/kb/en/full-text-indexes/">FULLTEXT indexes</a> use different <a href="stopword">stopword</a> lists and different system variables.</p>
<p> <em>Recommendation.</em> Search for such indexes. Keep such tables in MyISAM.
Better yet, do Vertical Partitioning (see above) to split out the minimum
number of columns from InnoDB. </p>
<p> <em>Fact.</em> The maximum length of an INDEX is different between the Engines.
(This change is not likely to hit you, but watch out.) MyISAM allows 1000
bytes; InnoDB allows 767 bytes, just big enough for a</p>
<pre class="fixed">VARCHAR(255) CHARACTER SET utf8.

ERROR 1071 (42000): Specified key was too long; max key length is 767 bytes
</pre><p> <em>Fact.</em> The PRIMARY KEY is included in the data. Hence, SHOW TABLE STATUS
will show and <code>Index_length</code> of 0 bytes (or 16KB) for a table with no
secondary indexes. Otherwise, <code>Index_length</code> is the total size for the
secondary keys. </p>
<p> <em>Fact.</em> The PRIMARY KEY is included in the data. Hence, exact match by PK
may be a little faster with InnoDB. And, "range" scans by PK are likely to be
faster. </p>
<p> <em>Fact.</em> A lookup by Secondary Key traverses the secondary key's BTree, grabs
the PRIMARY KEY, then traverses the PK's BTree. Hence, secondary key lookups
are a little more cumbersome in InnoDB. </p>
<p> <em>Contrast.</em> The fields of the PRIMARY KEY are included in each Secondary
key.  This may lead to "Using index" (in the EXPLAIN plan) for InnoDB for cases
where it did not happen in MyISAM. (This is a slight performance boost, and
counteracts the double-lookup otherwise needed.) However, when "Using index"
would be useful on the PRIMARY KEY, MyISAM would do an "index scan", yet InnoDB
effectively has to do a "table scan". </p>
<p> <em>Same as MyISAM.</em> Almost always</p>
<pre class="fixed">INDEX(a)   -- DROP this one because the other one handles it.
INDEX(a,b)
</pre><p> <em>Contrast.</em> The data is stored in PK order. This means that "recent" records
are 'clustered' together at the end. This may give you better 'locality of
reference' than in MyISAM. </p>
<p> <em>Same as MyISAM.</em> The optimizer almost never uses two indexes in a single
SELECT. (5.1 will occasionally do "index merge".) SELECT in subqueries and
UNIONs can independently pick indexes. </p>
<p> <em>Subtle issue.</em> When you DELETE a row, the AUTO_INCREMENT id will be burned.
Ditto for REPLACE, which is a DELETE plus an INSERT. </p>
<p> <em>Very subtle issue.</em> Replication occurs on COMMIT. If you have multiple
threads using transactions, the AUTO_INCREMENTs can arrive at a slave out of
order. One transaction BEGINs, grabs an id. Then another transaction grabs an
id but COMMITs before the first finishes. </p>
<p> <em>Same as MyISAM.</em> "Prefix" indexing is usually bad in both InnoDB and
MyISAM.  Example: <code>INDEX(foo(30))</code></p>
<h2 class="anchored_heading" id="non-index-issues">Non-INDEX Issues</h2>
<p>Disk space for InnoDB is likely to be 2-3 times as much as for MyISAM. </p>
<p>MyISAM and InnoDB use RAM radically differently. If you change all your tables,
you should make significant adjustments: </p>
<ul start="1"><li><a href="/kb/en/myisam-system-variables/#key_buffer_size">key_buffer_size</a> <span>&mdash;</span> small but non-zero; say, 10M; 
</li><li><a href="/kb/en/xtradbinnodb-server-system-variables/#innodb_buffer_pool_size">innodb_buffer_pool_size</a> <span>&mdash;</span> 70% of available RAM 
</li></ul>
<p>InnoDB has essentially no need for CHECK, OPTIMIZE, or ANALYZE. Remove them
from your maintenance scripts. (No real harm if you keep them.) </p>
<p>Backup scripts may need checking. A MyISAM table can be backed up by copying
three files. With InnoDB this is only possible if <a href="/kb/en/xtradbinnodb-server-system-variables/#innodb_file_per_table">innodb_file_per_table</a> is set to 1. Before <a href="/kb/en/what-is-mariadb-100/">MariaDB 10.0</a>,
capturing a table or database for copying from production to a development
environment was not possible. Change to <a href="/kb/en/mysqldump/">mysqldump</a>. Since <a href="/kb/en/what-is-mariadb-100/">MariaDB 10.0</a> a hot copy can be created - see <a href="/kb/en/backup-and-restore-overview/">Backup and restore overview</a>.</p>
<p>Before <a href="/kb/en/what-is-mariadb-55/">MariaDB 5.5</a>, the DATA DIRECTORY <a href="/kb/en/create-table/#table-options">table option</a> was not supported for InnoDB. Since <a href="/kb/en/what-is-mariadb-55/">MariaDB 5.5</a> it is supported, but only in CREATE TABLE. INDEX DIRECTORY has no effect, since InnoDB does not use separate files for indexes. To better balance the workload through several disks, the paths of some InnoDB log files can also be changed.</p>
<p>Understand autocommit and BEGIN/COMMIT. </p>
<ul start="1"><li>(default) autocommit = 1: In the absence of any BEGIN or COMMIT statements,
  every statement is a transaction by itself. This is close to the MyISAM
  behavior, but is not really the best. 
</li><li>autocommit = 0: COMMIT will close a transaction and start another one. To me,
  this is kludgy. 
</li><li>(recommended) BEGIN...COMMIT gives you control over what sequence of
  operation(s) are to be considered a transaction and "atomic". Include the
  ROLLBACK statement if you need to undo stuff back to the BEGIN. 
</li></ul>
<p>Perl's DBIx::DWIW and Java's JDBC have API calls to do BEGIN and COMMIT. These
are probably better than 'executing' BEGIN and COMMIT. </p>
<p>Test for errors everywhere! Because InnoDB uses row-level locking, it can
stumble into deadlocks that you are not expecting. The engine will
automatically ROLLBACK to the BEGIN. The normal recovery is to redo, beginning
at the BEGIN. Note that this is a strong reason to have BEGINs. </p>
<p>LOCK/UNLOCK TABLES <span>&mdash;</span> remove them. Replace them (sort
of) with BEGIN ... COMMIT. (LOCK will work if <a href="/kb/en/xtradbinnodb-server-system-variables/#innodb_table_locks">innodb_table_locks</a> is set to 1, but it is less efficient, and
may have subtle issues.) </p>
<p>In 5.1, ALTER ONLINE TABLE can speed up some operations significantly.
(Normally ALTER TABLE copies the table over and rebuilds the indexes.) </p>
<p>The "limits" on virtually everything are different between MyISAM and InnoDB.
Unless you have huge tables, wide rows, lots of indexes, etc, you are unlikely
to stumble into a different limit. </p>
<p>Mixture of MyISAM and InnoDB? This is OK. But there are caveats. </p>
<ul start="1"><li>RAM settings should be adjusted to accordingly. 
</li><li>JOINing tables of different Engines works. 
</li><li>A transaction that affects tables of both types can ROLLBACK InnoDB changes,
  but will leave MyISAM changes intact. 
</li><li>Replication: MyISAM statements are replicated when finished; InnoDB
  statements are held until the COMMIT. 
</li></ul>
<p>FIXED (vs DYNAMIC) is meaningless in InnoDB. </p>
<p>PARTITION <span>&mdash;</span> You can partition MyISAM and InnoDB
tables. Remember the screwball rule: You must either </p>
<ul start="1"><li>have no UNIQUE (or PRIMARY) keys, or 
</li><li>have the value you are "partitioning on" in every UNIQUE key. 
</li></ul>
<p>The former is not advised for InnoDB. The latter is messy if you want an
AUTO_INCREMENT. </p>
<p>PRIMARY KEY in PARTITION <span>&mdash;</span> Since every key must
include the field on which you are PARTITIONing, how can AUTO_INCREMENT work?
Well, there seems to be a convenient special case: </p>
<ul start="1"><li>This works: PRIMARY KEY(autoinc, partition_key) 
</li></ul>
<ul start="1"><li>This does not work for InnoDB: PRIMARY KEY(partition_key, autoinc) 
</li></ul>
<p>That is, an AUTO_INCREMENT will correctly increment, and be unique across all
PARTITINOs, when it is the first field of the PRIMARY KEY, but not otherwise.</p>
<h2 class="anchored_heading" id="see-also">See Also</h2>
<p>Rick James graciously allowed us to use this article in the Knowledge Base.</p>
<p><a href="http://mysql.rjweb.org/">Rick James' site</a> has other useful tips, how-tos,
optimizations, and debugging tips.</p>
<p>
Original source: <a href="http://mysql.rjweb.org/doc.php/myisam2innodb">http://mysql.rjweb.org/doc.php/myisam2innodb</a></p>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/converting-tables-from-myisam-to-innodb/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/converting-tables-from-myisam-to-innodb/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/storage-engines-storage-engine-development/">
                        ← Storage Engine Development
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/mariadb-storage-engines/">
                        ↑ Storage Engines ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/machine-learning-with-mindsdb/">
                        Machine Learning with MindsDB →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="2948" data-comments-url="/kb/en/converting-tables-from-myisam-to-innodb/+comments"
         data-reply-url="/kb/en/converting-tables-from-myisam-to-innodb/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/mariadb-storage-engines/">
                    ↑ Storage Engines ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/choosing-the-right-storage-engine/">
                            
                            Choosing the Right Storage Engine
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/innodb/">
                            
                            InnoDB
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-columnstore/">
                            
                            MariaDB ColumnStore
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/aria/">
                            
                            Aria
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/archive/">
                            
                            Archive
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/blackhole/">
                            
                            BLACKHOLE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/connect/">
                            
                            CONNECT
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/csv/">
                            
                            CSV
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/federatedx-storage-engine/">
                            
                            FederatedX
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/memory-storage-engine/">
                            
                            MEMORY Storage Engine
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/merge/">
                            
                            MERGE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mroonga/">
                            
                            Mroonga
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/myisam-storage-engine/">
                            
                            MyISAM
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/myrocks/">
                            
                            MyRocks
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/oqgraph-storage-engine/">
                            
                            OQGRAPH
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/s3-storage-engine/">
                            
                            S3 Storage Engine
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/sequence-storage-engine/">
                            
                            Sequence Storage Engine
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/sphinx-storage-engine/">
                            
                            SphinxSE
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/spider/">
                            
                            Spider
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/tokudb/">
                            
                            TokuDB
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/information-schema-engines-table/">
                            <span class="pull-right not_primary"></span>
                            Information Schema ENGINES Table
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/performance_schema-storage-engine/">
                            
                            PERFORMANCE_SCHEMA Storage Engine
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/legacy-storage-engines/">
                            
                            Legacy Storage Engines
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/storage-engines-storage-engine-development/">
                            
                            Storage Engine Development
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>Converting Tables from MyISAM to InnoDB</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/machine-learning-with-mindsdb/">
                            
                            Machine Learning with MindsDB
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>