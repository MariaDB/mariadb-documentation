<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Sequence Overview - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.b9e1e104f007.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Sequence Overview - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/sequence-overview/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/sequence-overview/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/sequence-overview/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/using-mariadb-server/">Using MariaDB Server</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements-structure/">SQL Statements &amp; Structure</a>
    

    
    » <a class="crumb" href="/kb/en/sequences/">Sequences</a>
    


    » <a class="node_link crumb" href="/kb/en/sequence-overview/">Sequence Overview</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/sequence-overview/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Sequence Overview - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/sequence-overview/+r/127736/">127736</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-1368">
<a href="/kb/user/id/1368" title="Ian Gilfillan">Ian Gilfillan</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2023-07-10 12:01">2023-07-10 12:01</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;style class=&#34;greenbox&#34;&gt;&gt;
This page is about sequence objects. For details about the storage engine, see [[sequence-storage-engine|Sequence Storage Engine]].
&lt;&lt;/style&gt;&gt;

== Introduction
A sequence is an object that generates a sequence of numeric values, as specified by the [[create-sequence|CREATE SEQUENCE]] statement. 

CREATE SEQUENCE will create a sequence that generates new values when called with NEXT VALUE FOR sequence_name. It&#39;s an alternative to [[auto_increment|AUTO INCREMENT]] when one wants to have more control of how the numbers are generated. As the SEQUENCE caches values (up to the CACHE value in the [[create-sequence|CREATE SEQUENCE]] statement, by default 1000) it can in some cases be much faster than AUTO INCREMENT. Another benefit is that one can access the last value generated by all used sequences, which solves one of the limitations with [[last_insert_id|LAST_INSERT_ID()]].

== Creating a Sequence
The [[create-sequence|CREATE SEQUENCE]] statement is used to create a sequence. Here is an example of a sequence starting at 100, incrementing by 10 each time:
&lt;&lt;sql&gt;&gt;
CREATE SEQUENCE s START WITH 100 INCREMENT BY 10;
&lt;&lt;/sql&gt;&gt;

The CREATE SEQUENCE statement, along with defaults, can be viewd with the [[show-create-sequence|SHOW CREATE SEQUENCE STATEMENT]], for example:
&lt;&lt;code&gt;&gt;
SHOW CREATE SEQUENCE s\G
*************************** 1. row ***************************
       Table: s
Create Table: CREATE SEQUENCE `s` start with 100 minvalue 1 maxvalue 9223372036854775806 
  increment by 10 cache 1000 nocycle ENGINE=InnoDB
&lt;&lt;/code&gt;&gt;

== Using Sequence Objects
To get the  [[next-value-for-sequence_name|next value from a sequence]], use

&lt;&lt;code&gt;&gt;
NEXT VALUE FOR sequence_name
&lt;&lt;/code&gt;&gt;
or
&lt;&lt;code&gt;&gt;
NEXTVAL(sequence_name)
&lt;&lt;/code&gt;&gt;
or in Oracle mode ([[sql-mode|SQL_MODE=ORACLE]])
&lt;&lt;code&gt;&gt;
sequence_name.nextval
&lt;&lt;/code&gt;&gt;

For [[previous-value-for-sequence_name|retrieving the last value]] used by the current connection from a sequence
use:
&lt;&lt;code&gt;&gt;
PREVIOUS VALUE FOR sequence_name
&lt;&lt;/code&gt;&gt;
or
&lt;&lt;code&gt;&gt;
LASTVAL(sequence_name)
&lt;&lt;/code&gt;&gt;
or in Oracle mode ([[sql-mode|SQL_MODE=ORACLE]])
&lt;&lt;code&gt;&gt;
sequence_name.currval
&lt;&lt;/code&gt;&gt;

For example:
&lt;&lt;sql&gt;&gt;
SELECT NEXTVAL(s);
+------------+
| NEXTVAL(s) |
+------------+
|        100 |
+------------+

SELECT NEXTVAL(s);
+------------+
| NEXTVAL(s) |
+------------+
|        110 |
+------------+

SELECT LASTVAL(s);
+------------+
| LASTVAL(s) |
+------------+
|        110 |
+------------+
&lt;&lt;/sql&gt;&gt;

=== Using Sequences in DEFAULT
Sequences can be used in DEFAULT:

&lt;&lt;sql&gt;&gt;
create sequence s1;
create table t1 (a int primary key default (next value for s1), b int);
insert into t1 (b) values (1),(2);
select * from t1;
+---+------+
| a | b    |
+---+------+
| 1 |    1 |
| 2 |    2 |
+---+------+
&lt;&lt;/sql&gt;&gt;

== Changing a Sequence
The [[alter-sequence|ALTER SEQUENCE]] statement is used for changing sequences. For example, to restart the sequence at another value:
&lt;&lt;sql&gt;&gt;
ALTER SEQUENCE s RESTART 50;

SELECT NEXTVAL(s);
+------------+
| NEXTVAL(s) |
+------------+
|         50 |
+------------+
&lt;&lt;/sql&gt;&gt;

The [[setval|SETVAL function]] can also be used to set the next value to be returned for a SEQUENCE, for example:
&lt;&lt;sql&gt;&gt;
SELECT SETVAL(s, 100);
+----------------+
| SETVAL(s, 100) |
+----------------+
|            100 |
+----------------+
&lt;&lt;/sql&gt;&gt;

##SETVAL## can only be used to increase the sequence value. Attempting to set a lower value will fail, returning NULL:

&lt;&lt;sql&gt;&gt;
SELECT SETVAL(s, 50);
+---------------+
| SETVAL(s, 50) |
+---------------+
|          NULL |
+---------------+
&lt;&lt;/sql&gt;&gt;


== Dropping a Sequence
The [[drop-sequence|DROP SEQUENCE]] statement is used to drop a sequence, for example:
&lt;&lt;sql&gt;&gt;
DROP SEQUENCE s;
&lt;&lt;/sql&gt;&gt;

== Replication

If one wants to use Sequences in a master-master setup or with Galera one
should use ##INCREMENT=0##.  This will tell the Sequence to use [[replication-and-binary-log-server-system-variables/#auto_increment_increment|auto_increment_increment]] and [[replication-and-binary-log-server-system-variables/#auto_increment_offset|auto_increment_offset]] to generate unique values for each server.

== Standards Compliance

MariaDB supports both ANSI SQL and Oracle syntax for sequences.

However as ##SEQUENCE## is implemented as a special kind of table, it uses the same namespace as tables. The benefits are that sequences show up in [[show-tables|SHOW TABLES]], and one can also create a sequence with [[create-table|CREATE TABLE]] and drop it with [[drop-table|DROP TABLE]]. One can [[select|SELECT]] from it as from any other table. This ensures that all old tools that work with tables should work with sequences.

Since sequence objects act as regular tables in many contexts, they will be affected by [[lock-tables|LOCK TABLES]]. This is not the case in other DBMS, such as Oracle, where LOCK TABLE does not affect sequences.

== Notes

One of the goals with the Sequence implementation is that all old
tools, such as [[mariadb-dump]] (previously mysqldump), should work unchanged, while still keeping the
normal usage of sequence standard compatibly.

To make this possible, ##sequence## is currently implemented as a table with a few exclusive properties.

The special properties for sequence tables are:

* A sequence table has always one row.
* When one creates a sequence, either with [[create-table|CREATE TABLE]] or [[create-sequence|CREATE SEQUENCE]], one row will be inserted.
* If one tries to insert into a sequence table, the single row will be updated.  This allows [[mariadb-dump]] to work but also gives the additional benefit that one can change all properties of a sequence with a single insert. New applications should of course also use ##ALTER SEQUENCE##.
* [[update|UPDATE]] or [[delete|DELETE]] can&#39;t be performed on Sequence objects.
* Doing a select on the sequence shows the current state of the sequence, except the values that are reserved in the cache.  The ##next_value## column shows the next value not reserved by the cache.
* [[flush|FLUSH TABLES]] will close the sequence and the next sequence number generated will be according to what&#39;s stored in the Sequence object. In effect, this will discard the cached values.
* A number of normal table operations work on Sequence tables. See next section.

== Table Operations that Work with Sequences

* [[show-create-table|SHOW CREATE TABLE sequence_name]]. This shows the table structure that is behind the ##SEQUENCE## including the field names that can be used with [[select|SELECT]] or even [[create-table|CREATE TABLE]].
* [[create-table|CREATE TABLE sequence-structure ... SEQUENCE=1]]
* [[alter-table|ALTER TABLE sequence RENAME TO sequence2]]
* [[rename-table|RENAME TABLE sequence_name TO new_sequence_name]]
* [[drop-table|DROP TABLE sequence_name]]. This is allowed mainly to get old tools like [[mariadb-dump]] to work with sequence tables.
* [[show-tables|SHOW TABLES]]

== Implementation

Internally, sequence tables are created as a normal table without
rollback (the [[innodb|InnoDB]], [[aria|Aria]] and [[myisam|MySAM]] engines support this), wrapped by a
sequence engine object. This allowed us to create sequences with
almost no performance impact for normal tables. (The cost is one &#39;if&#39;
per insert if the [[binary-log|binary log]] is enabled).

== Underlying Table Structure

The following example shows the table structure of sequences and how it
can be used as a table.
(Output of results are slightly edited to make them easier to read)

&lt;&lt;style style=&#34;font-size:0.8em;&#34;&gt;&gt;
&lt;&lt;code wrap=true&gt;&gt;
create sequence t1;
show create sequence t1\G
*************************** 1. row ***************************
  CREATE SEQUENCE `t1` start with 1 minvalue 1 maxvalue 9223372036854775806
  increment by 1 cache 1000 nocycle ENGINE=InnoDB

show create table t1\G
*************************** 1. row ***************************
Create Table: CREATE TABLE `t1` (
  `next_not_cached_value` bigint(21) NOT NULL,
  `minimum_value` bigint(21) NOT NULL,
  `maximum_value` bigint(21) NOT NULL,
  `start_value` bigint(21) NOT NULL COMMENT &#39;start value when sequences is created or value if RESTART is used&#39;,
  `increment` bigint(21) NOT NULL COMMENT &#39;increment value&#39;,
  `cache_size` bigint(21) unsigned NOT NULL,
  `cycle_option` tinyint(1) unsigned NOT NULL COMMENT &#39;0 if no cycles are allowed, 1 if the sequence should begin a new cycle when maximum_value is passed&#39;,
  `cycle_count` bigint(21) NOT NULL COMMENT &#39;How many cycles have been done&#39;
) ENGINE=InnoDB SEQUENCE=1


select * from t1\G
next_not_cached_value: 1
 minimum_value: 1
 maximum_value: 9223372036854775806
  start_value: 1
  increment: 1
  cache_size: 1000
  cycle_option: 0
  cycle_count: 0
&lt;&lt;/code&gt;&gt;
&lt;&lt;/style&gt;&gt;

The ##cycle_count## column is incremented every time the sequence wraps around.

== Credits

* Thanks to Jianwe Zhao from Aliyun for his work on SEQUENCE in AliSQL, which gave ideas and inspiration for this work.
* Thanks to Peter Gulutzan,who helped test and gave useful comments about the implementation.

== See Also
* [[create-sequence|CREATE SEQUENCE]]
* [[alter-sequence|ALTER SEQUENCE]]
* [[drop-sequence|DROP SEQUENCE]]
* [[next-value-for-sequence_name|NEXT VALUE FOR]]
* [[previous-value-for-sequence_name|PREVIOUS VALUE FOR]]
* [[setval|SETVAL()]].  Set next value for the sequence.
* [[auto_increment|AUTO INCREMENT]]
* [[sequence-storage-engine|Sequence Storage Engine]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>