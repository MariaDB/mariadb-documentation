<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>MariaDB protocol difference with MySQL - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="MariaDB protocol difference with MySQL - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariadb-protocol-difference-with-mysql/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-protocol-difference-with-mysql/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-protocol-difference-with-mysql/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/server-client-software/">Server &amp; Client Software</a>
    

    
    » <a class="crumb" href="/kb/en/client-libraries/">Client Libraries</a>
    

    
    » <a class="crumb" href="/kb/en/clientserver-protocol/">Client/Server Protocol</a>
    


    » <a class="node_link crumb" href="/kb/en/mariadb-protocol-difference-with-mysql/">MariaDB protocol difference with MySQL</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/mariadb-protocol-difference-with-mysql/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>MariaDB protocol difference with MySQL - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/mariadb-protocol-difference-with-mysql/+r/143620/">143620</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-3114">
<a href="/kb/user/id/3114" title="Diego Dupin">Diego Dupin</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2024-09-25 07:22">2024-09-25 07:22</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">Here is a list of the difference between MariaDB and MySQL in term of protocol, in order help community drivers maintainers

=== MariaDB Capabilities Extension

MariaDB/MySQL servers can advertise feature support using capabilities. To expand the capabilities beyond the original 4 bytes, MariaDB utilizes 4 bytes, unused by MySQL, in the [[connection/#initial-handshake-packet|Initial handshake packet]] (server capabilities 3rd part). In order to avoid incompatibility in the future, those 4 bytes have to be read only if capability CLIENT_MYSQL is not SET (server being then MariaDB).

Enhanced Capabilities
* MARIADB_CLIENT_CACHE_METADATA: Enables clients to cache metadata and avoid repeated network transmissions.
* MARIADB_CLIENT_EXTENDED_TYPE_INFO: Provides more detailed column metadata information for specific data types.
* MARIADB_CLIENT_STMT_BULK_OPERATIONS: Introduces a dedicated command, [[com_stmt_bulk_execute|COM_STMT_BULK_EXECUTE]], for efficient batch execution of statements.
* MARIADB_CLIENT_BULK_UNIT_RESULTS: Allows for individual result sets for each bulk operation.

See [[connection/#capabilities|Connection Capabilities]].

=== Prepare statement skipping metadata

Prepared statement metadata, which typically remains unchanged except during table alterations, can be cached by clients when the MARIADB_CLIENT_CACHE_METADATA capability is enabled, server won&#39;t then send them again, unless they changes. This significantly improves the performance of subsequent executions, especially for large metadata sets.

When MARIADB_CLIENT_CACHE_METADATA  capability is set, Resultset [[result-set-packets/#column-count-packet|Column count packet]] format indicate if metadata follows or are skipped:

&lt;&lt;style style=&#34;padding: 16px;background-color: #f7f7f7;border-radius: 3px;&#34;&gt;&gt; 
* int&lt;lenenc&gt; column count
* if (MARIADB_CLIENT_CACHE_METADATA capability set)
    int&lt;1&gt; metadata follows (0 / 1)
&lt;&lt;/style&gt;&gt; 


=== Extended Column Information
When the MARIADB_CLIENT_EXTENDED_TYPE_INFO capability is set, [[result-set-packets/#column-definition-packet|column definition packet]] can include additional type and format information.
* For geometric fields: Detailed geometric data type (e.g., &#39;point&#39;, &#39;polygon&#39;)
* For JSON fields: Type &#39;json&#39;
* For UUID fields: Type &#39;uuid&#39;

=== Bulk

The MARIADB_CLIENT_STMT_BULK_OPERATIONS capability enables the [[com_stmt_bulk_execute/|COM_STMT_BULK_EXECUTE]] command for efficient batch processing. However, note that only one result (OK or ERROR) is returned per batch, containing the total affected rows and the first auto-generated ID. For individual results, the MARIADB_CLIENT_BULK_UNIT_RESULTS capability can be set, server will then return a resultset containing for each unitary results (containing auto generated ids and affected rows)

=== Authentication plugins

MariaDB has specifics authentication methods. 

* [[connection/#client_ed25519-plugin|ED25519 plugin]]
* [[connection/#parsec-plugin|PARSEC plugin]]
* [[connection/#auth_gssapi_client-plugin| GSSAPI plugin]]

=== Redirection

MariaDB permit [[connection-redirection-mechanism-in-the-mariadb-clientserver-protocol/|connection redirection]].

===== Use Cases:

* Proxy Scenarios: Connection redirection is particularly beneficial when multiple servers share a single proxy.
* Server Management: This feature can also be used during planned server shutdowns or restarts, allowing for a graceful transition to a new server.

Connector can supports 2 different levels:

* On Connection Creation only: The redirection information is included in the initial [[ok_packet/#server-status-flag|OK_Packet]] sent by the server to the client. This allows the client to connect directly to the target server immediately.
* Anytime Redirection: If redirection information becomes available later, the connector can handle it based on the existing transaction state.
** No Transaction: If no transaction is in progress, the connector can redirect the connection directly.
** Transaction in Progress: If a transaction is ongoing, the redirection information is stored until the transaction is completed. The transaction state is determined using server status flags like SERVER_STATUS_IN_TRANS in the &#34;OK_Packet,&#34; &#34;ERR_Packet,&#34; or &#34;EOF_Packet.&#34;


=== No configuration SSL

MariaDB 11.4.1 introduces  [[https://mariadb.org/mission-impossible-zero-configuration-ssl/|a feature permits TLS certificate validation without needs to provide certificate client side]].

===== Benefits:

* Simplified Setup: No need to install and manage client certificates, making initial configuration much easier.

===== Limitations:

* Password Requirement: To ensure security, this approach requires users to connect with a password.
* Authentication Methods: Only mysql_native_password and client_ed25519 authentication methods are currently supported.

===== How it Works:

* Self-Signed Certificates: The server can utilize a self-signed certificate, which doesn&#39;t require a trusted Certificate Authority (CA).
* Fingerprint Storage: The client connector needs to handle self-signed certificates. It first saves the SHA256 fingerprint of the server certificate.
* Server Validation: Upon connection, the server sends a special hash within the &#34;OK_Packet&#34; info field.
* Local Validation: The client generates a hash by combining the password hash, server seed, and the stored certificate fingerprint.
* Comparison: If the client-generated hash matches the server-sent hash, the connection is deemed secure and proceeds. Otherwise, the connection must be terminated for security reasons.

=== Initial session tracking

MySQL and MariaDB support session tracking with CLIENT_SESSION_TRACK capability set. 
On difference is that since MariaDB 11.5.1, connection ending OK_Packet list all the current variables of tracked variable. 

=== Collations

Connector doesn&#39;t care of collations, but normally wants to ensure charset in connection exchanges.

The only good solution is to use &lt;&lt;sql&gt;&gt;SET NAMES utf8mb4&lt;&lt;/sql&gt;&gt; or &lt;&lt;sql&gt;&gt;SET NAMES utf8mb4 COLLATE someUtf8mb4collation&lt;&lt;/sql&gt;&gt;

If supporting session tracking, connector can check if charset of initial tracked variable &#39;character_set_connection&#39; correspond to expected value, then permitting to skipping this SET NAMES command.


=== MySQL features not supported

* X protocol is not supported

Not supported features and associate capabilities:
* CLIENT_OPTIONAL_RESULTSET_METADATA: permit to set no METADATA at all for a connection. See [[#prepare-statement-skipping-metadata|Prepare statement skipping metadata]]&#39;s MariaDB implementation choice.
* CLIENT_QUERY_ATTRIBUTES adds some metadata attributes
* CLIENT_ZSTD_COMPRESSION_ALGORITHM permit to have a zstd compression 
* MULTI_FACTOR_AUTHENTICATION Multifactor Authentication capability.


=== TIPS

==== Identifying MariaDB server. 
MariaDB connectors use specific criteria to determine if a server is a MariaDB instance during the initial handshake process. 

The two key indicators used are:

* Missing CLIENT_MYSQL Capability: MariaDB 10.2 and newer versions do not set the CLIENT_MYSQL capability flag in the initial handshake packet.
* Server Version String: The server&#39;s version string is examined for the presence of the word &#34;mariadb&#34; (ignoring case sensitivity). 

The reason is some features like using COM_RESET_CONNECTION has no capability, and depends on MySQL or MariaDB server version. 

==== Pipelining Prepare Execute

Connectors usually follow a two-step process for prepared statements:

* Prepare: Send a  [[com_stmt_prepare/|COM_STMT_PREPARE]] command to the server, receiving a statement ID in response.
* Execute: Send a [[com_stmt_execute/|COM_STMT_EXECUTE]] command, using the statement ID obtained in the previous step.


When the server support MARIADB_CLIENT_STMT_BULK_OPERATIONS capability, a specific statement ID value of -1 (or 0xffffffff in hexadecimal) can be used to indicate that the previously prepared statement could be reused. This enables connectors to pipeline the preparation and execution steps into a single request:

* Send a  [[com_stmt_prepare/|COM_STMT_PREPARE]] then a [[com_stmt_execute/|COM_STMT_EXECUTE]] with statement ID -1 (0xffffffff) commands to the server.
* Read the prepare and execute responses


If the  [[com_stmt_prepare/|COM_STMT_PREPARE]] command returns an error (ERR_Packet), the subsequent [[com_stmt_execute/|COM_STMT_EXECUTE]] with statement ID -1 will also fail and return an error.

By eliminating the round trip for the separate COM_STMT_EXECUTE command, this approach improve performance for the first execution.

Traditionnally, connector sent [[com_stmt_prepare/|COM_STMT_PREPARE]], wait for results, then execute [[com_stmt_execute/|COM_STMT_EXECUTE]]  with statement_id received from prepare result. 
 
This description has been done for [[com_stmt_execute/|COM_STMT_EXECUTE]], but [[com_stmt_bulk_execute/|COM_STMT_BULK_EXECUTE]] works exactly the same way. 

==== Query timeout

Since MariaDB 10.1.2 (so all supported server have it), setting a timeout for all commands can be set using &lt;&lt;sql&gt;&gt;SET max_statement_time=XXX&lt;&lt;/sql&gt;&gt; with XXX in seconds.

Setting it for a specific query can be done using &lt;&lt;sql&gt;&gt;SET STATEMENT max_statement_time=XXX FOR ...&lt;&lt;/sql&gt;&gt;</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>