<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Installing and Using MariaDB via Docker - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Installing and Using MariaDB via Docker" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/installing-and-using-mariadb-via-docker/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Creating and managing a MariaDB Docker container." />

    <meta name="description" content="Creating and managing a MariaDB Docker container." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/installing-and-using-mariadb-via-docker/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/installing-and-using-mariadb-via-docker/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/getting-installing-and-upgrading-mariadb/">Getting, Installing, and Upgrading MariaDB</a>
    

    
    » <a class="crumb" href="/kb/en/binary-packages/">MariaDB Binary Packages</a>
    

    
    » <a class="crumb" href="/kb/en/automated-mariadb-deployment-and-administration/">Automated MariaDB Deployment and Administration</a>
    

    
    » <a class="crumb" href="/kb/en/docker-and-mariadb/">MariaDB Containers</a>
    


    » <a class="node_link crumb" href="/kb/en/installing-and-using-mariadb-via-docker/">Installing and Using MariaDB via Docker</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/installing-and-using-mariadb-via-docker/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/installing-and-using-mariadb-via-docker/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/installing-and-using-mariadb-via-docker/+flag"
                data-flag-url="/kb/en/installing-and-using-mariadb-via-docker/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/installing-and-using-mariadb-via-docker/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2015-08-13 13:57">9 years, 3 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2024-07-29 12:13">3 months, 3 weeks ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/installing-and-using-mariadb-via-docker/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/installing-and-using-mariadb-via-docker/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/installing-and-using-mariadb-via-docker/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/installing-and-using-mariadb-via-docker/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Installing and Using MariaDB via Docker</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
            <div class="cta">
                <div style="background: #C0E1E3;padding: 15px 25px;margin-bottom: 20px;border-radius:30px;">
        
    <div class="row">
        <div class="col-md-12 text-center">
            <h2 class="h3" style="font-size: 18px;">See MariaDB and Docker in action!</h2>
            
            <ul style="list-style: none;">
                
                <li>Set up web-based developer environments locally, and connect MariaDB to VS Code Server, CloudBeaver, PHP/Laravel and phpMyAdmin, using a single docker-compose command and configuration file.</li>
            </ul>
    <a class="btn btn-primary btn-lg" href="https://go.mariadb.com/24Q2-WBN-GLBL-2024-02-22-Develop-via-Docker_Registration-LP.html?utm_source=onpagepromo&utm_medium=kb&utm_campaign=webinar-develop-via-docker" style="padding: 12px 50px;margin-top: 15px;margin-bottom: 10px;" target="_blank">Watch the Webinar</a>
        </div>
        
    </div>
    </div>
            </div>
        
        
        


    
    <div class="answer formatted">
        <div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">

    <li class=""><a href="#installing-docker-on-your-system-with-the-universal-installation-script" title="Installing Docker on Your System with the Universal Installation Script">Installing Docker on Your System with the Universal Installation Script</a>    <ol class="toc">

        <li class=""><a href="#starting-dockerd" title="Starting dockerd">Starting dockerd</a>    </ol>
</li>

    <li class=""><a href="#using-mariadb-images" title="Using MariaDB Images">Using MariaDB Images</a>    <ol class="toc">

        <li class=""><a href="#downloading-an-image" title="Downloading an Image">Downloading an Image</a></li>

        <li class=""><a href="#creating-a-container" title="Creating a Container">Creating a Container</a></li>

        <li class=""><a href="#running-and-stopping-the-container" title="Running and Stopping the Container">Running and Stopping the Container</a>        <ol class="toc">

            <li class=""><a href="#automatic-restart" title="Automatic Restart">Automatic Restart</a></li>

            <li class=""><a href="#pausing-containers" title="Pausing Containers">Pausing Containers</a>        </ol>
</li>

        <li class=""><a href="#troubleshooting-a-container" title="Troubleshooting a Container">Troubleshooting a Container</a></li>

        <li class=""><a href="#accessing-the-container" title="Accessing the Container">Accessing the Container</a></li>

        <li class=""><a href="#connecting-to-mariadb-from-outside-the-container" title="Connecting to MariaDB from Outside the Container">Connecting to MariaDB from Outside the Container</a>        <ol class="toc">

            <li class=""><a href="#forcing-a-tcp-connection" title="Forcing a TCP Connection">Forcing a TCP Connection</a></li>

            <li class=""><a href="#port-configuration-for-clustered-containers-and-replication" title="Port Configuration for Clustered Containers and Replication">Port Configuration for Clustered Containers and Replication</a>        </ol>
    </ol>
</li>

    <li class=""><a href="#installing-mariadb-on-another-image" title="Installing MariaDB on Another Image">Installing MariaDB on Another Image</a>    <ol class="toc">

        <li class=""><a href="#daemonizing-the-operating-system" title="Daemonizing the Operating System">Daemonizing the Operating System</a></li>

        <li class=""><a href="#installing-mariadb" title="Installing MariaDB">Installing MariaDB</a>    </ol>
</li>

    <li class=""><a href="#see-also" title="See Also">See Also</a> </ol>
</li>
</div><p>
Sometimes we want to install a specific version of MariaDB, <a href="https://mariadb.com/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a>, or <a href="/kb/en/mariadb-maxscale/">MaxScale</a> on a certain system, but no packages are available. Or maybe, we simply want to isolate MariaDB from the rest of the system, to be sure that we won't cause any damage.</p>
<p>A virtual machine would certainly serve the scope. However, this means installing a system on the top of another system. It requires a lot of resources.</p>
<p>In many cases, the best solution is using containers. Docker is a framework that runs containers. A container is meant to run a specific daemon, and the software that is needed for that daemon to properly work. Docker does not virtualize a whole system; a container only includes the packages that are not included in the underlying system.</p>
<p>Docker requires a very small amount of resources. It can run on a virtualized system. It is used both in development and in production environments. Docker is an open source project, released under the Apache License, version 2.</p>
<p>Note that, while your package repositories could have a package called <code>docker</code>, it is probably not the Docker we are talking about. The Docker package could be called <code>docker.io</code> or <code>docker-engine</code>.</p>
<p>For information about installing Docker, see <a href="https://docs.docker.com/get-docker/">Get Docker</a> in Docker documentation.</p>
<h2 class="anchored_heading" id="installing-docker-on-your-system-with-the-universal-installation-script">Installing Docker on Your System with the Universal Installation Script</h2>
<p>The script below will install the Docker repositories, required kernel modules and packages on the most common Linux distributions:</p>
<pre class="fixed">curl -sSL https://get.docker.com/ | sh
</pre><h3 class="anchored_heading" id="starting-dockerd">Starting dockerd</h3>
<p>On some systems you may have to start the <code>dockerd daemon</code> yourself:</p>
<pre class="fixed">sudo systemctl start docker
sudo gpasswd -a &#34;${USER}&#34; docker
</pre><p>If you don't have <code>dockerd</code> running, you will get the following error for most <code>docker</code> commands:
installing-and-using-mariadb-via-docker
Cannot connect to the Docker daemon at unix:<em>/var/run/docker.sock. Is the docker daemon running?
&lt;&lt;/code&gt;&gt;</em></p>
<h2 class="anchored_heading" id="using-mariadb-images">Using MariaDB Images</h2>
<p>The easiest way to use MariaDB on Docker is choosing a MariaDB image and creating a container.</p>
<h3 class="anchored_heading" id="downloading-an-image">Downloading an Image</h3>
<p>You can download a MariaDB image for Docker from the <a href="https://hub.docker.com/_/mariadb/">Offical Docker MariaDB</a>, or choose another image that better suits your needs. You can search Docker Hub (the official set of repositories) for an image with this command:</p>
<pre class="fixed"> docker search mariadb
</pre><p>Once you have found an image that you want to use, you can download it via Docker. Some layers including necessary dependencies will be downloaded too. Note that, once a layer is downloaded for a certain image, Docker will not need to download it again for another image.</p>
<p>For example, if you want to install the default MariaDB image, you can type:</p>
<pre class="fixed">docker pull mariadb:10.4
</pre><p>This will install the 10.4 version. Versions 10.2, 10.3, 10.5 are also valid choices.</p>
<p>You will see a list of necessary layers. For each layer, Docker will say if it is already present, or its download progress.</p>
<p>To get a list of installed images:</p>
<pre class="fixed">docker images
</pre><h3 class="anchored_heading" id="creating-a-container">Creating a Container</h3>
<p>An image is not a running process; it is just the software needed to be launched. To run it, we must create a container first. The command needed to create a container can usually be found in the image documentation. For example, to create a container for the official MariaDB image:</p>
<pre class="fixed wrap">docker run --name mariadbtest -e MYSQL_ROOT_PASSWORD=mypass -p 3306:3306 -d docker.io/library/mariadb:10.3
</pre><p><code>mariadbtest</code> is the name we want to assign the container. If we don't specify a name, an id will be automatically generated.</p>
<p>10.2 and 10.5 are also valid target versions:</p>
<pre class="fixed wrap">docker run --name mariadbtest -e MYSQL_ROOT_PASSWORD=mypass -p 3306:3306 -d docker.io/library/mariadb:10.2
</pre><pre class="fixed wrap">docker run --name mariadbtest -e MYSQL_ROOT_PASSWORD=mypass -p 3306:3306  -d docker.io/library/mariadb:10.5
</pre><p>Optionally, after the image name, we can specify some <a href="/kb/en/mariadbd-options/">options for mariadbd</a>. For example:</p>
<pre class="fixed wrap">docker run --name mariadbtest -e MYSQL_ROOT_PASSWORD=mypass -p 3306:3306 -d mariadb:10.3 --log-bin --binlog-format=MIXED
</pre><p>Docker will respond with the container's id. But, just to be sure that the container has been created and is running, we can get a list of running containers in this way:</p>
<pre class="fixed">docker ps
</pre><p>We should get an output similar to this one:</p>
<pre class="fixed wrap">CONTAINER ID        IMAGE                      COMMAND                CREATED             STATUS              PORTS               NAMES
819b786a8b48        mariadb                    &#34;/docker-entrypoint.   4 minutes ago       Up 4 minutes        3306/tcp            mariadbtest        
</pre><h3 class="anchored_heading" id="running-and-stopping-the-container">Running and Stopping the Container</h3>
<p>Docker allows us to restart a container with a single command:</p>
<pre class="fixed">docker restart mariadbtest
</pre><p>The container can also be stopped like this:</p>
<pre class="fixed">docker stop mariadbtest
</pre><p>The container will not be destroyed by this command. The data will still live inside the container, even if MariaDB is not running. To restart the container and see our data, we can issue:</p>
<pre class="fixed">docker start mariadbtest
</pre><p>With <code>docker stop</code>, the container will be gracefully terminated: a <code>SIGTERM</code> signal will be sent to the <code>mariadbd</code> process, and Docker will wait for the process to shutdown before returning the control to the shell. However, it is also possible to set a timeout, after which the process will be immediately killed with a <code>SIGKILL</code>. Or it is possible to immediately kill the process, with no timeout.</p>
<pre class="fixed">docker stop --time=30 mariadbtest
docker kill mariadbtest
</pre><p>In case we want to destroy a container, perhaps because the image does not suit our needs, we can stop it and then run:</p>
<pre class="fixed">docker rm mariadbtest
</pre><p>Note that the command above does not destroy the data volume that Docker has created for /var/lib/mysql. If you want to destroy the volume as well, use:</p>
<pre class="fixed">docker rm -v mariadbtest
</pre><h4 class="anchored_heading" id="automatic-restart">Automatic Restart</h4>
<p>When we start a container, we can use the <code>--restart</code> option to set an automatic restart policy. This is useful in production.</p>
<p>Allowed values are:</p>
<ul start="1"><li><code>no</code>: No automatic restart.
</li><li><code>on-failure</code>: The container restarts if it exits with a non-zero exit code.
</li><li><code>unless-stopped</code>: Always restart the container, unless it was explicitly stopped as shown above.
</li><li><code>always</code>: Similar to <code>unless-stopped</code>, but when Docker itself restarts, even containers that were explicitly stopped will restart.
</li></ul>
<p>It is possible to change the restart policy of existing, possibly running containers:</p>
<pre class="fixed">docker update --restart always mariadb
# or, to change the restart policy of all containers:
docker update --restart always $(docker ps -q)
</pre><p>A use case for changing the restart policy of existing containers is performing maintenance in production. For example, before upgrading the Docker version, we may want to change all containers restart policy to <code>always</code>, so they will restart as soon as the new version is up and running. However, if some containers are stopped and not needed at the moment, we can change their restart policy to <code>unless-stopped</code>.</p>
<h4 class="anchored_heading" id="pausing-containers">Pausing Containers</h4>
<p>A container can also be frozen with the <code>pause</code> command.  Docker will freeze the process using croups. MariaDB will not know that it is being frozen and, when we <code>unpause</code> it, MariaDB will resume its work as expected.</p>
<p>Both <code>pause</code> and <code>unpause</code> accept one or more container names. So, if we are running a cluster, we can freeze and resume all nodes simultaneously:</p>
<pre class="fixed">docker pause node1 node2 node3
docker unpause node1 node2 node3
</pre><p>Pausing a container is very useful when we need to temporarily free our system's resources. If the container is not crucial at this moment (for example, it is performing some batch work), we can free it to allow other programs to run faster.</p>
<h3 class="anchored_heading" id="troubleshooting-a-container">Troubleshooting a Container</h3>
<p>If the container doesn't start, or is not working properly, we can investigate with the following command:</p>
<pre class="fixed">docker logs mariadbtest
</pre><p>This command shows what the daemon sent to the stdout since the last attempt of starting - the text that we typically see when we invoke <code>mariadbd</code> from the command line.</p>
<p>On some systems, commands such as <code>docker stop mariadbtest</code> and <code>docker restart mariadbtest</code> may fail with a permissions error. This can be caused by AppArmor, and even <code>sudo</code> won't allow you to execute the command. In this case, you will need to find out which profile is causing the problem and correct it, or disable it. <strong>Disabling AppArmor altogether is not recommended, especially in production.</strong></p>
<p>To check which operations were prevented by AppArmor, see <a href="https://gitlab.com/apparmor/apparmor/-/wikis/AppArmor_Failures">AppArmor Failures</a> in AppArmor documentation.</p>
<p>To disable a profile, create a symlink with the profile name (in this example, <code>mariadbd</code>) to <code>etc/apparmor.d/disable</code>, and then reload profiles:</p>
<pre class="fixed">ln -s /etc/apparmor.d/usr.sbin.mariadbd /etc/apparmor.d/disable/
sudo apparmor_parser -R /etc/apparmor.d/usr.sbin.mariadbd
</pre><p>For more information, see <a href="https://gitlab.com/apparmor/apparmor/-/wikis/Policy_Layout">Policy Layout</a> in AppArmor documentation.</p>
<p>After disabling the profile, you may need to run:</p>
<pre class="fixed">sudo service docker restart
docker system prune --all --volumes
</pre><p>Restarting the system will then allow Docker to operate normally.</p>
<h3 class="anchored_heading" id="accessing-the-container">Accessing the Container</h3>
<p>To access the container via Bash, we can run this command:</p>
<pre class="fixed">docker exec -it mariadbtest bash
</pre><p>Now we can use normal Linux commands like <em>cd</em>, <em>ls</em>, etc. We will have root privileges. We can even install our favorite file editor, for example:</p>
<pre class="fixed">apt-get update
apt-get install vim
</pre><p>In some images, no repository is configured by default, so we may need to add them.</p>
<p>Note that if we run <a href="/kb/en/mariadb-admin/#mariadb-admin-commands">mariadb-admin shutdown</a> or the <a href="/kb/en/shutdown/">SHUTDOWN</a> command to stop the container, the container will be deactivated, and we will automatically exit to our system.</p>
<h3 class="anchored_heading" id="connecting-to-mariadb-from-outside-the-container">Connecting to MariaDB from Outside the Container</h3>
<p>If we try to connect to the MariaDB server on <code>localhost</code>, the client will bypass networking and attempt to connect to the server using a socket file in the local filesystem. However, this doesn't work when MariaDB is running inside a container because the server's filesystem is isolated from the host. The client can't access the socket file which is inside the container, so it fails to connect.</p>
<p>Therefore connections to the MariaDB server must be made using TCP, even when the client is running on the same machine as the server container.</p>
<p>Find the IP address that has been assigned to the container:</p>
<pre class="fixed">docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' mariadbtest
</pre><p>You can now connect to the MariaDB server using a TCP connection to that IP address.</p>
<h4 class="anchored_heading" id="forcing-a-tcp-connection">Forcing a TCP Connection</h4>
<p>After enabling network connections in MariaDB as described above, we will be able to connect to the server from outside the container.</p>
<p>On the host, run the client and set the server address ("-h") to the container's IP address that you found in the previous step:</p>
<pre class="fixed">mysql -h 172.17.0.2 -u root -p
</pre><p>This simple form of the connection should work in most situations. Depending on your configuration, it may also be necessary to specify the port for the server or to force TCP mode:</p>
<pre class="fixed">mysql -h 172.17.0.2 -P 3306 --protocol=TCP -u root -p
</pre><h4 class="anchored_heading" id="port-configuration-for-clustered-containers-and-replication">Port Configuration for Clustered Containers and Replication</h4>
<p>Multiple MariaDB servers running in separate Docker containers can connect to each other using TCP. This is useful for forming a Galera cluster or for replication.</p>
<p>When running a cluster or a replication setup via Docker, we will want the containers to use different ports. The fastest way to achieve this is mapping the containers ports to different port on our system. We can do this when creating the containers (<code>docker run</code> command), by using the <code>-p</code> option, several times if necessary. For example, for Galera nodes we will use a mapping similar to this one:</p>
<pre class="fixed">-p 4306:3306 -p 5567:5567 -p 5444:5444 -p 5568:5568
</pre><h2 class="anchored_heading" id="installing-mariadb-on-another-image">Installing MariaDB on Another Image</h2>
<p>It is possible to download a Linux distribution image, and to install MariaDB on it. This is not much harder than installing MariaDB on a regular operating system (which is easy), but it is still the hardest option. Normally we will try existing images first. However, it is possible that no image is available for the exact version we want, or we want a custom installation, or perhaps we want to use a distribution for which no images are available. In these cases, we will install MariaDB in an operating system image.</p>
<h3 class="anchored_heading" id="daemonizing-the-operating-system">Daemonizing the Operating System</h3>
<p>First, we need the system image to run as a daemon. If we skip this step, MariaDB and all databases will be lost when the container stops.</p>
<p>To demonize an image, we need to give it a command that never ends. In the following example, we will create a Debian Jessie daemon that constantly pings the 8.8.8.8 special address:</p>
<pre class="fixed wrap">docker run --name debian -p 3306:3306 -d debian /bin/sh -c &#34;while true; do ping 8.8.8.8; done&#34;
</pre><h3 class="anchored_heading" id="installing-mariadb">Installing MariaDB</h3>
<p>At this point, we can enter the shell and issue commands. First we will need to update the repositories, or no packages will be available. We can also update the packages, in case some of them are newer than the image. Then, we will need to install a text editor; we will need it to edit configuration files. For example:</p>
<pre class="fixed"># start an interactive Bash session in the container
docker exec -ti debian bash
apt-get -y update
apt-get -y upgrade
apt-get -y install vim
</pre><p>Now we are ready to <a href="/kb/en/getting-installing-and-upgrading-mariadb/">install MariaDB</a> in the way we prefer.</p>
<h2 class="anchored_heading" id="see-also">See Also</h2>
<ul start="1"><li><a href="https://go.mariadb.com/GLBL-WBN_2018-10-09-MariaDB_Containers.html">Official MariaDB Docker Images Webinar</a>.
</li><li><a href="https://www.docker.com/">Docker official site</a>.
</li><li><a href="https://hub.docker.com/">Docker Hub</a>.
</li><li><a href="https://docs.docker.com/">Docker documentation</a>.</li></ul>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/installing-and-using-mariadb-via-docker/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/installing-and-using-mariadb-via-docker/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/benefits-of-managing-mariadb-containers-with-orchestration-software/">
                        ← Benefits of Managing MariaDB Containers with Orchestration Software
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/mariadb-containers/">
                        ↑ MariaDB Containers ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/container-backup-and-restoration/">
                        Container Backup and Restoration →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="5152" data-comments-url="/kb/en/installing-and-using-mariadb-via-docker/+comments"
         data-reply-url="/kb/en/installing-and-using-mariadb-via-docker/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/mariadb-containers/">
                    ↑ MariaDB Containers ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/benefits-of-managing-mariadb-containers-with-orchestration-software/">
                            
                            Benefits of Managing MariaDB Containers with Orchestration Software
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>Installing and Using MariaDB via Docker</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/container-backup-and-restoration/">
                            
                            Container Backup and Restoration
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/container-security-concerns/">
                            
                            Container Security Concerns
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/adding-plugins-to-the-mariadb-docker-official-image/">
                            
                            Adding Plugins to the MariaDB Docker Official Image
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/setting-up-a-lamp-stack-with-docker-compose/">
                            
                            Setting Up a LAMP Stack with Docker Compose
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/creating-a-custom-container-image/">
                            
                            Creating a Custom Container Image
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-server-docker-official-image-environment-variables/">
                            
                            MariaDB Server Docker Official Image Environment Variables
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/running-mariadb-columnstore-containers-on-linux-windows-and-macos/">
                            <span class="pull-right not_primary"></span>
                            Running MariaDB ColumnStore containers on Linux, Windows and MacOS
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/docker-official-image-frequently-asked-questions/">
                            
                            Docker Official Image Frequently Asked Questions
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-container-cheat-sheet/">
                            
                            MariaDB Container Cheat Sheet
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/using-healthcheck-sh/">
                            
                            Using Healthcheck.sh
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/docker-and-aws-ec2/">
                            
                            Docker and AWS EC2
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/docker-and-google-cloud/">
                            
                            Docker and Google Cloud
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/docker-and-microsoft-azure/">
                            
                            Docker and Microsoft Azure
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>