<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>CONNECT MONGO Table Type: Accessing Collections from MongoDB - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.b9e1e104f007.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="CONNECT MONGO Table Type: Accessing Collections from MongoDB - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/connect-mongo-table-type/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/connect-mongo-table-type/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/connect-mongo-table-type/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/connect/">CONNECT</a>
    

    
    » <a class="crumb" href="/kb/en/connect-table-types/">CONNECT Table Types</a>
    


    » <a class="node_link crumb" href="/kb/en/connect-mongo-table-type/">CONNECT MONGO Table Type: Accessing Collections from MongoDB</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/connect-mongo-table-type/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>CONNECT MONGO Table Type: Accessing Collections from MongoDB - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/connect-mongo-table-type/+r/125993/">125993</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-1368">
<a href="/kb/user/id/1368" title="Ian Gilfillan">Ian Gilfillan</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2023-05-22 16:45">2023-05-22 16:45</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;

Classified as a NoSQL database program, MongoDB uses JSON-like documents (BSON) grouped in collections. The MONGO type is used to directly access MongoDB collections as tables. 

== Accessing MongDB from CONNECT
Accessing MongoDB from CONNECT can be done in different ways:

# As a MONGO table via the MongoDB C Driver.
# As a MONGO table via the MongoDB Java Driver.
# As a JDBC table using some commercially available MongoDB JDBC drivers.
# As a JSON table via the MongoDB C or Java Driver.

==== Using the MongoDB C Driver
This is currently not available from binary distributions but only for versions compiled from source. The preferred version of the MongoDB C Driver is 1.7, because they provide package recognition. What must be done is:

# Install libbson and the MongoDB C Driver 1.7.
# Configure, compile and install MariaDB.

With earlier versions of the Mongo C Driver, the additional include directories and libraries will have to be specified manually when compiling.

When possible, this is the preferred means of access because it does not require all the Java path settings etc. and is faster than using the Java driver.

==== Using the Mongo Java Driver
This is possible with all distributions including JDBC support, or compiling from source. With a binary distribution that does not enable the MONGO table type, it is possible to access MongoDB using an OEM module. See [[connect-oem-table-example|CONNECT OEM Table Example]] for details. The only additional things to do are:

# Install the MongoDB Java Driver by downloading its jar file. Several versions are available. If possible use the latest version 3 one.
# Add the path to it in the CLASSPATH environment variable or in the connect_class_path variable. This is like what is done to declare JDBC drivers.

Connection is established by new Java wrappers Mongo3Interface and Mongo2Interface. They are available in a JDBC distribution in the Mongo2.jar and Mongo3.jar files (previously JavaWrappers.jar). If version 2 of the Java Driver is used, specify “Version=2” in the option list when creating tables.

==== Using JDBC
See the documentation of the existing commercial JDBC Mongo drivers.

==== Using JSON
See the specific chapter of the JSON Table Type.

The following describes the MONGO table type.

== CONNECT MONGO Tables
Creating and running MONGO tables requires a connection to a running local or remote MongoDB server.

A MONGO table is defined to access a MongoDB collection. The table rows will be the collection documents. For instance, to create a table based on the MongoDB sample collection restaurants, you can do something such as the following:

&lt;&lt;sql&gt;&gt;
create table resto (
_id varchar(24) not null,
name varchar(64) not null,
cuisine char(200) not null,
borough char(16) not null,
restaurant_id varchar(12) not null)
engine=connect table_type=MONGO tabname=&#39;restaurants&#39;
data_charset=utf8 connection=&#39;mongodb://localhost:27017&#39;;
&lt;&lt;/sql&gt;&gt;

Note: The used driver is by default the C driver if only the MongoDB C Driver is installed and the Java driver if only the MongoDB Java Driver is installed. If both are available, it can be specified by the DRIVER option to be specified in the option list and defaults to C.

Here we did not define all the items of the collection documents but only those that are JSON values. The database is test by default. The connection value is the URI used to establish a connection to a local or remote MongoDB server. The value shown in this example corresponds to a local server started with its default port. It is the default connection value for MONGO tables so we could have omit specifying it.

Using discovery is available. This table could have been created by:

&lt;&lt;sql&gt;&gt;
create table resto
engine=connect table_type=MONGO tabname=&#39;restaurants&#39;
data_charset=utf8 option_list=&#39;level=-1&#39;;
&lt;&lt;/sql&gt;&gt;

Here “depth=-1” is used to create only columns that are simple values (no array or object). Without this, with the default value “depth=0” the table had been created as:

&lt;&lt;code wrap=true lang=sql&gt;&gt;
CREATE TABLE `resto` (
  `_id` char(24) NOT NULL,
  `address` varchar(136) NOT NULL,
  `borough` char(13) NOT NULL,
  `cuisine` char(64) NOT NULL,
  `grades` varchar(638) NOT NULL,
  `name` char(98) NOT NULL,
  `restaurant_id` char(8) NOT NULL
) ENGINE=CONNECT DEFAULT CHARSET=latin1 `TABLE_TYPE`=&#39;MONGO&#39; `TABNAME`=&#39;restaurants&#39; `DATA_CHARSET`=&#39;utf8&#39;;
&lt;&lt;/code&gt;&gt;

=== Fixing Problems With mariadb-dump
In some case or some platforms, when CONNECT is set up for use with JDBC table types, this causes [[mariadb-dump]] with the --all-databases option to fail.

This was reported by Robert Dyas who found the cause of it and how to fix it (see MDEV-11238).

This occurs when the Java JRE “Usage Tracker” is enabled. In that case, Java creates a directory #mysql50#.oracle_jre_usage in the mysql data directory that shows up as a database but cannot be accessed via MySQL Workbench nor apparently backed up by mariadb-dump --all-databases.

Per the Oracle documentation (https://docs.oracle.com/javacomponents/usage-tracker/overview/) the 
“Usage Tracker” is disabled by default. It is enabled only when creating the properties file &lt;JRE directory&gt;/lib/management/usagetracker.properties. This turns out to be WRONG on some platforms as the file does exist by default on a new installation, and the existence of this file enables the usage tracker.

The solution on CentOS 7 with the Oracle JVM is to rename or delete the usagetracker.properties file (to disable it) and then delete the bogus folder it created in the mysql database directory, then restart.

For example, the following works:

&lt;&lt;code wrap=true&gt;&gt;
sudo mv /usr/java/default/jre/lib/management/management.properties /usr/java/default/jre/lib/management/management.properties.TRACKER-OFF
sudo reboot
sudo rm -rf  /var/lib/mysql/.oracle_jre_usage
sudo reboot
&lt;&lt;/code&gt;&gt;

In this collection, the address column is a JSON object and the column grades is a JSON array. Unlike the JSON table, just specifying the column name with no Jpath result in displaying the JSON representation of them. For instance:

&lt;&lt;sql&gt;&gt;
select name, address from resto limit 3;
&lt;&lt;/sql&gt;&gt;

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= name |= address
| Morris Park Bake Shop | {&#34;building&#34;:&#34;1007&#34;,&#34;coord&#34;:[-73.8561,40.8484], &#34;street&#34;:&#34;Morris ParkAve&#34;, &#34;zipcode&#34;:&#34;10462&#34;}
| Wendy&#39;S | {&#34;building&#34;:&#34;469&#34;,&#34;coord&#34;:[-73.9617,40.6629], &#34;street&#34;:&#34;Flatbush Avenue&#34;, &#34;zipcode&#34;:&#34;11225&#34;}
| Reynolds Restaurant | {&#34;building&#34;:&#34;351&#34;,&#34;coord&#34;:[-73.9851,40.7677], &#34;street&#34;:&#34;West 57Street&#34;, &#34;zipcode&#34;:&#34;10019&#34;}
&lt;&lt;/style&gt;&gt;

===MongoDB Dot Notation
To address the items inside object or arrays, specify the Jpath in MongoDB syntax (if using Discovery, specify the Depth option accordingly):

From Connect 1.7.0002
&lt;&lt;sql&gt;&gt;
create table newresto (
_id varchar(24) not null,
name varchar(64) not null,
cuisine char(200) not null,
borough char(16) not null,
street varchar(65) jpath=&#39;address.street&#39;,
building char(16) jpath=&#39;address.building&#39;,
zipcode char(5) jpath=&#39;address.zipcode&#39;,
grade char(1) jpath=&#39;grades.0.grade&#39;,
score int(4) not null jpath=&#39;grades.0.score&#39;, 
`date` date jpath=&#39;grades.0.date&#39;,
restaurant_id varchar(255) not null)
engine=connect table_type=MONGO tabname=&#39;restaurants&#39;
data_charset=utf8 connection=&#39;mongodb://localhost:27017&#39;;
&lt;&lt;/sql&gt;&gt;

Before Connect 1.7.0002
&lt;&lt;sql&gt;&gt;
create table newresto (
_id varchar(24) not null,
name varchar(64) not null,
cuisine char(200) not null,
borough char(16) not null,
street varchar(65) field_format=&#39;address.street&#39;,
building char(16) field_format=&#39;address.building&#39;,
zipcode char(5) field_format=&#39;address.zipcode&#39;,
grade char(1) field_format=&#39;grades.0.grade&#39;,
score int(4) not null field_format=&#39;grades.0.score&#39;, 
`date` date field_format=&#39;grades.0.date&#39;,
restaurant_id varchar(255) not null)
engine=connect table_type=MONGO tabname=&#39;restaurants&#39;
data_charset=utf8 connection=&#39;mongodb://localhost:27017&#39;;
&lt;&lt;/sql&gt;&gt;
If this is not done, the Oracle JVM will start the usage tracker, which will create the hidden folder .oracle_jre_usage in the mysql home directory, which will cause a mariadb-dump of the server to fail. 

&lt;&lt;sql&gt;&gt;
select name, street, score, date from newresto limit 5;
&lt;&lt;/sql&gt;&gt;

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= name |= street |= score |= date
| Morris Park Bake Shop | Morris Park Ave | 2 | 03/03/2014
| Wendy&#39;S | Flatbush Avenue | 8 | 30/12/2014
| Dj Reynolds Pub And Restaurant | West 57 Street | 2 | 06/09/2014
| Riviera Caterer | Stillwell Avenue | 5 | 10/06/2014
| Tov Kosher Kitchen | 63 Road | 20 | 24/11/2014
&lt;&lt;/style&gt;&gt;

== MONGO Specific Options

The MongoDB syntax for Jpath does not allow the CONNECT specific items on arrays. The same effect can still be obtained by a different way. For this, additional options are used when creating MONGO tables.

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Option |= Type |= Description
| Colist | String | Options to pass to the MongoDB cursor.
| Filter | String | Query used by the MongoDB cursor.
| Pipeline* | Boolean | If True, Colist is a pipeline.
| Fullarray* | Boolean | Used when creating with Discovery.
| Driver* | String | C or Java.
| Version* | Integer | The Java Driver version (defaults to 3)
&lt;&lt;/style&gt;&gt;

*: To be specified in the option list.

Note: For the content of these options, refer to the MongoDB documentation.

=== Colist Option
Used to pass different options when making the MongoDB cursor used to retrieve the collation documents. One of them is the projection, allowing to limit the items retrieved in documents. It is hardly useful because this limitation is made automatically by CONNECT. However, it can be used when using discovery to eliminate the _id (or another) column when you are not willing to keep it:

&lt;&lt;sql&gt;&gt;
create table restest
engine=connect table_type=MONGO tabname=&#39;restaurants&#39;
data_charset=utf8 option_list=&#39;depth=-1&#39;
colist=&#39;{&#34;projection&#34;:{&#34;_id&#34;:0},&#34;limit&#34;:5}&#39;;
&lt;&lt;/sql&gt;&gt;

In this example, we added another cursor option, the limit option that works like the limit SQL clause.

This additional option works only with the C driver. When using the Java driver, colist should be:

&lt;&lt;code&gt;&gt;
colist=&#39;{&#34;_id&#34;:0}&#39;;
&lt;&lt;/code&gt;&gt;

And limit would be specified with select statements.

Note: When used with a JSON table, to specify the projection list (or ‘all’ to get all columns) makes JPATH to be Connect Json paths, not MongoDB ones, allowing JPATH options not available to MongoDB.

=== Filter Option 
This option is used to specify a “filter” that works as a where clause on the table. Supposing we want to create a table restricted to the restaurant making English cuisine that are not located in the Manhattan borough, we can do it by:

&lt;&lt;sql&gt;&gt;
create table english
engine=connect table_type=MONGO tabname=&#39;restaurants&#39;
data_charset=utf8
colist=&#39;{&#34;projection&#34;:{&#34;cuisine&#34;:0}}&#39;
filter=&#39;{&#34;cuisine&#34;:&#34;English&#34;,&#34;borough&#34;:{&#34;$ne&#34;:&#34;Manhattan&#34;}}&#39;
option_list=&#39;Depth=-1&#39;;
&lt;&lt;/sql&gt;&gt;

And if we ask:

&lt;&lt;sql&gt;&gt;
select * from english;
&lt;&lt;/sql&gt;&gt;

This query will return:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= _id |= borough |= name |= restaurant_id
| 58ada47de5a51ddfcd5ee1f3 | Brooklyn | The Park Slope Chipshop | 40816202
| 58ada47de5a51ddfcd5ee999 | Brooklyn | Chip Shop | 41076583 
| 58ada47ee5a51ddfcd5f13d5 | Brooklyn | The Monro | 41660253
| 58ada47ee5a51ddfcd5f176e | Brooklyn | Dear Bushwick | 41690534
| 58ada47ee5a51ddfcd5f1e91 | Queens | Snowdonia Pub | 50000290
&lt;&lt;/style&gt;&gt;

=== Pipeline Option
When this option is specified as true (by YES or 1) the Colist option contains a MongoDB pipeline applying to the table collation. This is a powerful mean for doing things such as expanding arrays like we do with JSON tables. For instance:

&lt;&lt;code wrap=true lang=sql&gt;&gt;
create table resto2 (
name varchar(64) not null,
borough char(16) not null,
date datetime not null,
grade char(1) not null,
score int(4) not null)
engine=connect table_type=MONGO tabname=&#39;restaurants&#39; data_charset=utf8
colist=&#39;{&#34;pipeline&#34;:[{&#34;$match&#34;:{&#34;cuisine&#34;:&#34;French&#34;}},{&#34;$unwind&#34;:&#34;$grades&#34;},{&#34;$project&#34;:{&#34;_id&#34;:0,&#34;name&#34;:1,&#34;borough&#34;:1,&#34;date&#34;:&#34;$grades.date&#34;,&#34;grade&#34;:&#34;$grades.grade&#34;,&#34;score&#34;:&#34;$grades.score&#34;}}]}&#39;
option_list=&#39;Pipeline=1&#39;;
&lt;&lt;/code&gt;&gt;

In this pipeline “$match” is an early filter, “$unwind” means that the grades array will be expanded (one Document for each array values) and “$project” eliminates the _id and cuisine columns and gives the Jpath for the date, grade and score columns.

&lt;&lt;sql&gt;&gt;
select name, grade, score, date from resto2
where borough = &#39;Bronx&#39;;
&lt;&lt;/sql&gt;&gt;

This query replies:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= name |= grade |= score |= date
| Bistro Sk | A | 10 | 21/11/2014 01:00:00
| Bistro Sk | A | 12 | 19/02/2014 01:00:00
| Bistro Sk | B | 18 | 12/06/2013 02:00:00
&lt;&lt;/style&gt;&gt;

This make possible to get things like we do with JSON tables:

&lt;&lt;sql&gt;&gt;
select name, avg(score) average from resto2
group by name having average &gt;= 25;
&lt;&lt;/sql&gt;&gt;

Can be used to get the average score inside the grades array.

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= name |= average
| Bouley Botanical | 25,0000
 | Cheri | 46,0000
| Graine De Paris | 30,0000
| Le Pescadeux | 29,7500
&lt;&lt;/style&gt;&gt;

=== Fullarray Option
This option, like the Depth option, is only interpreted when creating a table with Discovery (meaning not specifying the columns). It tells CONNECT to generate a column for all existing values in the array. For instance, let us see the MongoDB collection tar by:

From Connect 1.7.0002
&lt;&lt;sql&gt;&gt;
create table seetar (
Collection varchar(300) not null jpath=&#39;*&#39;)
engine=CONNECT table_type=MONGO tabname=tar;
&lt;&lt;/sql&gt;&gt;

Before Connect 1.7.0002
&lt;&lt;sql&gt;&gt;
create table seetar (
Collection varchar(300) not null field_format=&#39;*&#39;)
engine=CONNECT table_type=MONGO tabname=tar;
&lt;&lt;/sql&gt;&gt;

The format ‘*’ indicates we want to see the Json documents. This small collection is:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Collection
| {&#34;_id&#34;:{&#34;$oid&#34;:&#34;58f63a5099b37d9c930f9f3b&#34;},&#34;item&#34;:&#34;journal&#34;,&#34;prices&#34;:[87.0,45.0,63.0,12.0,78.0]}
| {&#34;_id&#34;:{&#34;$oid&#34;:&#34;58f63a5099b37d9c930f9f3c&#34;},&#34;item&#34;:&#34;notebook&#34;,&#34;prices&#34;:[123.0,456.0,789.0]}
&lt;&lt;/style&gt;&gt;

The Fullarray option can be used here to generate enough columns to see all the prices of the document prices array.

&lt;&lt;sql&gt;&gt;
create table tar
engine=connect table_type=MONGO
colist=&#39;{&#34;projection&#34;:{&#34;_id&#34;:0}}&#39;
option_list=&#39;depth=1,Fullarray=YES&#39;;
&lt;&lt;/sql&gt;&gt;

The table has been created as:

From Connect 1.7.0002
&lt;&lt;code lang=sql wrap=true&gt;&gt;
CREATE TABLE `tar` (
  `item` char(8) NOT NULL,
  `prices_0` double(12,6) NOT NULL `JPATH`=&#39;prices.0&#39;,
  `prices_1` double(12,6) NOT NULL `JPATH`=&#39;prices.1&#39;,
  `prices_2` double(12,6) NOT NULL `JPATH`=&#39;prices.2&#39;,
  `prices_3` double(12,6) DEFAULT NULL `JPATH`=&#39;prices.3&#39;,
  `prices_4` double(12,6) DEFAULT NULL `JPATH`=&#39;prices.4&#39;
) ENGINE=CONNECT DEFAULT CHARSET=latin1 `TABLE_TYPE`=&#39;MONGO&#39; `COLIST`=&#39;{&#34;projection&#34;:{&#34;_id&#34;:0}}&#39; `OPTION_LIST`=&#39;depth=1,Fullarray=YES&#39;;
&lt;&lt;/code&gt;&gt;

Before Connect 1.7.0002
&lt;&lt;code lang=sql wrap=true&gt;&gt;
CREATE TABLE `tar` (
  `item` char(8) NOT NULL,
  `prices_0` double(12,6) NOT NULL `FIELD_FORMAT`=&#39;prices.0&#39;,
  `prices_1` double(12,6) NOT NULL `FIELD_FORMAT`=&#39;prices.1&#39;,
  `prices_2` double(12,6) NOT NULL `FIELD_FORMAT`=&#39;prices.2&#39;,
  `prices_3` double(12,6) DEFAULT NULL `FIELD_FORMAT`=&#39;prices.3&#39;,
  `prices_4` double(12,6) DEFAULT NULL `FIELD_FORMAT`=&#39;prices.4&#39;
) ENGINE=CONNECT DEFAULT CHARSET=latin1 `TABLE_TYPE`=&#39;MONGO&#39; `COLIST`=&#39;{&#34;projection&#34;:{&#34;_id&#34;:0}}&#39; `OPTION_LIST`=&#39;level=1,Fullarray=YES&#39;;
&lt;&lt;/code&gt;&gt;

And is displayed as:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= item |= prices_0 |= prices_1 |= prices_2 |= prices_3 |= prices_4
| journal | 87.00 | 45.00 | 63.00 | 12.00 | 78.00
| notebook | 123.00 | 456.00 | 789.00 | NULL | NULL
&lt;&lt;/style&gt;&gt;

== Create, Read, Update and Delete Operations
All modifying operations are supported. However, inserting into arrays must be done in a specific way. Like with the Fullarray option, we must have enough columns to specify the array values. For instance, we can create a new table by:


From Connect 1.7.0002
&lt;&lt;sql&gt;&gt;
create table testin (
n int not null,
m char(12) not null,
surname char(16) not null jpath=&#39;person.name.first&#39;,
name char(16) not null jpath=&#39;person.name.last&#39;,
age int(3) not null jpath=&#39;person.age&#39;,
price_1 double(8,2) jpath=&#39;d.0&#39;,
price_2 double(8,2) jpath=&#39;d.1&#39;,
price_3 double(8,2) jpath=&#39;d.2&#39;)
engine=connect table_type=MONGO tabname=&#39;tin&#39;
connection=&#39;mongodb://localhost:27017&#39;;
&lt;&lt;/sql&gt;&gt;

Before Connect 1.7.0002
&lt;&lt;sql&gt;&gt;
create table testin (
n int not null,
m char(12) not null,
surname char(16) not null field_format=&#39;person.name.first&#39;,
name char(16) not null field_format=&#39;person.name.last&#39;,
age int(3) not null field_format=&#39;person.age&#39;,
price_1 double(8,2) field_format=&#39;d.0&#39;,
price_2 double(8,2) field_format=&#39;d.1&#39;,
price_3 double(8,2) field_format=&#39;d.2&#39;)
engine=connect table_type=MONGO tabname=&#39;tin&#39;
connection=&#39;mongodb://localhost:27017&#39;;
&lt;&lt;/sql&gt;&gt;

Now it is possible to populate it by:

&lt;&lt;sql&gt;&gt;
insert into testin values
(1789, &#39;Welcome&#39;, &#39;Olivier&#39;,&#39;Bertrand&#39;,56, 3.14, 2.36, 8.45),
(1515, &#39;Hello&#39;, &#39;John&#39;,&#39;Smith&#39;,32, 65.17, 98.12, NULL),
(2014, &#39;Coucou&#39;, &#39;Foo&#39;,&#39;Bar&#39;,20, -1.0, 74, 81356);
&lt;&lt;/sql&gt;&gt;

The result will be:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|=n |= m |= surname |= name |= age |= price_1 |= price_2 |= price_3
| 1789 | Welcome | Olivier | Bertrand | 56 | 3,14 | 2,36 | 8,45 
| 1515 | Hello | John | Smith | 32 | 65,17 | 98,12 | NULL
| 2014 | Coucou | Foo | Bar | 20 | -1 | 74 | 81356
&lt;&lt;/style&gt;&gt;

Note: If the collection does not exist yet when creating the table and inserting in it, MongoDB creates it automatically.

It can be updated by queries such as:

&lt;&lt;sql&gt;&gt;
update tintin set price_3 = 83.36 where n = 2014;
&lt;&lt;/sql&gt;&gt;

To look how the array is generated, let us create another table:

From Connect 1.7.0002
&lt;&lt;sql&gt;&gt;
create table tintin (
n int not null,
name char(16) not null jpath=&#39;person.name.first&#39;,
prices varchar(255) jpath=&#39;d&#39;)
engine=connect table_type=MONGO tabname=&#39;tin&#39;;
&lt;&lt;/sql&gt;&gt;

Before Connect 1.7.002
&lt;&lt;sql&gt;&gt;
create table tintin (
n int not null,
name char(16) not null field_format=&#39;person.name.first&#39;,
prices varchar(255) field_format=&#39;d&#39;)
engine=connect table_type=MONGO tabname=&#39;in&#39;;
&lt;&lt;/sql&gt;&gt;

This table is displayed as:

From Connect 1.7.0002
&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= n |= name |= prices
| 1789 | Olivier | [3.1400000000000001243,2.3599999999999998757,8.4499999999999992895]
| 1515 | John | [65.170000000000001705,98.120000000000004547,null]
| 2014 | Foo | [null,74.0,83.359999999999999432]
&lt;&lt;/style&gt;&gt;

Before Connect 1.7.002
&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= n |= name |= prices
| 1789 | Olivier | [3.14, 2.36, 8.45]
| 1515 | John | [65.17, 98.12]
| 2014 | Foo | [&lt;null&gt;, 74.0, 83.36]
&lt;&lt;/style&gt;&gt;

Note: This last table can be used to make array calculations like with JSON tables using the JSON UDF functions. For instance:

&lt;&lt;sql&gt;&gt;
select name, jsonget_real(prices,&#39;[+]&#39;) sum_prices, jsonget_real(prices,&#39;[!]&#39;) avg_prices from tintin;
&lt;&lt;/sql&gt;&gt;

This query returns:
&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= name |= sum_prices |= avg_prices
| Olivier | 13.95 | 4.65
| John | 163.29 | 81.64
| Foo | 157,36 | 78.68
&lt;&lt;/style&gt;&gt;

Note: When calculating on arrays, null values are ignored.

== Status of MONGO Table Type
This table type is still under development. It has significant advantages over the JSON type to access MongoDB collections. Firstly, the access being direct, tables are always up to date whether the collection has been modified by another application. Performance wise, it can be faster than JSON, because most processing is done by MongoDB on BSON, its internal representation of JSON data, which is designed to optimize all operations. Note that using the MongoDB C Driver can be faster than using the MongoDB Java Driver.

== Current Restrictions
* Option “CATFUNC=tables” is not implemented yet.
* Options SRCDEF and EXECSRC do not apply to MONGO tables.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>