<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Pluggable Authentication Overview - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Pluggable Authentication Overview - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/pluggable-authentication-overview/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/pluggable-authentication-overview/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/pluggable-authentication-overview/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/plugins/">Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/authentication-plugins/">Authentication Plugins</a>
    


    » <a class="node_link crumb" href="/kb/en/pluggable-authentication-overview/">Pluggable Authentication Overview</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/pluggable-authentication-overview/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Pluggable Authentication Overview - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/pluggable-authentication-overview/+r/126540/">126540</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-2">
<a href="/kb/user/id/2" title="Daniel Bartholomew">Daniel Bartholomew</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2023-05-30 12:18">2023-05-30 12:18</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;

When a user attempts to log in, the authentication plugin controls how MariaDB Server determines whether the connection is from a legitimate user.

When creating or altering a user account with the [[grant|GRANT]], [[create-user|CREATE USER]] or [[alter-user|ALTER USER]] statements, you can specify the authentication plugin you want the user account to use by providing the ##IDENTIFIED VIA## clause. By default, when you create a user account without specifying an authentication plugin, MariaDB uses the [[authentication-plugin-mysql_native_password|mysql_native_password]] plugin.

&lt;&lt;product mariadb from=&#34;10.4&#34;&gt;&gt;
In MariaDB 10.4 and later, there are some notable changes, such as:

* You can specify multiple authentication plugins for each user account.
* The ##root@localhost## user created by [[mariadb-install-db]] is created with the ability to use two authentication plugins. First, it is configured to try to use the [[authentication-plugin-unix-socket|unix_socket]] authentication plugin. This allows the the ##root@localhost## user to login without a password via the local Unix socket file defined by the [[server-system-variables/#socket|socket]] system variable, as long as the login is attempted from a process owned by the operating system ##root## user account. Second, if authentication fails with the [[authentication-plugin-unix-socket|unix_socket]] authentication plugin, then it is configured to try to use the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin. However, an invalid password is initially set, so in order to authenticate this way, a password must be set with [[set-password|SET PASSWORD]].
&lt;&lt;/product&gt;&gt;

== Supported Authentication Plugins

The authentication process is a conversation between the server and a client. MariaDB implements both server-side and client-side authentication plugins.

=== Supported Server Authentication Plugins

MariaDB provides seven server-side authentication plugins:

* [[authentication-plugin-mysql_native_password|mysql_native_password]]
* [[authentication-plugin-mysql_old_password|mysql_old_password]]
* [[authentication-plugin-ed25519|ed25519]]
* [[authentication-plugin-gssapi|gssapi]]
* [[authentication-plugin-pam|pam]] (Unix only)
* [[authentication-plugin-unix-socket|unix_socket]] (Unix only)
* [[authentication-plugin-named-pipe|named_pipe]] (Windows only)

=== Supported Client Authentication Plugins

MariaDB provides eight client-side authentication plugins:

* [[authentication-plugin-mysql_native_password/#client-authentication-plugins|mysql_native_password]]
* [[authentication-plugin-mysql_old_password/#client-authentication-plugins|mysql_old_password]]
* [[authentication-plugin-ed25519/#client-authentication-plugins|client_ed25519]]
* [[authentication-plugin-gssapi/#client-authentication-plugins|auth_gssapi_client]]
* [[authentication-plugin-pam/#client-authentication-plugins|dialog]]
* [[authentication-plugin-pam/#client-authentication-plugins|mysql_clear_password]]
* [[authentication-plugin-sha-256/#client-authentication-plugins|sha256_password]]
* [[authentication-plugin-sha-256/#client-authentication-plugins|caching_sha256_password]]

== Options Related to Authentication Plugins

=== Server Options Related to Authentication Plugins

MariaDB supports the following server options related to authentication plugins:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Server Option |= Description |
| ##[[server-system-variables/#old_passwords|old_passwords={1 | 0}]]## | If set to ##1## (##0## is default), MariaDB reverts to using the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin by default for newly created users and passwords, instead of the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin. |
| ##[[server-system-variables/#plugin_dir|plugin_dir=path]]## | Path to the [[mariadb-plugins|plugin]] directory. For security reasons, either make sure this directory can only be read by the server, or set [[#secure_file_priv|secure_file_priv]]. |
| ##[[server-system-variables/#plugin_maturity|plugin_maturity=level]]## | The lowest acceptable [[mariadb-plugins|plugin]] maturity. MariaDB will not load plugins less mature than the specified level. |
| ##[[server-system-variables/#secure_auth|secure_auth]]## | Connections will be blocked if they use the the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin. The server will also fail to start if the privilege tables are in the old, pre-MySQL 4.1 format. |
&lt;&lt;/style&gt;&gt;

=== Client Options Related to Authentication Plugins

Most [[clients-utilities|clients and utilities]] support some command line arguments related to client authentication plugins:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Client Option |= Description |
| ##--connect-expired-password## | Notify the server that this client is prepared to handle [[user-password-expiry|expired password sandbox mode]] even if ##--batch## was specified. From MariaDB 10.4.3. |
| ##--default-auth=name## | Default authentication client-side plugin to use. |
| ##--plugin-dir=path## | Directory for client-side plugins. |
| ##--secure-auth## | Refuse to connect to the server if the server uses the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin. This mode is off by default, which is a difference in behavior compared to MySQL 5.6 and later, where it is on by default. |
&lt;&lt;/style&gt;&gt;

Developers who are using [[mariadb-connector-c|MariaDB Connector/C]] can implement similar functionality in their application by setting the following options with the [[mysql_optionsv|mysql_optionsv]] function:

* ##MYSQL_OPT_CAN_HANDLE_EXPIRED_PASSWORDS##
* ##MYSQL_PLUGIN_DIR##
* ##MYSQL_DEFAULT_AUTH##
* ##MYSQL_SECURE_AUTH## 

For example:

&lt;&lt;code&gt;&gt;
mysql_optionsv(mysql, MYSQL_OPT_CAN_HANDLE_EXPIRED_PASSWORDS, 1);
mysql_optionsv(mysql, MYSQL_DEFAULT_AUTH, &#34;name&#34;);
mysql_optionsv(mysql, MYSQL_PLUGIN_DIR, &#34;path&#34;);
mysql_optionsv(mysql, MYSQL_SECURE_AUTH, 1);
&lt;&lt;/code&gt;&gt;

=== Installation Options Related to Authentication Plugins

[[mariadb-install-db]] supports the following installation options related to authentication plugins:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Installation Option |= Description |
| ##--auth-root-authentication-method={normal {{{|}}} socket}## | If set to ##normal##, it creates a ##root@localhost## account that authenticates with the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin and that has no initial password set, which can be insecure. If set to ##socket##, it creates a ##root@localhost## account that authenticates with the [[authentication-plugin-unix-socket|unix_socket]] authentication plugin. Set to ##normal## by default. Available since MariaDB 10.1. |
| ##--auth-root-socket-user=USER## | Used with ##--auth-root-authentication-method=socket##. It specifies the name of the second account to create with [[grant/#global-privileges|SUPER]] privileges in addition to ##root##, as well as of the system account allowed to access it. Defaults to the value of ##--user##. |
&lt;&lt;/style&gt;&gt;

== Extended SQL Syntax

MariaDB has extended the SQL standard [[grant|GRANT]], [[create-user|CREATE USER]], and [[alter-user|ALTER USER]] statements, so that they support specifying different authentication plugins for specific users. An authentication plugin can be specified with these statements by providing the ##IDENTIFIED VIA## clause.

For example, the [[grant|GRANT]] syntax is:

&lt;&lt;sql&gt;&gt;
GRANT &lt;privileges&gt; ON &lt;level&gt; TO &lt;user&gt; 
   IDENTIFIED VIA &lt;plugin&gt; [ USING &lt;string&gt; ]
&lt;&lt;/sql&gt;&gt;

And the [[create-user|CREATE USER]] syntax is:

&lt;&lt;sql&gt;&gt;
CREATE USER &lt;user&gt; 
   IDENTIFIED VIA &lt;plugin&gt; [ USING &lt;string&gt; ]
&lt;&lt;/sql&gt;&gt;

And the [[alter-user|ALTER USER]] syntax is:

&lt;&lt;sql&gt;&gt;
ALTER USER &lt;user&gt; 
   IDENTIFIED VIA &lt;plugin&gt; [ USING &lt;string&gt; ]
&lt;&lt;/sql&gt;&gt;

The optional ##USING## clause allows users to provide an authentication string to a plugin. The authentication string&#39;s format and meaning is completely defined by the plugin.

For example, for the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin, the authentication string should be a password hash:

&lt;&lt;sql&gt;&gt;
CREATE USER mysqltest_up1 
   IDENTIFIED VIA mysql_native_password USING &#39;*E8D46CE25265E545D225A8A6F1BAF642FEBEE5CB&#39;;
&lt;&lt;/sql&gt;&gt;

Since [[authentication-plugin-mysql_native_password|mysql_native_password]] is the default authentication plugin, the above is just another way of saying the following:

&lt;&lt;sql&gt;&gt;
CREATE USER mysqltest_up1 
   IDENTIFIED BY PASSWORD &#39;*E8D46CE25265E545D225A8A6F1BAF642FEBEE5CB&#39;;
&lt;&lt;/sql&gt;&gt;

In contrast, for the [[authentication-plugin-pam|pam]] authentication plugin, the authentication string should refer to a [[authentication-plugin-pam/#configuring-the-pam-service|PAM service name]]:

&lt;&lt;sql&gt;&gt;
CREATE USER mysqltest_up1 
   IDENTIFIED VIA pam USING &#39;mariadb&#39;;
&lt;&lt;/sql&gt;&gt;

&lt;&lt;product mariadb from=&#34;10.4&#34;&gt;&gt;
In MariaDB 10.4 and later, a user account can be associated with multiple authentication plugins.

For example, to configure the ##root@localhost## user account to try the [[authentication-plugin-unix-socket|unix_socket]] authentication plugin, followed by the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin as a backup, you could execute the following:
&lt;&lt;sql&gt;&gt;
CREATE USER root@localhost 
   IDENTIFIED VIA unix_socket 
   OR mysql_native_password USING PASSWORD(&#34;verysecret&#34;);
&lt;&lt;/sql&gt;&gt;

See [[authentication-from-mariadb-104|Authentication from MariaDB 10.4]] for more information.
&lt;&lt;/product&gt;&gt;

== Authentication Plugins Installed by Default

=== Server Authentication Plugins Installed by Default

Not all server-side authentication plugins are installed by default. If a specific server-side authentication plugin is not installed by default, then you can find the installation procedure on the documentation page for the specific authentication plugin.

\\

&lt;&lt;product mariadb from=&#34;10.4&#34;&gt;&gt;
In MariaDB 10.4 and later, the following server-side authentication plugins are installed by default:

* The [[authentication-plugin-mysql_native_password|mysql_native_password]] and [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugins authentication plugins are installed by default in all builds.

* The [[authentication-plugin-unix-socket|unix_socket]] authentication plugin is installed by default in all builds on Unix and Linux.

* The [[authentication-plugin-named-pipe|named_pipe]] authentication plugin is installed by default in all builds on Windows.
&lt;&lt;/product&gt;&gt;

&lt;&lt;product mariadb to=&#34;10.3&#34;&gt;&gt;
In MariaDB 10.3 and below, the following server-side authentication plugins are installed by default:

* The [[authentication-plugin-mysql_native_password|mysql_native_password]] and [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugins are installed by default in all builds.

* The [[authentication-plugin-unix-socket|unix_socket]] authentication plugin is installed by default in **new installations** that use the [[installing-mariadb-deb-files|.deb]] packages provided by Debian&#39;s default repositories in Debian 9 and later and Ubuntu&#39;s default repositories in Ubuntu 15.10 and later. See [[differences-in-mariadb-in-debian-and-ubuntu|Differences in MariaDB in Debian (and Ubuntu)]] for more information.

* The [[authentication-plugin-named-pipe|named_pipe]] authentication plugin is installed by default in all builds on Windows.
&lt;&lt;/product&gt;&gt;

=== Client Authentication Plugins Installed by Default

Client-side authentication plugins do not need to be //installed// in the same way that server-side authentication plugins do. If the client uses either the ##libmysqlclient## or [[mariadb-connector-c|MariaDB Connector/C]] library, then the library automatically loads client-side authentication plugins from the library&#39;s plugin directory whenever they are needed.

Most [[clients-utilities|clients and utilities]] support the ##--plugin-dir## command line argument that can be used to set the path to the library&#39;s plugin directory:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Client Option |= Description |
| ##--plugin-dir=path## | Directory for client-side plugins. |
&lt;&lt;/style&gt;&gt;

Developers who are using [[mariadb-connector-c|MariaDB Connector/C]] can implement similar functionality in their application by setting the ##MYSQL_PLUGIN_DIR## option with the [[mysql_optionsv|mysql_optionsv]] function.

For example:

&lt;&lt;code&gt;&gt;
mysql_optionsv(mysql, MYSQL_PLUGIN_DIR, &#34;path&#34;);
&lt;&lt;/code&gt;&gt;

If your client encounters errors similar to the following, then you may need to set the path to the library&#39;s plugin directory:

&lt;&lt;code wrap=true&gt;&gt;
ERROR 2059 (HY000): Authentication plugin &#39;dialog&#39; cannot be loaded: /usr/lib/mysql/plugin/dialog.so: cannot open shared object file: No such file or directory
&lt;&lt;/code&gt;&gt;

If the client does **not** use either the ##libmysqlclient## or [[mariadb-connector-c|MariaDB Connector/C]] library, then you will have to determine which authentication plugins are supported by the specific client library used by the client.

If the client uses either the ##libmysqlclient## or [[mariadb-connector-c|MariaDB Connector/C]] library, but the client is not bundled with either library&#39;s //optional// client authentication plugins, then you can only use the conventional authentication plugins (like [[authentication-plugin-mysql_native_password|mysql_native_password]] and [[authentication-plugin-mysql_old_password|mysql_old_password]]) and the non-conventional authentication plugins that don&#39;t require special client-side authentication plugins (like [[authentication-plugin-unix-socket|unix_socket]] and [[authentication-plugin-named-pipe|named_pipe]]).

== Default Authentication Plugin

=== Default Server Authentication Plugin

The [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin is currently the default authentication plugin in all versions of MariaDB if the [[server-system-variables/#old_passwords|old_passwords]] system variable is set to ##0##, which is the default.

On a system with the [[server-system-variables/#old_passwords|old_passwords]] system variable set to ##0##, this means that if you create a user account with either the [[grant|GRANT]] or [[create-user|CREATE USER]]## statements, and if you do not specify an authentication plugin with the ##IDENTIFIED VIA## clause, then MariaDB will use the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin for the user account.

For example, this user account will use the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin:

&lt;&lt;sql&gt;&gt;
CREATE USER username@hostname;
&lt;&lt;/sql&gt;&gt;

And so will this user account:

&lt;&lt;sql&gt;&gt;
CREATE USER username@hostname IDENTIFIED BY &#39;notagoodpassword&#39;;
&lt;&lt;/sql&gt;&gt;

The [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin becomes the default authentication plugin in all versions of MariaDB if the [[server-system-variables/#old_passwords|old_passwords]] system variable is explicitly set to ##1##.

However, the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin is not considered secure, so it is recommended to avoid using this authentication plugin. To help prevent undesired use of the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin, the server supports the [[server-system-variables/#secure_auth|secure_auth]] system variable that can be used to configured the server to refuse connections that try to use the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Server Option |= Description |
| ##[[server-system-variables/#old_passwords|old_passwords={1 | 0}]]## | If set to ##1## (##0## is default), MariaDB reverts to using the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin by default for newly created users and passwords, instead of the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin. |
| ##[[server-system-variables/#secure_auth|secure_auth]]## | Connections will be blocked if they use the the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin. The server will also fail to start if the privilege tables are in the old, pre-MySQL 4.1 format. |
&lt;&lt;/style&gt;&gt;

Most [[clients-utilities|clients and utilities]] also support the ##--secure-auth## command line argument that can also be used to configure the client to refuse to connect to servers that use the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Client Option |= Description |
| ##--secure-auth## | Refuse to connect to the server if the server uses the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin. This mode is off by default, which is a difference in behavior compared to MySQL 5.6 and later, where it is on by default. |
&lt;&lt;/style&gt;&gt;

Developers who are using [[mariadb-connector-c|MariaDB Connector/C]] can implement similar functionality in their application by setting the ##MYSQL_SECURE_AUTH## option with the [[mysql_optionsv|mysql_optionsv]] function.

For example:

&lt;&lt;code&gt;&gt;
mysql_optionsv(mysql, MYSQL_SECURE_AUTH, 1);
&lt;&lt;/code&gt;&gt;

=== Default Client Authentication Plugin

The default client-side authentication plugin depends on a few factors.

If a client doesn&#39;t explicitly set the default client-side authentication plugin, then the client will determine which authentication plugin to use by checking the length of the scramble in the server&#39;s handshake packet.

If the server&#39;s handshake packet contains a 9-byte scramble, then the client will default to the [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin.

If the server&#39;s handshake packet contains a 20-byte scramble, then the client will default to the [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin.

==== Setting the Default Client Authentication Plugin

Most [[clients-utilities|clients and utilities]] support the ##--default-auth## command line argument that can be used to set the default client-side authentication plugin:

&lt;&lt;style class=&#34;darkheader-nospace-borders centered&#34;&gt;&gt;
|= Client Option |= Description |
| ##--default-auth=name## | Default authentication client-side plugin to use. |
&lt;&lt;/style&gt;&gt;

Developers who are using [[mariadb-connector-c|MariaDB Connector/C]] can implement similar functionality in their application by setting the ##MYSQL_DEFAULT_AUTH## option with the [[mysql_optionsv|mysql_optionsv]] function.

For example:

&lt;&lt;code&gt;&gt;
mysql_optionsv(mysql, MYSQL_DEFAULT_AUTH, &#34;name&#34;);
&lt;&lt;/code&gt;&gt;

If you know that your user account is configured to require a client-side authentication plugin that isn&#39;t [[authentication-plugin-mysql_old_password|mysql_old_password]] or [[authentication-plugin-mysql_native_password|mysql_native_password]], then it can help speed up your connection process to explicitly set the default client-side authentication plugin.

According to the [[clientserver-protocol/|client-server protocol]], the server first sends the handshake packet to the client, then the client replies with a packet containing the user name of the user account that is requesting access. The server handshake packet initially tells the client to use the default server authentication plugin, and the client reply initially tells the server that it will use the default client authentication plugin. 

However, the server-side and client-side authentication plugins mentioned in these initial packets may not be the correct ones for this specific user account. The server only knows what authentication plugin to use for this specific user account after reading the user name from the client reply packet and finding the appropriate row for the user account in either the [[mysqluser-table|mysql.user]] table or the [[mysqlglobal_priv-table|mysql.global_priv]] table, depending on the MariaDB version.

If the server finds that either the server-side or client-side default authentication plugin does not match the actual authentication plugin that should be used for the given user account, then the server restarts the authentication on either the server side or the client side.

This means that, if you know what client authentication plugin your user account requires, then you can avoid an unnecessary authentication restart and you can save two packets and two round-trips.between the client and server by configuring your client to use the correct authentication plugin by default.

== Authentication Plugins

=== Server Authentication Plugins

==== ##mysql_native_password##

The [[authentication-plugin-mysql_native_password|mysql_native_password]] authentication plugin uses the password hashing algorithm introduced in MySQL 4.1, which is also used by the [[password|PASSWORD()]]## function when [[server-system-variables/#old_passwords|old_passwords=0]] is set. This hashing algorithm is based on [[https://en.wikipedia.org/wiki/SHA-1|SHA-1]].

==== ##mysql_old_password##

The [[authentication-plugin-mysql_old_password|mysql_old_password]] authentication plugin uses the pre-MySQL 4.1 password hashing algorithm, which is also used by the [[old_password|OLD_PASSWORD()]] function and by the [[password|PASSWORD()]] function when [[server-system-variables/#old_passwords|old_passwords=1]] is set.

==== ##ed25519##

The [[authentication-plugin-ed25519|ed25519]] authentication plugin uses [[https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm|Elliptic Curve Digital Signature Algorithm]] to securely store users&#39; passwords and to authenticate users. The [[https://en.wikipedia.org/wiki/EdDSA#Ed25519|ed25519]] algorithm is the same one that is [[https://www.openssh.com/txt/release-6.5|used by OpenSSH]]. It is based on the elliptic curve and code created by [[https://en.wikipedia.org/wiki/Daniel_J._Bernstein|Daniel J. Bernstein]].

From a user&#39;s perspective, the [[authentication-plugin-ed25519|ed25519]] authentication plugin still provides conventional password-based authentication.

==== ##gssapi##

The [[authentication-plugin-gssapi|gssapi]] authentication plugin allows the user to authenticate with services that use the [[https://en.wikipedia.org/wiki/Generic_Security_Services_Application_Program_Interface|Generic Security Services Application Program Interface (GSSAPI)]]. Windows has a slightly different but very similar API called [[https://docs.microsoft.com/en-us/windows/desktop/secauthn/sspi|Security Support Provider Interface (SSPI)]].

On Windows, this authentication plugin supports [[https://docs.microsoft.com/en-us/windows/desktop/secauthn/microsoft-kerberos|Kerberos]] and [[https://docs.microsoft.com/en-us/windows/desktop/secauthn/microsoft-ntlm|NTLM]] authentication. Windows authentication is supported regardless of whether a [[https://en.wikipedia.org/wiki/Windows_domain|domain]] is used in the environment.

On Unix systems, the most dominant GSSAPI service is [[https://en.wikipedia.org/wiki/Kerberos_(protocol)|Kerberos]]. However, it is less commonly used on Unix systems than it is on Windows. Regardless, this authentication plugin also supports Kerberos authentication on Unix.

The [[authentication-plugin-gssapi|gssapi]] authentication plugin is most often used for authenticating with [[https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview|Microsoft Active Directory]].

==== ##pam##

The [[authentication-plugin-pam|pam]] authentication plugin allows MariaDB to offload user authentication to the system&#39;s [[http://en.wikipedia.org/wiki/Pluggable_authentication_module|Pluggable Authentication Module (PAM)]] framework. PAM is an authentication framework used by Linux, FreeBSD, Solaris, and other Unix-like operating systems.

==== ##unix_socket##

The [[authentication-plugin-unix-socket|unix_socket]] authentication plugin allows the user to use operating system credentials when connecting to MariaDB via the local Unix socket file. This Unix socket file is defined by the [[server-system-variables/#socket|socket]] system variable.

The [[authentication-plugin-unix-socket|unix_socket]] authentication plugin works by calling the [[http://man7.org/linux/man-pages/man7/socket.7.html|getsockopt]] system call with the ##SO_PEERCRED## socket option, which allows it to retrieve the ##uid## of the process that is connected to the socket. It is then able to get the user name associated with that ##uid##. Once it has the user name, it will authenticate the connecting user as the MariaDB account that has the same user name.

For example:

&lt;&lt;code&gt;&gt;
$ mysql -uroot
MariaDB []&gt; CREATE USER serg IDENTIFIED VIA unix_socket;
MariaDB []&gt; CREATE USER monty IDENTIFIED VIA unix_socket;
MariaDB []&gt; quit
Bye
$ whoami
serg
$ mysql --user=serg
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 2
Server version: 5.2.0-MariaDB-alpha-debug Source distribution
MariaDB []&gt; quit
Bye
$ mysql --user=monty
ERROR 1045 (28000): Access denied for user &#39;monty&#39;@&#39;localhost&#39; (using password: NO)
&lt;&lt;/code&gt;&gt;

In this example, a user ##serg## is already logged into the operating system and has full shell access. He has already authenticated with the operating system and his MariaDB account is configured to use the [[authentication-plugin-unix-socket|unix_socket]] authentication plugin, so he does not need to authenticate again for the database. MariaDB accepts his operating system credentials and allows him to connect. However, any attempt to connect to the database as another operating system user will be denied.

==== ##named_pipe##

The [[authentication-plugin-named-pipe|named_pipe]] authentication plugin allows the user to use operating system credentials when connecting to MariaDB via named pipe on Windows. Named pipe connections are enabled by the [[server-system-variables/#named_pipe|named_pipe]] system variable.

The [[authentication-plugin-named-pipe|named_pipe]] authentication plugin works by using [[https://msdn.microsoft.com/en-us/library/windows/desktop/aa378618%28v=vs.85%29.aspx|named pipe impersonation]] and calling ##GetUserName()## to retrieve the user name of the process that is connected to the named pipe. Once it has the user name, it authenticates the connecting user as the MariaDB account that has the same user name.

For example:

&lt;&lt;code&gt;&gt;
CREATE USER wlad IDENTIFIED VIA named_pipe;
CREATE USER monty IDENTIFIED VIA named_pipe;
quit

C:\&gt;echo %USERNAME%
wlad

C:\&gt; mysql --user=wlad --protocol=PIPE
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 4
Server version: 10.1.12-MariaDB-debug Source distribution

Copyright (c) 2000, 2015, Oracle, MariaDB Corporation Ab and others.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

MariaDB [(none)]&gt; quit
Bye

C:\&gt; mysql --user=monty  --protocol=PIPE
ERROR 1698 (28000): Access denied for user &#39;monty&#39;@&#39;localhost&#39;
&lt;&lt;/code&gt;&gt;

== Authentication Plugin API

The authentication plugin API is extensively documented in the [[getting-the-mariadb-source-code|source code]] in the following files:

* ##mysql/plugin_auth.h## (server part)
* ##mysql/client_plugin.h## (client part)
* ##mysql/plugin_auth_common.h## (common parts)

The MariaDB [[getting-the-mariadb-source-code|source code]] also contains some authentication plugins that are intended explicitly to be examples for developers. They are located in ##plugin/auth_examples##.

The definitions of two example authentication plugins called ##two_questions## and ##three_attempts## can be seen in ##plugin/auth_examples/dialog_examples.c##. These authentication plugins demonstrate how to communicate with the user using the [[authentication-plugin-pam/#dialog|dialog]] client authentication plugin.

The ##two_questions## authentication plugin asks the user for a password and a confirmation (&#34;Are you sure?&#34;).

The ##three_attempts## authentication plugin gives the user three attempts to enter a correct password.

The password for both of these plugins should be specified in the plain text in the ##USING## clause:

&lt;&lt;sql&gt;&gt;
CREATE USER insecure IDENTIFIED VIA two_questions USING &#39;notverysecret&#39;;
&lt;&lt;/sql&gt;&gt;

=== Dialog Client Authentication Plugin - Client Library Extension

The [[authentication-plugin-pam/#dialog|dialog]] client authentication plugin, strictly speaking, is not part of the client-server or authentication plugin API. But it can be loaded into any client application that uses the ##libmysqlclient## or [[mariadb-connector-c|MariaDB Connector/C]] libraries. This authentication plugin provides a way for the application to customize the UI of the dialog function.

In order to use the [[authentication-plugin-pam/#dialog|dialog]] client authentication plugin to communicate with the user in a customized way, the application will need to implement a function with the following signature:

&lt;&lt;code lang=c&gt;&gt;
extern &#34;C&#34; char *mysql_authentication_dialog_ask(
  MYSQL *mysql, int type, const char *prompt, char *buf, int buf_len)
&lt;&lt;/code&gt;&gt;

The function takes the following arguments:

* The connection handle.
* A question &#34;type&#34;, which has one of the following values:
** ##1## - Normal question
** ##2## - Password (no echo)
* A prompt.
* A buffer.
* The length of the buffer.

The function returns a pointer to a string of characters, as entered by the user. It may be stored in ##buf## or allocated with ##malloc()##.

Using this function a GUI application can pop up a dialog window, a network application can send the question over the network, as required. If no ##mysql_authentication_dialog_ask## function is provided by the application, the [[authentication-plugin-pam/#dialog|dialog]] client authentication plugin falls back to [[https://linux.die.net/man/3/fputs|fputs()]] and [[https://linux.die.net/man/3/fgets|fgets()]].

Providing this callback is particularly important on Windows, because Windows GUI applications have no associated console and the default dialog function will not be able to reach the user. An example of Windows GUI client that does it correctly is [[HeidiSQL]].

== See Also

* [[grant|GRANT]]
* [[create-user|CREATE USER]]
* [[alter-user|ALTER USER]]
* [[authentication-from-mariadb-104|Authentication from MariaDB 10.4]]
* [[https://mariadb.org/history-of-mysql-mariadb-authentication-protocols/|Who are you? The history of MySQL and MariaDB authentication protocols from 1997 to 2017]]
* [[https://dev.mysql.com/doc/refman/5.6/en/pluggable-authentication.html|MySQL 5.6 Reference Manual: Pluggable Authentication]]
* [[http://dev.mysql.com/doc/refman/5.6/en/writing-authentication-plugins.html|MySQL 5.6 Reference Manual: Writing Authentication Plugins]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>