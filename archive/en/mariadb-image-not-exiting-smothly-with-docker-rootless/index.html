<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>mariadb image not exiting smothly with docker rootless - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="mariadb image not exiting smothly with docker rootless" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="it seems the mariadb:10.3 image is not compatible with docker rootless mode:
my stripped down docker compose file:
services:
    test-db:
        image: mariadb:10.3
        r..." />

    <meta name="description" content="it seems the mariadb:10.3 image is not compatible with docker rootless mode:
my stripped down docker compose file:
services:
    test-db:
        image: mariadb:10.3
        r..." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/getting-installing-and-upgrading-mariadb/">Getting, Installing, and Upgrading MariaDB</a>
    

    
    » <a class="crumb" href="/kb/en/binary-packages/">MariaDB Binary Packages</a>
    

    
    » <a class="crumb" href="/kb/en/automated-mariadb-deployment-and-administration/">Automated MariaDB Deployment and Administration</a>
    

    
    » <a class="crumb" href="/kb/en/docker-and-mariadb/">MariaDB Containers</a>
    


    » <a class="node_link crumb" href="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/">mariadb image not exiting smothly with docker rootless</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+flag"
                data-flag-url="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2024-06-24 23:42">5 months, 3 weeks ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2024-10-01 11:24">2 months, 2 weeks ago</span></dd>

        <dt>Type</dt>
        <dd>question</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>mariadb image not exiting smothly with docker rootless</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        
    <div class="question formatted">
        <p>it seems the mariadb:10.3 image is not compatible with docker rootless mode:</p>
<p>my stripped down docker compose file:</p>
<pre class="fixed">services:
    test-db:
        image: mariadb:10.3
        restart: always
        environment:
            MARIADB_ROOT_PASSWORD: &#34;ping&#34;
        command: --sql-mode=&#34;ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#34;
    test-phpmyadmin:
        image: phpmyadmin
        restart: always
        ports:
            - 8180:8180
        environment:
            PMA_HOST: test-db
            APACHE_PORT: 8180
            UPLOAD_LIMIT: 300M
            PMA_ABSOLUTE_URI: &#34;https://pma.${hostname}&#34;
        hostname: &#34;pma.${hostname}&#34;
</pre><pre class="fixed">db-test$ docker compose up
WARN[0000] The &#34;hostname&#34; variable is not set. Defaulting to a blank string. 
WARN[0000] The &#34;hostname&#34; variable is not set. Defaulting to a blank string. 
[+] Running 3/3
 ✔ Network db-test_default              Created                                                                                                                                                                                                                                                            0.1s 
 ✔ Container db-test-test-phpmyadmin-1  Created                                                                                                                                                                                                                                                            0.1s 
 ✔ Container db-test-test-db-1          Created                                                                                                                                                                                                                                                            0.1s 
Attaching to test-db-1, test-phpmyadmin-1
test-phpmyadmin-1  | Setting apache port to 8180.
test-db-1          | 2024-06-24 23:24:30+00:00 [Note] [Entrypoint]: Entrypoint script for MariaDB Server 1:10.3.39+maria~ubu2004 started.
test-phpmyadmin-1  | Syntax OK
test-phpmyadmin-1  | [Mon Jun 24 23:24:31.041079 2024] [mpm_prefork:notice] [pid 1] AH00163: Apache/2.4.59 (Debian) PHP/8.2.20 configured -- resuming normal operations
test-phpmyadmin-1  | [Mon Jun 24 23:24:31.041130 2024] [core:notice] [pid 1] AH00094: Command line: 'apache2 -D FOREGROUND'
test-db-1          | 2024-06-24 23:24:31+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql'
test-db-1          | 2024-06-24 23:24:31+00:00 [Note] [Entrypoint]: Entrypoint script for MariaDB Server 1:10.3.39+maria~ubu2004 started.
test-db-1          | 2024-06-24 23:24:31+00:00 [Note] [Entrypoint]: Initializing database files
test-db-1          | 
test-db-1          | 
test-db-1          | PLEASE REMEMBER TO SET A PASSWORD FOR THE MariaDB root USER !
test-db-1          | To do so, start the server, then issue the following command:
test-db-1          | 
test-db-1          | '/usr/bin/mysql_secure_installation'
test-db-1          | 
test-db-1          | which will also give you the option of removing the test
test-db-1          | databases and anonymous user created by default.  This is
test-db-1          | strongly recommended for production servers.
test-db-1          | 
test-db-1          | See the MariaDB Knowledgebase at http://mariadb.com/kb
test-db-1          | 
test-db-1          | Please report any problems at http://mariadb.org/jira
test-db-1          | 
test-db-1          | The latest information about MariaDB is available at http://mariadb.org/.
test-db-1          | 
test-db-1          | Consider joining MariaDB's strong and vibrant community:
test-db-1          | https://mariadb.org/get-involved/
test-db-1          | 
test-db-1          | 2024-06-24 23:24:33+00:00 [Note] [Entrypoint]: Database files initialized
test-db-1          | 2024-06-24 23:24:33+00:00 [Note] [Entrypoint]: Starting temporary server
test-db-1          | 2024-06-24 23:24:33+00:00 [Note] [Entrypoint]: Waiting for server startup
test-db-1          | 2024-06-24 23:24:33 0 [Note] Starting MariaDB 10.3.39-MariaDB-1:10.3.39+maria~ubu2004 source revision ca001cf2048f0152689e1895e2dc15486dd0b1af as process 109
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Using Linux native AIO
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Uses event mutexes
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Compressed tables use zlib 1.2.11
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Number of pools: 1
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Using SSE2 crc32 instructions
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Initializing buffer pool, total size = 256M, instances = 1, chunk size = 128M
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Completed initialization of buffer pool
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority().
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: 128 out of 128 rollback segments are active.
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Creating shared tablespace for temporary tables
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ...
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB.
test-db-1          | 2024-06-24 23:24:33 0 [Note] InnoDB: 10.3.39 started; log sequence number 1625419; transaction id 20
test-db-1          | 2024-06-24 23:24:33 0 [Note] Plugin 'FEEDBACK' is disabled.
test-db-1          | 2024-06-24 23:24:33 0 [Warning] 'user' entry 'root@a25e34f9f94c' ignored in --skip-name-resolve mode.
test-db-1          | 2024-06-24 23:24:33 0 [Warning] 'proxies_priv' entry '@% root@a25e34f9f94c' ignored in --skip-name-resolve mode.
test-db-1          | 2024-06-24 23:24:33 0 [Note] Reading of all Master_info entries succeeded
test-db-1          | 2024-06-24 23:24:33 0 [Note] Added new Master_info '' to hash table
test-db-1          | 2024-06-24 23:24:33 0 [Note] mysqld: ready for connections.
test-db-1          | Version: '10.3.39-MariaDB-1:10.3.39+maria~ubu2004'  socket: '/var/run/mysqld/mysqld.sock'  port: 0  mariadb.org binary distribution
test-db-1          | 2024-06-24 23:24:34+00:00 [Note] [Entrypoint]: Temporary server started.
test-db-1          | 2024-06-24 23:24:35+00:00 [Note] [Entrypoint]: Securing system users (equivalent to running mysql_secure_installation)
test-db-1          | 
test-db-1          | /usr/local/bin/docker-entrypoint.sh: line 149: kill: (109) - Permission denied
test-db-1          | 2024-06-24 23:24:35+00:00 [Note] [Entrypoint]: Stopping temporary server
test-db-1 exited with code 1
test-db-1          | 2024-06-24 23:24:35+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql'
test-db-1          | 2024-06-24 23:24:35+00:00 [Note] [Entrypoint]: Entrypoint script for MariaDB Server 1:10.3.39+maria~ubu2004 started.
test-db-1          | 2024-06-24 23:24:35+00:00 [Note] [Entrypoint]: MariaDB upgrade not required
test-db-1          | 2024-06-24 23:24:35 0 [Note] Starting MariaDB 10.3.39-MariaDB-1:10.3.39+maria~ubu2004 source revision ca001cf2048f0152689e1895e2dc15486dd0b1af as process 1
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Using Linux native AIO
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Uses event mutexes
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Compressed tables use zlib 1.2.11
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Number of pools: 1
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Using SSE2 crc32 instructions
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Initializing buffer pool, total size = 256M, instances = 1, chunk size = 128M
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Completed initialization of buffer pool
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority().
test-db-1          | 2024-06-24 23:24:35 0 [Note] InnoDB: Starting crash recovery from checkpoint LSN=1625419
test-db-1          | 2024-06-24 23:24:36 0 [Note] InnoDB: 128 out of 128 rollback segments are active.
test-db-1          | 2024-06-24 23:24:36 0 [Note] InnoDB: Removed temporary tablespace data file: &#34;ibtmp1&#34;
test-db-1          | 2024-06-24 23:24:36 0 [Note] InnoDB: Creating shared tablespace for temporary tables
test-db-1          | 2024-06-24 23:24:36 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ...
test-db-1          | 2024-06-24 23:24:36 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB.
test-db-1          | 2024-06-24 23:24:36 0 [Note] InnoDB: 10.3.39 started; log sequence number 1625428; transaction id 20
test-db-1          | 2024-06-24 23:24:36 0 [Note] InnoDB: Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool
test-db-1          | 2024-06-24 23:24:36 0 [Note] InnoDB: Cannot open '/var/lib/mysql/ib_buffer_pool' for reading: No such file or directory
test-db-1          | 2024-06-24 23:24:36 0 [Note] Plugin 'FEEDBACK' is disabled.
test-db-1          | 2024-06-24 23:24:36 0 [Note] Recovering after a crash using tc.log
test-db-1          | 2024-06-24 23:24:36 0 [Note] Starting crash recovery...
test-db-1          | 2024-06-24 23:24:36 0 [Note] Crash recovery finished.
test-db-1          | 2024-06-24 23:24:36 0 [Note] Server socket created on IP: '::'.
test-db-1          | 2024-06-24 23:24:36 0 [ERROR] mysqld: Table './mysql/user' is marked as crashed and should be repaired
test-db-1          | 2024-06-24 23:24:36 0 [Warning] Checking table:   './mysql/user'
test-db-1          | 2024-06-24 23:24:36 0 [ERROR] mysql.user: 1 client is using or hasn't closed the table properly
test-db-1          | 2024-06-24 23:24:36 0 [ERROR] mysqld: Table './mysql/proxies_priv' is marked as crashed and should be repaired
test-db-1          | 2024-06-24 23:24:36 0 [Warning] Checking table:   './mysql/proxies_priv'
test-db-1          | 2024-06-24 23:24:36 0 [ERROR] mysql.proxies_priv: 1 client is using or hasn't closed the table properly
test-db-1          | 2024-06-24 23:24:36 0 [ERROR] mysqld: Table './mysql/time_zone_name' is marked as crashed and should be repaired
test-db-1          | 2024-06-24 23:24:36 0 [Warning] Checking table:   './mysql/time_zone_name'
test-db-1          | 2024-06-24 23:24:36 0 [ERROR] mysql.time_zone_name: 1 client is using or hasn't closed the table properly
test-db-1          | 2024-06-24 23:24:36 0 [ERROR] mysqld: Table './mysql/time_zone' is marked as crashed and should be repaired
test-db-1          | 2024-06-24 23:24:36 0 [Warning] Checking table:   './mysql/time_zone'
test-db-1          | 2024-06-24 23:24:36 0 [ERROR] mysql.time_zone: 1 client is using or hasn't closed the table properly
test-db-1          | 2024-06-24 23:24:36 0 [Note] Reading of all Master_info entries succeeded
test-db-1          | 2024-06-24 23:24:36 0 [Note] Added new Master_info '' to hash table
test-db-1          | 2024-06-24 23:24:36 0 [Note] mysqld: ready for connections.
test-db-1          | Version: '10.3.39-MariaDB-1:10.3.39+maria~ubu2004'  socket: '/var/run/mysqld/mysqld.sock'  port: 3306  mariadb.org binary distribution


^CGracefully stopping... (press Ctrl+C again to force)
[+] Stopping 2/2
 ✔ Container db-test-test-phpmyadmin-1  Stopped                                                                                                                                                                                                                                                            1.2s 
 ✘ Container db-test-test-db-1          Error while Stopping      


canceled
</pre><p>i can only stop this with restarting the docker daemon:</p>
<pre class="fixed">$ systemctl --user restart docker
</pre><p>when i try the same with docker in root mode i get:</p>
<pre class="fixed">
db-test$ docker compose up
WARN[0000] The &#34;hostname&#34; variable is not set. Defaulting to a blank string. 
WARN[0000] The &#34;hostname&#34; variable is not set. Defaulting to a blank string. 
[+] Running 3/3
 ✔ Network db-test_default              Created                                                                                                                                                                                                                                                            0.1s 
 ✔ Container db-test-test-phpmyadmin-1  Created                                                                                                                                                                                                                                                            0.1s 
 ✔ Container db-test-test-db-1          Created                                                                                                                                                                                                                                                            0.1s 
Attaching to test-db-1, test-phpmyadmin-1
test-db-1          | 2024-06-24 23:36:54+00:00 [Note] [Entrypoint]: Entrypoint script for MariaDB Server 1:10.3.39+maria~ubu2004 started.
test-phpmyadmin-1  | Setting apache port to 8180.
test-phpmyadmin-1  | Syntax OK
test-db-1          | 2024-06-24 23:36:54+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql'
test-db-1          | 2024-06-24 23:36:54+00:00 [Note] [Entrypoint]: Entrypoint script for MariaDB Server 1:10.3.39+maria~ubu2004 started.
test-phpmyadmin-1  | [Mon Jun 24 23:36:54.726401 2024] [mpm_prefork:notice] [pid 1] AH00163: Apache/2.4.59 (Debian) PHP/8.2.18 configured -- resuming normal operations
test-phpmyadmin-1  | [Mon Jun 24 23:36:54.726448 2024] [core:notice] [pid 1] AH00094: Command line: 'apache2 -D FOREGROUND'
test-db-1          | 2024-06-24 23:36:54+00:00 [Note] [Entrypoint]: Initializing database files
test-db-1          | 
test-db-1          | 
test-db-1          | PLEASE REMEMBER TO SET A PASSWORD FOR THE MariaDB root USER !
test-db-1          | To do so, start the server, then issue the following command:
test-db-1          | 
test-db-1          | '/usr/bin/mysql_secure_installation'
test-db-1          | 
test-db-1          | which will also give you the option of removing the test
test-db-1          | databases and anonymous user created by default.  This is
test-db-1          | strongly recommended for production servers.
test-db-1          | 
test-db-1          | See the MariaDB Knowledgebase at http://mariadb.com/kb
test-db-1          | 
test-db-1          | Please report any problems at http://mariadb.org/jira
test-db-1          | 
test-db-1          | The latest information about MariaDB is available at http://mariadb.org/.
test-db-1          | 
test-db-1          | Consider joining MariaDB's strong and vibrant community:
test-db-1          | https://mariadb.org/get-involved/
test-db-1          | 
test-db-1          | 2024-06-24 23:36:56+00:00 [Note] [Entrypoint]: Database files initialized
test-db-1          | 2024-06-24 23:36:56+00:00 [Note] [Entrypoint]: Starting temporary server
test-db-1          | 2024-06-24 23:36:56+00:00 [Note] [Entrypoint]: Waiting for server startup
test-db-1          | 2024-06-24 23:36:57 0 [Note] Starting MariaDB 10.3.39-MariaDB-1:10.3.39+maria~ubu2004 source revision ca001cf2048f0152689e1895e2dc15486dd0b1af as process 109
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Using Linux native AIO
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Uses event mutexes
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Compressed tables use zlib 1.2.11
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Number of pools: 1
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Using SSE2 crc32 instructions
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Initializing buffer pool, total size = 256M, instances = 1, chunk size = 128M
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Completed initialization of buffer pool
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority().
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: 128 out of 128 rollback segments are active.
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Creating shared tablespace for temporary tables
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ...
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB.
test-db-1          | 2024-06-24 23:36:57 0 [Note] InnoDB: 10.3.39 started; log sequence number 1625419; transaction id 20
test-db-1          | 2024-06-24 23:36:57 0 [Note] Plugin 'FEEDBACK' is disabled.
test-db-1          | 2024-06-24 23:36:57 0 [Warning] 'user' entry 'root@b86b2e5732bf' ignored in --skip-name-resolve mode.
test-db-1          | 2024-06-24 23:36:57 0 [Warning] 'proxies_priv' entry '@% root@b86b2e5732bf' ignored in --skip-name-resolve mode.
test-db-1          | 2024-06-24 23:36:57 0 [Note] Reading of all Master_info entries succeeded
test-db-1          | 2024-06-24 23:36:57 0 [Note] Added new Master_info '' to hash table
test-db-1          | 2024-06-24 23:36:57 0 [Note] mysqld: ready for connections.
test-db-1          | Version: '10.3.39-MariaDB-1:10.3.39+maria~ubu2004'  socket: '/var/run/mysqld/mysqld.sock'  port: 0  mariadb.org binary distribution
test-db-1          | 2024-06-24 23:36:58+00:00 [Note] [Entrypoint]: Temporary server started.
test-db-1          | 2024-06-24 23:36:58+00:00 [Note] [Entrypoint]: Securing system users (equivalent to running mysql_secure_installation)
test-db-1          | 
test-db-1          | 2024-06-24 23:36:58+00:00 [Note] [Entrypoint]: Stopping temporary server
test-db-1          | 2024-06-24 23:36:58 0 [Note] mysqld (initiated by: unknown): Normal shutdown
test-db-1          | 2024-06-24 23:36:58 0 [Note] Event Scheduler: Purging the queue. 0 events
test-db-1          | 2024-06-24 23:36:58 0 [Note] InnoDB: FTS optimize thread exiting.
test-db-1          | 2024-06-24 23:36:58 0 [Note] InnoDB: Starting shutdown...
test-db-1          | 2024-06-24 23:36:58 0 [Note] InnoDB: Dumping buffer pool(s) to /var/lib/mysql/ib_buffer_pool
test-db-1          | 2024-06-24 23:36:58 0 [Note] InnoDB: Buffer pool(s) dump completed at 240624 23:36:58
test-db-1          | 2024-06-24 23:36:59 0 [Note] InnoDB: Removed temporary tablespace data file: &#34;ibtmp1&#34;
test-db-1          | 2024-06-24 23:36:59 0 [Note] InnoDB: Shutdown completed; log sequence number 1625428; transaction id 21
test-db-1          | 2024-06-24 23:37:00 0 [Note] mysqld: Shutdown complete
test-db-1          | 
test-db-1          | 2024-06-24 23:37:00+00:00 [Note] [Entrypoint]: Temporary server stopped
test-db-1          | 
test-db-1          | 2024-06-24 23:37:00+00:00 [Note] [Entrypoint]: MariaDB init process done. Ready for start up.
test-db-1          | 
test-db-1          | 2024-06-24 23:37:00 0 [Note] Starting MariaDB 10.3.39-MariaDB-1:10.3.39+maria~ubu2004 source revision ca001cf2048f0152689e1895e2dc15486dd0b1af as process 1
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Using Linux native AIO
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Uses event mutexes
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Compressed tables use zlib 1.2.11
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Number of pools: 1
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Using SSE2 crc32 instructions
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Initializing buffer pool, total size = 256M, instances = 1, chunk size = 128M
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Completed initialization of buffer pool
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority().
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: 128 out of 128 rollback segments are active.
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Creating shared tablespace for temporary tables
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ...
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB.
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: 10.3.39 started; log sequence number 1625428; transaction id 20
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool
test-db-1          | 2024-06-24 23:37:00 0 [Note] Plugin 'FEEDBACK' is disabled.
test-db-1          | 2024-06-24 23:37:00 0 [Note] InnoDB: Buffer pool(s) load completed at 240624 23:37:00
test-db-1          | 2024-06-24 23:37:00 0 [Note] Server socket created on IP: '::'.
test-db-1          | 2024-06-24 23:37:00 0 [Note] Reading of all Master_info entries succeeded
test-db-1          | 2024-06-24 23:37:00 0 [Note] Added new Master_info '' to hash table
test-db-1          | 2024-06-24 23:37:00 0 [Note] mysqld: ready for connections.
test-db-1          | Version: '10.3.39-MariaDB-1:10.3.39+maria~ubu2004'  socket: '/var/run/mysqld/mysqld.sock'  port: 3306  mariadb.org binary distribution
^CGracefully stopping... (press Ctrl+C again to force)
[+] Stopping 2/2
 ✔ Container db-test-test-phpmyadmin-1  Stopped                                                                                                                                                                                                                                                            1.2s 
 ✔ Container db-test-test-db-1          Stopped                                                                                                                                                                                                                                                            1.4s 
canceled
</pre><p>both tests are on a *blank-canvas* (i checked that there are no old volumes hanging around..)</p>
<p>in the root mode i definitely see some other startup behavior!</p>
<p>is this a known bug / incompatibility with my old image version??!
(i use this old version for maximum compatibility with the old server setup i try to replicate...)</p>
<p>i am thankful for any kind of hints!!</p>
<p>sunny greetings
stefan</p>

    </div>



    
        <h2>Answer
            <span class="answer_comment">Answered by 
<span class="user" id="user-15412">
<a href="/kb/user/id/15412" title="Stefan Krüger">Stefan Krüger</a>
</span> in <a href="#comment_6769">this comment</a>.</span></h2>
    
    <div class="answer formatted">
        <p>ok - it seems to be the old image..
with the current lts (mariadb:11.4) it seems working fine.</p>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                
                    <li><a href="/kb/en/mariadb-containers/">
                        ↑ MariaDB Containers ↑
                    </a>
                    </li>
                
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="14802" data-comments-url="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/+comments"
         data-reply-url="/kb/en/mariadb-image-not-exiting-smothly-with-docker-rootless/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/mariadb-containers/">
                    ↑ MariaDB Containers ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/benefits-of-managing-mariadb-containers-with-orchestration-software/">
                            
                            Benefits of Managing MariaDB Containers with Orchestration Software
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/installing-and-using-mariadb-via-docker/">
                            
                            Installing and Using MariaDB via Docker
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/container-backup-and-restoration/">
                            
                            Container Backup and Restoration
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/container-security-concerns/">
                            
                            Container Security Concerns
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/adding-plugins-to-the-mariadb-docker-official-image/">
                            
                            Adding Plugins to the MariaDB Docker Official Image
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/setting-up-a-lamp-stack-with-docker-compose/">
                            
                            Setting Up a LAMP Stack with Docker Compose
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/creating-a-custom-container-image/">
                            
                            Creating a Custom Container Image
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-server-docker-official-image-environment-variables/">
                            
                            MariaDB Server Docker Official Image Environment Variables
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/running-mariadb-columnstore-containers-on-linux-windows-and-macos/">
                            <span class="pull-right not_primary"></span>
                            Running MariaDB ColumnStore containers on Linux, Windows and MacOS
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/docker-official-image-frequently-asked-questions/">
                            
                            Docker Official Image Frequently Asked Questions
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/mariadb-container-cheat-sheet/">
                            
                            MariaDB Container Cheat Sheet
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/using-healthcheck-sh/">
                            
                            Using Healthcheck.sh
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/docker-and-aws-ec2/">
                            
                            Docker and AWS EC2
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/docker-and-google-cloud/">
                            
                            Docker and Google Cloud
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/docker-and-microsoft-azure/">
                            
                            Docker and Microsoft Azure
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>