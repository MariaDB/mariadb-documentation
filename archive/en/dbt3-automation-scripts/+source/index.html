<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>DBT3 Automation Scripts - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="DBT3 Automation Scripts - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/dbt3-automation-scripts/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/dbt3-automation-scripts/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/dbt3-automation-scripts/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/training-tutorials/">Training &amp; Tutorials</a>
    

    
    » <a class="crumb" href="/kb/en/advanced-mariadb-articles/">Advanced MariaDB Articles</a>
    

    
    » <a class="crumb" href="/kb/en/development-articles/">Development Articles</a>
    

    
    » <a class="crumb" href="/kb/en/quality/">Quality</a>
    

    
    » <a class="crumb" href="/kb/en/benchmarks-and-long-running-tests/">Benchmarks and Long Running Tests</a>
    

    
    » <a class="crumb" href="/kb/en/benchmarks/">Benchmarks</a>
    


    » <a class="node_link crumb" href="/kb/en/dbt3-automation-scripts/">DBT3 Automation Scripts</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/dbt3-automation-scripts/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>DBT3 Automation Scripts - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/dbt3-automation-scripts/+r/12745/">12745</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-2">
<a href="/kb/user/id/2" title="Daniel Bartholomew">Daniel Bartholomew</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2012-11-29 10:35">2012-11-29 10:35</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;
DBT-3 (OSDL Database Test 3) is a workload tool for the Linux kernel that OSDL
(Open Source Development Labs, inc) developed based on TPC-H which is provided
by the Transaction Performance Processing Council (TPC).

DBT-3, like TPC-H, simulates an actual decision-making support system and
models complex business analysis applications that perform data processing jobs
for making better business decisions. By running the workload that DBT-3
simulates, it is possible to verify and measure the performances of the Linux
kernel in an actual decision-making support system.

DBT-3 uses the &#34;scale factor (SF)&#34; as a stress indicator of the system. By
varying the SF, it becomes possible to make the size of a database the SF times
its size.

The tests performed by DBT-3 comprise the three tests listed below. DBT-3
obtains the execution times of these three tests as well as the system status
information and database statistics information.

#.1 **Load test**
**none Enters the data to be used for the Power and Throughput tests into the
       database.  Makes a bulk insert of the huge CSV data corresponding to the
       scale factor into the database.

#.2 **Power test**
**none Performs 22 complex queries.

#.3 **Throughput test**
**none Performs the same 22 queries as in the Power test simultaneously in more
       than one process.

For the purpose of this task, only the Power test is performed over preliminary
prepared database with various Scale factors. The time for each query execution
will be measured and stored into a database. Later the results of one whole
test with all 22 queries will be rendered into a histogram graphics comparing
it to different configurations.

== Benchmark environment preparation
=== sudo rights

The user that will run the benchmark must have sudo rights on the machine.

For clearing the system caches between query runs, the automation script uses
the following command:

&lt;&lt;code lang=bash inline=false&gt;&gt;
sudo /sbin/sysctl vm.drop_caches=3
&lt;&lt;/code&gt;&gt;

This command must be run with superuser rights. Even if a user supplies a
password to sudo, this password expires after some timeout. In order for this
command to be run without requiring password, the following line should be
added to the sudoers file (edit it with the ##&#34;sudo visudo&#34;## command):

&lt;&lt;code lang=bash inline=false&gt;&gt;
&#39;your_username&#39; ALL=NOPASSWD:/sbin/sysctl
&lt;&lt;/code&gt;&gt;

...where ##&#39;your_username&#39;## is the user that will run the benchmark.

=== Required software

The automated DBT3 benchmark requires the following software:

* **[[http://www.perl.org/|Perl]]**
**none **Project home:** http://www.perl.org/

* **[[https://launchpad.net/mariadb-tools|mariadb-tools]]**
**none **Project home:** https://launchpad.net/mariadb-tools
** The project folder is called &#34;##dbt3_benchmark##&#34; and is under ##mariadb-tools##.

* **[[http://sourceforge.net/projects/osdldbt/files/dbt3/|dbt3-1.9]]**
**none **Download location:** http://sourceforge.net/projects/osdldbt/files/dbt3/

* **[[http://www.gnuplot.info/|Gnuplot 4.4]]** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; graphics output program. 
**none **Project home:** http://www.gnuplot.info/

* **[[http://search.cpan.org/~simon/Config-Auto-0.03/Auto.pm|Config::Auto]]** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt;
  a Perl module that reads configuration files. To install it use the following
  command:&lt;&lt;code lang=bash inline=false&gt;&gt;sudo cpan Config::Auto&lt;&lt;/code&gt;&gt;

* **[[http://search.cpan.org/~capttofu/DBD-mysql-4.020/lib/DBD/mysql.pm|DBD::mysql]]** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt;
  a Perl module to connect to MariaDB/MySQL and PostgreSQL. To install it use
  the following command:&lt;&lt;code lang=bash inline=false&gt;&gt;sudo cpan DBD::mysql&lt;&lt;/code&gt;&gt;

**NOTE:** You may receive an error saying that CPAN could not find
##mysql_config##. In this case you have to install the mysql client development
library. In OpenSuse the command is: &lt;&lt;code lang=bash inline=false&gt;&gt;sudo zypper install libmysqlclient-devel&lt;&lt;/code&gt;&gt;

Alternatively this module can be installed manually by following these steps:

#.1 Download DBD-mysql-4.020.tar.gz from http://search.cpan.org/~capttofu/DBD-mysql-4.020/lib/DBD/mysql.pm and unpack it

#.2 Run the perl script PerlMake.pl under the unzipped dir:&lt;&lt;code lang=bash inline=false&gt;&gt;perl Makefile.PL --mysql_config=/path/to/some/mysql_binary_distribution/bin/mysql_config&lt;&lt;/code&gt;&gt;

#.3 Run ##make## to compile ##DBD::mysql##:&lt;&lt;code lang=bash inline=false&gt;&gt;make&lt;&lt;/code&gt;&gt;

#.4 Add the necessary paths in order to run ##DBD::mysql##:&lt;&lt;code lang=bash inline=false&gt;&gt;export PERL5LIB=&#34;/path/to/unzipped_DBD_mysql/DBD-mysql-4.020/lib&#34;
export LD_LIBRARY_PATH=&#34;/path/to/unzipped_DBD_mysql/DBD-mysql-4.020/blib/arch/auto/DBD/mysql/:/path/to/some/mysql_binary_distribution/lib/&#34;
&lt;&lt;/code&gt;&gt;

=== Tested DBMS

* **[[http://dev.mysql.com/downloads/mysql/#downloads|MySQL 5.5.x]]**
**none **Download location:** http://dev.mysql.com/downloads/mysql/#downloads →
  Generally Available (GA) Releases → Linux - Generic 2.6 (x86, 64-bit),
  Compressed TAR Archive - downloads mysql-5.5.x-linux2.6-x86_64.tar.gz -
  gzipped tar file for Linux x86

* **[[http://dev.mysql.com/downloads/mysql/#downloads|MySQL 5.6.x]]**
**none **Download location:** http://dev.mysql.com/downloads/mysql/#downloads →
  Development Releases → Linux - Generic 2.6 (x86, 64-bit), Compressed TAR
  Archive - downloads mysql-5.6.x-m5-linux2.6-x86_64.tar.gz - gzipped tar file
  for Linux x86 

* **[[https://launchpad.net/maria/5.3|MariaDB 5.3.x]]**
**none **Download location:** https://launchpad.net/maria/5.3 , downloaded with Bazaar: &lt;&lt;code lang=bash inline=false&gt;&gt;bzr branch lp:maria/5.3&lt;&lt;/code&gt;&gt;

* **[[https://launchpad.net/maria/5.3|MariaDB 5.5.x]]**
**none **Download location:** https://launchpad.net/maria/5.5 , downloaded with Bazaar: &lt;&lt;code lang=bash inline=false&gt;&gt;bzr branch lp:maria/5.5&lt;&lt;/code&gt;&gt;

* **[[http://www.postgresql.org/ftp/source/v9.1rc1/|PostgreSQL]]**
**none **Download location:** http://www.postgresql.org/ftp/source/v9.1rc1/

**NOTE:** The DBT3 benchmark requires a lot of disk space (for example MySQL
5.5.x + MyISAM database with scale factor 30 takes about 50 GB). Also some
queries require the utilization of temp tables under the directory set by the
&lt;&lt;code&gt;&gt;--tmpdir&lt;&lt;/code&gt;&gt; startup parameter passed to ##mysqld##. In the
prepared configuration files the temp directory is pointed to the ##mysql##
system directory of the binary distribution, but one should reassure that there
is enough free space available for the temp directory.

== Installation instructions

**NOTE:** The directory where all the files will be downloaded or installed
will be referred as ##$PROJECT_HOME##. This could be for example &lt;&lt;code&gt;&gt;~/benchmark/dbt3&lt;&lt;/code&gt;&gt;.

=== Download **[[https://launchpad.net/mariadb-tools|mariadb-tools]]**

# Go to your project folder&lt;&lt;code lang=bash inline=false&gt;&gt;cd $PROJECT_HOME&lt;&lt;/code&gt;&gt;
# Get the latest branch from LaunchPad with Bazaar:&lt;&lt;code lang=bash inline=false&gt;&gt;bzr branch lp:mariadb-tools&lt;&lt;/code&gt;&gt;

Now the project for the dbt3 benchmark test will be in the following dir:

&lt;&lt;code lang=bash inline=false&gt;&gt;
$PROJECT_HOME/mariadb-tools/dbt3_benchmark/
&lt;&lt;/code&gt;&gt;

The project ##dbt3_benchmark## has the following directories and files:

* **config** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; a folder where the configuration files
  for MariaDB, MySQL and PostgreSQL are stored. They are divided into
  subfolders named &#39;##sXX##&#39;, where ##XX## is the scale factor.
* **dbt3_mysql** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; a folder with all the necessary
  files for preparing DBT3 databases and queries for the tests with MySQL and
  MariaDB
* **tests** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; a folder where the different test
  configurations are stored. It contains the following directories:
** **db_conf** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; here are stored the database
   configuration files
** **queries_conf** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; here are stored the different
   queries configuration files
** **results_db_conf** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; here is stored the
   configuration of the results database
** **test_conf** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; here are the test configurations
** **launcher.pl** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; a perl script that automates the
   test. Details about calling and functionality of this file are listed later
   on this page.

=== Prepare benchmark workload and queries

For the purpose of the benchmark from
[[http://sourceforge.net/projects/osdldbt/files/dbt3/|DBT3-1.9]] we will only
need **DBGEN** and **QGEN**. DBGEN is a tool that generates a workload for the
test and QGEN is a tool that generates the queries used for the test.

#.1 Go to http://sourceforge.net/projects/osdldbt/files/dbt3/

#.2 Download the archive for DBT3 1.9 into your project folder $PROJECT_HOME

#.3 Unzip the archive into your project folder&lt;&lt;code lang=bash inline=false&gt;&gt;cd $PROJECT_HOME
tar -zxf dbt3-1.9.tar.gz
&lt;&lt;/code&gt;&gt;

#.4 Copy the file tpcd.h into the dbt3 folder. This step includes the necessary labels for MySQL/MariaDB when building queries.&lt;&lt;code lang=bash inline=false&gt;&gt;cp $PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/tpcd.h $PROJECT_HOME/dbt3-1.9/src/dbgen/&lt;&lt;/code&gt;&gt;

#.5 Copy the file Makefile under ##$PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/## into the dbt3 folder

*none **NOTE:** This step is executed only if you want to overwrite the default
   behavior of PostgreSQL settings. After copying this Makefile and building the
   project, QGEN will be set to generate queries for MariaDB/MySQL. If you skip
   this step, QGEN will generate queries for PostgreSQL by default.&lt;&lt;code lang=bash inline=false&gt;&gt;cp $PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/Makefile $PROJECT_HOME/dbt3-1.9/src/dbgen/&lt;&lt;/code&gt;&gt;

#.6 Go to $PROJECT_HOME/dbt3-1.9/src/dbgen and build the project&lt;&lt;code lang=bash inline=false&gt;&gt;cd $PROJECT_HOME/dbt3-1.9/src/dbgen
make
&lt;&lt;/code&gt;&gt;

#.7 Set the variable DSS_QUERY to the folder with template queries for MariaDB/MySQL or for PostgreSQL
## If you want to build the queries that fit MariaDB/MySQL dialect execute the following command:&lt;&lt;code lang=bash inline=false&gt;&gt;export DSS_QUERY=$PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/mysql_queries/&lt;&lt;/code&gt;&gt;
## If you want to use the default PostgreSQL templates, execute the following command:&lt;&lt;code lang=bash inline=false&gt;&gt;export DSS_QUERY=$PROJECT_HOME/dbt3-1.9/queries/pgsql/&lt;&lt;/code&gt;&gt;

#.8 Create a directory to store the generated queries in&lt;&lt;code lang=bash inline=false&gt;&gt;mkdir $PROJECT_HOME/gen_query&lt;&lt;/code&gt;&gt;

#.9 Generate the queries

&gt; **NOTE:** The examples use scale factor 30. If you want different scale, change
&gt; the value of ##-s## parameter

*none &lt;&lt;code lang=bash inline=false&gt;&gt;cd $PROJECT_HOME/dbt3-1.9/src/dbgen
./qgen -s 30 1 &gt; $PROJECT_HOME/gen_query/s30-m/1.sql
./qgen -s 30 2 &gt; $PROJECT_HOME/gen_query/s30-m/2.sql
./qgen -s 30 3 &gt; $PROJECT_HOME/gen_query/s30-m/3.sql
./qgen -s 30 4 &gt; $PROJECT_HOME/gen_query/s30-m/4.sql
./qgen -s 30 5 &gt; $PROJECT_HOME/gen_query/s30-m/5.sql
./qgen -s 30 6 &gt; $PROJECT_HOME/gen_query/s30-m/6.sql
./qgen -s 30 7 &gt; $PROJECT_HOME/gen_query/s30-m/7.sql
./qgen -s 30 8 &gt; $PROJECT_HOME/gen_query/s30-m/8.sql
./qgen -s 30 9 &gt; $PROJECT_HOME/gen_query/s30-m/9.sql
./qgen -s 30 10 &gt; $PROJECT_HOME/gen_query/s30-m/10.sql
./qgen -s 30 11 &gt; $PROJECT_HOME/gen_query/s30-m/11.sql
./qgen -s 30 12 &gt; $PROJECT_HOME/gen_query/s30-m/12.sql
./qgen -s 30 13 &gt; $PROJECT_HOME/gen_query/s30-m/13.sql
./qgen -s 30 14 &gt; $PROJECT_HOME/gen_query/s30-m/14.sql
./qgen -s 30 15 &gt; $PROJECT_HOME/gen_query/s30-m/15.sql
./qgen -s 30 16 &gt; $PROJECT_HOME/gen_query/s30-m/16.sql
./qgen -s 30 17 &gt; $PROJECT_HOME/gen_query/s30-m/17.sql
./qgen -s 30 18 &gt; $PROJECT_HOME/gen_query/s30-m/18.sql
./qgen -s 30 19 &gt; $PROJECT_HOME/gen_query/s30-m/19.sql
./qgen -s 30 20 &gt; $PROJECT_HOME/gen_query/s30-m/20.sql
./qgen -s 30 21 &gt; $PROJECT_HOME/gen_query/s30-m/21.sql
./qgen -s 30 22 &gt; $PROJECT_HOME/gen_query/s30-m/22.sql
&lt;&lt;/code&gt;&gt;

#.10 Generate the explain queries&lt;&lt;code lang=bash inline=false&gt;&gt;./qgen -s 30 -x 1 &gt; $PROJECT_HOME/gen_query/s30-m/1_explain.sql
./qgen -s 30 -x 2 &gt; $PROJECT_HOME/gen_query/s30-m/2_explain.sql
./qgen -s 30 -x 3 &gt; $PROJECT_HOME/gen_query/s30-m/3_explain.sql
./qgen -s 30 -x 4 &gt; $PROJECT_HOME/gen_query/s30-m/4_explain.sql
./qgen -s 30 -x 5 &gt; $PROJECT_HOME/gen_query/s30-m/5_explain.sql
./qgen -s 30 -x 6 &gt; $PROJECT_HOME/gen_query/s30-m/6_explain.sql
./qgen -s 30 -x 7 &gt; $PROJECT_HOME/gen_query/s30-m/7_explain.sql
./qgen -s 30 -x 8 &gt; $PROJECT_HOME/gen_query/s30-m/8_explain.sql
./qgen -s 30 -x 9 &gt; $PROJECT_HOME/gen_query/s30-m/9_explain.sql
./qgen -s 30 -x 10 &gt; $PROJECT_HOME/gen_query/s30-m/10_explain.sql
./qgen -s 30 -x 11 &gt; $PROJECT_HOME/gen_query/s30-m/11_explain.sql
./qgen -s 30 -x 12 &gt; $PROJECT_HOME/gen_query/s30-m/12_explain.sql
./qgen -s 30 -x 13 &gt; $PROJECT_HOME/gen_query/s30-m/13_explain.sql
./qgen -s 30 -x 14 &gt; $PROJECT_HOME/gen_query/s30-m/14_explain.sql
./qgen -s 30 -x 15 &gt; $PROJECT_HOME/gen_query/s30-m/15_explain.sql
./qgen -s 30 -x 16 &gt; $PROJECT_HOME/gen_query/s30-m/16_explain.sql
./qgen -s 30 -x 17 &gt; $PROJECT_HOME/gen_query/s30-m/17_explain.sql
./qgen -s 30 -x 18 &gt; $PROJECT_HOME/gen_query/s30-m/18_explain.sql
./qgen -s 30 -x 19 &gt; $PROJECT_HOME/gen_query/s30-m/19_explain.sql
./qgen -s 30 -x 20 &gt; $PROJECT_HOME/gen_query/s30-m/20_explain.sql
./qgen -s 30 -x 21 &gt; $PROJECT_HOME/gen_query/s30-m/21_explain.sql
./qgen -s 30 -x 22 &gt; $PROJECT_HOME/gen_query/s30-m/22_explain.sql
&lt;&lt;/code&gt;&gt;

Now the generated queries for MariaDB/MySQL test are ready and are stored into
the folder ##$PROJECT_HOME/gen_query/s30-m/## (-m is for MariaDB/MySQL).

Additional reorganization of directories is up to the user.

#.11 Create a directory for the generated workload&lt;&lt;code lang=bash inline=false&gt;&gt;mkdir $PROJECT_HOME/gen_data/s30&lt;&lt;/code&gt;&gt;

#.12 Set the variable DSS_PATH to the folder with the generated table data. The generated workload for the test will be generated there.&lt;&lt;code lang=bash inline=false&gt;&gt;export DSS_PATH=$PROJECT_HOME/gen_data/s30/&lt;&lt;/code&gt;&gt;

#.13 Generate the table data

*none **NOTE:** The example uses scale factor = ##30##. If you want to change it, you should change the parameter ##-s##.&lt;&lt;code lang=bash inline=false&gt;&gt;./dbgen -vfF -s 30&lt;&lt;/code&gt;&gt;

*none Now the generated data load is stored into the folder set in &lt;&lt;code&gt;&gt;$DSS_PATH = $PROJECT_HOME/gen_data/&lt;&lt;/code&gt;&gt;

For the purpose of this benchmark these steps have been performed for scale
factor 30 and are stored on facebook-maria1 in the following locations:

* ##~/benchmark/dbt3/gen_data/s30## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; the data load for scale factor 30
* ##~/benchmark/dbt3/gen_query/s30-m## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; generated queries for MariaDB/MySQL with scale factor 30
* ##~/benchmark/dbt3/gen_query/s30-p## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; generated queries for PostgreSQL with scale factor 30

See [[dbt3-example-preparation-time|DBT3 example preparation time]] to see how long it would take you to
prepare the databases for the test.

=== Download **[[http://dev.mysql.com/downloads/mysql/#downloads|MySQL 5.5.x]]**

#.1 Download the tar.gz file into your project folder ##$PROJECT_HOME/bin/## for example

#.2 Unzip the archive with the following command:&lt;&lt;code lang=bash inline=false&gt;&gt;gunzip &lt; mysql-5.5.x-linux2.6-x86_64.tar.gz |tar xf -&lt;&lt;/code&gt;&gt;

Now the server could be started with the following command:&lt;&lt;code lang=bash inline=false&gt;&gt;$PROJECT_HOME/bin/mysql-5.5.x-linux2.6-x86_64/bin/mysqld_safe --datadir=some/data/dir &amp;&lt;&lt;/code&gt;&gt;

=== Download **[[http://dev.mysql.com/downloads/mysql/#downloads|MySQL 5.6.x]]**

#.1 Download the tar.gz file into your project folder ##$PROJECT_HOME/bin/## for example

#.2 Unzip the archive with the following command:&lt;&lt;code lang=bash inline=false&gt;&gt;gunzip &lt; mysql-5.6.x-m5-linux2.6-x86_64.tar.gz |tar xf -&lt;&lt;/code&gt;&gt;

Now the server could be started with the following command:

&lt;&lt;code&gt;&gt;
$PROJECT_HOME/bin/mysql-5.6.x-m5-linux2.6-x86_64/bin/mysqld_safe --datadir=some/data/dir &amp;
&lt;&lt;/code&gt;&gt;

=== Download and build MariaDB 5.3.x / MariaDB 5.5.x

**NOTE:** These steps are the same for MariaDB 5.5.x with properly replaced
version numbers

#.1 Download with Bazaar the mariadb 5.3 project&lt;&lt;code lang=bash inline=false&gt;&gt;bzr branch lp:maria/5.3
mv 5.3/ mariadb-5.3&lt;&lt;/code&gt;&gt;

#.2 Build MariaDB&lt;&lt;code lang=bash inline=false&gt;&gt;cd mariadb-5.3/
./BUILD/compile-amd64-max&lt;&lt;/code&gt;&gt;

#.3 Build a binary distribution tar.gz file&lt;&lt;code lang=bash inline=false&gt;&gt;./scripts/make_binary_distribution&lt;&lt;/code&gt;&gt;

#.4 Move the generated tar.gz file and unzip it to $PROJECT_HOME/bin from where
    it will be used by the automation script&lt;&lt;code lang=bash inline=false&gt;&gt;mv mariadb-5.3.x-beta-linux-x86_64.tar.gz $PROJECT_HOME/bin/
cd $PROJECT_HOME/bin/
tar -xf mariadb-5.3.x-beta-linux-x86_64.tar.gz&lt;&lt;/code&gt;&gt;

Now the server could be started with the following command:&lt;&lt;code lang=bash inline=false&gt;&gt;$PROJECT_HOME/bin/mariadb-5.3.x-beta-linux-x86_64/bin/mysqld_safe --datadir=some/data/dir &amp;&lt;&lt;/code&gt;&gt;

=== Prepare the databases for the benchmark

**NOTE:** These instructions are the same for MariaDB, MySQL 5.5.x and MySQL
5.6.x with changing only the database home folders, noted here as $DB_HOME (for
example for MySQL 5.5.x $DB_HOME is
##$PROJECT_HOME/bin/mysql-5.5.x-linux2.6-x86_64##). Also you can prepare InnoDB
storage engine test databases. Instructions for preparing PostgreSQL could be
found in the section for downloading, building and preparing PostgreSQL later
on this page.

#.1 Open the file ##$PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/make-dbt3-db_innodb.sql## and edit the values for the call of the sql commands that look like this one:&lt;&lt;code lang=sql inline=false&gt;&gt;LOAD DATA INFILE &#39;/some/path/to/gen_data/nation.tbl&#39; into table nation fields terminated by &#39;|&#39;;&lt;&lt;/code&gt;&gt;

*none They all look the same but operate with different tables.

*none Replace &#34;/some/path/to/gen_data/&#34; with the proper directory where the
   generated data load is stored. At the end the same command could look like
   this:&lt;&lt;code lang=sql inline=false&gt;&gt;LOAD DATA INFILE &#39;~/benchmark/dbt3/gen_data/s30/nation.tbl&#39; into table nation fields terminated by &#39;|&#39;;&lt;&lt;/code&gt;&gt;

#.2 Create an empty MySQL database into a folder that will be used for the benchmark&lt;&lt;code lang=bash inline=false&gt;&gt;cd $DB_HOME
./scripts/mysql_install_db --defaults-file=$PROJECT_HOME/mariadb-tools/dbt3_benchmark/config/s30/load_mysql_myisam_my.cnf --basedir=$DB_HOME --datadir=$PROJECT_HOME/db_data/myisam-s30/&lt;&lt;/code&gt;&gt;

*none **NOTE:** For InnoDB change the defaults-file to ##load_mysql_innodb_my.cnf##.

#.3 Start the mysqld process&lt;&lt;code&gt;&gt;./bin/mysqld_safe --defaults-file=$PROJECT_HOME/mariadb-tools/dbt3_benchmark/config/s30/load_mysql_myisam_my.cnf --tmpdir=$PROJECT_HOME/temp/ --socket=$PROJECT_HOME/temp/mysql.sock --datadir=$PROJECT_HOME/db_data/myisam-s30/ &amp;&lt;&lt;/code&gt;&gt;

*none **NOTE:** For InnoDB change the defaults-file to ##load_mysql_innodb_my.cnf##.
   Also make sure that you have enough space in the directory set by the
   parameter &lt;&lt;code&gt;&gt;--tmpdir&lt;&lt;/code&gt;&gt;, since loading the database could take a
   lot of temporary space.

#.4 Load the data into the database by executing the file ##make-dbt3-db_pre_create_PK.sql## (for InnoDB) or ##make-dbt3-db_post_create_PK.sql## (for MyISAM)&lt;&lt;code&gt;&gt;./bin/mysql -u root -S $PROJECT_HOME/temp/mysql.sock &lt; $PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/make-dbt3-db_post_create_PK.sql&lt;&lt;/code&gt;&gt;

*none **NOTE:** For faster creation, it is recommended to
   use ##make-dbt3-db_pre_create_PK.sql## for loading InnoDB
   and ##make-dbt3-db_post_create_PK.sql## for loading MyISAM databases.

#.5 Shutdown the database server:&lt;&lt;code lang=bash inline=false&gt;&gt;./bin/mysqladmin --user=root --socket=$PROJECT_HOME/temp/mysql.sock shutdown 0&lt;&lt;/code&gt;&gt;

Now you have a database loaded with scale 30. Its datadir is
##$PROJECT_HOME/db_data/myisam-s30/##

The same steps can be reproduced for different scale factors and for different
storage engines.

=== Download, build and prepare **[[http://www.postgresql.org/ftp/source/v9.1rc1/|PostgreSQL]]**===

#.1 Go to http://www.postgresql.org/ftp/source/v9.1rc1/

#.2 Download the file under the link postgresql-9.1rc1.tar.gz

#.3 Unzip the archive to your project folder&lt;&lt;code lang=bash inline=false&gt;&gt;gunzip &lt; postgresql-9.1rc1.tar.gz |tar xf -&lt;&lt;/code&gt;&gt;

#.4 Execute the following commnads into the shell to install PostgreSQL:&lt;&lt;code lang=bash inline=false&gt;&gt;mkdir $PROJECT_HOME/PostgreSQL_bin
cd $PROJECT_HOME/postgresql-9.1rc1 
./configure --prefix=$PROJECT_HOME/bin/PostgreSQL_bin 
make
make install&lt;&lt;/code&gt;&gt;

*none **NOTE:** Configure script may not find the following libraries: readline
   and zlib. In that case you can run configure without these libraries by
   adding the following parameters to the command line:
   &lt;&lt;code&gt;&gt;--without-readline --without-zlib&lt;&lt;/code&gt;&gt;

#.5 Prepare the database to test with:&lt;&lt;code lang=bash inline=false&gt;&gt;mkdir $PROJECT_HOME/db_data/postgre_s30
cd $PROJECT_HOME/bin/PostgreSQL_bin
./bin/initdb -D $PROJECT_HOME/db_data/postgre_s30&lt;&lt;/code&gt;&gt;

#.6 Start the server:&lt;&lt;code lang=bash inline=false&gt;&gt;./bin/postgres -D $PROJECT_HOME/db_data/postgre_s30 -p 54322 &amp;&lt;&lt;/code&gt;&gt;

#.7 Load the dataload into the DB&lt;&lt;code lang=bash inline=false&gt;&gt;./bin/createdb -O {YOUR_USERNAME} dbt3 -p 54322
./bin/psql -p 54322 -d dbt3 -f $PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/make-dbt3-db_pg.sql&lt;&lt;/code&gt;&gt;

*none **NOTE:** Here under &lt;&lt;code&gt;&gt;{YOUR_USERNAME}&lt;&lt;/code&gt;&gt; you should put the
   database owner.

#.8 Stop the server:
&lt;&lt;code lang=bash inline=false&gt;&gt;
./bin/pg_ctl -D $PROJECT_HOME/db_data/postgre_s30/ -p 54322 stop
&lt;&lt;/code&gt;&gt;

The steps for preparing the workload for the benchmark on facebook-maria1 are
already made for MariaDB, MySQL and PostgreSQL. Here are the directories for
the different DBMS, storage engines and scale factors that are prepared on
facebook-maria1:

* &lt;&lt;code&gt;&gt;~/benchmark/dbt3/db_data/myisam_s30&lt;&lt;/code&gt;&gt;
  &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; datadir for MariaDB/MySQL + MyISAM with scale
  factor 30

* &lt;&lt;code&gt;&gt;~/benchmark/dbt3/db_data/innodb_mariadb_s30&lt;&lt;/code&gt;&gt;
  &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; datadir for MariaDB + InnoDB with scale factor 30
  (TODO)

* &lt;&lt;code&gt;&gt;~/benchmark/dbt3/db_data/innodb_mysql_s30&lt;&lt;/code&gt;&gt;
  &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; datadir for
  MySQL + InnoDB with scale factor 30 (TODO)

* &lt;&lt;code&gt;&gt;~/benchmark/dbt3/db_data/postgre_s30&lt;&lt;/code&gt;&gt;
  &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; datadir for
  PostgreSQL with scale factor 30 (TODO)

=== Prepare the results database

The results of the benchmark will be stored in a separate database that will be
run by MariaDB 5.3.x.

**NOTE:** The results database will be a subject to change in future versions
of the DBT3 benchmarking project. 

The database is created by the file
##$PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/make-results-db.sql##.
In that file you can find details about every table and column in the database.

To prepare the database for work follow these steps:

#.1 Go to MariaDB 5.3.x installation directory&lt;&lt;code lang=bash inline=false&gt;&gt;cd $PROJECT_HOME/bin/mariadb-5.3.x-beta-linux-x86_64&lt;&lt;/code&gt;&gt;

#.2 Install the system database tables into the datadir for the results (for
example ##$PROJECT_HOME/db_data/dbt3_results_db##)&lt;&lt;code lang=bash inline=false&gt;&gt;./scripts/mysql_install_db --datadir=$PROJECT_HOME/db_data/dbt3_results_db&lt;&lt;/code&gt;&gt;

#.3 Start mysqld for results db&lt;&lt;code lang=bash inline=false&gt;&gt;./bin/mysqld_safe --defaults-file=$PROJECT_HOME/mariadb-tools/dbt3_benchmark/config/results_mariadb_my.cnf --port=12340 --socket=$PROJECT_HOME/temp/mysql_results.sock  --datadir=$PROJECT_HOME/db_data/dbt3_results_db/ &amp;&lt;&lt;/code&gt;&gt;

#.4 Install the database&lt;&lt;code lang=bash inline=false&gt;&gt;./bin/mysql -u root -P 12340 -S $PROJECT_HOME/temp/mysql_results.sock &lt; $PROJECT_HOME/mariadb-tools/dbt3_benchmark/dbt3_mysql/make-results-db.sql&lt;&lt;/code&gt;&gt;

#.5 Shutdown the results db server:&lt;&lt;code lang=bash inline=false&gt;&gt;./bin/mysqladmin --user=root --port=12340 --socket=$PROJECT_HOME/temp/mysql_results.sock shutdown 0&lt;&lt;/code&gt;&gt;

== Automation script

=== Configuring and running a benchmark

In order to run a benchmark, one should have:

* 5 configuration files:
## **DBMS** server configuration (see [[#dbms-server-configuration]])
## **Test** configuration (see [[#test-configuration]])
## **Queries** configuration (see [[#queries-configuration]])
## **Results database** configuration (see [[#results-database-configuration]])
## **Top-level** configuration file that combines all of the above (see
   [[#top-level-configuration]])
* an **automation script ##launcher.pl##** that could be found
  under ##mariadb-tools/dbt3_benchmark/##
* **startup parameters** that should be passed to the automation script (see
  [[#script-startup-parameters]]).

Details about each of these is given in the following sections.

Each benchmark is configured by a set of configuration files. One can find
example (default) configuration files under the directory
&#39;mariadb-tools/dbt3_benchmark/tests&#39;. Each configuration file has an &#39;ini&#39;
configuration syntax and is parsed by the perl automation script with the CPAN
module [[http://search.cpan.org/~simon/Config-Auto-0.03/Auto.pm|Config::Auto]]

==== Configuration keywords

Every configuration file could contain keywords that will be replaced by the
script with particular values. They are used for convenience when you want to
make your configuration files more common to the environment that you have
prepared for the benchmark. These keywords are:

* ##$PROJECT_HOME## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; used as the directory where the
  project &#39;##mariadb-tools##&#39; is located or as a base path for the whole project
  (e.g. &#34;&lt;&lt;code&gt;&gt;DBMS_HOME = $PROJECT_HOME/bin/mariadb-5.3.x-beta-linux-x86_64&lt;&lt;/code&gt;&gt;&#34;).
  It is replaced by the value set with the startup parameter **&#39;project-home**&#39;
  passed to **launcher.pl**,

* ##$DATADIR_HOME## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; used as the directory where the
  datadir folders are located for the benchmark (e.g.
  &#34;&lt;&lt;code&gt;&gt;$DATADIR_HOME/myisam-s30&lt;&lt;/code&gt;&gt;&#34;). It is replaced by the value set
  with the startup parameter **&#39;datadir-home&#39;** passed to **launcher.pl**.

* ##$QUERIES_HOME## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; used as the directory where the
  queries are located (e.g.  &#34;##$QUERIES_HOME/s30-m##&#34;
  &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; queries for MariaDB/MySQL for scale factor 30). It
  is replaced by the value set with the startup parameter **&#39;queries-home&#39;**
  passed to **launcher.pl**.

* ##$SCALE_FACTOR## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; the scale factor that will be
  used. It is usually a part of the name of the datadir directory (e.g.
  &#34;##$DATADIR_HOME/myisam-s$SCALE_FACTOR##&#34;), the queries directory (e.g.
  &#34;##$QUERIES_HOME/s$SCALE_FACTOR-m##&#34;) or the database configuration directory
  (e.g. ##$PROJECT_HOME/mariadb-tools/dbt3_benchmark/config/s$SCALE_FACTOR##).
  It is replaced by the value set with the startup parameter **&#39;scale-factor&#39;**
  passed to **launcher.pl**.

Note that if any of the configuration files contains such keyword, the
corresponding startup parameter passed to **launcher.pl** will become required.

==== Top-level configuration

A top-level configuration file provides paths to the **Test, DBMS, Queries**
and **Results database** configurations files

There are default configuration files in the directory
##mariadb-tools/dbt3_benchmark/tests/## and contain the following settings:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Parameter            |= Description
| ##RESULTS_DB_CONFIG## | The configuration file for results DB settings
| ##TEST_CONFIG##       | The configuration file for the test settings
| ##QUERIES_CONFIG##    | The configuration file for the queries settings
| ##DB_CONFIG##         | The configuration file for the DBMS server settigns
&lt;&lt;/style&gt;&gt;

This file has the following format:

&lt;&lt;code&gt;&gt;
[common]
RESULTS_DB_CONFIG  = $PROJECT_HOME/mariadb-tools/dbt3_benchmark/tests/results_db_conf/results_db.conf
TEST_CONFIG        = $PROJECT_HOME/mariadb-tools/dbt3_benchmark/tests/test_conf/test_myisam.conf

[mariadb_5_3]
QUERIES_CONFIG 	= $PROJECT_HOME/mariadb-tools/dbt3_benchmark/tests/queries_conf/queries.conf
DB_CONFIG 	= $PROJECT_HOME/mariadb-tools/dbt3_benchmark/tests/db_conf/db_mariadb_5_3_myisam.conf

[mysql_5_5]
QUERIES_CONFIG 	= $PROJECT_HOME/mariadb-tools/dbt3_benchmark/tests/queries_conf/queries_mysql.conf
DB_CONFIG 	= $PROJECT_HOME/mariadb-tools/dbt3_benchmark/tests/db_conf/db_mysql_5_5_myisam.conf
...
&lt;&lt;/code&gt;&gt;

**NOTE:** The settings ##RESULTS_DB_CONFIG## and ##TEST_CONFIG## should be set
under the ##[common]## section. They are common for the whole test (although
some settings from ##TEST_CONFIG## could be overridden in the
##QUERIES_CONFIG## file). All settings that combine ##QUERIES_CONFIG## and
##DB_CONFIG## should be in a separate section (e.g. ##[mariadb_5_3]##).

A test configuration is passed as an input parameter to the automation script
with the parameter
&lt;&lt;code&gt;&gt;--test=/path/to/some_test_configuration.conf&lt;&lt;/code&gt;&gt; (see
[[#script-startup-parameters]])

==== DBMS server configuration

These configuration files contain settings that describe the benchmarked DBMS.
They are usually contained into the folder
##mariadb-tools/dbt3_benchmark/tests/db_conf##.

Here is the list of parameters that could be set into this configuration file:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Parameter            |= Description
|  ##DBMS_HOME##        | Where the instalation folder of MariaDB / MySQL / PostgreSQL is located.\\\\**NOTE:** The automation script uses &#34;##./bin/mysqld_safe##&#34; to start the ##mysqld## process. So the versions of MariaDB and MySQL should be a &#34;binary distribution&#34; ones.
|  ##DBMS_USER##        | The database user that will be used.
|  ##CONFIG_FILE##      | The config file that mysqld or postgres will use when starting
|  ##SOCKET##           | The socket that will be used to start the server
|  ##PORT##             | The port that the server will be started on
|  ##HOST##             | The host where the server is located
|  ##DATADIR##          | Where the datadir for mysqld or postgres is located
|  ##TMPDIR##           | Where the temp tables will be created while sorting and grouping.
|  ##DBNAME##           | The database (schema) name where the benchmark tables are located.
|  ##KEYWORD##          | This text will be stored into the results database as a keyword. Also will be used as a name for a subfolder with results and statistics.
|  ##DBMS##             | Database Management System that will be used. Possible values: &#34;MySQL&#34;, &#34;MariaDB&#34; and &#34;PostgreSQL&#34;
|  ##STORAGE_ENGINE##   | The storage engine that was used (MyISAM, InnoDB, etc.)
|  ##STARTUP_PARAMS##   | Any startup parameters that will be used while starting the mysqld process or postgres process. Same format as given on the command line.
|  ##GRAPH_HEADING##    | The heading of the graphic for that particular test.
|  ##MYSQL_SYSTEM_DIR## | See //&#34;##MYSQL_SYSTEM_DIR## note&#34;//, below.
|  ##READ_ONLY##        | If set to 1, mysqld process will be started with &#39;&lt;&lt;code&gt;&gt;--read-only&lt;&lt;/code&gt;&gt;&#39; startup parameter
|  ##PRE_RUN_SQL##      | SQL commands that are run prior each query run
|  ##POST_RUN_SQL##     | SQL commands that are run after each query run
|  ##PRE_TEST_SQL##     | SQL commands that are run prior the whole test with that database settings
|  ##POST_TEST_SQL##    | SQL commands that are run after the whole test with that database settings
&lt;&lt;/style&gt;&gt;

&lt;&lt;style class=graybox&gt;&gt;
**##MYSQL_SYSTEM_DIR## note:**\\\\

This option is added for convenience when you want to save time and disk space
for generating databases for different DBMS (and different versions) and use a
single data directory for all of them. When running different versions of
MariaDB/MySQL over a single datadir, one should run
[[http://dev.mysql.com/doc/refman/5.5/en/mysql-upgrade.html|mysql-upgrade]] in
order to fix the system tables. So in one data directory, you could prepare the
following directories for different MariaDB/MySQL system directories:
\\\\
* ##mysql_mysql_5_5## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; a copy of the system directory
  &#39;##mysql##&#39; upgraded by MySQL 5.5.x
* ##mysql_mariadb_5_3## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; a copy of the system
  directory &#39;##mysql##&#39; upgraded by MariaDB 5.3.x
* ##mysql_mariadb_5_5## &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; a copy of the system
  directory &#39;##mysql##&#39; upgraded by MariaDB 5.5.x\\\\

If ##MYSQL_SYSTEM_DIR## is set to one of these directories, the automation
script will unlink the current system directory &#39;mysql&#39; and make a new symbolic
link with that name to the one in the setting.\\\\

Here is an example command that will be executed:
\\
&lt;&lt;code lang=bash inline=false&gt;&gt;
unlink /path/to/datadir/mysql
ln -s /path/to/value/in/MYSQL_SYSTEM_DIR/mysql_mariadb_5_3 /path/to/datadir/mysql
&lt;&lt;/code&gt;&gt;
\\
**NOTE:** This approach is suitable for MyISAM tests.
&lt;&lt;/style&gt;&gt;

The configuration file looks like this:

&lt;&lt;code&gt;&gt;
[db_settings]
DBMS_HOME	= $PROJECT_HOME/bin/mariadb-5.3.2-beta-linux-x86_64
DBMS_USER	= root
...
&lt;&lt;/code&gt;&gt;

Note that the section ##[db_settings]## is required for the file to be properly
parsed by the automation script.

==== Test configuration

These configuration files contain settings describing the test. They are
usually contained into the folder
**mariadb-tools/dbt3_benchmark/tests/test_conf**. 

Here is the list of parameters that could be set into this configuration file:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Parameter |= Description
|  ##QUERIES_AT_ONCE## | If set to ##1##, then all the queries are executed sequentially without restarting the server or clearing the caches between queries.
|  ##CLEAR_CACHES## | If set to ##1##, the disk caches will be cleared before each query test.
|  ##WARMUP## | Perform a warm-up runs before running the query.
|  ##EXPLAIN## | Run an Explain command prior the run of the query. The explain results will be stored in a file under the results output directory.
|  ##RUN## | Perform the actual test
|  ##ANALYZE_EXPLAIN## | A result extraction mechanism where only the best execution plan (results from ##EXPLAIN## select) will be measured. It is designed to be used when benchmarking InnoDB storage engine where execution plan is changing between server restarts (see [[#results-extraction-mechanisms]]).
|  ##MIN_MAX_OUT_OF_N## | A result extraction mechanism where the minimal and maximal values out of ##N## (set by the parameter ##NUM_TESTS##) tests are taken as a result. This could be used when InnoDB storage engine is tested (see [[#results-extraction-mechanisms]]).
|  ##SIMPLE_AVERAGE## | A result extraction mechanism where the final result is the average time taken for the tests. The number of tests is per query is set by the NUM_TESTS parameter. Note that if even one test has timed out, the result is &#39;time-out&#39;. This is used when testing MyISAM storage engine since there the execution plan is constant (see [[#results-extraction-mechanisms]]).
|  ##NUM_TESTS## | How many tests should be performed for each query. When ANALYZE_EXPLAIN is set, this value could be set to 0, meaning that the tests will continue until enough results are extracted (see setting ##CLUSTER_SIZE##). This parameter is very important when ##MIN_MAX_OUT_OF_N## or ##SIMPLE_AVERAGE## is selected.
|  ##MAX_SKIPPED_TESTS## | When ANALYZE_EXPLAIN is set and an execution plan that is slower is selected, the execution of the query is skipped and the server is restarted in order to change the execution plan. If the server is restarted more than ##MAX_SKIPPED_TESTS##, there are obviously no more different execution plans and the script continues to the next query benchmark.
|  ##WARMUPS_COUNT## | How many warmup runs will be performed prior the actual benchmark run.
|  ##CLUSTER_SIZE## | How big a cluster with results for a query should be in order to extract the final result. It is used when ##ANALYZE_EXPLAIN## is selected as a result extraction method.
|  ##MAX_QUERY_TIME## | The maximum time that one query will be tested. Currently it is applicable only when ##ANALYZE_EXPLAIN## is selected.
|  ##TIMEOUT## | The maximum time that one query could run. Currently timeout is applicable only for MySQL and MariaDB.
|  ##OS_STATS_INTERVAL## | What is the time interval between extraction of OS statistics for CPU, memory, etc.
|  ##PRE_RUN_OS## | OS commands that should be executed prior each query run
|  ##POST_RUN_OS## | OS commands that should be executed after each query run
|  ##PRE_TEST_OS## | OS commands that should be executed prior the whole test
|  ##POST_TEST_OS## | OS commands that should be executed after the whole test is complete
&lt;&lt;/style&gt;&gt;

The configuration file looks like this:

&lt;&lt;code&gt;&gt;
QUERIES_AT_ONCE = 0
CLEAR_CACHES	= 1
WARMUP		= 0
...
&lt;&lt;/code&gt;&gt;

==== Queries configuration

These configuration files contain the list of all the queries that will be
benchmarked against each database. Some settings
from ##DBMS server configuration## and ##Test configuration## could be
overridden into the ##Queries configuration## files.  The folder that contains
such configurations is ##mariadb-tools/dbt3_benchmark/tests/queries_conf##.

Here is the list of parameters that could be set into this configuration file:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Parameter |= Description
|  ##QUERIES_HOME## | Where the queries are located on disk. This value is concatenated to the ##QUERY## setting and this makes the path to the particular query. **NOTE:** This setting should be set under the section ##[queries_settings]##.
|  ##CONFIG_FILE## | This overrides the startup setting ##CONFIG_FILE## from **DMBS server** configuration file and sets the database configuration file that is used. It could be used if some configuration file without any optimizations should be set for this particular queries configuration file.\\\\**NOTE:** This setting should be set under the section ##[queries_settings]##.
|  ##QUERY## | The name of the query located into ##QUERIES_HOME## folder. E.g. &#34;1.sql&#34;
|  ##EXPLAIN_QUERY## | The name of the explain query into ##QUERIES_HOME## folder. E.g. &#34;1_explain.sql&#34;
|  ##TMPDIR## | This overrides the setting TMPDIR from the ##DMBS server## configuration.
|  ##STARTUP_PARAMS## | This overrides the setting ##STARTUP_PARAMS## from the ##DMBS server## configuration. Using this setting one could change the particular startup parameters (like optimizations and buffers) for the DB server.
|  ##PRE_RUN_SQL## | This overrides the setting ##PRE_RUN_SQL## from the **DMBS server** configuration.
|  ##POST_RUN_SQL## | This overrides the setting ##POST_RUN_SQL## from the **DMBS server** configuration.
|  ##RUN## | This overrides the setting ##RUN## from the **test** configuration.
|  ##EXPLAIN## | This overrides the setting ##EXPLAIN## from the **test** configuration.
|  ##TIMEOUT## | This overrides the setting ##TIMEOUT## from the **test** configuration.
|  ##NUM_TESTS## | This overrides the setting ##NUM_TESTS## from the **test** configuration.
|  ##MAX_SKIPPED_TESTS## | This overrides the setting ##MAX_SKIPPED_TESTS## from the **test**  configuration.
|  ##WARMUP## | This overrides the setting ##WARMUP## from the **test**  configuration.
|  ##WARMUPS_COUNT## | This overrides the setting ##WARMUPS_COUNT## from the **test**  configuration.
|  ##MAX_QUERY_TIME## | This overrides the setting ##MAX_QUERY_TIME## from the **test**  configuration.
|  ##CLUSTER_SIZE## | This overrides the setting ##CLUSTER_SIZE## from the **test**  configuration.
|  ##PRE_RUN_OS## | This overrides the setting ##PRE_RUN_OS## from the **test**  configuration.
|  ##POST_RUN_OS## | This overrides the setting ##POST_RUN_OS## from the **test**  configuration.
|  ##OS_STATS_INTERVAL## | This overrides the setting ##OS_STATS_INTERVAL## from the **test**  configuration.
&lt;&lt;/style&gt;&gt;

The queries configuration file could look like this:

&lt;&lt;code&gt;&gt;
[queries_settings]
QUERIES_HOME = /path/to/queries

[query1]
QUERY=1.sql
EXPLAIN_QUERY=1_explain.sql
STARTUP_PARAMS=

[query2]
QUERY=2.sql
EXPLAIN_QUERY=2_explain.sql
STARTUP_PARAMS=--optimizer_switch=&#39;mrr=on&#39; --mrr_buffer_size=8M --some_startup_parmas
...
&lt;&lt;/code&gt;&gt;

...where &#34;##QUERIES_HOME = /path/to/queries##&#34; could be replaced with
&#34;##QUERIES_HOME = $QUERIES_HOME/s$SCALE_FACTOR-m##&#34; for example and thus
##$QUERIES_HOME## and $SCALE_FACTOR will be replaced by the script startup
parameters passed to ##launcher.pl## (see [[#script-startup-parameters]])

**NOTE:** The section ##[queries_settings]## is required for the configuration
file to be parsed correctly. Also each query settings should be set under an
uniquely named configuration section (e.g. ##[query1]## or ##[1.sql]##)

==== Results database configuration

These configuration files contain settings about the database where the results
will be stored. They are usually contained into the folder
##mariadb-tools/dbt3_benchmark/tests/results_db_conf##.

Here is the list of parameters that could be set into this configuration file:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Parameter |= Description
|  ##DBMS_HOME## | Where the database directory is located. E.g. &#34;##$PROJECT_HOME/mariadb-5.3.x-beta-linux-x86_64##&#34;. This should be a binary distribution of MariaDB or MySQL.
|  ##DBMS_USER## | The user that will be used by the DBMS
|  ##DATADIR## | Where the data directory is located for the results database
|  ##CONFIG_FILE## | What the configuration file used by the database is.
|  ##SOCKET## | The socket that will be used by the results database. This should be different socket than the one provided for the testing databases.
|  ##PORT## | The port that the results database will use. This should be different port than the one provided for the testing databases.
|  ##STARTUP_PARAMS## | Any startup parameters that should be set to start the server.
|  ##DBNAME## | The database name to use.
|  ##HOST## | The host where the results database is.
&lt;&lt;/style&gt;&gt;

The results database configuration could look like this:
&lt;&lt;code&gt;&gt;
DBMS_HOME	= $PROJECT_HOME/mariadb-5.3.x-beta-linux-x86_64
DBMS_USER	= root
...
&lt;&lt;/code&gt;&gt;

==== Script startup parameters

##launcher.pl## could accept startup parameters called in the manner
&#34;&lt;&lt;code&gt;&gt;--some-param&lt;&lt;/code&gt;&gt;&#34;. Note that these startup parameters are
case-sensitive. The ones that are with upper-case are used when overriding a
setting in some of the configuration files.

Here is a list of the startup parameters:

&lt;&lt;style class=&#34;darkheader-nospace-borders&#34;&gt;&gt;
|= Parameter |= Description
|  ##test## | The top-level benchmark configuration file that will be run. This is a **required** startup parameter.
|  ##results-output-dir## | Where the results of the benchmark will be stored. A timestamp is automatically attached to the directory name so that it keeps track of time and date of the benchmark. This is a **required** parameter.
|  ##dry-run## | If set, no benchmark will be performed. Instead only messages will be displayed for the actions that were intended to be done.
|  ##project-home## | Required if any configuration file uses the variable &#39;##$PROJECT_HOME##&#39;. If all configuration files use absolute paths, not used.
|  ##datadir-home## | The value in this parameter will replace any occurrences of the string &#39;##$DATADIR_HOME##&#39; into the configuration files. If there are no such occurances, it is not a required parameter.
|  ##queries-home## | The value in this parameter will replace any occurrences of the string &#39;##$QUERIES_HOME##&#39; into the configuration files.  If there are no such occurances, it is not a required parameter.
|  ##scale-factor## | The value in this parameter will replace any occurrences of the string &#39;##$SCALE_FACTOR##&#39; into the configuration files.  If there are no such occurances, it is not a required parameter.
|  ##CLEAR_CACHES## | If set. this overrides the default setting set into the **test** configuration file.
|  ##QUERIES_AT_ONCE## | If set. this overrides the default setting set into the **test** configuration file.
|  ##RUN## | If set. this overrides the default setting set into the **test** configuration file.
|  ##EXPLAIN## | If set. this overrides the default setting set into the **test** configuration file.
|  ##TIMEOUT## | If set. this overrides the default setting set into the **test** configuration file.
|  ##NUM_TESTS## | If set. this overrides the default setting set into the **test** configuration file.
|  ##MAX_SKIPPED_TESTS## | If set. this overrides the default setting set into the **test** configuration file.
|  ##WARMUP## | If set. this overrides the default setting set into the **test** configuration file.
|  ##WARMUPS_COUNT## | If set. this overrides the default setting set into the **test** configuration file.
|  ##MAX_QUERY_TIME## | If set. this overrides the default setting set into the **test** configuration file.
|  ##CLUSTER_SIZE## | If set. this overrides the default setting set into the **test** configuration file.
|  ##PRE_RUN_OS## | If set. this overrides the default setting set into the **test** configuration file.
|  ##POST_RUN_OS## | If set. this overrides the default setting set into the **test** configuration file.
|  ##OS_STATS_INTERVAL## | If set. this overrides the default setting set into the **test** configuration file.
&lt;&lt;/style&gt;&gt;

=== Results extraction mechanisms

There are three possible result extraction mechanisms. They are set by the
parameters set into the test configuration file:

* ##ANALYZE_EXPLAIN##
* ##MIN_MAX_OUT_OF_N##
* ##SIMPLE_AVERAGE##

Only one of these should be set to true (1). 

**##ANALYZE_EXPLAIN##** is used for benchmarking InnoDB storage engine where the
execution plan could change for the same query when the server is restarted. It
is designed to run the query only with the fastest execution plan. This means
that the server is restarted if the current execution plan is proven slower
than the other. As a final result is taken the result for the query plan that
turns out to be fastest and there are at least ##CLUSTER_SIZE## tests with it for
that query. By setting the configuration parameter ##NUM_TESTS## you can set a
maximum test runs that when reached will get the best cluster&#39;s average time
(even if it is less than ##CLUSTER_SIZE##). Also when a timeout for that query
(##MAX_QUERY_TIME##) is reached, the scoring mechanism will return the best
available cluster result.

**##MIN_MAX_OUT_OF_N##** is also used for benchmarking InnoDB storage engine.
As a result are stored the values for the fastest and the slowest run. It is
assumed that when the execution plan has changed it has different execution
plan and we are interested only in the min and max time.

**##SIMPLE_AVERAGE##** is used for benchmarking storage engines that do not
change the execution plan between restarts like MyISAM. The final result is the
average execution time from all the test runs for the query.

=== Results graphics

After each query test run, the result is stored into a file named
**results.dat** located into &lt;&lt;code&gt;&gt;{RESULTS_OUTPUT_DIR}&lt;&lt;/code&gt;&gt;. This file
is designed to be easy to be read by the plotting program Gnuplot 4.4. It is
divided into blocks, separated by several new lines. Each block starts with a
comment line containing details for the current block of results.

Queries that have timed out have a value of ##100000## so that they run out of
the graphics and are cut off. Other queries have their real times (in seconds)
starting from ##0##. The graphics is cut off on the y-axis on the longest time
for ##completed test + 20%##. For example if the longest time is ##100##
seconds, the graphics is cut-off to ##120## seconds. Thus the timed out queries
will be truncated by this limitation and will seem as really timed out.

During the test run, a gnuplot script file is generated with the necessary
parameters for the graphics to be generated automatically. After each query
test run is complete, the graphic is regenerated, so that the user can see the
current results before the whole benchmark is complete. This file is called
##gnuplot_script.txt## and is located into ##{RESULTS_OUTPUT_DIR}##. The user
can edit it to fine-tune the parameters or headings after the test is complete
so that one could get the look and feel he/she wants for the final result.

=== Script output
==== Benchmark output

In the directory set by the parameter {RESULTS_OUTPUT_DIR} (example:
##~/benchmark/dbt3/results/myisam_test_2011-12-08_191427/##) there are the
following files/directories:

* A directory for each test, named as the parameter {KEYWORD} from the test
  configuration (example: ##mariadb-5-3-2##)
* **cpu_info.txt** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; the output
  of &#34;##/bin/cat /proc/cpuinfo##&#34; OS command
* **uname.txt** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; the output of &#34;##uname -a##&#34; OS
  command
* **results.dat** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; the results of each query
  execution in one file. This file will be used as a datafile for the gnuplot
  script. It also contains the ratio between the current test and the first
  one.
* **gnuplot_script.txt** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; the Gnuplot script that
  renders the graphics.
* **graphics.jpeg** &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; the output graphics
* A **benchmark** configuration file
  (example: ##myisam_test_mariadb_5_3_mysql_5_5_mysql_5_6.conf##) copied
  from ##mariadb-tools/dbt3_benchmark/tests/##
* A **results database** configuration file (example: ##results_db.conf##)
  copied from ##mariadb-tools/dbt3_benchmark/tests/results_db_conf/##
* A **test** configuration file (example: ##test_myisam.conf##) copied
  from ##mariadb-tools/dbt3_benchmark/tests/test_conf/##

==== Test output

In the subdirectory for the particular test, set by the parameter {KEYWORD}
(example:
##~/benchmark/dbt3/results/myisam_test_2011-12-08_191427/mariadb-5-3-2/##),
there are the following files:

* **pre_test_os_resutls.txt** - the output of the OS commands (if any) executed
  before the first query run for that test
* **pre_test_sql_resutls.txt** - the output of the SQL commands (if any)
  executed before the first query run for that test
* **post_test_os_resutls.txt** - the output of the OS commands (if any)
  executed after the last query run for that test
* **post_test_sql_resutls.txt** - the output of the SQL commands (if any)
  executed after the last query run for that test
* **all_explains.txt** - a file containing all the explain queries, their
  startup parameters for the benchmark and the explain result
* The **config file** (my.cnf) that was passed to mysqld or postgres
  (example: ##mariadb_myisam_my.cnf##) copied
  from ##mariadb-tools/dbt3_benchmark/config/s$SCALE_FACTOR/##
* The **queries** configuration file (example: &#39;&#39;queries-mariadb.conf&#39;&#39;) copied
  from ##mariadb-tools/dbt3_benchmark/tests/queries_conf/##
* The **database** configuration file (example: &#39;&#39;db_mariadb_5_3_myisam.conf&#39;&#39;)
  copied from ##mariadb-tools/dbt3_benchmark/tests/db_conf/##

==== Query output

For each query execution there are several files that are outputted by the
automation script. They are all saved under the subdirectory set by the
parameters ##{KEYWORD}##:

* Explain result - a file named
  &#39;**{query_name}_{number_of_query_run}_results.txt**&#39; (example:
  &#39;**1_explain.sql_1_results.txt**&#39; &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; first test for 1_explain.sql)
* Pre-run OS commands - OS commands, executed before the actual query run.
  Output is a file named
  &#39;**pre_run_os_q_{query_name}_no_{number_of_query_run}_results.txt**&#39; (example:
  &#39;**pre_run_os_q_1.sql_no_2_results.txt**&#39; &lt;&lt;entity&gt;&gt;mdash&lt;&lt;/entity&gt;&gt; second test for query 1.sql)
* Pre-run SQL commands - SQL commands executed before the actual query run.
  Output is a file named
  &#39;**pre_run_sql_q_{query_name}_no_{number_of_query_run}_results.txt**&#39;.
* Post-run OS commands - OS commands, executed after the actual query run.
  Output is a file named
  &#39;**post_run_os_q_{query_name}_no_{number_of_query_run}_results.txt**&#39;.
* Post-run SQL commands - SQL commands executed after the actual query run.
  Output is a file named
  &#39;**post_run_sql_q_{query_name}_no_{number_of_query_run}_results.txt**&#39;.
* CPU utilization statistics:
  &#39;**{query_name}_no_{number_of_query_run}_sar_u.txt**&#39;
* I/O and transfer rate statistics:
  &#39;**{query_name}_no_{number_of_query_run}_sar_b.txt**&#39;
* Memory utilization statistics:
  &#39;**{query_name}_no_{number_of_query_run}_sar_r.txt**&#39;


=== Hooks

The automation script provides hooks that allow the user to add both SQL and OS commands prior and after each test. Here is a list of all possible hooks:

* Pre-test SQL hook: it is set with the parameter ##PRE_TEST_SQL##. Contains
  SQL commands that are run once for the whole test configuration before the
  first run.
  (Example: &#34;&lt;&lt;code lang=mysql inline=true&gt;&gt;use dbt3; select version(); show variables; show engines; show table status;&lt;&lt;/code&gt;&gt;&#34;)
* Post-test SQL hook: it is set with the parameter ##POST_TEST_SQL##. Contains
  SQL commands that are run once for the whole test configuration after the
  last run.
* Pre-test OS hook: it is set with the parameter ##PRE_TEST_OS##. Contains OS
  commands that are run once for the whole test configuration before the first
  run.
* Post-test OS hook: it is set with the parameter ##POST_TEST_OS##. Contains OS
  commands that are run once for the whole test configuration after the last
  run.
* Pre-run SQL hook: it is set with the parameter ##PRE_RUN_SQL##. Contains SQL
  commands that are run prior each query run.
  (Example: &#34;&lt;&lt;code lang=mysql inline=true&gt;&gt;flush status; set global userstat=on;&lt;&lt;/code&gt;&gt;&#34;)
* Post-run SQL hook: it is set with the parameter ##POST_RUN_SQL##. Contains SQL
  commands that are run after each query run.
  (Example: &#34;&lt;&lt;code lang=mysql inline=true&gt;&gt;show status; select * from information_schema.TABLE_STATISTICS;&lt;&lt;/code&gt;&gt;&#34;)
* Pre-run OS hook: it is set with the parameter ##PRE_RUN_OS##. Contains OS
  commands that are run once prior each query run. 
* Post-run OS hook: it is set with the parameter ##POST_RUN_OS##. Contains OS
  commands that are run once after each query run.

The results of these commands is stored into the
##{RESULTS_OUTPUT_DIR}/{KEYWORD}## folder (see [[#script-output]])

=== Activities

Here are the main activities that this script does:

# Parse the configuration files and check the input parameters - if any of the
  required parameters is missing, the script will stop resulting an error.
# Collect hardware information - collecting information about the hardware of
  the machine that the benchmark is run. Currently it collects ##cpuinfo##
  and ##uname##. Results of these commands are stored into the results output
  directory set as an input parameter
# Loop through the passed test configurations\\\\For each passed in test
  configuration the script does the following:
## Start the results database server. The results of the test are stored into
   that database.
## Clears the caches on the server\\\\Clearing the caches is done with the
   following
   command:&lt;&lt;code lang=bash inline=false&gt;&gt;sudo /sbin/sysctl vm.drop_caches=3&lt;&lt;/code&gt;&gt;
***none **NOTE:** In order to clear the caches, the user is required to have
    sudo rights and the following line should be added to the ##sudoers## file
    (edit it with &#34;##sudo vusudo##&#34;
    command):&lt;&lt;code lang=bash inline=false&gt;&gt;{your_username} ALL=NOPASSWD:/sbin/sysctl&lt;&lt;/code&gt;&gt;
## Start the database server
## Perform pre-test SQL commands. The results are stored
   under ##results_output_dir/{KEYWORD}## folder and are
   called ##pre_test_sql_results.txt##. ##{KEYWORD}## is a unique keyword for
   the current database configuration.
## Perform pre-test OS commands. The results are stored
   under ##results_output_dir/{KEYWORD}## folder and are
   called ##pre_test_os_results.txt##.
***none **NOTE:** If in the test configuration the setting QUERIES_AT_ONCE is
    set to 0, then the server is restarted between each query run. Thus the
    steps 3.2, 3.3, 3.4 and 3.5 are executed only once right before step 3.6.2.
## Read all query configurations and execute the following for each of them:
### Check the test configuration parameters. If something is wrong with some
    required parameter, the program will exit resulting an error.
### Get the server version if that&#39;s the first run of the query
### Perform pre-run OS commands in shell. The results of these queries are
    stored into a file named ##pre_run_os_q_{QUERY}_no_{RUN_NO}_results.txt##
    under ##results_output_dir/{KEYWORD}## where ##{QUERY}## is the query name
    (ex: ##1.sql##), ##{RUN_NO}## is the sequential run number
    and ##{KEYWORD}## is a unique keyword for the particular test
    configuration.
### Perform pre-run SQL queries. The results of these queries are stored into a
    file named ##pre_run_sql_q_{QUERY}_no_{RUN_NO}_results.txt##
    under ##results_output_dir/{KEYWORD}## where ##{QUERY}## is the query name
    (ex: ##1.sql##), ##{RUN_NO}## is the sequential run number and ##{KEYWORD}## is
    a unique keyword for the particular test configuration. 
### Perform warm-up runs if set into the test configuration file
### Perform actual test run and measure time.
****none During this step, a new child process is created in order to measure
     the statistics of the OS. Currently the statistics being collected are:
***** CPU utilization statistics. The command for this is:&lt;&lt;code lang=sh inline=false&gt;&gt;sar -u 0 2&gt;null&lt;&lt;/code&gt;&gt;
***** I/O and transfer rate statistics. The command for this is:&lt;&lt;code lang=sh inline=false&gt;&gt;sar -b 0 2&gt;null&lt;&lt;/code&gt;&gt;
***** Memory utilization statistics. The command for this is:&lt;&lt;code lang=sh inline=false&gt;&gt;sar -r 0 2&gt;null&lt;&lt;/code&gt;&gt;
**** These statistics are measured every N seconds, where ##N## is set with
     the ##OS_STATS_INTERVAL## test configuration parameter.
**** The test run for MariaDB and MySQL has an implemented mechanism for
     cut-off when timeout exceeds. It is controlled with the ##TIMEOUT## test
     parameter. Currently for PostgreSQL there is no such functionality and
     should be implemented in future versions.
### Execute the &#34;explain&#34; statement for that query.
****none **NOTE:** Running ##EXPLAIN## queries with MySQL prior version 5.6.3 could
     result in long running queries since MySQL has to execute the whole query
     when there are nested selects in it. For MariaDB and PostgreSQL there is
     no such problem. The long-running explain queries are for queries #7, 8,
     9, 13 and 15.  For that reason in MySQL prior version 5.6.3 for these
     queries no ##EXPLAIN## selects should be executed.
### Perform post-run SQL queries
### Perform post-run OS commands in shell
### Log the results into the results database
### A graphics with the current results is generated using Gnuplot
## Shutdown the database server.
## Perform post-test SQL commands. The results are stored
   under ##results_output_dir/{KEYWORD}## folder and are
   called ##post_test_sql_results.txt##.
## Perform post-test OS commands. The results are stored
   under ##results_output_dir/{KEYWORD}## folder and are
   called ##post_test_os_results.txt##.
## Stop the results database server

=== Script calling examples

* Example call for MyISAM test for scale factor 30 and timeout 10 minutes:&lt;&lt;code lang=perl inline=false&gt;&gt;perl launcher.pl \
--project-home=/path/to/project/home/ \
--results-output-dir=/path/to/project/home/results/myisam_test \
--datadir=/path/to/project/home/db_data/ \
--test=/path/to/project/home/mariadb-tools/dbt3_benchmark/tests/myisam_test_mariadb_5_3_mysql_5_5_mysql_5_6.conf \
--queries-home=/path/to/project/home/gen_query/ \
--scale-factor=30 \
--TIMEOUT=600
&lt;&lt;/code&gt;&gt;

...where ##/path/to/project/home## is where the ##mariadb-tools## project is
located. This will replace all occurrences of the string &#34;$PROJECT_HOME&#34; in the
configuration files (example: &#34;##TMPDIR = $PROJECT_HOME/temp/##&#34; will become
&#34;##TMPDIR = /path/to/project/home/temp/##&#34;).

&lt;&lt;code&gt;&gt;--TIMEOUT&lt;&lt;/code&gt;&gt; overrides the timeout setting into the test
configuration file to 10 minutes.

* Example for InnoDB test for scale factor 30 with 2 hours timeout per query
  and 3 runs for each query:&lt;&lt;code lang=perl inline=false&gt;&gt;perl launcher.pl \
--project-home=/path/to/project/home/ \
--results-output-dir=/path/to/project/home/results/innodb_test \
--datadir=/path/to/project/home/db_data/ \
--test=/path/to/project/home/mariadb-tools/dbt3_benchmark/tests/innodb_test_mariadb_5_3_mysql_5_5_mysql_5_6.conf \
--queries-home=/path/to/project/home/gen_query/ \
--scale-factor=30 \
--TIMEOUT=7200 \
--NUM_TESTS=3
&lt;&lt;/code&gt;&gt;

* If a newer version of MariaDB 5.5 is available:
** copy or edit the **DMBS server** configuration
   file ##mariadb-tools/dbt3_benchmark/tests/db_conf/db_mariadb_5_5_myisam.conf##
   and change the parameter ##DBMS_HOME## to the new binary distribution. You
   can also edit ##KEYWORD## and ##GRAPH_HEADING##

* If you want to add additional test in the MyISAM benchmark for MariaDB 5.3,
  but with another defaults-file (my.cnf):
** copy or edit the **DMBS server** configuration
   file ##mariadb-tools/dbt3_benchmark/tests/db_conf/db_mariadb_5_3_myisam.conf##
   and change the parameter CONFIG_FILE to the new my.cnf
** copy or edit the **test** configuration
   file ##mariadb-tools/dbt3_benchmark/tests/myisam_test_mariadb_5_3_mysql_5_5_mysql_5_6.conf##
   and add the new configuration settings:&lt;&lt;code lang=mysql inline=false&gt;&gt;[mariadb_5_3_new_configuration]
QUERIES_CONFIG = $PROJECT_HOME/mariadb-tools/dbt3_benchmark/tests/queries_conf/queries-mariadb.conf
DB_CONFIG 	= $PROJECT_HOME/mariadb-tools/dbt3_benchmark/tests/db_conf/db_mariadb_5_3_myisam_new_configuration.conf
&lt;&lt;/code&gt;&gt;

* If you want to add additional startup parameters for query 6 for MariaDB for
  example:
** copy or edit the
   file ##mariadb-tools/dbt3_benchmark/tests/queries_conf/queries-mariadb.conf##
   and add a parameter
   &#34;&lt;&lt;code&gt;&gt;STARTUP_PARAMS=--optimizer_switch=&#39;mrr=on&#39; --mrr_buffer_size=96M&lt;&lt;/code&gt;&gt;&#34;
   for example for the section for query 6.
** copy or edit the **test** configuration
   file ##mariadb-tools/dbt3_benchmark/tests/myisam_test_mariadb_5_3_mysql_5_5_mysql_5_6.conf##
   to include the new **queries** configuration file

== Results
=== MyISAM test

DBT3 benchmark for the following configuration:

* MariaDB 5.3.2 Beta + MyISAM
* MariaDB 5.5.18 + MyISAM
* MySQL 5.5.19 + MyISAM
* MySQL 5.6.4 + MyISAM

Results page: [[dbt3-benchmark-results-myisam|DBT3 benchmark results MyISAM]]

=== InnoDB test

DBT3 benchmark for the following configuration:

* MariaDB 5.3.2 Beta + XtraDB
* MariaDB 5.5.18 + XtraDB
* MySQL 5.5.19 + InnoDB
* MySQL 5.6.4 + InnoDB

Results page: [[dbt3-benchmark-results-innodb|DBT3 benchmark results InnoDB]]

=== PostgreSQL test

DBT3 benchmark for the following configuration:

* MariaDB 5.3.2 Beta + XtraDB
* MySQL 5.6.4 + InnoDB
* PostgreSQL

Results page: (TODO)

</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>