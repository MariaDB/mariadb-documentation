<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Step 4: Start and Configure MariaDB Enterprise Server - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Step 4: Start and Configure MariaDB Enterprise Server - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/columnstore-shared-local-storage-step-4-start-and-configure-mariadb-enterpr/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/columnstore-shared-local-storage-step-4-start-and-configure-mariadb-enterpr/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/columnstore-shared-local-storage-step-4-start-and-configure-mariadb-enterpr/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/topologies/">Topologies</a>
    

    
    » <a class="crumb" href="/kb/en/columnstore-shared-local-storage/">ColumnStore Shared Local Storage</a>
    


    » <a class="node_link crumb" href="/kb/en/columnstore-shared-local-storage-step-4-start-and-configure-mariadb-enterpr/">Step 4: Start and Configure MariaDB Enterprise Server</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/columnstore-shared-local-storage-step-4-start-and-configure-mariadb-enterpr/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Step 4: Start and Configure MariaDB Enterprise Server - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/columnstore-shared-local-storage-step-4-start-and-configure-mariadb-enterpr/+r/151248/">151248</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-16293">
<a href="/kb/user/id/16293" title="Shwetha CM">Shwetha CM</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2025-05-05 22:44">2025-05-05 22:44</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;

= Overview
This page details step 4 of the 9-step procedure &#34;[[deploy-columnstore-shared-local-storage-topology|Deploy ColumnStore Shared Local Storage Topology]]&#34;.

This step starts and configures MariaDB Enterprise Server, and MariaDB Enterprise ColumnStore 23.10.

Interactive commands are detailed. Alternatively, the described operations can be performed using automation.

= Stop the Enterprise ColumnStore Services
The installation process might have started some of the ColumnStore services. The services should be stopped prior to making configuration changes.

1. On each Enterprise ColumnStore node, stop the MariaDB Enterprise Server service:

&lt;&lt;code&gt;&gt;
$ sudo systemctl stop mariadb
&lt;&lt;/code&gt;&gt;

2. On each Enterprise ColumnStore node, stop the MariaDB Enterprise ColumnStore service:

&lt;&lt;code&gt;&gt;
$ sudo systemctl stop mariadb-columnstore
&lt;&lt;/code&gt;&gt;

3. On each Enterprise ColumnStore node, stop the CMAPI service:

&lt;&lt;code&gt;&gt;
$ sudo systemctl stop mariadb-columnstore-cmapi
&lt;&lt;/code&gt;&gt;

= Configure Enterprise ColumnStore
**On each Enterprise ColumnStore node**, configure Enterprise Server.
&lt;&lt;style class=&#34;darkheader-nospace-borders left&#34;&gt;&gt;
|= Connector |= MariaDB Connector/R2DBC |
| [[server-system-variables/#character_set_server|character_set_server]]  | Set this system variable to utf8 |
| [[server-system-variables/#collation_server|collation_server]]  | Set this system variable to utf8_general_ci |
| columnstore_use_import_for_batchinsert  | Set this system variable to ALWAYS to always use cpimport for [[load-data-infile|LOAD DATA INFILE]] and [[insert|INSERT...SELECT]] statements. |
| [[gtid/#gtid_strict_mode|gtid_strict_mode]]  | Set this system variable to ON. |
| [[replication-and-binary-log-system-variables/#log_bin|log_bin]]  | Set this option to the file you want to use for the Binary Log. Setting this option enables binary logging. |
| [[replication-and-binary-log-system-variables/#log_bin_index|log_bin_index]]  | Set this option to the file you want to use to track binlog filenames. |
| [[replication-and-binary-log-system-variables/#log_slave_updates|log_slave_updates]]  | Set this system variable to ON. |
| [[replication-and-binary-log-system-variables/#relay_log|relay_log]]  | Set this option to the file you want to use for the Relay Logs. Setting this option enables relay logging. |
| [[replication-and-binary-log-system-variables/#relay_log_index|relay_log_index]]  | Set this option to the file you want to use to index Relay Log filenames. |
| [[replication-and-binary-log-system-variables/#server_id|server_id]]  | Sets the numeric Server ID for this MariaDB Enterprise Server. The value set on this option must be unique to each node. |
&lt;&lt;/style&gt;&gt;


Mandatory system variables and options for ColumnStore Object Storage include:

Example Configuration
&lt;&lt;code&gt;&gt;
[mariadb]
bind_address                           = 0.0.0.0
log_error                              = mariadbd.err
character_set_server                   = utf8
collation_server                       = utf8_general_ci
log_bin                                = mariadb-bin
log_bin_index                          = mariadb-bin.index
relay_log                              = mariadb-relay
relay_log_index                        = mariadb-relay.index
log_slave_updates                      = ON
gtid_strict_mode                       = ON

# This must be unique on each Enterprise ColumnStore node
server_id                              = 1
&lt;&lt;/code&gt;&gt;

= Start the Enterprise ColumnStore Services

1. On each Enterprise ColumnStore node, start and enable the MariaDB Enterprise Server service, so that it starts automatically upon reboot:

&lt;&lt;code&gt;&gt;
$ sudo systemctl start mariadb
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
$ sudo systemctl enable mariadb
&lt;&lt;/code&gt;&gt;

2. On each Enterprise ColumnStore node, stop the MariaDB Enterprise ColumnStore service:

&lt;&lt;code&gt;&gt;
$ sudo systemctl stop mariadb-columnstore
&lt;&lt;/code&gt;&gt;

After the CMAPI service is installed in the next step, CMAPI will start the Enterprise ColumnStore service as-needed on each node. CMAPI disables the Enterprise ColumnStore service to prevent systemd from automatically starting Enterprise ColumnStore upon reboot.

3. On each Enterprise ColumnStore node, start and enable the CMAPI service, so that it starts automatically upon reboot:

&lt;&lt;code&gt;&gt;
$ sudo systemctl start mariadb-columnstore-cmapi
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
$ sudo systemctl enable mariadb-columnstore-cmapi
&lt;&lt;/code&gt;&gt;

For additional information, see &#34;Start and Stop Services&#34;.

= Create User Accounts
The ColumnStore Object Storage topology requires several user accounts. Each user account should be created on the primary server, so that it is replicated to the replica servers.

== Create the Utility User
Enterprise ColumnStore requires a mandatory utility user account to perform cross-engine joins and similar operations.

1. On the primary server, create the user account with the [[create-user|CREATE USER]] statement:

&lt;&lt;code&gt;&gt;
CREATE USER &#39;util_user&#39;@&#39;127.0.0.1&#39;
IDENTIFIED BY &#39;util_user_passwd&#39;;
&lt;&lt;/code&gt;&gt;

2. On the primary server, grant the user account [[select|SELECT]] privileges on all databases with the [[grant|GRANT]] statement:

&lt;&lt;code&gt;&gt;
GRANT SELECT, PROCESS ON *.*
TO &#39;util_user&#39;@&#39;127.0.0.1&#39;;
&lt;&lt;/code&gt;&gt;

3. On each Enterprise ColumnStore node, configure the ColumnStore utility user:

&lt;&lt;code&gt;&gt;
$ sudo mcsSetConfig CrossEngineSupport Host 127.0.0.1
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
$ sudo mcsSetConfig CrossEngineSupport Port 3306
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
$ sudo mcsSetConfig CrossEngineSupport User util_user
&lt;&lt;/code&gt;&gt;

4. On each Enterprise ColumnStore node, set the password:

&lt;&lt;code&gt;&gt;
$ sudo mcsSetConfig CrossEngineSupport Password util_user_passwd
&lt;&lt;/code&gt;&gt;

For details about how to encrypt the password, see &#34;[[enterprise-columnstore-credentials-management|Credentials Management for MariaDB Enterprise ColumnStore]]&#34;.

Passwords should meet your organization&#39;s password policies. If your MariaDB Enterprise Server instance has a password validation plugin installed, then the password should also meet the configured requirements.

== Create the Replication User
ColumnStore Object Storage uses [[standard-replication|MariaDB Replication]] to replicate writes between the primary and replica servers. As MaxScale can promote a replica server to become a new primary in the event of node failure, all nodes must have a replication user.

The action is performed **on the primary server**.

Create the replication user and grant it the required privileges:

1. Use the [[create-user|CREATE USER]] statement to create replication user.

&lt;&lt;code&gt;&gt;
CREATE USER &#39;repl&#39;@&#39;192.0.2.%&#39; IDENTIFIED BY &#39;repl_passwd&#39;;
&lt;&lt;/code&gt;&gt;

Replace the referenced IP address with the relevant address for your environment.

Ensure that the user account can connect to the primary server from each replica.

2. Grant the user account the required privileges with the [[grant|GRANT]] statement.

&lt;&lt;code&gt;&gt;
GRANT REPLICA MONITOR,
   REPLICATION REPLICA,
   REPLICATION REPLICA ADMIN,
   REPLICATION MASTER ADMIN
ON *.* TO &#39;repl&#39;@&#39;192.0.2.%&#39;;
&lt;&lt;/code&gt;&gt;

== Create MaxScale User
ColumnStore Object Storage 23.10 uses MariaDB MaxScale 22.08 to load balance between the nodes.

This action is performed on the primary server.

1. Use the [[create-user|CREATE USER]] statement to create the MaxScale user:

&lt;&lt;code&gt;&gt;
CREATE USER &#39;mxs&#39;@&#39;192.0.2.%&#39;
IDENTIFIED BY &#39;mxs_passwd&#39;;
&lt;&lt;/code&gt;&gt;

Replace the referenced IP address with the relevant address for your environment.

Ensure that the user account can connect from the IP address of the MaxScale instance.

2. Use the [[grant|GRANT]] statement to grant the privileges required by the router:

&lt;&lt;code&gt;&gt;
GRANT SHOW DATABASES ON *.* TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;

GRANT SELECT ON mysql.columns_priv TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;

GRANT SELECT ON mysql.db TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;

GRANT SELECT ON mysql.procs_priv TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;

GRANT SELECT ON mysql.proxies_priv TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;

GRANT SELECT ON mysql.roles_mapping TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;

GRANT SELECT ON mysql.tables_priv TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;

GRANT SELECT ON mysql.user TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;
&lt;&lt;/code&gt;&gt;

3. Use the [[grant|GRANT]] statement to grant privileges required by the MariaDB Monitor.

&lt;&lt;code&gt;&gt;
GRANT BINLOG ADMIN,
   READ_ONLY ADMIN,
   RELOAD,
   REPLICA MONITOR,
   REPLICATION MASTER ADMIN,
   REPLICATION REPLICA ADMIN,
   REPLICATION REPLICA,
   SHOW DATABASES,
   SELECT
ON *.* TO &#39;mxs&#39;@&#39;192.0.2.%&#39;;
&lt;&lt;/code&gt;&gt;

= Configure MariaDB Replication
On each replica server, configure MariaDB Replication:

1. Use the [[change-master-to|CHANGE MASTER TO]] statement to configure the connection to the primary server:

&lt;&lt;code&gt;&gt;
CHANGE MASTER TO
   MASTER_HOST=&#39;192.0.2.1&#39;,
   MASTER_USER=&#39;repl&#39;,
   MASTER_PASSWORD=&#39;repl_passwd&#39;,
   MASTER_USE_GTID=slave_pos;
&lt;&lt;/code&gt;&gt;

2. Start replication using the [[start-replica|START REPLICA]] statement:

&lt;&lt;code&gt;&gt;
START REPLICA;
&lt;&lt;/code&gt;&gt;

3. Confirm that replication is working using the [[show-replica-status|SHOW REPLICA STATUS]] statement:

&lt;&lt;code&gt;&gt;
SHOW REPLICA STATUS;
&lt;&lt;/code&gt;&gt;

Ensure that the replica server cannot accept local writes by setting the [[server-system-variables/#read_only|read_only]] system variable to ON using the [[set|SET GLOBAL]] statement:

&lt;&lt;code&gt;&gt;
SET GLOBAL read_only=ON;
&lt;&lt;/code&gt;&gt;

= Initiate the Primary Server with CMAPI

Initiate the primary server using CMAPI.

1. Create an API key for the cluster.
This API key should be stored securely and kept confidential, because it can be used to add cluster nodes to the multi-node Enterprise ColumnStore deployment.

For example, to create a random 256-bit API key using openssl rand:

&lt;&lt;code&gt;&gt;
$ openssl rand -hex 32

93816fa66cc2d8c224e62275bd4f248234dd4947b68d4af2b29671dd7d5532dd
&lt;&lt;/code&gt;&gt;
This document will use the following API key in further examples, but users should create their own:

2. Use CMAPI to add the primary server to the cluster and set the API key.
The new API key needs to be provided as part of the X-API-key HTML header.

For example, if the primary server&#39;s host name is mcs1 and its IP address is 192.0.2.1, use the following node command:

&lt;&lt;code&gt;&gt;
$ curl -k -s -X PUT https://mcs1:8640/cmapi/0.4.0/cluster/node \
   --header &#39;Content-Type:application/json&#39; \
   --header &#39;x-api-key:93816fa66cc2d8c224e62275bd4f248234dd4947b68d4af2b29671dd7d5532dd&#39; \
   --data &#39;{&#34;timeout&#34;:120, &#34;node&#34;: &#34;192.0.2.1&#34;}&#39; \
   | jq .
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
{
  &#34;timestamp&#34;: &#34;2020-10-28 00:39:14.672142&#34;,
  &#34;node_id&#34;: &#34;192.0.2.1&#34;
}
&lt;&lt;/code&gt;&gt;

3. Use CMAPI to check the status of the cluster node:

&lt;&lt;code&gt;&gt;
$ curl -k -s https://mcs1:8640/cmapi/0.4.0/cluster/status \
   --header &#39;Content-Type:application/json&#39; \
   --header &#39;x-api-key:93816fa66cc2d8c224e62275bd4f248234dd4947b68d4af2b29671dd7d5532dd&#39; \
   | jq .
&lt;&lt;/code&gt;&gt;
&lt;&lt;code&gt;&gt;
{
  &#34;timestamp&#34;: &#34;2020-12-15 00:40:34.353574&#34;,
  &#34;192.0.2.1&#34;: {
    &#34;timestamp&#34;: &#34;2020-12-15 00:40:34.362374&#34;,
    &#34;uptime&#34;: 11467,
    &#34;dbrm_mode&#34;: &#34;master&#34;,
    &#34;cluster_mode&#34;: &#34;readwrite&#34;,
    &#34;dbroots&#34;: [
      &#34;1&#34;
    ],
    &#34;module_id&#34;: 1,
    &#34;services&#34;: [
      {
        &#34;name&#34;: &#34;workernode&#34;,
        &#34;pid&#34;: 19202
      },
      {
        &#34;name&#34;: &#34;controllernode&#34;,
        &#34;pid&#34;: 19232
      },
      {
        &#34;name&#34;: &#34;PrimProc&#34;,
        &#34;pid&#34;: 19254
      },
      {
        &#34;name&#34;: &#34;ExeMgr&#34;,
        &#34;pid&#34;: 19292
      },
      {
        &#34;name&#34;: &#34;WriteEngine&#34;,
        &#34;pid&#34;: 19316
      },
      {
        &#34;name&#34;: &#34;DMLProc&#34;,
        &#34;pid&#34;: 19332
      },
      {
        &#34;name&#34;: &#34;DDLProc&#34;,
        &#34;pid&#34;: 19366
      }
    ]
  }
&lt;&lt;/code&gt;&gt;

= Add Replica Servers with CMAPI

Add the replica servers with CMAPI:

1. For each replica server, use CMAPI to add the replica server to the cluster.
The previously set API key needs to be provided as part of the X-API-key HTML header.

For example, if the primary server&#39;s host name is mcs1 and the replica server&#39;s IP address is 192.0.2.2, use the following node command:

&lt;&lt;code&gt;&gt;
$ curl -k -s -X PUT https://mcs1:8640/cmapi/0.4.0/cluster/node \
   --header &#39;Content-Type:application/json&#39; \
   --header &#39;x-api-key:93816fa66cc2d8c224e62275bd4f248234dd4947b68d4af2b29671dd7d5532dd&#39; \
   --data &#39;{&#34;timeout&#34;:120, &#34;node&#34;: &#34;192.0.2.2&#34;}&#39; \
   | jq .
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
{
  &#34;timestamp&#34;: &#34;2020-10-28 00:42:42.796050&#34;,
  &#34;node_id&#34;: &#34;192.0.2.2&#34;
}
&lt;&lt;/code&gt;&gt;

2. After all replica servers have been added, use CMAPI to confirm that all cluster nodes have been successfully added:

&lt;&lt;code&gt;&gt;
$ curl -k -s https://mcs1:8640/cmapi/0.4.0/cluster/status \
   --header &#39;Content-Type:application/json&#39; \
   --header &#39;x-api-key:93816fa66cc2d8c224e62275bd4f248234dd4947b68d4af2b29671dd7d5532dd&#39; \
   | jq .
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
{
  &#34;timestamp&#34;: &#34;2020-12-15 00:40:34.353574&#34;,
  &#34;192.0.2.1&#34;: {
    &#34;timestamp&#34;: &#34;2020-12-15 00:40:34.362374&#34;,
    &#34;uptime&#34;: 11467,
    &#34;dbrm_mode&#34;: &#34;master&#34;,
    &#34;cluster_mode&#34;: &#34;readwrite&#34;,
    &#34;dbroots&#34;: [
      &#34;1&#34;
    ],
    &#34;module_id&#34;: 1,
    &#34;services&#34;: [
      {
        &#34;name&#34;: &#34;workernode&#34;,
        &#34;pid&#34;: 19202
      },
      {
        &#34;name&#34;: &#34;controllernode&#34;,
        &#34;pid&#34;: 19232
      },
      {
        &#34;name&#34;: &#34;PrimProc&#34;,
        &#34;pid&#34;: 19254
      },
      {
        &#34;name&#34;: &#34;ExeMgr&#34;,
        &#34;pid&#34;: 19292
      },
      {
        &#34;name&#34;: &#34;WriteEngine&#34;,
        &#34;pid&#34;: 19316
      },
      {
        &#34;name&#34;: &#34;DMLProc&#34;,
        &#34;pid&#34;: 19332
      },
      {
        &#34;name&#34;: &#34;DDLProc&#34;,
        &#34;pid&#34;: 19366
      }
    ]
  },
  &#34;192.0.2.2&#34;: {
    &#34;timestamp&#34;: &#34;2020-12-15 00:40:34.428554&#34;,
    &#34;uptime&#34;: 11437,
    &#34;dbrm_mode&#34;: &#34;slave&#34;,
    &#34;cluster_mode&#34;: &#34;readonly&#34;,
    &#34;dbroots&#34;: [
      &#34;2&#34;
    ],
    &#34;module_id&#34;: 2,
    &#34;services&#34;: [
      {
        &#34;name&#34;: &#34;workernode&#34;,
        &#34;pid&#34;: 17789
      },
      {
        &#34;name&#34;: &#34;PrimProc&#34;,
        &#34;pid&#34;: 17813
      },
      {
        &#34;name&#34;: &#34;ExeMgr&#34;,
        &#34;pid&#34;: 17854
      },
      {
        &#34;name&#34;: &#34;WriteEngine&#34;,
        &#34;pid&#34;: 17877
      }
    ]
  },
  &#34;192.0.2.3&#34;: {
    &#34;timestamp&#34;: &#34;2020-12-15 00:40:34.428554&#34;,
    &#34;uptime&#34;: 11437,
    &#34;dbrm_mode&#34;: &#34;slave&#34;,
    &#34;cluster_mode&#34;: &#34;readonly&#34;,
    &#34;dbroots&#34;: [
      &#34;2&#34;
    ],
    &#34;module_id&#34;: 2,
    &#34;services&#34;: [
      {
        &#34;name&#34;: &#34;workernode&#34;,
        &#34;pid&#34;: 17789
      },
      {
        &#34;name&#34;: &#34;PrimProc&#34;,
        &#34;pid&#34;: 17813
      },
      {
        &#34;name&#34;: &#34;ExeMgr&#34;,
        &#34;pid&#34;: 17854
      },
      {
        &#34;name&#34;: &#34;WriteEngine&#34;,
        &#34;pid&#34;: 17877
      }
    ]
  },
  &#34;num_nodes&#34;: 3
}
&lt;&lt;/code&gt;&gt;

= Configure Linux Security Modules (LSM)
The specific steps to configure the security module depend on the operating system.

== Configure SELinux (CentOS, RHEL)
Configure SELinux for Enterprise ColumnStore:

1. To configure SELinux, you have to install the packages required for audit2allow.
On CentOS 7 and RHEL 7, install the following:

&lt;&lt;code&gt;&gt;
$ sudo yum install policycoreutils policycoreutils-python
&lt;&lt;/code&gt;&gt;

On RHEL 8, install the following:

&lt;&lt;code&gt;&gt;
$ sudo yum install policycoreutils python3-policycoreutils policycoreutils-python-utils
&lt;&lt;/code&gt;&gt;

2. Allow the system to run under load for a while to generate SELinux audit events.

3. After the system has taken some load, generate an SELinux policy from the audit events using audit2allow:

&lt;&lt;code&gt;&gt;
$ sudo grep mysqld /var/log/audit/audit.log | audit2allow -M mariadb_local
&lt;&lt;/code&gt;&gt;

If no audit events were found, this will print the following:

&lt;&lt;code&gt;&gt;
$ sudo grep mysqld /var/log/audit/audit.log | audit2allow -M mariadb_local

Nothing to do
&lt;&lt;/code&gt;&gt;

4. If audit events were found, the new SELinux policy can be loaded using semodule:

&lt;&lt;code&gt;&gt;
$ sudo semodule -i mariadb_local.pp
&lt;&lt;/code&gt;&gt;

5. Set SELinux to enforcing mode:

&lt;&lt;code&gt;&gt;
$ sudo setenforce enforcing
&lt;&lt;/code&gt;&gt;

6. Set SELinux to enforcing mode by setting SELINUX=enforcing in /etc/selinux/config.

For example, the file will usually look like this after the change:

&lt;&lt;code&gt;&gt;
# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#     enforcing - SELinux security policy is enforced.
#     permissive - SELinux prints warnings instead of enforcing.
#     disabled - No SELinux policy is loaded.
SELINUX=enforcing
# SELINUXTYPE= can take one of three values:
#     targeted - Targeted processes are protected,
#     minimum - Modification of targeted policy. Only selected processes are protected.
#     mls - Multi Level Security protection.
SELINUXTYPE=targeted
&lt;&lt;/code&gt;&gt;


7. Confirm that SELinux is in enforcing mode:

&lt;&lt;code&gt;&gt;
$ sudo getenforce
&lt;&lt;/code&gt;&gt;
&lt;&lt;code&gt;&gt;
Enforcing
&lt;&lt;/code&gt;&gt;

== Configure AppArmor (Ubuntu)
For information on how to create a profile, see [[https://ubuntu.com/tutorials/beginning-apparmor-profile-development#1-overview|How to create an AppArmor Profile]] on Ubuntu.com.

= Configure Firewalls
The specific steps to configure the firewall service depend on the platform.

== Configure firewalld (CentOS, RHEL)
Configure firewalld for Enterprise Cluster on CentOS and RHEL:

1. Check if the firewalld service is running:

&lt;&lt;code&gt;&gt;
$ sudo systemctl status firewalld
&lt;&lt;/code&gt;&gt;


2. If the firewalld service was stopped to perform the installation, start it now:

For example, if your cluster nodes are in the 192.0.2.0/24 subnet:
&lt;&lt;code&gt;&gt;

$ sudo systemctl start firewalld
&lt;&lt;/code&gt;&gt;

3. Open up the relevant ports using firewall-cmd:

&lt;&lt;code&gt;&gt;
$ sudo firewall-cmd --permanent --add-rich-rule=&#39;
   rule family=&#34;ipv4&#34;
   source address=&#34;192.0.2.0/24&#34;
   destination address=&#34;192.0.2.0/24&#34;
   port port=&#34;3306&#34; protocol=&#34;tcp&#34;
   accept&#39;
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
$ sudo firewall-cmd --permanent --add-rich-rule=&#39;
   rule family=&#34;ipv4&#34;
   source address=&#34;192.0.2.0/24&#34;
   destination address=&#34;192.0.2.0/24&#34;
   port port=&#34;8600-8630&#34; protocol=&#34;tcp&#34;
   accept&#39;
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;

$ sudo firewall-cmd --permanent --add-rich-rule=&#39;
   rule family=&#34;ipv4&#34;
   source address=&#34;192.0.2.0/24&#34;
   destination address=&#34;192.0.2.0/24&#34;
   port port=&#34;8640&#34; protocol=&#34;tcp&#34;
   accept&#39;
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
$ sudo firewall-cmd --permanent --add-rich-rule=&#39;
   rule family=&#34;ipv4&#34;
   source address=&#34;192.0.2.0/24&#34;
   destination address=&#34;192.0.2.0/24&#34;
   port port=&#34;8700&#34; protocol=&#34;tcp&#34;
   accept&#39;
&lt;&lt;/code&gt;&gt;

&lt;&lt;code&gt;&gt;
$ sudo firewall-cmd --permanent --add-rich-rule=&#39;
   rule family=&#34;ipv4&#34;
   source address=&#34;192.0.2.0/24&#34;
   destination address=&#34;192.0.2.0/24&#34;
   port port=&#34;8800&#34; protocol=&#34;tcp&#34;
   accept&#39;
&lt;&lt;/code&gt;&gt;

4. Reload the runtime configuration:

&lt;&lt;code&gt;&gt;
$ sudo firewall-cmd --reload
&lt;&lt;/code&gt;&gt;

== Configure UFW (Ubuntu)
Configure UFW for Enterprise ColumnStore on Ubuntu:

1. Check if the UFW service is running:
&lt;&lt;code&gt;&gt;
$ sudo ufw status verbose
&lt;&lt;/code&gt;&gt;

2. If the UFW service was stopped to perform the installation, start it now:

&lt;&lt;code&gt;&gt;
$ sudo ufw enable
&lt;&lt;/code&gt;&gt;

3. Open up the relevant ports using ufw.

For example, if your cluster nodes are in the 192.0.2.0/24 subnet in the range 192.0.2.1 - 192.0.2.3:

&lt;&lt;code&gt;&gt;
$ sudo ufw allow from 192.0.2.0/24 to 192.0.2.3 port 3306 proto tcp

$ sudo ufw allow from 192.0.2.0/24 to 192.0.2.3 port 8600:8630 proto tcp

$ sudo ufw allow from 192.0.2.0/24 to 192.0.2.3 port 8640 proto tcp

$ sudo ufw allow from 192.0.2.0/24 to 192.0.2.3 port 8700 proto tcp

$ sudo ufw allow from 192.0.2.0/24 to 192.0.2.3 port 8800 proto tcp
&lt;&lt;/code&gt;&gt;

4. Reload the runtime configuration:

&lt;&lt;code&gt;&gt;
$ sudo ufw reload
&lt;&lt;/code&gt;&gt;

= Next Step
Navigation in the procedure &#34;[[deploy-columnstore-shared-local-storage-topology|Deploy ColumnStore Shared Local Storage Topology]]&#34;.

This page was step 4 of 9.

Next: [[deploy-columnstore-shared-local-storage-topology-with-mariadb-server-step-5|Step 5: Test MariaDB Enterprise Server]].</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>