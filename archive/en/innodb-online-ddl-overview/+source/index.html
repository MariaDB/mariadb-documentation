<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>InnoDB Online DDL Overview - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="InnoDB Online DDL Overview - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/innodb-online-ddl-overview/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/innodb-online-ddl-overview/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/innodb-online-ddl-overview/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/innodb/">InnoDB</a>
    

    
    » <a class="crumb" href="/kb/en/innodb-online-ddl/">InnoDB Online DDL</a>
    


    » <a class="node_link crumb" href="/kb/en/innodb-online-ddl-overview/">InnoDB Online DDL Overview</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/innodb-online-ddl-overview/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>InnoDB Online DDL Overview - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/innodb-online-ddl-overview/+r/115647/">115647</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-1368">
<a href="/kb/user/id/1368" title="Ian Gilfillan">Ian Gilfillan</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2022-04-27 14:40">2022-04-27 14:40</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;

InnoDB tables support online DDL, which permits concurrent DML and uses optimizations to avoid unnecessary table copying.

The [[alter-table|ALTER TABLE]] statement supports two clauses that are used to implement online DDL:

* [[alter-table/#algorithm|ALGORITHM]] - This clause controls how the DDL operation is performed.
* [[alter-table/#lock|LOCK]] - This clause controls how much concurrency is allowed while the DDL operation is being performed.

== Alter Algorithms

InnoDB supports multiple algorithms for performing DDL operations. This offers a significant performance improvement over previous versions. The supported algorithms are:

* ##DEFAULT## - This implies the default behavior for the specific operation.
* ##COPY##
* ##INPLACE##
* ##NOCOPY## - This was added in MariaDB 10.3.7.
* ##INSTANT## - This was added in MariaDB 10.3.7.

== Specifying an Alter Algorithm

The set of alter algorithms can be considered as a hierarchy. The hierarchy is ranked in the following order, with //least efficient// algorithm at the top, and //most efficient// algorithm at the bottom:

* ##COPY##
* ##INPLACE##
* ##NOCOPY##
* ##INSTANT##

When a user specifies an alter algorithm for a DDL operation, MariaDB does not necessarily use that specific algorithm for the operation. It interprets the choice in the following way:

* If the user specifies ##COPY##, then InnoDB uses the ##COPY## algorithm.
* If the user specifies any other algorithm, then InnoDB interprets that choice as the //least efficient// algorithm that the user is willing to accept. This means that if the user specifies ##INPLACE##, then InnoDB will use the //most efficient// algorithm supported by the specific operation from the set (##INPLACE##, ##NOCOPY##, ##INSTANT##). Likewise, if the user specifies ##NOCOPY##, then InnoDB will use the //most efficient// algorithm supported by the specific operation from the set (##NOCOPY##, ##INSTANT##).

There is also a special value that can be specified:

* If the user specifies ##DEFAULT##, then InnoDB uses its default choice for the operation. The default choice is to use the most efficient algorithm supported by the operation. The default choice will also be used if no algorithm is specified. Therefore, if you want InnoDB to use the most efficient algorithm supported by an operation, then you usually do not have to explicitly specify any algorithm at all.

===  Specifying an Alter Algorithm Using the ALGORITHM Clause

InnoDB supports the [[alter-table/#algorithm|ALGORITHM]] clause.

The [[alter-table/#algorithm|ALGORITHM]] clause can be used to specify the //least efficient// algorithm that the user is willing to accept. It is supported by the [[alter-table|ALTER TABLE]] and [[create-index|CREATE INDEX]] statements.

For example, if a user wanted to add a column to a table, but only if the operation used an algorithm that is at least as efficient as the ##INPLACE##, then they could execute the following:

&lt;&lt;sql&gt;&gt;
CREATE OR REPLACE TABLE tab (
   a int PRIMARY KEY,
   b varchar(50)
);

ALTER TABLE tab ADD COLUMN c varchar(50), ALGORITHM=INPLACE;
&lt;&lt;/sql&gt;&gt;

In MariaDB 10.3 and later, the above operation would actually use the ##INSTANT## algorithm, because the ##ADD COLUMN## operation supports the ##INSTANT## algorithm, and the ##INSTANT## algorithm is more efficient than the ##INPLACE## algorithm.

===  Specifying an Alter Algorithm Using System Variables

&lt;&lt;product mariadb from=10.3&gt;&gt;
In MariaDB 10.3 and later, the [[server-system-variables/#alter_algorithm|alter_algorithm]] system variable can be used to pick the //least efficient// algorithm that the user is willing to accept.

For example, if a user wanted to add a column to a table, but only if the operation used an algorithm that is at least as efficient as the ##INPLACE##, then they could execute the following:

&lt;&lt;sql&gt;&gt;
CREATE OR REPLACE TABLE tab (
   a int PRIMARY KEY,
   b varchar(50)
);

SET SESSION alter_algorithm=&#39;INPLACE&#39;;
ALTER TABLE tab ADD COLUMN c varchar(50);
&lt;&lt;/sql&gt;&gt;

In MariaDB 10.3 and later, the above operation would actually use the ##INSTANT## algorithm, because the ##ADD COLUMN## operation supports the ##INSTANT## algorithm, and the ##INSTANT## algorithm is more efficient than the ##INPLACE## algorithm.
&lt;&lt;/product&gt;&gt;
&lt;&lt;product mariadb to=10.2&gt;&gt;
In MariaDB 10.2 and before, the [[server-system-variables#old_alter_table|old_alter_table]] system variable can be used to specify whether the ##COPY## algorithm should be used.

For example, if a user wanted to add a column to a table, but they wanted to use the ##COPY## algorithm instead of the default algorithm for the operation, then they could execute the following:

&lt;&lt;sql&gt;&gt;
CREATE OR REPLACE TABLE tab (
   a int PRIMARY KEY,
   b varchar(50)
);

SET SESSION old_alter_table=1;
ALTER TABLE tab ADD COLUMN c varchar(50);
&lt;&lt;/sql&gt;&gt;
&lt;&lt;/product&gt;&gt;

== Supported Alter Algorithms

The supported algorithms are described in more details below.

=== DEFAULT Algorithm

The default behavior, which occurs if ##ALGORITHM=DEFAULT## is specified, or if ##ALGORITHM## is not specified at all, usually only makes a copy if the operation doesn&#39;t support being done in-place at all. In this case, the //most efficient// available algorithm will usually be used.

This means that, if an operation supports the ##INSTANT## algorithm, then it will use that algorithm by default. If an operation does not support the ##INSTANT## algorithm, but it does support the ##NOCOPY## algorithm, then it will use that algorithm by default. If an operation does not support the ##NOCOPY## algorithm, but it does support the ##INPLACE## algorithm, then it will use that algorithm by default.

=== COPY Algorithm


The ##COPY## algorithm refers to the original [[alter-table|ALTER TABLE]] algorithm.

When the ##COPY## algorithm is used, MariaDB essentially does the following operations:

&lt;&lt;sql&gt;&gt;
-- Create a temporary table with the new definition
CREATE TEMPORARY TABLE tmp_tab (
...
);

-- Copy the data from the original table
INSERT INTO tmp_tab
   SELECT * FROM original_tab;

-- Drop the original table
DROP TABLE original_tab;

-- Rename the temporary table, so that it replaces the original one
RENAME TABLE tmp_tab TO original_tab;
&lt;&lt;/sql&gt;&gt;

This algorithm is very inefficient, but it is generic, so it works for all storage engines.

If the ##COPY## algorithm is specified with the [[alter-table/#algorithm|ALGORITHM]] clause or with the [[server-system-variables/#alter_algorithm|alter_algorithm]] system variable, then the ##COPY## algorithm will be used even if it is not necessary. This can result in a lengthy table copy. If multiple [[alter-table|ALTER TABLE]] operations are required that each require the table to be rebuilt, then it is best to specify all operations in a single [[alter-table|ALTER TABLE]] statement, so that the table is only rebuilt once.

==== Using the COPY Algorithm with InnoDB

If the ##COPY## algorithm is used with an [[innodb|InnoDB]] table, then the following statements apply:

* The table will be rebuilt using the current values of the [[innodb-system-variables#innodb_file_per_table|innodb_file_per_table]], [[innodb-system-variables#innodb_file_format|innodb_file_format]], and [[innodb-system-variables/#innodb_default_row_format|innodb_default_row_format]] system variables.

* The operation will have to create a temporary table to perform the the table copy. This temporary table will be in the same directory as the original table, and it&#39;s file name will be in the format ##{{{#}}}sql${PID}_${THREAD_ID}_${TMP_TABLE_COUNT}##, where ##${PID}## is the process ID of ##mysqld##, ##${THREAD_ID}## is the connection ID, and ##${TMP_TABLE_COUNT}## is the number of temporary tables that the connection has open. Therefore, the [[server-system-variables/#datadir|datadir]] may contain files with file names like ##{{{#}}}sql1234_12_1.ibd##.

* The operation inserts one record at a time into each index, which is very inefficient.

* InnoDB does not use a sort buffer.

* In MariaDB 10.2.13, MariaDB 10.3.5 and later, the table copy operation creates a lot fewer [[xtradbinnodb-undo-log|InnoDB undo log]] writes. See MDEV-11415 for more information.

* The table copy operation creates a lot of [[innodb-redo-log|InnoDB redo log]] writes.

=== INPLACE Algorithm

The ##COPY## algorithm can be incredibly slow, because the whole table has to be copied and rebuilt. The ##INPLACE## algorithm was introduced as a way to avoid this by performing operations in-place and avoiding the table copy and rebuild, when possible.

When the ##INPLACE## algorithm is used, the underlying storage engine uses optimizations to perform the operation while avoiding the table copy and rebuild. However, ##INPLACE## is a bit of a misnomer, since some operations may still require the table to be rebuilt for some storage engines. Regardless, several operations can be performed without a full copy of the table for some storage engines.

A more accurate name for the algorithm would have been the ##ENGINE## algorithm, since the [[storage-engines|storage engine]] decides how to implement the algorithm.

If an [[alter-table|ALTER TABLE]] operation supports the ##INPLACE## algorithm, then it can be performed using optimizations by the underlying storage engine, but it may rebuilt.

If the ##INPLACE## algorithm is specified with the [[alter-table/#algorithm|ALGORITHM]] clause or with the [[server-system-variables/#alter_algorithm|alter_algorithm]] system variable and if the [[alter-table|ALTER TABLE]] operation does not support the ##INPLACE## algorithm, then an error will be raised. For example:

&lt;&lt;code wrap=true lang=sql&gt;&gt;
SET SESSION alter_algorithm=&#39;INPLACE&#39;;

ALTER TABLE tab MODIFY COLUMN c int;
ERROR 1846 (0A000): ALGORITHM=INPLACE is not supported. Reason: Cannot change column type INPLACE. Try ALGORITHM=COPY
&lt;&lt;/code&gt;&gt;

In this case, raising an error is preferable, if the alternative is for the operation to make a copy of the table, and perform unexpectedly slowly.

==== Using the INPLACE Algorithm with InnoDB

If the ##INPLACE## algorithm is used with an [[innodb|InnoDB]] table, then the following statements apply:

* The operation might have to write sort files in the directory defined by the [[innodb-system-variables/#innodb_tmpdir|innodb_tmpdir]] system variable.

* The operation might also have to write a temporary log file to track data changes by [[data-manipulation|DML queries]] executed during the operation. The maximum size for this log file is configured by the [[innodb-system-variables/#innodb_online_alter_log_max_size|innodb_online_alter_log_max_size]] system variable.

* Some operations require the table to be rebuilt, even though the algorithm is inaccurately called &#34;in-place&#34;. This includes operations such as adding or dropping columns, adding a primary key, changing a column to [[null-and-not-null|NULL]], etc.

* If the operation requires the table to be rebuilt, then the operation might have to create temporary tables.
** It may have to create a temporary intermediate table for the actual table rebuild operation.
*** In MariaDB 10.2.19 and later, this temporary table will be in the same directory as the original table, and it&#39;s file name will be in the format ##{{{#}}}sql${PID}_${THREAD_ID}_${TMP_TABLE_COUNT}##, where ##${PID}## is the process ID of ##mysqld##, ##${THREAD_ID}## is the connection ID, and ##${TMP_TABLE_COUNT}## is the number of temporary tables that the connection has open. Therefore, the [[server-system-variables/#datadir|datadir]] may contain files with file names like ##{{{#}}}sql1234_12_1.ibd##.
*** In MariaDB 10.2.18 and before, this temporary table will be in the same directory as the original table, and it&#39;s file name will be in the format ##{{{#}}}sql-ib${TABLESPACE_ID}-${RAND}##, where ##${TABLESPACE_ID}## is the table&#39;s tablespace ID within InnoDB and ##${RAND}## is a randomly initialized number. Therefore, the [[server-system-variables/#datadir|datadir]] may contain files with file names like ##{{{#}}}sql-ib230291-1363966925.ibd##.
** When it replaces the original table with the rebuilt table, it may also have to rename the original table using a temporary table name.
*** If the server is MariaDB 10.3 or later or if it is running MariaDB 10.2 and the [[innodb-system-variables/#innodb_safe_truncate|innodb_safe_truncate]] system variable is set to ##OFF##, then the format will actually be ##{{{#}}}sql-ib${TABLESPACE_ID}-${RAND}##, where ##${TABLESPACE_ID}## is the table&#39;s tablespace ID within InnoDB and ##${RAND}## is a randomly initialized number. Therefore, the [[server-system-variables/#datadir|datadir]] may contain files with file names like ##{{{#}}}sql-ib230291-1363966925.ibd##.
*** If the server is running MariaDB 10.1 or before or if it is running MariaDB 10.2 and the [[innodb-system-variables/#innodb_safe_truncate|innodb_safe_truncate]] system variable is set to ##ON##, then the renamed table will have a temporary table name in the format ##{{{#}}}sql-ib${TABLESPACE_ID}##, where ##${TABLESPACE_ID}## is the table&#39;s tablespace ID within InnoDB. Therefore, the [[server-system-variables/#datadir|datadir]] may contain files with file names like ##{{{#}}}sql-ib230291.ibd##.

* The storage needed for the above items can add up to the size of the original table, or more in some cases.

* Some operations are instantaneous, if they only require the table&#39;s metadata to be changed. This includes operations such as renaming a column, changing a column&#39;s [[create-table/#default-column-option|DEFAULT]] value, etc.

==== Operations Supported by InnoDB with the ##INPLACE## Algorithm

With respect to the allowed operations, the ##INPLACE## algorithm supports a subset of the operations supported by the ##COPY## algorithm, and it supports a superset of the operations supported by the ##NOCOPY## algorithm.

See [[innodb-online-ddl-operations-with-algorithminplace|InnoDB Online DDL Operations with ALGORITHM=INPLACE]] for more information.

=== NOCOPY Algorithm

&lt;&lt;product mariadb from=10.3&gt;&gt;
In MariaDB 10.3 and later, the ##NOCOPY## algorithm is supported.
&lt;&lt;/product&gt;&gt;

The ##INPLACE## algorithm can sometimes be surprisingly slow in instances where it has to rebuild the clustered index, because when the clustered index has to be rebuilt, the whole table has to be rebuilt. The ##NOCOPY## algorithm was introduced as a way to avoid this. 

If an [[alter-table|ALTER TABLE]] operation supports the ##NOCOPY## algorithm, then it can be performed without rebuilding the clustered index.

If the ##NOCOPY## algorithm is specified with the [[alter-table/#algorithm|ALGORITHM]] clause or with the [[server-system-variables/#alter_algorithm|alter_algorithm]] system variable and if the [[alter-table|ALTER TABLE]] operation does not support the ##NOCOPY## algorithm, then an error will be raised. For example:

&lt;&lt;sql&gt;&gt;
SET SESSION alter_algorithm=&#39;NOCOPY&#39;;

ALTER TABLE tab MODIFY COLUMN c int;
ERROR 1846 (0A000): ALGORITHM=NOCOPY is not supported. Reason: Cannot change column type INPLACE. Try ALGORITHM=COPY
&lt;&lt;/sql&gt;&gt;

In this case, raising an error is preferable, if the alternative is for the operation to rebuild the clustered index, and perform unexpectedly slowly.

==== Operations Supported by InnoDB with the ##NOCOPY## Algorithm

With respect to the allowed operations, the ##NOCOPY## algorithm supports a subset of the operations supported by the ##INPLACE## algorithm, and it supports a superset of the operations supported by the ##INSTANT## algorithm.

See [[innodb-online-ddl-operations-with-algorithmnocopy|InnoDB Online DDL Operations with ALGORITHM=NOCOPY]] for more information.

=== INSTANT Algorithm

&lt;&lt;product mariadb from=10.3&gt;&gt;
In MariaDB 10.3 and later, the ##INSTANT## algorithm is supported.
&lt;&lt;/product&gt;&gt;

The ##INPLACE## algorithm can sometimes be surprisingly slow in instances where it has to modify data files. The ##INSTANT## algorithm was introduced as a way to avoid this.

If an [[alter-table|ALTER TABLE]] operation supports the ##INSTANT## algorithm, then it can be performed without modifying any data files.

If the ##INSTANT## algorithm is specified with the [[alter-table/#algorithm|ALGORITHM]] clause or with the [[server-system-variables/#alter_algorithm|alter_algorithm]] system variable and if the [[alter-table|ALTER TABLE]] operation does not support the ##INSTANT## algorithm, then an error will be raised. For example:

&lt;&lt;code wrap=true lang=sql&gt;&gt;
SET SESSION alter_algorithm=&#39;INSTANT&#39;;

ALTER TABLE tab MODIFY COLUMN c int;
ERROR 1846 (0A000): ALGORITHM=INSTANT is not supported. Reason: Cannot change column type INPLACE. Try ALGORITHM=COPY
&lt;&lt;/code&gt;&gt;

In this case, raising an error is preferable, if the alternative is for the operation to modify data files, and perform unexpectedly slowly.

==== Operations Supported by InnoDB with the INSTANT Algorithm

With respect to the allowed operations, the ##INSTANT## algorithm supports a subset of the operations supported by the ##NOCOPY## algorithm.

See [[innodb-online-ddl-operations-with-algorithminstant|InnoDB Online DDL Operations with ALGORITHM=INSTANT]] for more information.

== Alter Locking Strategies

InnoDB supports multiple locking strategies for performing DDL operations. This offers a significant performance improvement over previous versions. The supported locking strategies are:

* ##DEFAULT## - This implies the default behavior for the specific operation.
* ##NONE##
* ##SHARED##
* ##EXCLUSIVE##

Regardless of which locking strategy is used to perform a DDL operation, InnoDB will have to exclusively lock the table for a short time at the start and end of the operation&#39;s execution. This means that any active transactions that may have accessed the table must be committed or aborted for the operation to continue. This applies to most DDL statements, such as [[alter-table|ALTER TABLE]], [[create-index|CREATE INDEX]], [[drop-index|DROP INDEX]], [[optimize-table|OPTIMIZE TABLE]], [[rename-table|RENAME TABLE]], etc.

== Specifying an Alter Locking Strategy

===  Specifying an Alter Locking Strategy Using the ##LOCK## Clause

The [[alter-table|ALTER TABLE]] statement supports the [[alter-table/#lock|LOCK]] clause.

The [[alter-table/#lock|LOCK]] clause can be used to specify the locking strategy that the user is willing to accept. It is supported by the [[alter-table|ALTER TABLE]] and [[create-index|CREATE INDEX]] statements.

For example, if a user wanted to add a column to a table, but only if the operation is non-locking, then they could execute the following:

&lt;&lt;sql&gt;&gt;
CREATE OR REPLACE TABLE tab (
   a int PRIMARY KEY,
   b varchar(50)
);

ALTER TABLE tab ADD COLUMN c varchar(50), ALGORITHM=INPLACE, LOCK=NONE;
&lt;&lt;/sql&gt;&gt;

If the [[alter-table/#lock|LOCK]] clause is not explicitly set, then the operation uses ##LOCK=DEFAULT##.

===  Specifying an Alter Locking Strategy Using ##ALTER ONLINE TABLE##

[[alter-table/#alter-online-table|ALTER ONLINE TABLE]] is equivalent to ##LOCK=NONE##. Therefore, the [[alter-online-table|ALTER ONLINE TABLE]] statement can be used to ensure that your [[alter-table|ALTER TABLE]] operation allows all concurrent DML.

== Supported Alter Locking Strategies

The supported algorithms are described in more details below.

To see which locking strategies InnoDB supports for each operation, see the pages that describe which operations are supported for each algorithm:

* [[innodb-online-ddl-operations-with-algorithminplace|InnoDB Online DDL Operations with ALGORITHM=INPLACE]]
* [[innodb-online-ddl-operations-with-algorithmnocopy|InnoDB Online DDL Operations with ALGORITHM=NOCOPY]]
* [[innodb-online-ddl-operations-with-algorithminstant|InnoDB Online DDL Operations with ALGORITHM=INSTANT]]

=== DEFAULT Locking Strategy

The default behavior, which occurs if ##LOCK=DEFAULT## is specified, or if ##LOCK## is not specified at all, acquire the least restrictive lock on the table that is supported for the specific operation. This permits the maximum amount of concurrency that is supported for the specific operation.

=== NONE Locking Strategy

The ##NONE## locking strategy performs the operation without acquiring any lock on the table. This permits **all** concurrent DML.

If this locking strategy is not permitted for an operation, then an error is raised.

=== SHARED Locking Strategy

The ##SHARED## locking strategy performs the operation after acquiring a read lock on the table. This permit **read-only** concurrent DML.

If this locking strategy is not permitted for an operation, then an error is raised.

=== EXCLUSIVE Locking Strategy

The ##EXCLUSIVE## locking strategy performs the operation after acquiring a write lock on the table. This does **not** permit concurrent DML.</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>