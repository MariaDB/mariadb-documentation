<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>ColumnStore Architectural Overview - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="ColumnStore Architectural Overview - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/columnstore-architectural-overview/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/columnstore-architectural-overview/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/columnstore-architectural-overview/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a>
    

    
    » <a class="crumb" href="/kb/en/columnstore-architecture/">ColumnStore Architecture</a>
    


    » <a class="node_link crumb" href="/kb/en/columnstore-architectural-overview/">ColumnStore Architectural Overview</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/columnstore-architectural-overview/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>ColumnStore Architectural Overview - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/columnstore-architectural-overview/+r/150788/">150788</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-3210">
<a href="/kb/user/id/3210" title="Dipti Joshi">Dipti Joshi</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2025-04-23 08:43">2025-04-23 08:43</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">MariaDB ColumnStore is a columnar storage engine designed for distributed massively parallel processing (MPP), such as for big data analysis.  Deployments are composed of several MariaDB servers, operating as modules, working together to provide linear scalability and exceptional performance with real-time response to analytical queries.  These modules include [[#user-module|User]], [[#performance-module|Performance]] and [[#storage|Storage]].

{{columnstore-arch-diagram}}

It provides a highly available, fault tolerant, and performant columnar storage engine for MariaDB Enterprise Server. MariaDB Enterprise ColumnStore is designed for data warehousing, decision support systems (DSS), online analytical processing (OLAP), and hybrid transactional-analytical processing (HTAP).

&lt;&lt;toc&gt;&gt;

== Benefits

* **Columnar storage engine** that enables MariaDB Enterprise Server to perform new workloads
* **Optimized for online analytical process (OLAP) workloads** including data warehousing, decision support systems, and business intelligence
* **Single-stack solution for hybrid transactional-analytical workloads** to eliminate barriers and prevent data silos
* **Implements cross-engine JOINs** to join Enterprise ColumnStore tables with tables using row-based storage engines, such as [[storage-engines-overview-innodb-storage-engine|InnoDB]]
* **Smart storage engine** that plans and optimizes its own queries using a custom select handler
* **Scalable query execution** using massively parallel processing (MPP) strategies, parallel query execution, and distributed function evaluation
* **S3-compatible object storage** can be used for highly available, low-cost, multi-regional, resilient, scalable, secure, and virtually limitless data storage
* **High availability and automatic failover** by leveraging [[maxscale|MariaDB MaxScale]]
* **REST API** for multi-node administration with the [[columnstore-architecture-from-enterprise-docs/#cluster-management-api-cmapi-server|Cluster Management API (CMAPI) server]]
* **Connectors for popular BI platforms** such as Microsoft Power BI and Tableau
* **High-speed bulk data loading** that bypasses the SQL layer and does not block concurrent read-only queries

== Topologies

MariaDB Enterprise ColumnStore supports multiple topologies. Several options are described below. MariaDB Enterprise ColumnStore can be deployed in other topologies. The topologies on this page are representative of basic product capabilities.

MariaDB products can be deployed to form other topologies that leverage advanced product capabilities and combine the capabilities of multiple topologies.

=== Enterprise ColumnStore with Object Storage

{{columnstore-topology-s3}}

The MariaDB Enterprise ColumnStore topology with Object Storage delivers production analytics with high availability, fault tolerance, and limitless data storage by leveraging S3-compatible storage.

The topology consists of:

* One or more MaxScale nodes
* An odd number of ColumnStore nodes (minimum of 3) running ES, Enterprise ColumnStore, and CMAPI

The MaxScale nodes:

* Monitor the health and availability of each ColumnStore node using the MariaDB Monitor (mariadbmon)
* Accept client and application connections
* Route queries to ColumnStore nodes using the Read/Write Split Router (readwritesplit)

The ColumnStore nodes:

* Receive queries from MaxScale
* Execute queries
* Use [[mariadb-enterprise-columnstore-storage-architecture/#s3-compatible-object-storage|S3-compatible object storage]] for data
* Use [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage]] for the [[mariadb-enterprise-columnstore-storage-architecture/#storage-manager-directory|Storage Manager directory]].

=== Enterprise ColumnStore with Shared Local Storage
{{es-columnstore-topology-nfs-no-title}}

The MariaDB Enterprise ColumnStore topology with Shared Local Storage delivers production analytics with high availability and fault tolerance by leveraging shared local storage, such as NFS.

The topology consists of:

* One or more MaxScale nodes
* An odd number of ColumnStore nodes (minimum of 3) running ES, Enterprise ColumnStore, and CMAPI

The MaxScale nodes:

* Monitor the health and availability of each ColumnStore node using the MariaDB Monitor (mariadbmon)
* Accept client and application connections
*Route queries to ColumnStore nodes using the Read/Write Split Router (readwritesplit)

The ColumnStore nodes:

* Receive queries from MaxScale
* Execute queries
* Use [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage]] for the [[mariadb-enterprise-columnstore-storage-architecture/#db-root-directories|DB Root directories]].

== Software Architecture

&lt;&lt;style class=&#34;darkheader-nospace-borders left&#34;&gt;&gt;
|= Software Component |= Role |
| [[mariadb-columnstore|MariaDB Enterprise ColumnStore]]  | • Columnar storage engine \\ • Query execution \\ • Data storage|
| [[mariadb-enterprise-server|MariaDB Enterprise Server]]  | Enterprise-grade database server|
| [[columnstore-architecture-from-enterprise-docs/#columnstore-storage-engine-plugin|ColumnStore Storage Engine Plugin]]  | • Storage engine plugin \\ • Integrates MariaDB Enterprise ColumnStore into MariaDB Enterprise Server |
| [[columnstore-architecture-from-enterprise-docs/#cluster-management-api-cmapi-server|Cluster Management API (CMAPI)]]  | • REST API \\ • Used for administrative tasks |
| [[maxscale|MariaDB MaxScale]]  | • Database proxy \\ • Accepts connections \\ • Routes queries \\ • Performs auto-failover |
&lt;&lt;/style&gt;&gt;

=== MariaDB Enterprise ColumnStore
MariaDB Enterprise ColumnStore is the columnar storage engine that handles data storage and query optimization/execution.

MariaDB Enterprise ColumnStore is a columnar storage engine that is optimized for analytical or online analytical processing (OLAP) workloads, data warehousing, and DSS. MariaDB Enterprise ColumnStore can be used for hybrid transactional-analytical processing (HTAP) workloads when paired with a row-based storage engine, like [[storage-engines-overview-innodb-storage-engine|InnoDB]].

=== MariaDB Enterprise Server
MariaDB Enterprise ColumnStore is built on top of [[mariadb-enterprise-server|MariaDB Enterprise Server]]. MariaDB Enterprise ColumnStore 5 is included with the standard MariaDB Enterprise Server 10.5 releases, while MariaDB Enterprise ColumnStore 6 is included with the standard MariaDB Enterprise Server 10.6 releases.

Enterprise ColumnStore interfaces with the Enterprise Server SQL engine through the ColumnStore storage engine plugin.

MariaDB has been continually improving the integration of MariaDB Enterprise ColumnStore with MariaDB Enterprise Server:

* MariaDB ColumnStore required special custom-built releases of MariaDB Server.
* MariaDB Enterprise ColumnStore was included with the standard MariaDB Enterprise Server 10.5 releases up to ES 10.5.5-3. It was the first release to replace the Operations/Administration/Maintenance (OAM) API with the more modern Cluster Management API (CMAPI), which is still in use.
* Starting with ES 10.5.6-4, MariaDB Enterprise ColumnStore is included with the standard MariaDB Enterprise Server 10.5 releases.

=== ColumnStore Storage Engine Plugin
MariaDB Enterprise ColumnStore integrates with MariaDB Enterprise Server using the ColumnStore storage engine plugin. The ColumnStore storage engine plugin enables MariaDB Enterprise Server to interact with ColumnStore tables.

The ColumnStore storage engine plugin is a smart storage engine that implements a custom select handler to fully take advantage of Enterprise ColumnStore&#39;s capabilities, such as:

* Using a custom query planner
* Selecting data by column instead of by row
* Parallel query evaluation
* Distributed aggregations
* Distributed functions
* Extent elimination

As a smart storage engine, the ColumnStore storage engine plugin tightly integrates Enterprise ColumnStore with ES, but it has enough independence to efficiently execute analytical queries using a completely unique approach.

For additional information, see &#34;[[columnstore-storage-engine|ColumnStore Storage Engine]]&#34;.

=== Cluster Management API (CMAPI) Server
The [[columnstore-architecture-from-enterprise-docs/#cluster-management-api-cmapi-server|Cluster Management API (CMAPI)]] server provides a REST API that can be used to configure and manage Enterprise ColumnStore.

CMAPI must run on every ColumnStore node in a multi-node deployment but is not required in a single-node deployment.

The REST API can be used to perform multiple operations:

* Add ColumnStore nodes
* Remove ColumnStore nodes
* Start Enterprise ColumnStore
* Shutdown Enterprise ColumnStore
* Check the status of Enterprise ColumnStore


=== MariaDB MaxScale
MariaDB Enterprise ColumnStore leverages [[maxscale|MariaDB MaxScale]] as an advanced database proxy and query router.

Multi-node Enterprise ColumnStore deployments must have one or more [[maxscale|MaxScale]] nodes. MaxScale performs many different roles:

* Routing write queries to the primary server
* Load balancing read queries on replica servers
* Monitoring node health
* Performing automatic failover if a node fails

== Storage Architecture
MariaDB Enterprise ColumnStore&#39;s storage architecture provides a columnar storage engine with high availability, fault tolerance, compression, and automatic partitioning for production analytics and data warehousing.

For additional information, see &#34;[[mariadb-enterprise-columnstore-storage-architecture|MariaDB Enterprise ColumnStore Storage Architecture]]&#34;.

=== Columnar Storage Engine

MariaDB Enterprise ColumnStore is a columnar storage engine for [[mariadb-enterprise-server|MariaDB Enterprise Server]]. MariaDB Enterprise ColumnStore enables ES to perform analytical workloads, including online analytical processing (OLAP), data warehousing, decision support systems (DSS), and hybrid transactional-analytical processing (HTAP) workloads.

Most traditional relational databases use row-based storage engines. In row-based storage engines, all columns for a table are stored contiguously. Row-based storage engines perform very well for transactional workloads, but are less performant for analytical workloads.

Columnar storage engines store each column separately. Columnar storage engines perform very well for analytical workloads. Analytical workloads are characterized by ad hoc queries on very large data sets by relatively few users.

MariaDB Enterprise ColumnStore automatically partitions each column into extents, which helps improve query performance without using indexes.

=== S3-Compatible Object Storage
MariaDB Enterprise ColumnStore supports S3-compatible object storage.

S3-compatible object storage is optional, but **highly recommended**. If S3-compatible object storage is used, Enterprise ColumnStore requires the [[mariadb-enterprise-columnstore-storage-architecture/#storage-manager-directory|Storage Manager directory]] to use [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage]] (such as NFS) for high availability.

S3-compatible object storage is:

* **Compatible**: Many object storage services are compatible with the Amazon S3 API.
* **Economical**: S3-compatible object storage is often very low cost.
* **Flexible**: S3-compatible object storage is available for both cloud and on-premises deployments.
* **Limitless**: S3-compatible object storage is often virtually limitless.
* **Resilient**: S3-compatible object storage is often low maintenance and highly available, since many services use resilient cloud infrastructure.
* **Scalable**: S3-compatible object storage is often highly optimized for read and write scaling.
* **Secure**: S3-compatible object storage is often encrypted-at-rest.

Many S3-compatible object storage services exist. MariaDB Corporation cannot make guarantees about all S3-compatible object storage services, because different services provide different functionality.

If you have any questions about using specific S3-compatible object storage with MariaDB Enterprise ColumnStore, contact us.

=== Shared Local Storage
MariaDB Enterprise ColumnStore can use shared local storage.

Shared local storage is required for high availability. The specific [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage requirements]] depend on whether Enterprise ColumnStore is configured to use [[mariadb-enterprise-columnstore-storage-architecture/#s3-compatible-object-storage|S3-compatible object storage]]:

* When S3-compatible object storage is used, Enterprise ColumnStore requires the [[mariadb-enterprise-columnstore-storage-architecture/#storage-manager-directory|Storage Manager directory]] to use shared local storage for high availability.
* When S3-compatible object storage is not used, Enterprise ColumnStore requires the [[mariadb-enterprise-columnstore-storage-architecture/#db-root-directories|DB Root directories]] to use shared local storage for high availability.

The most common shared local storage options for on-premises and cloud deployments are:

* NFS (Network File System)
* GlusterFS

The most common shared local storage options for AWS (Amazon Web Services) deployments are:

* EBS (Elastic Block Store) Multi-Attach
* EFS (Elastic File System)

The most common shared local storage option for GCP (Google Cloud Platform) deployments is:

* Filestore

== Query Evaluation Architecture
{{ECStore-QueryExecutionwith-S3-FlowChart}}

MariaDB Enterprise ColumnStore uses distributed query execution and massively parallel processing (MPP) techniques to achieve vertical and horizontal scalability for production analytics and data warehousing.

For additional information, see &#34;[[mariadb-enterprise-columnstore-query-evaluation|MariaDB Enterprise ColumnStore Query Evaluation]]&#34;.

=== Extent Elimination

{{ECStore-QueryExecutionExtentElimination}}

MariaDB Enterprise ColumnStore uses extent elimination to scale query evaluation as table size increases.

Most databases are row-based databases that use manually-created indexes to achieve high performance on large tables. This works well for transactional workloads. However, analytical queries tend to have very low selectivity, so traditional indexes are not typically effective for analytical queries.

Enterprise ColumnStore uses extent elimination to achieve high performance, without requiring manually created indexes. Enterprise ColumnStore automatically partitions all data into extents. Enterprise ColumnStore stores the minimum and maximum values for each [[mariadb-enterprise-columnstore-storage-architecture/#extents|extent]] in the extent map. Enterprise ColumnStore uses the minimum and maximum values in the [[mariadb-enterprise-columnstore-storage-architecture/#extent-map|extent map]] to perform extent elimination.

When Enterprise ColumnStore performs extent elimination, it compares the query&#39;s join conditions and filter conditions (i.e., WHERE clause) to the minimum and maximum values for each extent in the extent map. If the extent&#39;s minimum and maximum values fall outside the bounds of the query&#39;s conditions, Enterprise ColumnStore skips that extent for the query.

Extent elimination is automatically performed for every query. It can significantly decrease I/O for columns with clustered values. For example, extent elimination works effectively for series, ordered, patterned, and time-based data.

=== Custom Select Handler
The ColumnStore storage engine plugin implements a custom select handler to fully take advantage of Enterprise ColumnStore&#39;s capabilities.

All storage engines interact with ES using an internal handler API, which is highly extensible. Storage engines can implement different features by implementing different methods within the handler API.

For select statements, the handler API transforms each query into a SELECT_LEX object, which is provided to the select handler.

The generic select handler is not optimal for Enterprise ColumnStore, because:

* Enterprise ColumnStore selects data by column, but the generic select handler selects data by row
* Enterprise ColumnStore supports parallel query evaluation, but the generic select handler does not
* Enterprise ColumnStore supports distributed aggregations, but the generic select handler does not
* Enterprise ColumnStore supports distributed functions, but the generic select handler does not
* Enterprise ColumnStore supports extent elimination, but the generic select handler does not
* Enterprise ColumnStore has its own query planner, but the generic select handler cannot use it

== Smart Storage Engine
The ColumnStore storage engine plugin is known as a smart storage engine, because it implements a custom select handler. MariaDB Enterprise ColumnStore integrates with MariaDB Enterprise Server using the ColumnStore storage engine plugin. The ColumnStore storage engine plugin enables MariaDB Enterprise Server to interact with ColumnStore tables.

If a storage engine implements a custom select handler, it is known as a smart storage engine.

As a smart storage engine, the ColumnStore storage engine plugin tightly integrates Enterprise ColumnStore with ES, but it has enough independence to efficiently execute analytical queries using a completely unique approach.

=== Query Planning
The ColumnStore storage engine plugin is a smart storage engine, so MariaDB Enterprise ColumnStore to plan its own queries using the [[mariadb-enterprise-columnstore-query-evaluation/#custom-select-handler|custom select handler]].

MariaDB Enterprise ColumnStore&#39;s query planning is divided into two steps:

1. ES provides the query&#39;s SELECT_LEX object to the [[mariadb-enterprise-columnstore-query-evaluation/#custom-select-handler|custom select handler]]. The custom select handler builds a [[columnstore-execution-plan-csep-for-mariadb-enterprise-columnstore|ColumnStore Execution Plan (CSEP)]].

2. The custom select handler provides the CSEP to the [[mariadb-enterprise-columnstore-query-evaluation/#exemgr-processfacility|ExeMgr process]] on the same node. The ExeMgr process performs [[mariadb-enterprise-columnstore-query-evaluation/#extent-elimination|extent elimination]] and creates a job list.

=== Job Steps
When Enterprise ColumnStore executes a query, the ExeMgr process on the initiator/aggregator node translates the ColumnStore execution plan (CSEP) into a job list. A job list is a sequence of job steps.

Enterprise ColumnStore uses many different types of job steps that provide different scalability benefits:

* Some types of job steps perform operations in a distributed manner using multiple nodes to operate on different extents. Distributed operations provide horizontal scalability.
* Some types of job steps perform operations in a multi-threaded manner using a thread pool. Performing multi-threaded operations provides vertical scalability.

As you increase the number of ColumnStore nodes or the number of cores on each node, Enterprise ColumnStore can use those resources to more efficiently execute job steps.

== High Availability and Failover
MariaDB Enterprise ColumnStore leverages common technologies to provide highly available production analytics with automatic failover:

&lt;&lt;style class=&#34;darkheader-nospace-borders left&#34;&gt;&gt;
|= Technology |= Role|
| [[mariadb-enterprise-columnstore-storage-architecture/#s3-compatible-object-storage|S3-compatible object storage]]  | • HA for data \\ • Optional. |
| [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage]]  | • With S3: HA for [[mariadb-enterprise-columnstore-storage-architecture/#storage-manager-directory|Storage Manager directory]] \\ • Without S3: HA for [[mariadb-enterprise-columnstore-storage-architecture/#db-root-directories|DB Root directories]] |
|[[columnstore-architecture-from-enterprise-docs/#mariadb-replication|MariaDB Replication]] | • Schema replication (ColumnStore tables) \\  • Schema and data replication (non-ColumnStore tables) \\ • Database object replication |
|[[columnstore-architecture-from-enterprise-docs/#maxscale|MaxScale]] | • Monitoring \\ • Automatic failover \\ • Load balancing|
|[[columnstore-architecture-from-enterprise-docs/#cluster-management-api-cmapi-server|Cluster Management API (CMAPI) Server]] |• REST API \\ • Administration \\ • Add nodes \\• Remove nodes |
&lt;&lt;/style&gt;&gt;

=== S3-Compatible Object Storage

MariaDB Enterprise ColumnStore supports S3-compatible object storage.

S3-compatible object storage is optional, but highly recommended. If S3-compatible object storage is used, Enterprise ColumnStore requires the [[mariadb-enterprise-columnstore-storage-architecture/#storage-manager-directory|Storage Manager directory]] to use [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage]] (such as NFS) for high availability.

S3-compatible object storage is:

* **Compatible**: Many object storage services are compatible with the Amazon S3 API.
* **Economical**: S3-compatible object storage is often very low cost.
* **Flexible**: S3-compatible object storage is available for both cloud and on-premises deployments.
* **Limitless**: S3-compatible object storage is often virtually limitless.
* **Resilient**: S3-compatible object storage is often low maintenance and highly available, since many services use resilient cloud infrastructure.
* **Scalable**: S3-compatible object storage is often highly optimized for read and write scaling.
* **Secure**: S3-compatible object storage is often encrypted-at-rest.

Many S3-compatible object storage services exist. MariaDB Corporation cannot make guarantees about all S3-compatible object storage services, because different services provide different functionality.

If you have any questions about using specific S3-compatible object storage with MariaDB Enterprise ColumnStore, contact us.

=== Shared Local Storage
MariaDB Enterprise ColumnStore can use shared local storage.

Shared local storage is required for high availability. The specific [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage requirements]] depend on whether Enterprise ColumnStore is configured to use [[mariadb-enterprise-columnstore-storage-architecture/#s3-compatible-object-storage|S3-compatible object storage]]:

* When S3-compatible object storage is used, Enterprise ColumnStore requires the [[mariadb-enterprise-columnstore-storage-architecture/#storage-manager-directory|Storage Manager directory]] to use shared local storage for high availability.
* When S3-compatible object storage is not used, Enterprise ColumnStore requires the [[mariadb-enterprise-columnstore-storage-architecture/#db-root-directories|DB Root directories]] to use [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage]] for high availability.

The most common shared local storage options for on-premises and cloud deployments are:

* NFS (Network File System)
* GlusterFS

The most common shared local storage options for AWS (Amazon Web Services) deployments are:

* EBS (Elastic Block Store) Multi-Attach
* EFS (Elastic File System)

The most common shared local storage option for GCP (Google Cloud Platform) deployments is:

* Filestore

=== MariaDB Replication
MariaDB Enterprise ColumnStore requires [[standard-replication|MariaDB Replication]] to synchronize various database objects on multiple nodes for high availability.

MariaDB replication synchronizes:

* The schemas for all ColumnStore tables on all nodes
* The schemas and data for all non-ColumnStore tables on all nodes
* All other databases objects (stored procedures, stored functions, user accounts, and other objects) on all nodes

=== MaxScale
MariaDB Enterprise ColumnStore requires [[maxscale|MariaDB MaxScale]] to achieve high availability, automatic failover, and load balancing.

MariaDB Monitor (mariadbmon) in MaxScale monitors the health of each Enterprise ColumnStore node.

MaxScale provides load balancing by routing queries and/or connections to healthy nodes by:

* Providing query-based routing using Read/Write Split Router (readwritesplit).
* Providing connection-based routing using Read Connection Router (readconnroute).

When MaxScale&#39;s MariaDB Monitor notices the primary node fail, MariaDB Monitor performs automatic failover by:

* Promoting a replica node to become the new primary node.
* Re-configuring all replica nodes to replicate from the new primary node.

=== Cluster Management API (CMAPI) Server
MariaDB Enterprise ColumnStore requires the [[Cluster Management API (CMAPI) Server for high availability.

The CMAPI server provides a REST API that can be used to manage and configure Enterprise ColumnStore.

The CMAPI server has a role in automatic failover. After MaxScale performs automatic failover, the CMAPI server detects the topology change and automatically re-configures the roles of each Enterprise ColumnStore node.

== Data Loading

{{ECStoreDataLoadingS3FlowChart}}

MariaDB Enterprise ColumnStore performs bulk data loads very efficiently using a variety of mechanisms including the cpimport tool, specialized handling of certain SQL statements, and minimal locking during data import.

For additional information, see &#34;MariaDB Enterprise ColumnStore Data Loading&#34;.

=== cpimport
MariaDB Enterprise ColumnStore includes a bulk data loading tool called cpimport, which provides several benefits:

* Bypasses the SQL layer to decrease overhead
* Does not block read queries
* Requires a write metadata lock on the table, which can be monitored with the [[metadata-lock-info-plugin|METADATA_LOCK_INFO plugin]].
* Appends the new data to the table. While the bulk load is in progress, the newly appended data is temporarily hidden from queries. After the bulk load is complete, the newly appended data is visible to queries.
* Inserts each row in the order the rows are read from the source file. Users can optimize data loads for Enterprise ColumnStore&#39;s automatic partitioning by loading presorted data files. For additional information, see &#34;[[query-tuning-recommendations-for-mariadb-enterprise-columnstore/#load-ordered-data-in-proper-order|Load Ordered Data in Proper Order]]&#34;.
* Supports parallel distributed bulk loads
* Imports data from text files
* Imports data from binary files
* Imports data from standard input (stdin)

=== Batch Insert Mode
MariaDB Enterprise ColumnStore enables batch insert mode by default.

When batch insert mode is enabled, MariaDB Enterprise ColumnStore, MariaDB Enterprise ColumnStore has special handling for the following statements:

* [[load-data-infile|LOAD DATA INFILE]]
* [[insert|INSERT INTO .. SELECT FROM]] .

Enterprise ColumnStore uses the following rules:

* If the statement is executed outside of a transaction, Enterprise ColumnStore loads the data using cpimport, which is a command-line utility that is designed to efficiently load data in bulk. Enterprise ColumnStore executes cpimport using a wrapper called cpimport.bin.
* If the statement is executed inside of a transaction, Enterprise ColumnStore loads the data using the DML interface, which is slower.

Batch insert mode can be disabled by setting the columnstore_use_import_for_batchinsert system variable. When batch insert mode is disabled, Enterprise ColumnStore executes the statements using the DML interface, which is slower.

=== Locking
MariaDB Enterprise ColumnStore requires a write metadata lock (MDL) on the table when a bulk data load is performed with cpimport.

When a bulk data load is running:

* Read queries will not be blocked.
* Write queries and concurrent bulk data loads on the same table will be blocked until the bulk data load operation is complete, and the write metadata lock on the table has been released.
* The write metadata lock (MDL) can be monitored with the [[metadata-lock-info-plugin|METADATA_LOCK_INFO plugin]].

== Backup and Restore
{{EntColStoreBackupS3FlowChart}}

MariaDB Enterprise ColumnStore supports backup and restore using well-known tools and methods.

&lt;&lt;style class=&#34;darkheader-nospace-borders left&#34;&gt;&gt;
|= Component |= Backup Methods |
| [[mariadb-enterprise-columnstore-storage-architecture/#s3-compatible-object-storage|S3-compatible object storage]]  | • S3 snapshot |
| [[mariadb-enterprise-columnstore-storage-architecture/#shared-local-storage|Shared Local Storage]]  | • File system snapshot \\ • File copy |
|[[columnstore-architecture-from-enterprise-docs/#enterprise-server-data-directory|Enterprise Server Data Directory]] |• MariaDB Enterprise Backup |
&lt;&lt;/style&gt;&gt;

For additional information, see &#34;MariaDB Enterprise ColumnStore Backup and Restore&#34;.

=== S3-Compatible Object Storage
MariaDB Enterprise ColumnStore can leverage S3 snapshots to backup S3-compatible object storage when it is used for Enterprise ColumnStore&#39;s data.

The S3-compatible object storage can be backed up by:

1. Locking the database on the primary node

2. Performing an S3 snapshot using the vendor&#39;s standard snapshot functionality

=== Shared Local Storage
MariaDB Enterprise ColumnStore can leverage file system snapshots or file copy tools (such as rsync) to backup shared local storage when it is used for the [[mariadb-enterprise-columnstore-storage-architecture/#storage-manager-directory|Storage Manager directory]] or the [[mariadb-enterprise-columnstore-storage-architecture/#db-root-directories|DB Root directories]].

The shared local storage can be backed up by:

1. Locking the database on the primary node

2. Performing a file system snapshot or using a file copy tool (such as rsync) to copy the contents of the [[mariadb-enterprise-columnstore-storage-architecture/#storage-manager-directory|Storage Manager directory]] and/or the [[mariadb-enterprise-columnstore-storage-architecture/#db-root-directories|DB Root directories]].

=== Enterprise Server Data Directory
MariaDB Enterprise ColumnStore can leverage the standard [[mariabackup|MariaDB Enterprise Backup]] utility to backup the Enterprise Server data directory.

The backup contains:

* All ColumnStore schemas
* All non-ColumnStore schemas and data
* All other database objects

It does not contain:

*ColumnStore data</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>