<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>MariaDB Knowledge Base Comments for: PREPARE Statement</title><link>https://mariadb.com/kb/en/prepare-statement/+comments/feed/</link><description></description><atom:link href="https://mariadb.com/kb/en/prepare-statement/+comments/feed/" rel="self"></atom:link><language>en-us</language><lastBuildDate>Mon, 07 Oct 2024 02:22:54 +0000</lastBuildDate><item><title>Re: PREPARE Statement</title><link>https://mariadb.com/kb/en/prepare-statement/+comments/4459</link><description>&lt;p&gt;I am fighting with right syntax of PREPARE statement for CONNECT type tables.
I run 10.4.12-MariaDB on Windows10 and I use 64-bit ODBC driver to connect tables from MS Access to MariaDB database.&lt;/p&gt;
&lt;p&gt;Having a table named fff which is  &lt;code class="fixed" style="white-space:pre-wrap"&gt;ENGINE=CONNECT TABLE_TYPE=ODBC &lt;/code&gt;, I try to run prepared statements on it.&lt;/p&gt;
&lt;p&gt;While I have &lt;strong&gt;no trouble&lt;/strong&gt; to run statement with &lt;strong&gt;integer&lt;/strong&gt; type parameter:
 &lt;/p&gt;&lt;pre class="fixed"&gt;set @createStr = (&amp;#34;select * from fff where reltpfak = ? &amp;#34;);
prepare theSQL from @createStr ;
set @i = 1;
execute theSQL using @i;
-- works! &lt;/pre&gt;&lt;p&gt;
I can not find a right syntax to pass &lt;strong&gt;string&lt;/strong&gt; variable. My trials lead to an &lt;strong&gt;error&lt;/strong&gt;:
 &lt;/p&gt;&lt;pre class="fixed"&gt;set @createStr = (&amp;#34;select reltpfak from fa where Firma = ? ;&amp;#34;);
prepare theSQL from @createStr ;
set @i = &amp;#34;NameOfCompany&amp;#34;;
execute theSQL using @i; &lt;/pre&gt;&lt;p&gt;
returns  &lt;code class="fixed" style="white-space:pre-wrap"&gt;Incorrect arguments to EXECUTE &lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The same one just with added ' around '?'
 &lt;/p&gt;&lt;pre class="fixed"&gt;set @createStr = (&amp;#34;select reltpfak from fa where Firma = '?' ;&amp;#34;)
prepare theSQL from @createStr ;
set @i = &amp;#34;NameOfCompany&amp;#34;;
execute theSQL using @i &lt;/pre&gt;&lt;p&gt;
returns  &lt;code class="fixed" style="white-space:pre-wrap"&gt;Error: Got error 174 'SQLExecDirect: [Microsoft][ODBC Microsoft Access Driver] Syntax error (missing operator) in query expression 'Firma= NameOfCompany'.' from CONNECT &lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;What is the right syntax of PREPARE statement for CONNECT type tables when passing string variable?&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Radim Mach≈Ø</dc:creator><guid>https://mariadb.com/kb/en/prepare-statement/+comments/4459</guid></item><item><title>Re: PREPARE Statement</title><link>https://mariadb.com/kb/en/prepare-statement/+comments/1951</link><description>&lt;p&gt;There were a number of related fixes in 10.1.11 (see &lt;a href="/kb/en/mariadb-10111-changelog/"&gt;changelog&lt;/a&gt;) - is this still an issue? Suggest reporting a bug if it is.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ian Gilfillan</dc:creator><guid>https://mariadb.com/kb/en/prepare-statement/+comments/1951</guid></item><item><title>Re: PREPARE Statement</title><link>https://mariadb.com/kb/en/prepare-statement/+comments/1946</link><description>&lt;p&gt;Using Statement Based Replication the prepare is not replicated and query is replay on slave with unprepared form. &lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Stephane Varoqui</dc:creator><guid>https://mariadb.com/kb/en/prepare-statement/+comments/1946</guid></item></channel></rss>