<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>PREPARE Statement - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.b9e1e104f007.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="PREPARE Statement - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/prepare-statement/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/prepare-statement/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/prepare-statement/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/using-mariadb-server/">Using MariaDB Server</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements-structure/">SQL Statements &amp; Structure</a>
    

    
    » <a class="crumb" href="/kb/en/sql-statements/">SQL Statements</a>
    

    
    » <a class="crumb" href="/kb/en/prepared-statements/">Prepared Statements</a>
    


    » <a class="node_link crumb" href="/kb/en/prepare-statement/">PREPARE Statement</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/prepare-statement/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>PREPARE Statement - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/prepare-statement/+r/130194/">130194</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-7">
<a href="/kb/user/id/7" title="Michael Widenius">Michael Widenius</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2023-09-08 02:33">2023-09-08 02:33</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">== Syntax

&lt;&lt;code&gt;&gt;           
PREPARE stmt_name FROM preparable_stmt
&lt;&lt;/code&gt;&gt;
&lt;&lt;toc&gt;&gt;
== Description

The &lt;&lt;code&gt;&gt;PREPARE&lt;&lt;/code&gt;&gt; statement prepares a statement and assigns it a name,
&lt;&lt;code&gt;&gt;stmt_name&lt;&lt;/code&gt;&gt;, by which to refer to the statement later. Statement names
are not case sensitive. &lt;&lt;code&gt;&gt;preparable_stmt&lt;&lt;/code&gt;&gt; is either a string literal or a [[user-defined-variables|user variable]] (not a [[declare-variable|local variable]], an SQL expression or a subquery) that contains the text of the statement. The text must   
represent a single SQL statement, not multiple statements. Within the
statement, &#34;?&#34; characters can be used as parameter markers to indicate
where data values are to be bound to the query later when you execute
it. The &#34;?&#34; characters should not be enclosed within quotes, even if
you intend to bind them to string values. Parameter markers can be used
only where expressions should appear, not for SQL keywords,
identifiers, and so forth.

The scope of a prepared statement is the session within which it is
created. Other sessions cannot see it.

If a prepared statement with the given name already exists, it is
deallocated implicitly before the new statement is prepared. This means
that if the new statement contains an error and cannot be prepared, an
error is returned and no statement with the given name exists.

Prepared statements can be PREPAREd and [[execute-statement|EXECUTEd]] in a stored procedure, but not in a stored function or trigger. Also, even if the statement is PREPAREd in a procedure, it will not be deallocated when the procedure execution ends.

A prepared statement can access [[user-defined-variables|user-defined variables]], but not [[declare-variable|local variables]] or procedure&#39;s parameters.

If the prepared statement contains a syntax error, PREPARE will fail. As a side effect, stored procedures can use it to check if a statement is valid. For example:

&lt;&lt;code&gt;&gt;
CREATE PROCEDURE `test_stmt`(IN sql_text TEXT)
BEGIN
        DECLARE EXIT HANDLER FOR SQLEXCEPTION
        BEGIN
                SELECT CONCAT(sql_text, &#39; is not valid&#39;);
        END;
        SET @SQL := sql_text;
        PREPARE stmt FROM @SQL;
        DEALLOCATE PREPARE stmt;
END;
&lt;&lt;/code&gt;&gt;

The [[found_rows|FOUND_ROWS()]] and [[information-functions-row_count|ROW_COUNT()]] functions, if called immediatly after EXECUTE, return the number of rows read or affected by the prepared statements; however, if they are called after DEALLOCATE PREPARE, they provide information about this statement. If the prepared statement produces errors or warnings, [[get-diagnostics|GET DIAGNOSTICS]] return information about them. DEALLOCATE PREPARE shouldn&#39;t clear the [[diagnostics-area|diagnostics area]], unless it produces an error.

A prepared statement is executed with ##[[execute-statement|EXECUTE]]## and released 
with ##[[deallocate-drop-prepared-statement|DEALLOCATE PREPARE]]##.

The [[server-system-variables#max_prepared_stmt_count|max_prepared_stmt_count]] server system variable determines the number of allowed prepared statements that can be prepared on the server. If it is set to 0, prepared statements are not allowed. If the limit is reached, an error similar to the following will be produced:

&lt;&lt;code&gt;&gt;
ERROR 1461 (42000): Can&#39;t create more than max_prepared_stmt_count statements 
  (current value: 0)
&lt;&lt;/code&gt;&gt;

=== Oracle Mode
&lt;&lt;product mariadb from=10.3&gt;&gt;
In [[sql_modeoracle-from-mariadb-103#prepared-statements|Oracle mode from MariaDB 10.3]], ##PREPARE stmt FROM &#39;SELECT :1, :2&#39;## is used, instead of ##?##.
&lt;&lt;/product&gt;&gt;

== Permitted Statements

&lt;&lt;product mariadb from=10.6.2&gt;&gt;
All statements can be prepared, except [[prepare-statement|PREPARE]], [[execute-statement|EXECUTE]], and [[deallocate-drop-prepare|DEALLOCATE / DROP PREPARE]].
&lt;&lt;/product&gt;&gt;

Prior to this, not all statements can be prepared. Only the following SQL commands are permitted:

*[[alter-table|ALTER TABLE]]
*[[analyze-table|ANALYZE TABLE]]
*[[binlog|BINLOG]]
*[[cache-index|CACHE INDEX]]
*[[call|CALL]]
*[[change-master-to|CHANGE MASTER]]
*[[checksum-table|CHECKSUM {TABLE | TABLES}]]
*[[commit|COMMIT]]
*{[[create-database|CREATE]] | [[drop-database|DROP]]} DATABASE
*{[[create-index|CREATE]] | [[drop-index|DROP]]} INDEX
*{[[create-table|CREATE]] | [[rename-table|RENAME]] | [[drop-table|DROP]]} TABLE
*{[[create-user|CREATE]] | [[rename-user|RENAME]] | [[drop-user|DROP]]} USER
*{[[create-view|CREATE]] | [[drop-view|DROP]]} VIEW
*[[delete|DELETE]]
*[[describe|DESCRIBE]]
*[[do|DO]]
*[[explain|EXPLAIN]]
*[[flush|FLUSH]] {TABLE | TABLES | TABLES WITH READ LOCK | HOSTS | PRIVILEGES | LOGS | STATUS | 
  MASTER | SLAVE | DES_KEY_FILE | USER_RESOURCES | [[flush-query-cache|QUERY CACHE]] | TABLE_STATISTICS | 
  INDEX_STATISTICS | USER_STATISTICS | CLIENT_STATISTICS}
*[[grant|GRANT]]
*[[insert|INSERT]]
*INSTALL {[[install-plugin|PLUGIN]] | [[install-soname|SONAME]]}
*[[handler-commands|HANDLER READ]]
*[[kill|KILL]]
*[[load-index|LOAD INDEX INTO CACHE]]
*[[optimize-table|OPTIMIZE TABLE]]
*[[repair-table|REPAIR TABLE]]
*[[replace|REPLACE]]
*[[reset|RESET]] {[[reset-master|MASTER]] | [[reset-slave-connection_name|SLAVE]] | [[reset|QUERY CACHE]]}
*[[revoke|REVOKE]]
*[[rollback|ROLLBACK]]
*[[select|SELECT]]
*[[set|SET]]
*[[set-global-sql_slave_skip_counter|SET GLOBAL SQL_SLAVE_SKIP_COUNTER]]
*[[set-role|SET ROLE]]
*[[set-sql_log_bin|SET SQL_LOG_BIN]]
*[[set-transaction|SET TRANSACTION ISOLATION LEVEL]]
*[[show-explain|SHOW EXPLAIN]]
*SHOW {[[show-databases|DATABASES]] | [[show-tables|TABLES]] | [[show-open-tables|OPEN TABLES]] | [[show-table-status|TABLE STATUS]] | [[show-columns|COLUMNS]] | [[show-index|INDEX]] | [[show-triggers|TRIGGERS]] | 
  [[show-events|EVENTS]] | [[show-grants|GRANTS]] | [[show-character-set|CHARACTER SET]] | [[show-collation|COLLATION]] | [[show-events|ENGINES]] | [[show-plugins|PLUGINS [SONAME]]] | [[show-privileges|PRIVILEGES]] | 
  [[show-processlist|PROCESSLIST]] | [[show-profile|PROFILE]] | [[show-profiles|PROFILES]] | [[show-variables|VARIABLES]] | [[show-status|STATUS]] | [[show-warnings|WARNINGS]] | [[show-errors|ERRORS]] | 
  [[show-table-statistics|TABLE_STATISTICS]] | [[show-index-statistics|INDEX_STATISTICS]] | [[show-user-statistics|USER_STATISTICS]] | [[show-client-statistics|CLIENT_STATISTICS]] | [[show-authors|AUTHORS]] | 
  [[show-contributors|CONTRIBUTORS]]}
*SHOW CREATE {[[show-create-database|DATABASE]] | [[show-create-table|TABLE]] | [[show-create-view|VIEW]] | [[show-create-procedure|PROCEDURE]] | [[show-create-function|FUNCTION]] | [[show-create-trigger|TRIGGER]] | [[show-create-event|EVENT]]}
*SHOW {[[show-function-code|FUNCTION]] | [[show-procedure-code|PROCEDURE]]} CODE
*[[show-binlog-events|SHOW BINLOG EVENTS]]
*[[show-replica-hosts|SHOW SLAVE HOSTS]]
*SHOW {MASTER | BINARY} LOGS
*SHOW {MASTER | SLAVE | TABLES | INNODB | FUNCTION | PROCEDURE} STATUS
*SLAVE {[[start-slave|START]] | [[stop-slave|STOP]]}
*[[truncate-table|TRUNCATE TABLE]]
*[[shutdown|SHUTDOWN]]
*UNINSTALL {PLUGIN | SONAME}
*[[update|UPDATE]]

Synonyms are not listed here, but can be used. For example, DESC can be used instead of DESCRIBE.

[[using-compound-statements-outside-of-stored-programs|Compound statements]] can be prepared too.

Note that if a statement can be run in a stored routine, it will work even if it is called by a prepared statement. For example, [[signal|SIGNAL]] can&#39;t be directly prepared. However, it is allowed in [[stored-routines|stored routines]]. If the x() procedure contains SIGNAL, you can still prepare and execute the &#39;CALL x();&#39; prepared statement.

PREPARE supports most kinds of expressions as well, for example:
&lt;&lt;code&gt;&gt;
PREPARE stmt FROM CONCAT(&#39;SELECT * FROM &#39;, table_name);
&lt;&lt;/code&gt;&gt;

When PREPARE is used with a statement which is not supported, the following error is produced:

&lt;&lt;code&gt;&gt;
ERROR 1295 (HY000): This command is not supported in the prepared statement protocol yet
&lt;&lt;/code&gt;&gt;

== Example
&lt;&lt;code&gt;&gt;
create table t1 (a int,b char(10));
insert into t1 values (1,&#34;one&#34;),(2, &#34;two&#34;),(3,&#34;three&#34;);
prepare test from &#34;select * from t1 where a=?&#34;;
set @param=2;
execute test using @param;
+------+------+
| a    | b    |
+------+------+
|    2 | two  |
+------+------+
set @param=3;
execute test using @param;
+------+-------+
| a    | b     |
+------+-------+
|    3 | three |
+------+-------+
deallocate prepare test;
&lt;&lt;/code&gt;&gt;

Since identifiers are not permitted as prepared statements parameters, sometimes it is necessary to dynamically compose an SQL statement. This technique is called //dynamic SQL//). The following example shows how to use dynamic SQL:

&lt;&lt;code&gt;&gt;
CREATE PROCEDURE test.stmt_test(IN tab_name VARCHAR(64))
BEGIN
	SET @sql = CONCAT(&#39;SELECT COUNT(*) FROM &#39;, tab_name);
	PREPARE stmt FROM @sql;
	EXECUTE stmt;
	DEALLOCATE PREPARE stmt;
END;

CALL test.stmt_test(&#39;mysql.user&#39;);
+----------+
| COUNT(*) |
+----------+
|        4 |
+----------+
&lt;&lt;/code&gt;&gt;

Use of variables in prepared statements:

&lt;&lt;code&gt;&gt;
PREPARE stmt FROM &#39;SELECT @x;&#39;;

SET @x = 1;

EXECUTE stmt;
+------+
| @x   |
+------+
|    1 |
+------+

SET @x = 0;

EXECUTE stmt;
+------+
| @x   |
+------+
|    0 |
+------+

DEALLOCATE PREPARE stmt;
&lt;&lt;/code&gt;&gt;

== See Also

* [[out-parameters-in-prepare|Out parameters in PREPARE]]
* [[execute-statement|EXECUTE Statement]]
* [[deallocate-drop-prepared-statement|DEALLOCATE / DROP Prepared Statement]]
* [[execute-immediate|EXECUTE IMMEDIATE]]
* [[sql_modeoracle-from-mariadb-103/#prepared-statements|Oracle mode from MariaDB 10.3]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>