<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>MariaDB Knowledge Base Comments for: Migrated from 10.1.22 to 10.6.7 and queries get stuck unless we manually analyze table.</title><link>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/feed/</link><description></description><atom:link href="https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/feed/" rel="self"></atom:link><language>en-us</language><lastBuildDate>Mon, 02 Sep 2024 11:08:28 +0000</lastBuildDate><item><title>Re: Migrated from 10.1.22 to 10.6.7 and queries get stuck unless we manually analyze table.</title><link>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/6048</link><description>&lt;p&gt;Same problem on 10.6.7 and 10.6.11 (10.6.11-MariaDB-0ubuntu0.22.04.1-log Ubuntu 22.04)
Ananlyze helps BEFORE mysql restart. After restart we have to do it again. Very-very unstable and frustration behavior. It was no such problem in 10.1 for sure.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Mikhail Benkovich</dc:creator><guid>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/6048</guid></item><item><title>Re: Migrated from 10.1.22 to 10.6.7 and queries get stuck unless we manually analyze table.</title><link>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/6014</link><description>&lt;p&gt;I am experiencing the exact same thing except that my database is comparatively small (100 MB) and has very little traffic. ANALYZE immediately solves the problem. Updating to a newer 10.6 version didn't solve the problem for me. May I ask if you ever found a solution?&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Julian Petri</dc:creator><guid>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/6014</guid></item><item><title>Re: Migrated from 10.1.22 to 10.6.7 and queries get stuck unless we manually analyze table.</title><link>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/5913</link><description>&lt;p&gt;That in itself is probably helpful and I would not have found it with what I was looking for.&lt;/p&gt;
&lt;p&gt;I can't think of a way to make it reproducible on our (or any) system, except just have a heavy workload with a lot of writes, and sometimes you'll get the problem after a few days, sometimes much longer.  And if its inconsistent like that its very tricky to deal with.&lt;/p&gt;
&lt;p&gt;Queries don't just run slow, they start running forever, because of this I couldn't use the slow query log, queries have to complete first.  "Explain" doesn't help and there is no error nor anything to go on in the status or logs.&lt;/p&gt;
&lt;p&gt;Like I said the key to it seems to be that once it gets into that state, running analyze table, restores the functionality - hence my guess is that it has to be to do with optimization.&lt;/p&gt;
&lt;p&gt;I could add more details - what do you suggest?  The query itself need not be complex and its not the query per-se as we see it on more than one query on more than one table.  &lt;/p&gt;
&lt;p&gt;More information:&lt;/p&gt;
&lt;ul start="1"&gt;&lt;li&gt;I think I have seen it when clustered and also when there are no nodes joined.
&lt;/li&gt;&lt;li&gt;Running on a container and using ZFS filesystem on the back end.
&lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;I mention ZFS as I've had other issues with maria db on that file system.  Along the lines of writes fail and it never recovers when previous snapshops are copied.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">James Cross</dc:creator><guid>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/5913</guid></item><item><title>Re: Migrated from 10.1.22 to 10.6.7 and queries get stuck unless we manually analyze table.</title><link>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/5912</link><description>&lt;p&gt;There's not much to go on with the information above, but I suggest looking to see if there's been a bug reported that matches your issue, for example &lt;a href="https://jira.mariadb.org/browse/MDEV-28073"&gt;MDEV-28073&lt;/a&gt;, which was fixed in &lt;a href="/kb/en/mariadb-1068-release-notes/"&gt;MariaDB 10.6.8&lt;/a&gt;, or &lt;a href="reporting_bugs"&gt;reporting as a new bug&lt;/a&gt; with more details so that someone could try recreate it.&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ian Gilfillan</dc:creator><guid>https://mariadb.com/kb/en/optimization-and-tuning-migrated-from-10122-to-1067-and-queries-get-stuck-u/+comments/5912</guid></item></channel></rss>