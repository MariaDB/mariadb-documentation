<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Installing TokuDB - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Installing TokuDB - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/installing-tokudb/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/installing-tokudb/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/installing-tokudb/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/solutions" title="Solutions">Solutions</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="Company">Company</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/columns-storage-engines-and-plugins/">Columns, Storage Engines, and Plugins</a>
    

    
    » <a class="crumb" href="/kb/en/storage-engines/">Storage Engines</a>
    

    
    » <a class="crumb" href="/kb/en/tokudb/">TokuDB</a>
    


    » <a class="node_link crumb" href="/kb/en/installing-tokudb/">Installing TokuDB</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/installing-tokudb/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Installing TokuDB - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/installing-tokudb/+r/98009/">98009</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-7">
<a href="/kb/user/id/7" title="Michael Widenius">Michael Widenius</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2020-04-19 13:31">2020-04-19 13:31</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;
&lt;&lt;include slug=&#34;tokudb-disabled&#34;&gt;&gt;

&lt;&lt;style class=&#34;redbox&#34;&gt;&gt;
Note that ha_tokudb is not included in binaries built with the &#34;old&#34; glibc. Binaries built with glibc 2.14+ do include it.
&lt;&lt;/style&gt;&gt;

&lt;&lt;include slug=&#34;tokudb-included-on&#34;&gt;&gt;

&lt;&lt;style class=&#34;bluebox&#34;&gt;&gt;
**Note:** The TokuDB version that comes from MariaDB.org differs slightly from the
TokuDB version from [[http://www.tokutek.com|Tokutek]]. Please
read the [[tokudb-differences|TokuDB Differences]] article before using TokuDB!
&lt;&lt;/style&gt;&gt;

The following sections detail how to install and enable TokuDB.

== Installing TokuDB

&lt;&lt;style class=&#34;redbox&#34;&gt;&gt;
Until MariaDB versions 5.5.39 and 10.0.13, before upgrading TokuDB, the server needed to be cleanly shut down. If the server was not cleanly shut down, TokuDB would fail to start. Since 5.5.40 and 10.0.14, this has no longer been necessary. See MDEV-6173.
&lt;&lt;/style&gt;&gt;

TokuDB has been included with MariaDB since MariaDB 5.5.34 and MariaDB 10.0.6 and does not require separate installation. Proceed straight to [[#check-for-transparent-hugepage-support-on-linux|Check for Transparent HugePage Support on Linux]]. For older versions, see the distro-specific instructions below.

=== Installing TokuDB on Fedora, RedHat, &amp; CentOS

In MariaDB 5.5.33, MariaDB 10.0.5, and starting from MariaDB 10.2.5 TokuDB is in a separate RPM package
called ##MariaDB-tokudb-engine## and is installed as follows:

&lt;&lt;code lang=sh inline=false&gt;&gt;
sudo yum install MariaDB-tokudb-engine
&lt;&lt;/code&gt;&gt;

=== Installing TokuDB on Ubuntu &amp; Debian

On Ubuntu, TokuDB is available on the 64-bit versions of Ubuntu 12.10 and
newer. On Debian, TokuDB is available on the 64-bit versions of Debian 7
&#34;Wheezy&#34; and newer. 

The package is installed as follows:

&lt;&lt;code lang=sh inline=false&gt;&gt;
sudo apt-get install mariadb-plugin-tokudb
&lt;&lt;/code&gt;&gt;

In some earlier versions, from MariaDB 5.5.33 and MariaDB 10.0.5, TokuDB is in a separate package called
##mariadb-tokudb-engine-x.x##, where ##x.x## is the MariaDB series (##5.5## or
##10.0##). The package is installed, for example on ##5.5##, as follows:

&lt;&lt;code lang=sh inline=false&gt;&gt;
sudo apt-get install mariadb-tokudb-engine-5.5
&lt;&lt;/code&gt;&gt;

== libjemalloc

TokuDB requires the libjemalloc library (currently version 3.3.0 or greater).

libjemalloc should automatically be installed when using a package manager, and is loaded by restarting MariaDB.

It can be enabled, if not already done, by adding the following to the my.cnf configuration file:
&lt;&lt;code&gt;&gt;
[mysqld_safe]

malloc-lib= /path/to/jemalloc
&lt;&lt;/code&gt;&gt;

If you don&#39;t do the above, you will get an error similar to the following one in your error file
&lt;&lt;code&gt;&gt;
2018-11-19 18:46:26 0 [ERROR] mysqld: Can&#39;t open shared library &#39;/home/my/maria-10.3/mysql-test/var/plugins/ha_tokudb.so&#39; (errno: 2, /usr/lib64/libjemalloc.so.2: cannot allocate memory in static TLS block)
&lt;&lt;/code&gt;&gt;

== Check for Transparent HugePage Support on Linux

&lt;&lt;style class=&#34;bluebox&#34;&gt;&gt;
Transparent hugepages is a feature in newer linux kernel versions that causes
problems for the memory usage tracking calculations in TokuKV and can lead to
memory overcommit. If you have this feature enabled, TokuKV will not start, and
you should turn it off.
&lt;&lt;/style&gt;&gt;

You can check the status of Transparent Hugepages as follows:

&lt;&lt;code lang=sh inline=false&gt;&gt;
cat /sys/kernel/mm/transparent_hugepage/enabled
&lt;&lt;/code&gt;&gt;

If the path does not exist, Transparent Hugepages are not enabled and you may continue. 

Alternatively, the following will be returned:

&lt;&lt;code&gt;&gt;
always madvise [never]
&lt;&lt;/code&gt;&gt;
indicating Transparent Hugepages are not enabled and you may continue. If the following is returned:
&lt;&lt;code&gt;&gt;
[always] madvise never
&lt;&lt;/code&gt;&gt;
Transparent Hugepages are enabled, and you will need to disable them.

To disable them, pass &#34;transparent_hugepage=never&#34; to the kernel in your bootloader (grub, lilo, etc.). For example, for SUSE, add ##transparent_hugepage=never## to Optional Kernel Command Line Parameter at the end, such as after &#34;showopts&#34;, and press OK. The setting will take effect on the next reboot. 

You can also disable with:
&lt;&lt;code lang=sh inline=false&gt;&gt;
echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled
echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag
&lt;&lt;/code&gt;&gt;

On Centos or RedHat you can do:

Add line &lt;&lt;code&gt;&gt;GRUB_CMDLINE_LINUX_DEFAULT=&#34;transparent_hugepage=never&#34;&lt;&lt;/code&gt;&gt; to file /etc/default/grub

Update grub (boot loader):
&lt;&lt;code lang=sh inline=false&gt;&gt;
grub2-mkconfig -o /boot/grub2/grub.cfg &#34;$@&#34;
&lt;&lt;/code&gt;&gt;

For more information, see [[http://unix.stackexchange.com/questions/99154/disable-transparent-hugepages]]

== Enabling TokuDB
Attempting to enable TokuDB while Linux Transparent HugePages are enabled will fail with an error such as:
&lt;&lt;code&gt;&gt;
ERROR 1123 (HY000): Can&#39;t initialize function &#39;TokuDB&#39;; Plugin initialization function failed
&lt;&lt;/code&gt;&gt;
See the section above; [[#check-for-transparent-hugepage-support-on-linux|Check for Transparent HugePage Support on Linux]].

The [[activating-the-binary-log|binary log also needs to be enabled]] before attempting to enable TokuDB. Strictly speaking, the XA code requires two XA-capable storage engines, and this is checked at startup. In practice, this requires InnoDB and the binary log to be active. If it isn&#39;t, the following warning will be returned and XA features will be disabled:
&lt;&lt;code&gt;&gt;
Cannot enable tc-log at run-time. XA features of TokuDB are disabled
&lt;&lt;/code&gt;&gt;

MariaDB&#39;s default &lt;&lt;fixed&gt;&gt;my.cnf&lt;&lt;/fixed&gt;&gt; files come with a section for
TokuDB. To enable TokuDB just remove the &#39;#&#39; comment markers from the options
in the TokuDB section.

A typical TokuDB section looks like the following:

&lt;&lt;code lang=sh inline=false&gt;&gt;
# See https://mariadb.com/kb/en/how-to-enable-tokudb-in-mariadb/
# for instructions how to enable TokuDB
#
# See https://mariadb.com/kb/en/tokudb-differences/ for differences
# between TokuDB in MariaDB and TokuDB from http://www.tokutek.com/

plugin-load=ha_tokudb
&lt;&lt;/code&gt;&gt;

By default, the ##plugin-load## option is commented out. Simply un-comment it
as in the example above.

Don&#39;t forget to also enable jemalloc in the config file.
&lt;&lt;code&gt;&gt;
[mysqld_safe]
malloc-lib= /path/to/jemalloc
&lt;&lt;/code&gt;&gt;

With these changes done, you can restart MariaDB to activate TokuDB.

=== Enabling TokuDB on Fedora

Instead of putting the TokuDB section in the main ##my.cnf## file, it is
placed in a separate file located at: ##/etc/my.cnf.d/tokudb.cnf##

=== Enabling TokuDB on Ubuntu &amp; Debian

Instead of putting the TokuDB section in the main ##my.cnf## file, it is
placed in a separate file located at: ##/etc/mysql/conf.d/tokudb.cnf##

=== Enabling TokuDB Manually From the mysql Command Line

Generally, it is recommended to use one of the above methods to enable the
TokuDB storage engine, but it is also possible to enable it manually as with
other plugins. To do so, launch the mysql command-line client and connect to
MariaDB as a user with the ##SUPER## privilege and execute the following
command:

&lt;&lt;code lang=mysql inline=false&gt;&gt;
INSTALL SONAME &#39;ha_tokudb&#39;;
&lt;&lt;/code&gt;&gt;

TokuDB will be installed until someone executes [[uninstall-soname|UNINSTALL SONAME]].

=== Temporarily Enabling TokuDB When Starting MariaDB

If you just want to test TokuDB, you can start the ##mysqld## server with TokuDB with the following command:

&lt;&lt;code&gt;&gt;
mysqld --plugin-load=ha_tokudb --plugin-dir=/usr/local/mysql/lib/mysql/plugin
&lt;&lt;/code&gt;&gt;

== See Also
* [[tokudb-differences|Differences between TokuDB from Tokutek.com and the TokuDB version in MariaDB from MariaDB.org]].
* [[tokudb-system-and-status-variables|TokuDB System and Status Variables]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/solutions" title="Solutions">Solutions</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">Company</a></h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        
                        
                        <li>
                            <h5><a href="https://mariadb.com/downloads" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>