<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Installing VM images for testing .deb upgrade between versions - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Installing VM images for testing .deb upgrade between versions" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="This step creates virtual machine images used to do an important additional
upgrade test for .debs. Each virtual machine is pre-installed with an older
version of MariaDB, and..." />

    <meta name="description" content="This step creates virtual machine images used to do an important additional
upgrade test for .debs. Each virtual machine is pre-installed with an older
version of MariaDB, and..." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/training-tutorials/">Training &amp; Tutorials</a>
    

    
    » <a class="crumb" href="/kb/en/advanced-mariadb-articles/">Advanced MariaDB Articles</a>
    

    
    » <a class="crumb" href="/kb/en/development-articles/">Development Articles</a>
    

    
    » <a class="crumb" href="/kb/en/tools/">MariaDB Development Tools</a>
    

    
    » <a class="crumb" href="/kb/en/buildbot/">Buildbot</a>
    

    
    » <a class="crumb" href="/kb/en/buildbot-setup/">Buildbot Setup</a>
    

    
    » <a class="crumb" href="/kb/en/buildbot-setup-for-virtual-machines/">Buildbot Setup for Virtual Machines</a>
    

    
    » <a class="crumb" href="/kb/en/buildbot-setup-for-virtual-machines-additional-steps/">Buildbot Setup for Virtual Machines - Additional Steps</a>
    


    » <a class="node_link crumb" href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/">Installing VM images for testing .deb upgrade between versions</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+history" rel="nofollow">History</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+flag"
                data-flag-url="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2011-07-01 18:35">13 years, 4 months ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2011-10-27 15:29">13 years ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    
        

<div class="well well-small box"><div><h5>Localized Versions</h5></div><div>

        <ul>
            
            <li><a href="/kb/it/installing-vm-images-for-testing-deb-upgrade-between-versions/">Installare le immagini delle VM per testare l&#39;aggiornamento dei .deb</a> [it]</li>
            
        </ul>
        
</div>
</div>

    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Installing VM images for testing .deb upgrade between versions</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <p>This step creates virtual machine images used to do an important additional
upgrade test for .debs. Each virtual machine is pre-installed with an older
version of MariaDB, and the test tries upgrading this version to the newly
build one (to check that dependencies etc. work out correctly).</p>
<p>This step may not be easily possible to replicate exactly for new or updated
images. For example, when we add a new platform/distro, we will not have the
same old version of MariaDB available for installation on the new planform. Or
if needing to re-create an image in the future, the original old .debs used
before may no longer be available. However, this is not a big problem, as we
can just use whatever version of MariaDB is available. In fact, while we
cannot reasonably test every possible upgrade combination between MariaDB
versions, it is still useful to test upgrades from different versions on
different platforms, to increase coverage a bit.</p>
<p>The bulk of the images were installed with the following two loops, using
packages from the OurDelta repository for <a href="/kb/en/mariadb-5142-release-notes/">MariaDB 5.1.42</a>, which was the one
available from there at the time of installation.</p>
<pre class="fixed"><span class="k">for</span> i in <span class="s2">&quot;vm-hardy-amd64-install qemu64 hardy&quot;</span> <span class="s2">&quot;vm-hardy-i386-install qemu32,-nx hardy&quot;</span> <span class="se">\</span>
          <span class="s2">&quot;vm-intrepid-amd64-install qemu64 intrepid&quot;</span> <span class="s2">&quot;vm-intrepid-i386-install qemu32,-nx intrepid&quot;</span> <span class="se">\</span>
          <span class="s2">&quot;vm-karmic-amd64-install qemu64 karmic&quot;</span> <span class="s2">&quot;vm-karmic-i386-install qemu32,-nx karmic&quot;</span> <span class="se">\</span>
          <span class="s2">&quot;vm-jaunty-amd64-install qemu64 jaunty&quot;</span> <span class="s2">&quot;vm-jaunty-i386-deb-install qemu32,-nx jaunty&quot;</span> <span class="se">\</span>
          <span class="s2">&quot;vm-debian5-amd64-install qemu64 lenny&quot;</span> <span class="s2">&quot;vm-debian5-i386-install qemu32,-nx lenny&quot;</span> <span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
  <span class="nb">set</span> <span class="nv">$i</span><span class="p">;</span> <span class="se">\</span>
  runvm -b  <span class="nv">$1</span>.qcow2 -m <span class="m">512</span> --smp<span class="o">=</span><span class="m">1</span> --port<span class="o">=</span><span class="m">2200</span> --user<span class="o">=</span>buildbot --cpu<span class="o">=</span><span class="nv">$2</span> <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/-install/-upgrade2/&#39;</span><span class="k">)</span>.qcow2 <span class="se">\</span>
    <span class="s2">&quot;wget -O- http://ourdelta.org/deb/ourdelta.gpg | sudo apt-key add -&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo sh -c \&quot;echo &#39;deb http://mirror.ourdelta.org/deb </span><span class="nv">$3</span><span class="s2"> mariadb-ourdelta&#39; &gt; /etc/apt/sources.list.d/ourdelta.list\&quot;&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo apt-get update || true&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get install -y mariadb-server mariadb-test libmariadbclient-dev || true&quot;</span> <span class="se">\</span>
    <span class="s1">&#39;mysql -uroot -prootpass -e &quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;&#39;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo rm /etc/apt/sources.list.d/ourdelta.list&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo apt-get update || true&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo DEBIAN_FRONTEND=noninteractive apt-get upgrade -y || true&quot;</span> <span class="p">;</span> <span class="se">\</span>
<span class="k">done</span>
</pre><pre class="fixed"><span class="k">for</span> i in <span class="s2">&quot;vm-debian4-amd64-install qemu64 etch /kvm/debian-40r8-amd64-netinst.iso&quot;</span> <span class="s2">&quot;vm-debian4-i386-install qemu32,-nx etch /kvm/debian-40r8-i386-netinst.iso&quot;</span> <span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
  <span class="nb">set</span> <span class="nv">$i</span><span class="p">;</span> <span class="se">\</span>
  runvm -b  <span class="nv">$1</span>.qcow2 -m <span class="m">512</span> --smp<span class="o">=</span><span class="m">1</span> --port<span class="o">=</span><span class="m">2200</span> --user<span class="o">=</span>buildbot --cpu<span class="o">=</span><span class="nv">$2</span> --netdev<span class="o">=</span>e1000 --kvm<span class="o">=</span>-cdrom --kvm<span class="o">=</span><span class="nv">$4</span> <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/-install/-upgrade2/&#39;</span><span class="k">)</span>.qcow2 <span class="se">\</span>
    <span class="s2">&quot;wget -O- http://ourdelta.org/deb/ourdelta.gpg | sudo apt-key add -&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo sh -c \&quot;echo &#39;deb http://mirror.ourdelta.org/deb </span><span class="nv">$3</span><span class="s2"> mariadb-ourdelta&#39; &gt; /etc/apt/sources.list.d/ourdelta.list\&quot;&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo apt-get update || true&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo sh -c &#39;DEBIAN_FRONTEND=noninteractive apt-get install -y mariadb-server mariadb-test libmariadbclient-dev&#39; || true&quot;</span> <span class="se">\</span>
    <span class="s1">&#39;mysql -uroot -prootpass -e &quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;&#39;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo rm /etc/apt/sources.list.d/ourdelta.list&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo apt-get update || true&quot;</span> <span class="se">\</span>
    <span class="s2">&quot;sudo sh -c &#39;DEBIAN_FRONTEND=noninteractive apt-get upgrade -y&#39; || true&quot;</span> <span class="p">;</span> <span class="se">\</span>
<span class="k">done</span>
</pre><p>The Ubuntu 10.04 "lucid" images were installed manually (as no packages for
lucid were available from OurDelta at the time of installation):</p>
<p>Create and boot 64-bit lucid upgrade image:</p>
<pre class="fixed">qemu-img create -b vm-lucid-amd64-install.qcow2 -f qcow2 vm-lucid-amd64-upgrade2.qcow2 
kvm -m <span class="m">512</span> -hda vm-lucid-amd64-upgrade2.qcow2 -redir <span class="s1">&#39;tcp:2200::22&#39;</span> -boot c -smp <span class="m">1</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user -nographic 
</pre><p>Create directory inside the image:</p>
<pre class="fixed">mkdir buildbot
</pre><p>Copy in packages to be installed from outside:</p>
<pre class="fixed">scp -P <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no -r /archive/pack/mariadb-5.1-knielsen/build-277/kvm-deb-lucid-amd64/debs buildbot@localhost:buildbot/
</pre><p>Install the MariaDB packages, remove package dir, and upgrade to latest
security fixes:</p>
<pre class="fixed">sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get install -y --allow-unauthenticated mariadb-server mariadb-test libmariadbclient-dev
mysql -uroot -prootpass -e <span class="s2">&quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;</span>
rm -Rf buildbot
sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get upgrade -y
</pre><p>Now the same, but for 32-bit lucid:</p>
<pre class="fixed">qemu-img create -b vm-lucid-i386-install.qcow2 -f qcow2 vm-lucid-i386-upgrade2.qcow2 
kvm -m <span class="m">512</span> -hda vm-lucid-i386-upgrade2.qcow2 -redir <span class="s1">&#39;tcp:2200::22&#39;</span> -boot c -smp <span class="m">1</span> -cpu qemu32,-nx -net nic,model<span class="o">=</span>virtio -net user -nographic
</pre><p>Create directory inside the image:</p>
<pre class="fixed">mkdir buildbot
</pre><p>Copy in packages to be installed from outside:</p>
<pre class="fixed">scp -P <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no -r /archive/pack/mariadb-5.1-knielsen/build-277/kvm-deb-lucid-x86/debs buildbot@localhost:buildbot/
</pre><p>Install the MariaDB packages, remove package dir, and upgrade to latest
security fixes:</p>
<pre class="fixed">sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get install -y --allow-unauthenticated mariadb-server mariadb-test libmariadbclient-dev
mysql -uroot -prootpass -e <span class="s2">&quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;</span>
rm -Rf buildbot
sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get upgrade -y
</pre><p>The Ubuntu 10.10 "maverick" images were likewise  installed manually:</p>
<p>Create and boot 64-bit maverick upgrade image:</p>
<pre class="fixed">qemu-img create -b vm-maverick-amd64-install.qcow2 -f qcow2 vm-maverick-amd64-upgrade2.qcow2
kvm -m <span class="m">512</span> -hda vm-maverick-amd64-upgrade2.qcow2 -redir <span class="s1">&#39;tcp:2200::22&#39;</span> -boot c -smp <span class="m">1</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user -nographic

ssh -p <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no buildbot@localhost mkdir buildbot
scp -P <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no -r /archive/pack/mariadb-5.1-knielsen/build-619/kvm-deb-maverick-amd64/debs buildbot@localhost:buildbot/
ssh -p <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no buildbot@localhost

sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get install -y --allow-unauthenticated mariadb-server mariadb-test libmariadbclient-dev
mysql -uroot -prootpass -e <span class="s2">&quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;</span>
rm -Rf buildbot
sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get upgrade -y
</pre><p>Same for 32-bit maverick:</p>
<pre class="fixed">qemu-img create -b vm-maverick-i386-install.qcow2 -f qcow2 vm-maverick-i386-upgrade2.qcow2
kvm -m <span class="m">512</span> -hda vm-maverick-i386-upgrade2.qcow2 -redir <span class="s1">&#39;tcp:2200::22&#39;</span> -boot c -smp <span class="m">1</span> -cpu qemu32,-nx -net nic,model<span class="o">=</span>virtio -net user -nographic

ssh -p <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no buildbot@localhost mkdir buildbot
scp -P <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no -r /archive/pack/mariadb-5.1-knielsen/build-619/kvm-deb-maverick-x86/debs buildbot@localhost:buildbot/
ssh -p <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no buildbot@localhost

sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get install -y --allow-unauthenticated mariadb-server mariadb-test libmariadbclient-dev
mysql -uroot -prootpass -e <span class="s2">&quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;</span>
rm -Rf buildbot
sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get upgrade -y
</pre><p>For Ubuntu 11.04 "natty", mariadb packages were installed from the repository
for the previous version.</p>
<p>64-bit Ubuntu natty:</p>
<pre class="fixed">qemu-img create -b vm-natty-amd64-install.qcow2 -f qcow2 vm-natty-amd64-upgrade2.qcow2
kvm -m <span class="m">512</span> -hda vm-natty-amd64-upgrade2.qcow2 -redir <span class="s1">&#39;tcp:2200::22&#39;</span> -boot c -smp <span class="m">1</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user -nographic
ssh -p <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no buildbot@localhost

sudo sh -c <span class="s1">&#39;cat &gt; /etc/apt/sources.list.d/tmp.list&#39;</span>
deb http://ftp.osuosl.org/pub/mariadb/repo/5.1/ubuntu maverick main
deb-src http://ftp.osuosl.org/pub/mariadb/repo/5.1/ubuntu maverick main

sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get install -y --allow-unauthenticated mariadb-server mariadb-test libmariadbclient-dev
mysql -uroot -prootpass -e <span class="s2">&quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;</span>
sudo rm /etc/apt/sources.list.d/tmp.list
sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get upgrade -y
</pre><p>32-bit Ubuntu natty:</p>
<pre class="fixed">qemu-img create -b vm-natty-i386-install.qcow2 -f qcow2 vm-natty-i386-upgrade2.qcow2
kvm -m <span class="m">512</span> -hda vm-natty-i386-upgrade2.qcow2 -redir <span class="s1">&#39;tcp:2200::22&#39;</span> -boot c -smp <span class="m">1</span> -cpu qemu64 -net nic,model<span class="o">=</span>virtio -net user -nographic
ssh -p <span class="m">2200</span> -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no buildbot@localhost

sudo sh -c <span class="s1">&#39;cat &gt; /etc/apt/sources.list.d/tmp.list&#39;</span>
deb http://ftp.osuosl.org/pub/mariadb/repo/5.1/ubuntu maverick main
deb-src http://ftp.osuosl.org/pub/mariadb/repo/5.1/ubuntu maverick main

sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get install -y --allow-unauthenticated mariadb-server mariadb-test libmariadbclient-dev
mysql -uroot -prootpass -e <span class="s2">&quot;create database mytest; use mytest; create table t(a int primary key); insert into t values (1); select * from t&quot;</span>
sudo rm /etc/apt/sources.list.d/tmp.list
sudo apt-get update
sudo <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get upgrade -y
</pre><p>For Ubuntu 11.10 "oneiric". The steps performed are listed at: <a href="/kb/en/buildbot-setup-for-virtual-machines-ubuntu-1110-oneiric/">Buildbot Setup for Virtual Machines - Ubuntu 11.10 "oneiric"</a> (in the VMs for Upgrade Testing section)</p>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+subscriptions/add"
                 data-unsubscribe-url="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/en/installing-the-boost-library-needed-for-the-oqgraph-storage-engine/">
                        ← Installing the Boost library needed for the OQGraph storage engine
                    </a>
                    </li>
                
                
                    <li><a href="/kb/en/buildbot-setup-for-virtual-machines-additional-steps/">
                        ↑ Buildbot Setup for Virtual Machines - Additional Steps ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/en/install-cassandra-on-fulltest-vms/">
                        Install Cassandra on Fulltest VMs →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="1690" data-comments-url="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/+comments"
         data-reply-url="/kb/en/installing-vm-images-for-testing-deb-upgrade-between-versions/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/en/buildbot-setup-for-virtual-machines-additional-steps/">
                    ↑ Buildbot Setup for Virtual Machines - Additional Steps ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/en/installing-the-boost-library-needed-for-the-oqgraph-storage-engine/">
                            
                            Installing the Boost library needed for the OQGraph storage engine
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>Installing VM images for testing .deb upgrade between versions</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/install-cassandra-on-fulltest-vms/">
                            
                            Install Cassandra on Fulltest VMs
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/install-cmake-on-build-vms/">
                            
                            Install cmake on build VMs
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/installing-correct-libraries-for-pam-and-readline/">
                            
                            Installing correct libraries for PAM and readline
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/resizing-a-virtual-machine-image/">
                            
                            Resizing a Virtual Machine Image
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/en/update-debian-4-mirrors-for-buildbot-vms/">
                            
                            Update Debian 4 mirrors for Buildbot VMs
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>