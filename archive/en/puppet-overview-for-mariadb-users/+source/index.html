<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Puppet Overview for MariaDB Users - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.b9e1e104f007.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Puppet Overview for MariaDB Users - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/puppet-overview-for-mariadb-users/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/puppet-overview-for-mariadb-users/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2024 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/en/puppet-overview-for-mariadb-users/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/en/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/en/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/en/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/en/documentation/">MariaDB Server Documentation</a>
    

    
    » <a class="crumb" href="/kb/en/mariadb-administration/">MariaDB Administration</a>
    

    
    » <a class="crumb" href="/kb/en/getting-installing-and-upgrading-mariadb/">Getting, Installing, and Upgrading MariaDB</a>
    

    
    » <a class="crumb" href="/kb/en/binary-packages/">MariaDB Binary Packages</a>
    

    
    » <a class="crumb" href="/kb/en/automated-mariadb-deployment-and-administration/">Automated MariaDB Deployment and Administration</a>
    

    
    » <a class="crumb" href="/kb/en/automated-mariadb-deployment-and-administration-puppet-and-mariadb/">Puppet and MariaDB</a>
    


    » <a class="node_link crumb" href="/kb/en/puppet-overview-for-mariadb-users/">Puppet Overview for MariaDB Users</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                
                                    <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/en/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/en/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/en/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/en/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/en/puppet-overview-for-mariadb-users/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>Puppet Overview for MariaDB Users - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/en/puppet-overview-for-mariadb-users/+r/110894/">110894</a></dd>
            <dt>User</dt>
            <dd>
<span class="user" id="user-125">
<a href="/kb/user/id/125" title="Federico Razzoli">Federico Razzoli</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2021-10-19 23:56">2021-10-19 23:56</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">Puppet is a tool to automate servers configuration management. It is produced by Puppet Inc, and released under the terms of the Apache License, version 2.

It is entirely possible to use Ansible to automate MariaDB deployments and configuration. This page contains generic information for MariaDB users who want to learn, or evaluate, Puppet.

Puppet modules can be searched using [[https://forge.puppet.com/|Puppet Forge]]. Most of them are also published on GitHub with open source licenses. Puppet Forge allows filtering modules to only view the most reliable: supported by Puppet, supported by a Puppet partner, or approved.

For information about installing Puppet, see [[https://puppet.com/docs/puppet/7.3/architecture.html|Installing and upgrading]] in Puppet documentation.

&lt;&lt;toc&gt;&gt;

== Design Principles

With Puppet, you write **manifests** that describe the resources you need to run on certain servers and their **attributes**.

Therefore manifests are **declarative**. You don&#39;t write the steps to achieve the desired result. Instead, you describe the desired result. When Puppet detects differences between your description and the current state of a server, it decides what to do to fix those differences.

Manifests are also **idempotent**. You don&#39;t need to worry about the effects of applying a manifest twice. This may happen (see Architecture below) but it won&#39;t have any side effects.


=== Defining Resources

Here&#39;s an example of how to describe a resource in a manifest:

&lt;&lt;code&gt;&gt;
file { &#39;/etc/motd&#39;:
  content =&gt; &#39;&#39;,
  ensure =&gt; present,
}
&lt;&lt;/code&gt;&gt;

This block describes a resource. The resource type is ##file##, while the resource itself is ##/etc/motd##. The description consists of a set of attributes. The most important is ##ensure##, which in this case states that the file must exist. It is also common to use this resource to indicate that a file (probably created by a previous version of the manifest) doesn&#39;t exist.

These classes of resource types exist:
* **Built-in resources**, or **Puppet core resources**: Resources that are part of Puppet, maintained by the Puppet team.
* **Defined resources**: Resources that are defined as a combination of other resources. They are written in the Puppet domain-specific language.
* **Custom resources**:  Resources that are written by users, in the Ruby language.

To obtain information about resources:
&lt;&lt;code&gt;&gt;
# list existing resource types
puppet resource --types
# print information about the file resource type
puppet describe file
&lt;&lt;/code&gt;&gt;

To group several resources in a reusable class:

&lt;&lt;code&gt;&gt;
class ssh_server {
  file { &#39;/etc/motd&#39;:
    content =&gt; &#39;&#39;,
    ensure =&gt; present,
  }
  file { &#39;/etc/issue.net&#39;:
    content =&gt; &#39;&#39;,
    ensure =&gt; present,
  }
}
&lt;&lt;/code&gt;&gt;

There are several ways to include a class. For example:

&lt;&lt;code&gt;&gt;
include Class[&#39;ssh_server&#39;]
&lt;&lt;/code&gt;&gt;


=== Defining Nodes

Puppet has a **main manifest** that could be a ##site.pp## file or a directory containing ##.pp## files. For simple infrastructures, we can define the nodes here. For more complex infrastructures, we may prefer to import other files that define the nodes.

Nodes are defined in this way:

&lt;&lt;code&gt;&gt;
node &#39;maria-1.example.com&#39; {
  include common
  include mariadb
}
&lt;&lt;/code&gt;&gt;

The resource type is ##node##. Then we specify a hostname that is used to match this node to an existing host. This can also be a list of hostnames, a regular expression that matches multiple nodes, or the ##default## keyword that matches all hosts. To use a regular expression:

&lt;&lt;code&gt;&gt;
node /^(maria|mysql)-[1-3]\.example\.com$/ {
  include common
}
&lt;&lt;/code&gt;&gt;


== Concepts

The most important Puppet concepts are the following:
* **Target**: A host whose configuration is managed via Puppet.
* **Group**: A logical group of targets. For example there may be a ##mariadb## group, and several targets may be part of this group.
* **Facts**: Information collected from the targets, like the system name or system version. They&#39;re collected by a Ruby gem called [[https://puppet.com/docs/puppet/latest/facter.html|Facter]]. They can be [[https://puppet.com/docs/puppet/latest/core_facts.html|core facts]] (collected by default) or [[https://puppet.com/docs/puppet/latest/custom_facts.html|custom facts]] (defined by the user).
* **Manifest**: A description that can be applied to a target.
* **Catalog**: A compiled manifest.
* **Apply**: Modifying the state of a target so that it reflects its description in a manifest.
* **Module**: A set of manifests.
* **Resource**: A minimal piece of description. A manifest consists of a piece of resources, which describe components of a system, like a file or a service.
* **Resource type**: Determines the class of a resource. For example there is a ##file## resource type, and a manifest can contain any number of resources of this type, which describe different files.
* **Attribute**: It&#39;s a characteristic of a resource, like a file owner, or its mode.
* **Class**: A group of resources that can be reused in several manifests.
 

== Architecture

Depending on how the user decides to deploy changes, Puppet can use two different architectures:
* An **Agent-master** architecture. This is the preferred way to use Puppet.
* A **standalone architecture**, that is similar to [[ansible-overview-for-mariadb-users/#architecture|Ansible architecture]].

=== Agent-master Architecture

A **Puppet master** stores a catalog for each target. There may be more than one Puppet master, for redundancy.

Each target runs a **Puppet agent** in background. Each Puppet agent periodically connects to the Puppet master, sending its facts. The Puppet master compiles the relevant manifest using the facts it receives, and send back a catalog. Note that it is also possible to store the catalogs in PuppetDB instead.

Once the Puppet agent receives the up-to-date catalog, it checks all resources and compares them with its current state. It applies the necessary changes to make sure that its state reflects the resources present in the catalog.


=== Standalone Architecture

With this architecture, the targets run **Puppet apply**. This application usually runs as a Linux cron job or a Windows scheduled task, but it can also be manually invoked by the user.

When Puppet apply runs, it compiles the latest versions of manifests using the local facts. Then it checks every resource from the resulting catalogs and compares it to the state of the local system, applying changes where needed.

Newly created or modified manifests are normally deployed to the targets, so Puppet apply can read them from the local host. However it is possible to use PuppetDB instead.


=== PuppetDB

PuppetDB is a Puppet node that runs a PostgreSQL database to store information that can be used by other nodes. PuppetDB can be used with both the Agent-master and the standalone architectures, but it is always optional. However it is necessary to use some advanced Puppet features.

PuppetDB stored the following information:
* The latest facts from each target.
* The latest catalogs, compiled by Puppet apply or a Puppet master.
* Optionally, the recent history of each node activities.


=== External Node Classifiers

With both architectures, it is possible to have a component called an External Node Classifier (ENC). This is a script or an executable written in any language that Puppet can call to determine the list of classes that should be applied to a certain target.

An ENC received a node name in input, and should return a list of classes, parameters, etc, as a YAML hash.


=== Bolt

Bolt can be used in both architectures to run operations against a target or a set of targets. These operations can be commands passed manually to Bolt, scripts, Puppet tasks or plans. Bolt directly connects to targets via ssh and runs system commands.

See [[bolt-examples|Bolt Examples]] to get an idea of what you can do with Bolt.


== hiera

hiera is a hierarchical configuration system that allows us to:
* Store configuration in separate files;
* Include the relevant configuration files for every server we automate with Puppet.

See [[puppet-hiera-configuration-system|Puppet hiera Configuration System]] for more information.

== Puppet Resources

* [[https://puppet.com/docs/|Puppet documentation]].
* [[https://forge.puppet.com/|forge.puppet.com]].
* [[https://github.com/puppetlabs/puppet|Puppet on GitHub]].
* [[https://en.wikipedia.org/wiki/Puppet_(company)|Puppet on Wikipedia]].

More information about the topics discussed in this page can be found in the Ansible documentation:

* [[https://puppet.com/docs/puppet/latest/glossary.html|Puppet Glossary]] in Puppet documentation.
* [[https://puppet.com/docs/puppet/latest/architecture.html|Overview of Puppet&#39;s architecture]] in Puppet documentation.
* [[https://puppet.com/docs/puppetdb/latest/index.html|PuppetDB documentation]].
* [[https://puppet.com/docs/puppet/latest/nodes_external.html|Classifying nodes]] in Puppet documentation.
* [[https://puppet.com/docs/puppet/latest/hiera_intro.html|Hiera]] in Puppet documentation.
* [[https://puppet.com/docs/bolt/latest/bolt.html|Bolt documentation]].


---- 
Content initially contributed by [[https://vettabase.com/|Vettabase Ltd]].</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2024 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>