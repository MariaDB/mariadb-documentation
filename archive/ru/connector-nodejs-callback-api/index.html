<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>Connector/Node.js Callback API - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.9a0d7dcebefd.css" rel="stylesheet" type="text/css" />

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Connector/Node.js Callback API" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/ru/connector-nodejs-callback-api/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Документация
Существует две различные реализации соединения: одна, по умолчанию, использует Promise, а другая - Callback, что обеспечивает совместимость с API mysql и mysql2. ..." />

    <meta name="description" content="Документация
Существует две различные реализации соединения: одна, по умолчанию, использует Promise, а другая - Callback, что обеспечивает совместимость с API mysql и mysql2. ..." />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes products nodes_view jqui" id="nodes_view">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/ru/connector-nodejs-callback-api/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2023 MariaDB. All rights reserved.</p>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/ru/connector-nodejs-callback-api/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/ru/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/ru/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/ru/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/ru/mariadb/">MariaDB - Russian</a>
    


    » <a class="node_link crumb" href="/kb/ru/connector-nodejs-callback-api/">Connector/Node.js Callback API</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/ru/">Начало</a></li>
                            
                                
                                    <li><a href="/kb/ru/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/ru/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/ru/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/ru/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/ru/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-blue btn-sm" href="/kb/ru/connector-nodejs-callback-api/+history" rel="nofollow">История</a>
        
        
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/ru/connector-nodejs-callback-api/+source/">Source</a>
        
        <a class="btn btn-block btn-blue btn-sm flag" href="/kb/ru/connector-nodejs-callback-api/+flag"
                data-flag-url="/kb/ru/connector-nodejs-callback-api/+flag" rel="nofollow">
                Flag as Spam / Inappropriate</a>
        
        <a class="btn btn-block btn-blue btn-sm" href="/kb/ru/connector-nodejs-callback-api/+translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Создан</dt>
        <dd>

<span class="datetime" title="2022-03-03 15:50">1 год, 3 месяца ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2022-03-03 15:59">1 год, 3 месяца ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        <dt>License</dt>
        <dd>
            
                <a href="/kb/ru/connector-nodejs-callback-api/+license/">CC BY-SA / Gnu FDL</a>
            
        </dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/ru/connector-nodejs-callback-api/+history/feed/">
            История</a>
        </li>
        <li><a href="/kb/ru/connector-nodejs-callback-api/+comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>





    
    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/ru/connector-nodejs-callback-api/+edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>

    



    
    
        

<div class="well well-small box"><div><h5>Localized Versions</h5></div><div>

        <ul>
            
            <li><a href="/kb/en/connectornode-js-callback-api/">Connector/Node.js Callback API</a> [en]</li>
            
        </ul>
        
</div>
</div>

    






</div>


                    

































                </aside>
            
            
            
                
            
            
                
            
            <section id="content" class="limited_width col-md-8 clearfix">
                
                    <h1>Connector/Node.js Callback API</h1>
                

                



                <div>
                    
    

    
    
    

    <div class="node creole">
        
        
        


    
    <div class="answer formatted">
        <h1 class="anchored_heading" id="документация">Документация</h1>
<p>Существует две различные реализации соединения: одна, по умолчанию, использует Promise, а другая - Callback, что обеспечивает совместимость с API mysql и mysql2.  В документации, представленной на этой странице, используется Callback.  Если вам нужна информация об API Promise, смотрите   <a href="/kb/en/connector-nodejs-promise-api/">documentation</a>. </p>
<h2 class="anchored_heading" id="быстрый-старт">Быстрый старт</h2>
<p>Установите mariadb Connector используя npm</p>
<pre class="fixed">$ npm install mariadb
</pre><p>Затем вы можете использовать коннектор в коде вашего приложения с помощью Callback API. Например,</p>
<pre class="fixed">  <span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">conn</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">({</span><span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span><span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;myPwd&#39;</span><span class="p">});</span>
  <span class="nx">conn</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT 1 as val&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">rows</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rows</span><span class="p">);</span> <span class="c1">//[ {val: 1}, meta: ... ]</span>
      <span class="nx">conn</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO myTable value (?, ?)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;mariadb&quot;</span><span class="p">],</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span> <span class="c1">// { affectedRows: 1, insertId: 1, warningStatus: 0 }</span>
        <span class="nx">conn</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
      <span class="p">});</span>
  <span class="p">});</span>
</pre><h2 class="anchored_heading" id="установка">Установка</h2>
<p>Чтобы использовать коннектор, сначала необходимо установить его в вашей системе. Процесс установки для Promise и Callback API управляется одним и тем же пакетом через npm. </p>
<pre class="fixed">$ npm install mariadb
</pre><p>Чтобы использовать коннектор, необходимо импортировать пакет в код вашего приложения.  Учитывая, что Callback API не используется по умолчанию, оператор `require()` немного отличается.</p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
</pre><p>Это инициализирует константу `mariadb`, которая настроена на использование Callback API, а не Promise API по умолчанию.</p>
<h2 class="anchored_heading" id="часовой-пояс">Часовой пояс</h2>
<p>Это не рекомендуется, но в некоторых случаях Node.js и база данных настроены на разный часовой пояс. </p>
<p>По умолчанию опция `timezone` установлена в значение 'local', что указывает на использование часового пояса клиента, поэтому преобразование не будет производиться.</p>
<p>Если часовой пояс клиента и сервера отличается, опция `timezone` должна быть установлена на часовой пояс сервера.
- Значение 'auto' означает, что клиент будет запрашивать часовой пояс сервера при создании соединения, а в дальнейшем будет использовать часовой пояс сервера. 
- Чтобы избежать этой дополнительной команды при подключении, `timezone` может быть установлен в значение <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">IANA time zone</a>. </p>
<p>Коннектор будет преобразовывать дату в часовой пояс сервера, а не в текущий часовой пояс Node.js. </p>
<h1 class="anchored_heading" id="callback-api">Callback API</h1>
<p>Коннектор с Callback API похож на коннектор с использованием Promise, но с некоторыми отличиями.</p>
<p><strong>Base:</strong></p>
<ul start="1"><li><a href="#createconnectionoptions-connection">createConnection(options) → Connection</a>: Создает соединение с сервером MariaDB.
</li><li><a href="#createpooloptions-pool">createPool(options) → Pool</a> : Создает новый пул.
</li><li><a href="#createpoolclusteroptions-poolcluster">createPoolCluster(options) → PoolCluster</a> : Создает новый кластер пула.
</li></ul>
<p><strong>Connect:</strong></p>
<ul start="1"><li><a href="#connectionquerysql-values-callback-emitter">connection.query(sql[, values][, callback]) → Emitter</a>: Выполняет запрос.
</li><li><a href="#connectionbatchsql-values-callback">connection.batch(sql, values[, callback])</a>: быстрая пакетная обработка.
</li><li><a href="#connectionbegintransactioncallback">connection.beginTransaction([callback])</a>: Начинает транзакцию.
</li><li><a href="#connectioncommitcallback">connection.commit([callback])</a>: Зафиксировать текущую транзакцию, если таковая имеется.
</li><li><a href="#connectionrollbackcallback">connection.rollback([callback])</a>: Откатывает текущую транзакцию, если таковая имеется.
</li><li><a href="#connectionchangeuseroptions-callback">connection.changeUser(options[, callback])</a>: Изменяет текущего пользователя соединения.
</li><li><a href="#connectionpingcallback">connection.ping([callback])</a>: Отправляет пустой пакет на сервер, чтобы проверить, что соединение активно.
</li><li><a href="#connectionendcallback">connection.end([callback])</a>: Закрывает соединение.
</li><li><a href="#connectionreset">connection.reset([callback])</a>: сброс текущего состояния соединения.
</li><li><a href="#connectionisvalid-boolean">connection.isValid() → boolean</a>: Проверяет, активно ли соединение без проверки состояния сокета.
</li><li><a href="#connectiondestroy">connection.destroy()</a>: Принудительное закрытие соединения. 
</li><li><a href="#connectionpause">connection.pause()</a>: Приостанавливает вывод сокета.
</li><li><a href="#connectionresume">connection.resume()</a>: Возобновляет вывод сокета.
</li><li><a href="#connectionserverversion">connection.serverVersion()</a>: Получает текущую версию сервера.
</li><li><a href="#events">events</a>: Подписка на события об ошибках соединения.
</li></ul>
<p><strong>Pool:</strong></p>
<ul start="1"><li><a href="#poolgetconnectioncallback">pool.getConnection([callback])</a> : Создает новое соединение.
</li><li><a href="#poolquerysql-values-callback">pool.query(sql[, values][, callback])</a>: Выполняет запрос.
</li><li><a href="#poolbatchsql-values-callback">pool.batch(sql, values[, callback])</a>: Выполняет пакет.
</li><li><a href="#poolendcallback">pool.end([callback])</a>: Благородно закрывает соединение.
</li><li>pool.activeConnections() → Number: Получает номер текущего активного соединения.
</li><li>pool.totalConnections() → Number: Получает текущее общее количество соединений.
</li><li>pool.idleConnections() → Number: Получает текущее количество неиспользуемых соединений.
</li><li>pool.taskQueueSize() → Number: Получает текущий стекированный запрос.
</li><li><a href="#pool-events-1">pool events</a>: Подписка на события пула.
</li></ul>
<p><strong>PoolCluster:</strong></p>
<ul start="1"><li><a href="#poolclusteraddid-config">poolCluster.add(id, config)</a> : добавить пул в кластер.
</li><li><a href="#poolclusterremovepattern">poolCluster.remove(pattern)</a> : удаление и завершение пула в соответствии с шаблоном.
</li><li><a href="#poolclusterendcallback">poolCluster.end([callback])</a> : завершить кластер.
</li><li><a href="#poolclustergetconnectionpattern-selector-callback">poolCluster.getConnection([pattern, ][selector, ]callback)</a> : возвращает соединение из кластера.
</li><li><a href="#poolcluster-events">poolCluster events</a>: подписывается на события кластера пула.
</li><li><a href="#poolclusterofpattern-selector-filteredpoolcluster">poolCluster.of(pattern, selector) → FilteredPoolCluster</a> : возвращает подмножество кластера.
</li></ul>
<h1 class="anchored_heading" id="base-api">Base API</h1>
<h2 class="anchored_heading" id="createconnectionoptions-connection">createConnection(options) → Connection</h2>
<div class="cstm-style bluebox"><ul start="1"><li>`options`: *JSON/String* Использует те же опции, что и Promise API. Для получения полного списка см. <a href="/documentation/connection-options.md">option documentation</a>.
</li></ul>
<p> Возвращает объект Connection.</p>
</div><p>Создает новое соединение.</p>
<p>Разница между этим методом и аналогичным методом с Promise API заключается в том, что этот метод возвращает объект `Connection`, а не Promise, который разрешается в объект `Connection`.</p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">conn</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">({</span>
      <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb.com&#39;</span><span class="p">,</span> 
      <span class="nx">user</span><span class="o">:</span><span class="s1">&#39;myUser&#39;</span><span class="p">,</span>
      <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;myPwd&#39;</span>
    <span class="p">});</span>
<span class="nx">conn</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;не удалось подключиться из-за ошибки: &quot;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;подключено ! идентификатор соединения равен &quot;</span> <span class="o">+</span> <span class="nx">conn</span><span class="p">.</span><span class="nx">threadId</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre><h3 class="anchored_heading" id="connection-options">Connection options</h3>
<p>Список основных опций:</p>
<div class="cstm-style newspaper-side table-head-align-top"><table><tr><th><strong>user</strong></th><td>Пользователь для доступа к базе данных.</td><td>*string*</td><td></td></tr>
<tr><th><strong>user</strong></th><td>Пользователь для доступа к базе данных.</td><td>*string*</td><td></td></tr>
<tr><th><strong>password</strong></th><td>Пароль пользователя.</td><td>*string*</td><td></td></tr>
<tr><th><strong>host</strong></th><td>IP-адрес или DNS сервера базы данных. *Не используется при использовании опции `socketPath`*.</td><td>*string*</td><td>"localhost"</td><td>.</td></tr>
<tr><th><strong>port</strong></th><td>Номер порта сервера базы данных. *Не используется при использовании опции `socketPath`*</td><td>*integer*</td><td>3306</td><td>.</td></tr>
<tr><th><strong>ssl</strong></th><td>Включает поддержку TLS. Для получения дополнительной информации смотрите документацию <a href="/documentation/connection-options.md#ssl">ssl option</a>.</td><td>*mixed*</td><td></td></tr>
<tr><th><strong>database</strong></th><td>База данных по умолчанию, используемая при установлении соединения.</td><td>*string*</td><td></td></tr>
<tr><th><strong>socketPath</strong></th><td>Разрешает соединения с базой данных через сокет домена Unix или именованный канал.</td><td>*string*</td><td></td></tr>
<tr><th><strong>compress</strong></th><td>Сжимает обмен с базой данных с помощью gzip.  Это позволяет повысить производительность, когда база данных находится в другом месте.</td><td>*boolean*</td><td>false</td></tr>
<tr><th><strong>connectTimeout</strong></th><td>Устанавливает таймаут соединения в миллисекундах.</td><td>*integer*</td><td>10 000</td></tr>
<tr><th><strong>socketTimeout</strong></th><td>Устанавливает таймаут сокета в миллисекундах после успешного соединения. Значение `0` отключает таймаут.</td><td>*integer*</td><td>0</td></tr>
<tr><th><strong>rowsAsArray</strong></th><td>Возвращает наборы результатов в виде массивов, а не JSON. Это более быстрый способ получения результатов. Для получения дополнительной информации смотрите раздел Запрос.</td><td>*boolean*</td><td>false</td></tr>
</table>
</div><p>Для получения дополнительной информации см. <a href="/documentation/connection-options.md">Connection Options</a> documentation. </p>
<h3 class="anchored_heading" id="подключение-к-локальным-базам-данных">Подключение к локальным базам данных</h3>
<p>При работе с локальной базой данных (то есть в случаях, когда MariaDB и ваше приложение Node.js работают на одном хосте), вы можете подключиться к MariaDB через сокет Unix или именованную трубу Windows для лучшей производительности, а не использовать уровень TCP/IP.</p>
<p>Чтобы настроить это, вам нужно присвоить соединению значение `socketPath`.  Когда это сделано, коннектор игнорирует параметры `host` и `port`.</p>
<p>Конкретный путь к сокету, который необходимо задать, определяется параметром 
<a href="https://mariadb.com/kb/en/library/server-system-variables/#socket">socket</a> системной переменной сервера.  Если вы не знаете ее, вы можете получить ее с сервера.</p>
<pre class="fixed"><span class="k">SHOW</span> <span class="n">VARIABLES</span> <span class="k">LIKE</span> <span class="s1">&#39;socket&#39;</span><span class="p">;</span>
</pre><p>По умолчанию это `/tmp/mysql.sock` в Unix-подобных операционных системах и `MySQL` в Windows.  Кроме того, в Windows эта функция работает только тогда, когда сервер запущен с опцией `--enable-named-pipe`.</p>
<p>Например, на Unix соединение может выглядеть следующим образом:</p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">conn</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">({</span> <span class="nx">socketPath</span><span class="o">:</span> <span class="s1">&#39;/tmp/mysql.sock&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;root&#39;</span> <span class="p">});</span>
<span class="nx">conn</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">//do something with connection</span>
  <span class="nx">conn</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
<span class="p">});</span>

</pre><p>Это же имеет аналогичный синтаксис в Windows: </p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">conn</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">({</span> <span class="nx">socketPath</span><span class="o">:</span> <span class="s1">&#39;\\\\.\\pipe\\MySQL&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;root&#39;</span> <span class="p">});</span>
</pre><h3 class="anchored_heading" id="createpooloptions-pool">createPool(options) → Pool</h3>
<div class="cstm-style bluebox"><ul start="1"><li>`options`: *JSON/string* <a href="#pool-options">pool options</a>
</li></ul>
<p> Возварщает объект <a href="#pool-api">Pool</a></p>
</div><p>Создает новый пул.</p>
<p><strong>Пример:</strong></p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">pool</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPool</span><span class="p">({</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">pool</span><span class="p">.</span><span class="nx">getConnection</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">conn</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;не удалось подключиться из-за ошибки: &quot;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;подключено ! идентификатор соединения - &quot;</span> <span class="o">+</span> <span class="nx">conn</span><span class="p">.</span><span class="nx">threadId</span><span class="p">);</span>
	<span class="nx">conn</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span> <span class="c1">//передача в пул</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre><h4 class="anchored_heading" id="варианты-poolов">Варианты pool'ов</h4>
<p>Опции пула включают <a href="#connection-options">документацию по опциям соединения</a>, которые будут использоваться при создании новых соединений.</p>
<p>Конкретные варианты для pool'ов - это :</p>
<div class="cstm-style newspaper-side table-head-align-top"><table><tr><th><strong>acquireTimeout</strong></th><td>Время ожидания получения нового соединения из пула в мс.</td><td>*целое*</td><td>10000</td></tr>
<tr><th><strong>connectionLimit</strong></th><td>Максимальное количество соединений в пуле.</td><td>*целое*</td><td>10</td></tr>
<tr><th><strong>idleTimeout</strong></th><td>Укажите время простоя, после которого соединение с пулом будет освобождено. Значение должно быть меньше, чем <a href="https://mariadb.com/kb/en/library/server-system-variables/#wait_timeout">https://mariadb.com/kb/en/library/server-system-variables/#wait_timeout</a>. В секундах (0 означает никогда не освобождать</td><td>@@wait_timeout]]</td><td>*целое число*</td><td>1800</td></tr>
<tr><th><strong>minimumIdle</strong></th><td>Разрешает установить минимальное количество соединений в пуле. <strong>Рекомендация - использовать фиксированный пул, поэтому не устанавливать это значение</strong>.</td><td>*integer*</td><td>*set to connectionLimit value*</td><td>*set to connectionLimit value*.</td></tr>
<tr><th><strong>minDelayValidation</strong></th><td>При запросе соединения в пул, пул будет проверять состояние соединения. "minDelayValidation" позволяет отключить эту проверку, если соединение было заимствовано недавно, избегая бесполезных проверок в случае частого повторного использования соединений. 0 означает, что проверка выполняется каждый раз, когда запрашивается соединение. (в мс)</td><td>*целое*</td><td>500</td></tr>
<tr><th><strong>noControlAfterUse</strong></th><td>После возврата соединения в пул (connection.end) коннектор сбросит или откатит соединение, чтобы убедиться, что оно действительно. Эта опция позволяет отключить эти элементы управления</td><td>*boolean*</td><td>false</td></tr>
</table>
</div><h2 class="anchored_heading" id="события-в-poolе">События в pool'е</h2>
<div class="cstm-style newspaper-side table-head-align-top"><table><tr><th><strong>acquire</strong></th><td>Это событие означает, что соединение было получено из пула.</td></tr>
<tr><th><strong>connection</strong></th><td>Это событие возникает, когда в пул добавляется новое соединение. Имеет параметр объекта соединения</td></tr>
<tr><th><strong>enqueue</strong></th><td>Это событие возникает, когда команда не может быть немедленно удовлетворена пулом и ставится в очередь.</td></tr>
<tr><th><strong>release</strong></th><td>Это событие возникает, когда соединение возвращается обратно в пул. Имеет параметр объекта соединения</td></tr>
</table>
</div><p><strong>Пример:</strong></p>
<pre class="fixed"><span class="nx">pool</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">conn</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`соединение </span><span class="si">${</span><span class="nx">conn</span><span class="p">.</span><span class="nx">threadId</span><span class="si">}</span><span class="sb"> было создано в пуле`</span><span class="p">);</span>
</pre><h3 class="anchored_heading" id="createpoolclusteroptions-poolcluster">createPoolCluster(options) → PoolCluster</h3>
<div class="cstm-style bluebox"><ul start="1"><li>`options`: *JSON* <a href="#poolCluster-options">poolCluster options</a>
</li></ul>
<p> Возвращает объект <a href="#poolCluster-api">PoolCluster</a>,</p>
</div><p>Создает новый кластер пулов. Кластер обрабатывает несколько пулов, обеспечивая высокую доступность / распределяя нагрузку (с использованием круговой / случайной / упорядоченной).</p>
<p><strong>Пример:</strong></p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">cluster</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPoolCluster</span><span class="p">();</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;master&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb1.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave1&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb2.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave2&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb3.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>

<span class="c1">//получение соединения от slave1 или slave2 с использованием round-robin</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">getConnection</span><span class="p">(</span><span class="sr">/^slave*$/</span><span class="p">,</span> <span class="s2">&quot;RR&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">conn</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">conn</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT 1&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">rows</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">conn</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
	<span class="k">return</span> <span class="nx">row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;@node&quot;</span><span class="p">];</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre><h4 class="anchored_heading" id="параметры-poolcluster">Параметры PoolCluster</h4>
<p>Опции кластера пулов включают <a href="#pool-options">pool option documentation</a>, которые будут использоваться при создании новых пулов.</p>
<p>Специфическими опциями для кластера пулов являются :</p>
<div class="cstm-style newspaper-side table-head-align-top"><table><tr><th><strong>canRetry</strong></th><td>Когда получение соединения из пула не удалось, кластер может повторить попытку с другими пулами</td><td>*boolean*</td><td>true</td></tr>
<tr><th><strong>removeNodeErrorCount</strong></th><td>Максимальное количество последовательных ошибок соединения из пула перед удалением пула из конфигурации кластера. null означает, что узел не будет удален</td><td>*integer*</td><td>5</td><td></td></tr>
<tr><th><strong>restoreNodeTimeout</strong></th><td>Задержка перед повторным использованием пула после разрыва соединения. 0 = может быть использован немедленно (в мс)</td><td>*integer*</td><td>0</td></tr>
<tr><th><strong>defaultSelector</strong></th><td>Селектор пулов по умолчанию. Может быть 'RR' (round-robin), 'RANDOM' или 'ORDER' (use in sequence = всегда использовать первые пулы, если не происходит сбой)</td><td>*string*</td><td>'RR'</td></tr>
</table>
</div><h1 class="anchored_heading" id="api-подключения">API подключения</h1>
<h2 class="anchored_heading" id="connectionquerysql-values-callback-emitter">connection.query(sql[, values][, callback])` -&gt; `Emitter</h2>
<div class="cstm-style bluebox"><ul start="1"><li>`sql`: *string | JSON* Строковое значение SQL или объект JSON, заменяющий стандартные параметры соединений.  Если это объект JSON, он должен иметь свойство `` sql``.  Например: `{dateStrings:true, sql:'SELECT NOW()'}`.
</li><li>``значения``: *массив | объект* Значения заполнителя. Обычно это массив, но в случаях, когда есть только одно значение, его можно указать как есть.
</li><li>`callback`: *function* Функция обратного вызова с аргументами (ошибка, результаты, метаданные).
</li></ul>
<p>Возвращает объект Emitter, который может испускать четыре различных типа событий:</p>
<ul start="1"><li>error : Выдает объект <a href="#error">Error</a>, если запрос завершился неудачно.
</li><li>columns : Выдается при получении метаданных колонок из набора результатов (параметр представляет собой массив <a href="#metadata-field%29">полей метаданных</a>.
</li><li>data : Выдается каждый раз при получении строки (параметр - строка).
</li><li>end : Выдается, когда запрос заканчивается (без параметра).
</li></ul>
</div><p>Отправляет запрос в базу данных с функцией обратного вызова, которая вызывается после завершения.</p>
<p>В случаях, когда запрос возвращает огромные наборы результатов, это означает, что все данные хранятся в памяти.  Возможно, вам покажется более практичным использовать объект `Emitter` для обработки строк по одной, чтобы избежать перегрузки ресурсов памяти.</p>
<p>Например, выдача запроса с SQL-строкой:</p>
<pre class="fixed"><span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT NOW()&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">rows</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rows</span><span class="p">);</span> <span class="c1">//[ { { &#39;now()&#39;: 2018-07-02T17:06:38.000Z } ]</span>
<span class="p">});</span>
</pre><p>Использование объектов JSON:</p>
<pre class="fixed"><span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">({</span><span class="nx">dateStrings</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="nx">sql</span><span class="o">:</span><span class="s1">&#39;SELECT now()&#39;</span><span class="p">},</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">rows</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rows</span><span class="p">);</span> <span class="c1">//[ { { &#39;now()&#39;: &#39;2018-07-02 19:06:38&#39; } }</span>
<span class="p">});</span>
</pre><h3 class="anchored_heading" id="placeholder">Placeholder</h3>
<p>Чтобы избежать атак SQL Injection, в запросах разрешается использовать вопросительный знак в качестве заполнителя.  Коннектор экранирует значения в соответствии с их типом.  Вы можете использовать в этих значениях любой собственный тип JavaScript, Buffer, Readable или любой объект с методом `toSqlString`.  Все остальные объекты строятся с помощью метода `JSON.stringify`.</p>
<p>Коннектор автоматически передает потоки объектов, реализующих Readable.  В этих случаях проверьте значения следующих системных переменных сервера, так как они могут мешать:</p>
<p>- <a href="https://mariadb.com/kb/en/library/server-system-variables/#net_write_timeout">net_read_timeout</a>: Сервер должен полностью получить запрос от коннектора, прежде чем произойдет таймаут.  Значение по умолчанию для этой системной переменной - 30 секунд.
- <a href="https://mariadb.com/kb/en/library/server-system-variables/#max_allowed_packet">max_allowed_packet</a>: С помощью этой системной переменной вы можете контролировать максимальный объем данных, который коннектор может отправить на сервер.</p>
<pre class="fixed"><span class="c1">// Отправляет INSERT INTO someTable VALUES (1, _BINARY &#39;.\&#39;.st&#39;, &#39;mariadb&#39;)</span>
<span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span>
  <span class="s2">&quot;INSERT INTO someTable VALUES (?, ?, ?)&quot;</span><span class="p">,</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="s2">&quot;c327a97374&quot;</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">),</span> <span class="s2">&quot;mariadb&quot;</span><span class="p">],</span>
  <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
    <span class="c1">//log : { affectedRows: 1, insertId: 1, warningStatus: 0 }</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre><p>Вы также можете выполнить тот же запрос, используя Streaming.</p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">https</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;https&quot;</span><span class="p">);</span>
<span class="nx">https</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;https://node.green/#ES2018-features-Promise-prototype-finally-basic-support&quot;</span><span class="p">,</span>
  <span class="nx">readableStream</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO StreamingContent (b) VALUE (?)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">readableStream</span><span class="p">],</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
	<span class="c1">//inserted</span>
	<span class="p">});</span>
  <span class="p">}</span>
<span class="p">)</span>
</pre><h3 class="anchored_heading" id="результаты-запроса">Результаты запроса</h3>
<p>Запросы, выполняемые из коннектора, возвращают два различных вида результатов: объект JSON и массив, в зависимости от типа выполняемого запроса.  Запросы, которые записывают данные в базу данных, такие как команды `INSERT`, `DELETE` и `UPDATE`, возвращают объект JSON со следующими свойствами:</p>
<ul start="1"><li>`affectedRows`: Указывает количество строк, затронутых запросом.
</li><li>`insertId`: Показывает последнее автоинкрементное значение из `INSERT`.
</li><li>`warningStatus`: Указывает, завершился ли запрос предупреждением.
</li></ul>
<pre class="fixed"><span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span>
  <span class="s2">&quot;CREATE TABLE animals (&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;id MEDIUMINT NOT NULL AUTO_INCREMENT,&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;name VARCHAR(30) NOT NULL,&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;PRIMARY KEY (id))&quot;</span><span class="p">,</span>
  <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO animals(name) value (?)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;морские львы&quot;</span><span class="p">],</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
      <span class="c1">//log : { affectedRows: 1, insertId: 1, warningStatus: 0 }</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre><h4 class="anchored_heading" id="массив-набора-результатов">Массив набора результатов</h4>
<p>Запросы, выполняемые с помощью Коннектора, возвращают два различных вида результатов: объект JSON и массив, в зависимости от типа запроса.  Если запрос возвращает несколько строк, коннектор возвращает массив, представляющий данные для каждой строки в массиве.  Он также возвращает объект `meta`, содержащий метаданные запроса.</p>
<p>Вы можете формировать результаты данных с помощью опций `nestTables` и `rowsAsArray`.  По умолчанию возвращается объект JSON для каждой строки.</p>
<pre class="fixed"><span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;select * from animals&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
  <span class="c1">// [</span>
	  <span class="c1">//{id: 1, name: &#39;sea lions&#39; },</span>
	  <span class="c1">//{id: 2, name: &#39;bird&#39; },</span>
	  <span class="c1">//meta: [ ... ]</span>
  <span class="c1">// ]  </span>
<span class="p">});</span>
<span class="o">&lt;&lt;</span><span class="nx">code</span><span class="o">&gt;&gt;</span>

<span class="o">===</span> <span class="nx">Потоковое</span> <span class="nx">вещание</span>

<span class="o">&lt;&lt;</span><span class="nx">code</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">&quot;javascript&quot;</span><span class="o">&gt;&gt;</span>
<span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM mysql.user&quot;</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span> <span class="c1">//если ошибка</span>
	<span class="p">})</span>
	<span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;fields&quot;</span><span class="p">,</span> <span class="nx">meta</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">meta</span><span class="p">);</span> <span class="c1">// [ ... ].</span>
	<span class="p">})</span>
	<span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="nx">row</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
	<span class="p">})</span>
	<span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="c1">//ended</span>
	<span class="p">});</span>
</pre><h2 class="anchored_heading" id="connectionbatchsql-values-callback">connection.batch(sql, values [, callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>`sql`: *string | JSON* Строковое значение SQL или объект JSON для замены опций соединений по умолчанию.  Объекты JSON должны иметь свойство `` sql``.  Например, `{ dateStrings: true, sql: 'SELECT now()' }`
</li><li>``значения``: *array* Массив параметра (массив массива или массив объекта, если используются именованные заполнители).
</li><li>`callback`: *function* Функция обратного вызова с аргументами (ошибка, результаты, метаданные).
</li></ul>
<p> обратный вызов либо возвращает <a href="#error">Error</a> с нулевыми результатами/метаданными, либо с пустой ошибкой и результатами/метаданными</p>
</div><p>Реализация зависит от типа и версии сервера.
для сервера MariaDB версии 10.2.7+, реализация использует выделенный протокол bulk.</p>
<p>В других случаях запросы на вставку будут переписаны для оптимизации.
пример:
insert into ab (i) values (?) со значениями первой партии = 1, второй = 2 будет переписано
вставьте в ab (i) значения (1), (2).</p>
<p>Если запрос не может быть переписан, будет выполнен запрос для каждого значения.</p>
<p>Разница в результате по сравнению с выполнением нескольких вставок по одному запросу заключается в том, что возвращается только первый сгенерированный идентификатор вставки.</p>
<p>Например,</p>
<pre class="fixed">  <span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span>
	<span class="s2">&quot;CREATE TEMPORARY TABLE batchExample(id int, id2 int, id3 int, t varchar(128), id4 int)&quot;</span>
  <span class="p">);</span>
  <span class="nx">подключение</span>
	<span class="p">.</span><span class="nx">batch</span><span class="p">(</span><span class="s2">&quot;INSERT INTO `batchExample` values (1, ?, 2, ?, 3)&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;john&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;jack&quot;</span><span class="p">]],</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ошибка обработки&#39;</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">affectedRows</span><span class="p">);</span> <span class="c1">// 2</span>
	<span class="p">}</span>
	<span class="p">});</span>

</pre><h2 class="anchored_heading" id="connectionbegintransactioncallback">connection.beginTransaction([callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``callback``: *function* Функция обратного вызова с аргументом <a href="#error">Error</a>, если произошла ошибка.
</li></ul>
</div><p>Начинает новую транзакцию.</p>
<h2 class="anchored_heading" id="connectioncommitcallback">connection.commit([callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>`callback`: *функция* функция обратного вызова с аргументом <a href="#error">Error</a>, если произошла ошибка.
</li></ul>
</div><p>Завершает текущую транзакцию, если она активна.  Коннектор отслеживает состояние текущей транзакции на сервере.  Когда активной транзакции нет, этот метод не посылает никаких команд на сервер.</p>
<h2 class="anchored_heading" id="connectionrollbackcallback">connection.rollback([callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``callback``: *function* Функция обратного вызова с аргументом <a href="#error">Error</a>, если произошла ошибка.
</li></ul>
</div><p>Откатывает текущую транзакцию, если она активна.  Коннектор отслеживает текущее состояние транзакции на сервере.  Если активной транзакции нет, этот метод не посылает никаких команд на сервер.</p>
<pre class="fixed"><span class="nx">conn</span><span class="p">.</span><span class="nx">beginTransaction</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="nx">conn</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO testTransaction values (&#39;test&#39;)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="nx">conn</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO testTransaction values (&#39;test2&#39;)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">conn</span><span class="p">.</span><span class="nx">rollback</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
	<span class="p">}</span>
	<span class="p">});</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="nx">conn</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
	<span class="p">}</span>
	<span class="p">});</span>
	<span class="p">}</span>
	<span class="p">});</span>
	<span class="p">}</span>
	<span class="p">})</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre><h2 class="anchored_heading" id="connectionchangeuseroptions-callback">connection.changeUser(options[, callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``options``: *JSON*, подмножество <a href="#connection-options">документация по опциям подключения</a> = база данных / charset / пароль / пользователь
</li><li>`callback`: *функция* функция обратного вызова с аргументом <a href="#error">Error</a>, если произошла ошибка.
</li></ul>
</div><p>Сброс соединения и повторная аутентификация с заданными учетными данными.  Это эквивалентно созданию нового соединения с новым пользователем, повторно используя существующий открытый сокет.</p>
<pre class="fixed"><span class="nx">conn</span><span class="p">.</span><span class="nx">changeUser</span><span class="p">({</span><span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;changeUser&#39;</span><span class="p">,</span> <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;mypassword&#39;</span><span class="p">},</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="c1">//Пользователь соединения теперь изменен.</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre><h2 class="anchored_heading" id="connectionpingcallback">connection.ping([callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``callback``: *function* Функция обратного вызова с аргументом <a href="#error">Error</a>, если произошла ошибка.
</li></ul>
</div><p>Отправляет однобайтовый пакет на сервер, чтобы проверить, что соединение все еще активно.</p>
<pre class="fixed"><span class="nx">conn</span><span class="p">.</span><span class="nx">ping</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="c1">//соединение действительно</span>
  <span class="p">}</span>
<span class="p">})</span>
</pre><h2 class="anchored_heading" id="connectionendcallback">connection.end([callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``callback``: *function* Функция обратного вызова с аргументом <a href="#error">Error</a>, если произошла ошибка.
</li></ul>
</div><p>Закрывает соединение изящно.  То есть коннектор ожидает завершения выполнения текущих запросов, после чего закрывает соединение.</p>
<pre class="fixed"><span class="nx">conn</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// обработка ошибки</span>
<span class="p">})</span>
</pre><h2 class="anchored_heading" id="connectionresetcallback">connection.reset([callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``callback``: *function* Функция обратного вызова с аргументом <a href="#error">Error</a>, если произошла ошибка.
</li></ul>
</div><p>сбросить соединение. Сброс будет:</p>
<ul start="1"><li>откат любой открытой транзакции
</li><li>сброс уровня изоляции транзакций
</li><li>сброс переменных сессии
</li><li>удалить пользовательские переменные
</li><li>удалить временные таблицы
</li><li>удалить все утверждения PREPARE
</li></ul>
<h2 class="anchored_heading" id="connectionisvalid-boolean">connection.isValid() → boolean</h2>
<div class="cstm-style bluebox"><p> Возвращает булево значение</p>
</div><p>Указывает состояние соединения, известное Коннектору.  Если возвращается false, значит, с соединением возникли проблемы, например, сокет отключился без ведома Коннектора.</p>
<h2 class="anchored_heading" id="connectiondestroy">connection.destroy()</h2>
<p>Закрывает соединение, не дожидаясь выполнения текущих запросов.  Эти запросы прерываются.  MariaDB регистрирует это событие как неожиданное закрытие сокета.</p>
<h2 class="anchored_heading" id="connectionpause">connection.pause()</h2>
<p>Приостанавливает считывание данных.</p>
<h2 class="anchored_heading" id="connectionresume">connection.resume()</h2>
<p>Возобновляет чтение данных после паузы.</p>
<h2 class="anchored_heading" id="connectionserverversion">connection.serverVersion()</h2>
<div class="cstm-style bluebox"><p> Возвращает строку</p>
</div><p>Получает версию текущего подключенного сервера.  Выбрасывает ошибку при отсутствии подключения к серверу.</p>
<pre class="fixed">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">connection</span><span class="p">.</span><span class="nx">serverVersion</span><span class="p">());</span> <span class="c1">//10.2.14-MariaDB</span>
</pre><h2 class="anchored_heading" id="ошибка">Ошибка</h2>
<p>Когда коннектор сталкивается с ошибкой, Promise возвращает объект <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a>.  В дополнение к стандартным свойствам, этот объект имеет следующие свойства:</p>
<ul start="1"><li>`fatal`: Булево значение, указывающее, остается ли соединение действительным.
</li><li>`errno`: Номер ошибки.
</li><li>`sqlState`: Код состояния SQL.
</li><li>`code`: Код ошибки.
</li></ul>
<p>Пример на `console.log(error)`:</p>
<pre class="fixed">{ Error: (conn=116, no: 1146, SQLState: 42S02) Таблица 'testn.falsetable' не существует
  sql: INSERT INTO falseTable(t1, t2, t3, t4, t5) values (?, ?, ?, ?, ?, ?) - parameters:[1,0x01ff,'hh','01/01/2001 00:00:00.000',null]
	  	...
	at Socket.Readable.push (_stream_readable.js:134:10)
	at TCP.onread (net.js:559:20)
	От события:
	at C:\mariadb-connector-nodejs\lib\connection.js:185:29
	at Connection.query (C:\mariadb-connector-nodejs\lib\connection.js:183:12)
	at Context.&lt;anonymous&gt; (C:\mariadb-connector-nodejs\test\integration\test-error.js:250:8)
	fatal: false,
	errno: 1146,
	sqlState: '42S02',
	код: 'ER_NO_SUCH_TABLE' } }
</pre><p>Ошибки содержат стек ошибок, запрос и значения параметров (длина которых по умолчанию ограничена 1024 символами).  Чтобы получить начальную трассировку стека (показанную как `From event...` в примере выше), у вас должна быть включена опция Connection `trace`.</p>
<p>Для получения дополнительной информации о номерах ошибок и обозначениях состояний SQL смотрите документацию <a href="https://mariadb.com/kb/en/library/mariadb-error-codes/">MariaDB Error Code</a>.</p>
<h2 class="anchored_heading" id="события">события</h2>
<p>Объект соединения, который наследуется от Node.js <a href="https://nodejs.org/api/events.html">EventEmitter</a>.  Выдает событие ошибки при неожиданном закрытии соединения.</p>
<pre class="fixed">  <span class="kr">const</span> <span class="nx">conn</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">({</span><span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;myPwd&#39;</span><span class="p">,</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="nx">socketTimeout</span><span class="o">:</span> <span class="mi">100</span><span class="p">})</span>
  <span class="nx">conn</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="c1">//будет выполнен через 100 мс из-за бездействия, сокет закрылся.</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
	<span class="c1">//log :</span>
	<span class="c1">//{ Ошибка: (conn=6283, no: 45026, SQLState: 08S01) таймаут сокета</span>
		<span class="c1">//		...</span>
		<span class="c1">//atSocket.emit (events.js:208:7)</span>
		<span class="c1">//atSocket._onTimeout (net.js:410:8)</span>
		<span class="c1">//atontimeout (timers.js:498:11)</span>
		<span class="c1">//attryOnTimeout (timers.js:323:5)</span>
		<span class="c1">//atTimer.listOnTimeout (timers.js:290:5)</span>
	<span class="c1">// fatal: true,</span>
	<span class="c1">// errno: 45026,</span>
	<span class="c1">// sqlState: &#39;08S01&#39;,</span>
	<span class="c1">// код: &#39;ER_SOCKET_TIMEOUT&#39; }</span>
  <span class="p">});</span>
</pre><h1 class="anchored_heading" id="api-пула">API пула</h1>
<p>При каждом запросе соединения, если пул содержит соединение, которое не используется, пул будет проверять соединение,
обмен пустым пакетом MySQL с сервером, чтобы убедиться в состоянии соединения, а затем отдать соединение.
Пул интенсивно использует соединения, поэтому эта проверка выполняется только в том случае, если соединение не использовалось в течение определенного периода времени
(задается параметром "minDelayValidation" со значением по умолчанию 500 мс).</p>
<p>Если соединение недоступно, запрос на соединение будет помещен в очередь до истечения времени соединения.
Когда соединение становится доступным (новое создание или освобождение в пул), оно будет использоваться для удовлетворения запросов в очереди в порядке FIFO.</p>
<p>Когда соединение передается обратно в пул, все оставшиеся транзакции будут откатаны.</p>
<h2 class="anchored_heading" id="poolgetconnectioncallback">pool.getConnection(callback)</h2>
<div class="cstm-style bluebox"><ul start="1"><li>`callback`: *function* Функция обратного вызова с аргументами (<a href="#connection-api%29">Error](#error), [Connection</a>.
</li></ul>
</div><p>Создает новый объект <a href="#connection-api">Connection</a>.
Соединение должно быть передано обратно пулу с помощью метода connection.end().</p>
<p><strong>Пример:</strong></p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">pool</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPool</span><span class="p">({</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span><span class="s1">&#39;myUser&#39;</span> <span class="p">});</span>
<span class="nx">pool</span><span class="p">.</span><span class="nx">getConnection</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">conn</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;не удалось подключиться из-за ошибки: &quot;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;подключено ! идентификатор соединения - &quot;</span> <span class="o">+</span> <span class="nx">conn</span><span class="p">.</span><span class="nx">threadId</span><span class="p">);</span>
	<span class="nx">conn</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span> <span class="c1">//передача в пул</span>
  <span class="p">}</span>
<span class="p">}));</span>
</pre><h2 class="anchored_heading" id="poolquerysql-values-callback">pool.query(sql[, values][, callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>`sql`: *string | JSON* Строка SQL или объект JSON для замены стандартных опций подключения.  При использовании объекта JSON, объект должен иметь ключ "sql". Например, `{ dateStrings: true, sql: 'SELECT now()' }`
</li><li>``значения``: *массив | объект* Значения заполнителя. Обычно это массив, но в случаях, когда есть только один заполнитель, его можно указать как есть.
</li><li>`callback`: *function* Функция обратного вызова с аргументами (ошибка, результаты, метаданные).
</li></ul>
</div><p>Это быстрый способ получить соединение из пула, выполнить запрос и освободить соединение.</p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">pool</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPool</span><span class="p">({</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span><span class="s1">&#39;myUser&#39;</span> <span class="p">});</span>
<span class="nx">pool</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT NOW()&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">rows</span><span class="p">,</span> <span class="nx">metadata</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rows</span><span class="p">);</span> <span class="c1">//[ { { &#39;NOW()&#39;: 2018-07-02T17:06:38.000Z }, meta: [ ... ] ]</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre><h2 class="anchored_heading" id="poolbatchsql-values-callback">pool.batch(sql, values[, callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>`sql`: *string | JSON* Строка SQL или объект JSON для замены стандартных опций подключения.  При использовании объекта JSON, объект должен иметь ключ "sql". Например, `{ dateStrings: true, sql: 'SELECT now()' }`
</li><li>`values`: *массив* массив значений плейсхолдеров. Обычно это массив массивов, но в случаях, когда на одно значение приходится только один плейсхолдер, он может быть задан как один массив.
</li><li>`callback`: *function* Функция обратного вызова с аргументами (ошибка, результаты, метаданные).
</li></ul>
</div><p>Это быстрый способ получить соединение из пула, выполнить пакет и освободить соединение.</p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">pool</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPool</span><span class="p">({</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span><span class="s1">&#39;myUser&#39;</span> <span class="p">});</span>
<span class="nx">pool</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span>
  <span class="s2">&quot;CREATE TABLE parse(autoId int not null primary key auto_increment, c1 int, c2 int, c3 int, c4 varchar(128), c5 int)&quot;</span>
<span class="p">);</span>
<span class="nx">pool</span>
  <span class="p">.</span><span class="nx">batch</span><span class="p">(</span><span class="s2">&quot;INSERT INTO `parse`(c1,c2,c3,c4,c5) values (1, ?, 2, ?, 3)&quot;</span><span class="p">,</span>
	<span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;john&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;jack&quot;</span><span class="p">]],</span>
	<span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="c1">//res = { affectedRows: 2, insertId: 1, warningStatus: 0 }</span>
	<span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">affectedRows</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="nx">pool</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;select * from `parse`&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	res = [</span>
<span class="cm">	{ autoId: 1, c1: 1, c2: 1, c3: 2, c4: &#39;john&#39;, c5: 3 },</span>
<span class="cm">	{ autoId: 2, c1: 1, c2: 2, c3: 2, c4: &#39;jack&#39;, c5: 3 },</span>
<span class="cm">	meta: ...</span>
<span class="cm">	}</span>
<span class="cm">	*/</span>
	<span class="p">});</span>
	<span class="p">}</span>
  <span class="p">});</span>
</pre><h2 class="anchored_heading" id="poolendcallback">pool.end([callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``callback``: *функция* Функция обратного вызова с аргументом (<a href="#error%29">Error</a>).
</li></ul>
</div><p>Изящно закрывает пул и базовые соединения.</p>
<pre class="fixed"><span class="nx">pool</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="c1">//соединения были завершены должным образом    </span>
  <span class="p">}</span>
<span class="p">});</span>
</pre><h2 class="anchored_heading" id="события-в-poolе">События в pool'е</h2>
<div class="cstm-style newspaper-side table-head-align-top"><table><tr><th><strong>acquire</strong></th><td>Это событие означает, что соединение было получено из пула.</td></tr>
<tr><th><strong>connection</strong></th><td>Это событие возникает, когда в пул добавляется новое соединение. Имеет параметр объекта соединения</td></tr>
<tr><th><strong>enqueue</strong></th><td>Это событие возникает, когда команда не может быть немедленно удовлетворена пулом и ставится в очередь.</td></tr>
<tr><th><strong>release</strong></th><td>Это событие возникает, когда соединение возвращается обратно в пул. Имеет параметр объекта соединения</td></tr>
</table>
</div><p><strong>Пример:</strong></p>
<pre class="fixed"><span class="nx">pool</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">conn</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`соединение </span><span class="si">${</span><span class="nx">conn</span><span class="p">.</span><span class="nx">threadId</span><span class="si">}</span><span class="sb"> было создано в пуле`</span><span class="p">);</span>
</pre><h1 class="anchored_heading" id="api-кластера-пула">API кластера пула</h1>
<p>Кластер обрабатывает несколько пулов в соответствии с шаблонами и обрабатывает обход отказа / распределенную нагрузку (круговая / случайная / упорядоченная).</p>
<h2 class="anchored_heading" id="poolclusteraddid-config">poolCluster.add(id, config)</h2>
<div class="cstm-style bluebox"><ul start="1"><li>`id`: *строка* идентификатор узла. пример : 'master'.
</li><li>`config`: *JSON* <a href="#pool-options">pool options</a> для создания пула.
</li></ul>
</div><p>Добавьте новый пул в кластер.</p>
<p><strong>Пример:</strong></p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">cluster</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPoolCluster</span><span class="p">();</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;master&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb1.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave1&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb2.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave2&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb3.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
</pre><h2 class="anchored_heading" id="poolclusterremovepattern">poolCluster.remove(pattern)</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``шаблон'': *строка* regex-шаблон для выбора пулов. Пример, `"slave*".
</li></ul>
</div><p>удалить и завершить пул(ы), сконфигурированные в кластере.</p>
<h2 class="anchored_heading" id="poolclusterendcallback">poolCluster.end([callback])</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``callback``: *функция* Функция обратного вызова с аргументом (<a href="#error%29">Error</a>).
</li></ul>
</div><p>Закрывает кластер пулов и базовые пулы.</p>
<pre class="fixed"><span class="nx">poolCluster</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// обработка ошибки</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="c1">//pool&#39;ы были завершены должным образом    </span>
  <span class="p">}</span>
<span class="p">});</span>
</pre><h2 class="anchored_heading" id="poolclustergetconnectionpattern-selector-callback">poolCluster.getConnection([pattern, ][selector, ]callback)</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``шаблон'':  *строка* regex-шаблон для выбора пулов. Пример, `"slave*"`. По умолчанию `'*'`.
</li><li>`селектор`: *строка* селектор пулов. Может быть 'RR' (round-robin), 'RANDOM' или 'ORDER' (использовать по порядку = всегда использовать первые пулы, если нет неудач). по умолчанию - 'RR'.  
</li><li>`callback`: *function* Функция обратного вызова с аргументами (<a href="#connection-api%29">Error](#error), [Connection</a>.
</li></ul>
</div><p>Создает новый объект <a href="#connection-api">Connection</a>.
Соединение должно быть передано обратно пулу с помощью метода connection.end().</p>
<p><strong>Пример:</strong></p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">cluster</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPoolCluster</span><span class="p">();</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;master&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb1.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave1&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb2.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave2&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb3.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">getConnection</span><span class="p">(</span><span class="s2">&quot;slave*&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">conn</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">//использовать соединение и обработать возможную ошибку</span>
<span class="p">})</span>
</pre><h2 class="anchored_heading" id="события-poolcluster">события poolCluster</h2>
<p>Объект PoolCluster наследуется от объекта Node.js <a href="https://nodejs.org/api/events.html">EventEmitter</a>.
Выдает событие 'remove', когда узел удаляется из конфигурации, если определена опция `removeNodeErrorCount`.
(по умолчанию 5) и коннектору не удается подключиться более `removeNodeErrorCount` раз.
(если присутствуют другие узлы, каждая попытка будет ждать значения опции `restoreNodeTimeout`)</p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">cluster</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPoolCluster</span><span class="p">({</span> <span class="nx">removeNodeErrorCount</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">restoreNodeTimeout</span><span class="o">:</span> <span class="mi">5000</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;master&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb1.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave1&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb2.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave2&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb3.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span><span class="o">*</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;remove&#39;</span><span class="p">,</span> <span class="nx">node</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`узел </span><span class="si">${</span><span class="nx">node</span><span class="si">}</span><span class="sb"> был удален`</span><span class="p">);</span>
<span class="p">})</span>
</pre><h2 class="anchored_heading" id="poolclusterofpattern-selector-filteredpoolcluster">poolCluster.of(pattern, selector) → FilteredPoolCluster</h2>
<div class="cstm-style bluebox"><ul start="1"><li>``шаблон'':  *строка* regex-шаблон для выбора пулов. Пример, `"slave*"`. По умолчанию `'*'`.
</li><li>`селектор`: *строка* селектор пулов. Может быть 'RR' (round-robin), 'RANDOM' или 'ORDER' (использовать по порядку = всегда использовать первые пулы, если нет неудач). по умолчанию - 'RR'.  
</li></ul>
<p> Возвращается</p>
<ul start="1"><li>разрешается с помощью объекта <a href="#filteredpoolcluster">filtered pool cluster</a>,
</li><li>вызывает <a href="#error">Error</a>.
</li></ul>
</div><p>Создает новый объект <a href="#filteredpoolcluster">filtered pool cluster</a>, который является подмножеством кластера.</p>
<p><strong>Пример:</strong></p>
<pre class="fixed"><span class="kr">const</span> <span class="nx">mariadb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mariadb/callback&#39;</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">cluster</span> <span class="o">=</span> <span class="nx">mariadb</span><span class="p">.</span><span class="nx">createPoolCluster</span><span class="p">();</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;master-north&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb1.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;master-south&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb1.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave1-north&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb2.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave2-north&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb3.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>
<span class="nx">cluster</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;slave1-south&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;mydb2.com&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="s1">&#39;myUser&#39;</span><span class="p">,</span> <span class="nx">connectionLimit</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span>

<span class="kr">const</span> <span class="nx">masterCluster</span> <span class="o">=</span> <span class="nx">cluster</span><span class="p">.</span><span class="k">of</span><span class="p">(</span><span class="s1">&#39;master*&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">northSlaves</span> <span class="o">=</span> <span class="nx">cluster</span><span class="p">.</span><span class="k">of</span><span class="p">(</span><span class="sr">/^slave?-north/</span><span class="p">,</span> <span class="s1">&#39;RANDOM&#39;</span><span class="p">);</span>
<span class="nx">northSlaves</span><span class="p">.</span><span class="nx">getConnection</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">conn</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="c1">//использовать это соединение</span>
<span class="p">});</span>
</pre><h3 class="anchored_heading" id="кластер-фильтрованных-poolов">Кластер фильтрованных pool'ов</h3>
<ul start="1"><li>`filteredPoolCluster.getConnection(callback)` : Создает новое соединение из пулов, соответствующих шаблону.
</li><li>`filteredPoolCluster.query(sql[, values][, callback])` : это быстрый способ получить соединение из пулов, соответствующих шаблону, выполнить запрос и освободить соединение.</li></ul>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print"
                 data-subscribe-url="/kb/ru/connector-nodejs-callback-api/+subscriptions/add"
                 data-unsubscribe-url="/kb/ru/connector-nodejs-callback-api/+subscriptions/remove">
            </div>
        

        
        
    
        <div class="simple_section_nav">
            <ul class="nav nav-pills">
                
                    <li><a href="/kb/ru/5306/">
                        ← Документация по MariaDB
                    </a>
                    </li>
                
                
                    <li><a href="/kb/ru/mariadb/">
                        ↑ MariaDB - Russian ↑
                    </a>
                    </li>
                
                
                    <li class="pull-right"><a href="/kb/ru/mariadb-vs-mysql-features/">
                        MariaDB в сравнении с MySQL - Особенности →
                    </a>
                    </li>
                
            </ul>
        </div>
    

        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="11372" data-comments-url="/kb/ru/connector-nodejs-callback-api/+comments"
         data-reply-url="/kb/ru/connector-nodejs-callback-api/comments/post/">
        Comments loading...
    </div>

        

    </div>


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
                <div id="right_bar" class="col-md-2">
                    
    
        
        <ul class="section_navigation well well-small hidden-xs hidden-sm">
            
                <li class="parent"><a href="/kb/ru/mariadb/">
                    ↑ MariaDB - Russian ↑
                </a>
                </li>
            
            
                
                    <li>
                        <a href="/kb/ru/mariadb-faq/">
                            
                            MariaDB FAQ
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/ru/5306/">
                            
                            Документация по MariaDB
                        </a>
                    </li>
                
            
                
                    <li class="active">
                        <span>Connector/Node.js Callback API</span>
                        
                    </li>
                
            
                
                    <li>
                        <a href="/kb/ru/mariadb-vs-mysql-features/">
                            
                            MariaDB в сравнении с MySQL - Особенности
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/ru/a-mariadb-primer/">
                            
                            MariaDB: учебник для начинающих
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/ru/contributing-code/">
                            
                            Внесение изменений в код
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/ru/where-can-i-download-mariadb/">
                            
                            Где я могу скачать MariaDB?
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/ru/mariadb-russian-mariadb/">
                            
                            О РСУБД MariaDB
                        </a>
                    </li>
                
            
                
                    <li>
                        <a href="/kb/ru/mariadb-53/">
                            
                            Что такое MariaDB 5.3?
                        </a>
                    </li>
                
            
        </ul>
    
    

                </div>
            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row row-10">
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/products" title="Products">Products</a>
                    </h5>
                    <ul>
                        <li id="menu-item-7816" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7816"><a href="https://mariadb.com/products/mariadb-platform/">MariaDB Platform</a></li>
                        <li id="menu-item-7815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7815"><a href="https://mariadb.com/products/skysql/">MariaDB SkySQL</a></li>
                        <li id="menu-item-4172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4172"><a href="https://mariadb.com/pricing/">Pricing</a></li>
                        <li id="menu-item-4163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4163"><a href="https://mariadb.com/downloads/">Download MariaDB</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/services" title="Services">Services</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/remote-dba/">Remote DBA</a></li>
                        <li id="menu-item-41691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4169"><a href="https://mariadb.com/services/skydba/">SkyDBA</a></li>
                        <li id="menu-item-4167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4167"><a href="https://mariadb.com/services/enterprise-architect/">Enterprise Architect</a></li>
                        <li id="menu-item-4170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4170"><a href="https://mariadb.com/services/technical-support-services/">Technical Support</a></li>
                        <li id="menu-item-4168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4168"><a href="https://mariadb.com/services/migration-practice/">Migration Practice</a></li>
                        <li id="menu-item-4166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4166"><a href="https://mariadb.com/services/consulting/">Consulting</a></li>
                        <li id="menu-item-4171" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4171"><a href="https://mariadb.com/services/training/">Training</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-xs-4 item">
                    <h5>
                        <a href="/resources" title="Resources">Resources</a>
                    </h5>
                    <ul>
                        <li id="menu-item-41751" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/docs/">Documentation</a></li>
                        <li id="menu-item-41752" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/developers/">Developers</a></li>
                        <li id="menu-item-4175" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4175"><a href="https://mariadb.com/resources/blog/">Blog</a></li>
                        <li id="menu-item-5462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5462"><a href="https://support.mariadb.com">Support</a></li>
                        <li id="menu-item-6004" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/openworks/">OpenWorks</a></li>
                        <li id="menu-item-60041" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6004"><a href="https://mariadb.com/resources/customer-stories/">Customer Stories</a></li>
                        <li id="menu-item-7817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7817"><a href="https://mariadb.com/resources/events/">Events</a></li>
                        <li id="menu-item-4177" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4177"><a href="https://mariadb.com/roadshow/">MariaDB Roadshow</a></li>
                    </ul>
                </div>
                <div class="visible-xs visible-sm clear"></div>
                <div class="col-md-2 col-xs-5 item">
                    <h5>
                        <a href="/about-us" title="About MariaDB">About</a>
                    </h5>
                    <ul>
                        <li id="menu-item-4173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4173"><a href="https://mariadb.com/contact/">Contact</a></li>
                        <li id="menu-item-4161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4161"><a href="https://mariadb.com/about-us/leadership/">Leadership</a></li>
                        <li id="menu-item-4162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4162"><a href="https://mariadb.com/about-us/partners/">Partners</a></li>
                        <li id="menu-item-4174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4174"><a href="https://mariadb.com/newsroom/">Newsroom</a></li>
                        <li id="menu-item-4160" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4160"><a href="https://mariadb.com/about-us/investors/">Investors</a></li>
                        <li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/about-us/careers/">Careers</a></li>
                        <li id="menu-item-41591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/trust/">Trust Center</a></li>
                        <li id="menu-item-41592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://mariadb.com/vulnerability-reporting/">Vulnerability Reporting</a></li>
                    </ul>
                </div>
                <div class="col-md-4 col-xs-7 item">
                    <div id="block-footercontact" class="block block-block-content block-block-content22b3af28-0754-44ec-a5c6-4466568f37e3">
                        <h5><a href="/contact" title="Contact">Contact</a></h5>
                    </div>
                    <div class="social">
                        <ul class="list-inline">
                            <li>
                                <a target="_blank" href="https://www.facebook.com/MariaDB.dbms/" title="Facebook">
                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://twitter.com/mariadb" title="Twitter">
                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" href="https://www.linkedin.com/company/mariadb-corporation?trk=company_logo " title="LinkedIn">
                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <p>Subscribe to our newsletter!</p>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container text-center">
            <ul class="list-inline no-margin">
                <li>
                    <a href="/legal" title="Legal">Legal</a>
                </li>
                <li>
                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                </li>
                <li>
                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                </li>
            </ul>
            <p>Copyright &copy; 2023 MariaDB. All rights reserved.</p>
        </div>
    </div>
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.fed4ec768178.js" charset="utf-8"></script>

</html>