<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>设置字符集和排序规则 - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="设置字符集和排序规则 - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/zh-cn/setting-character-sets-and-collations/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/zh-cn/setting-character-sets-and-collations/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/zh-cn/setting-character-sets-and-collations/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/zh-cn/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/zh-cn/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/zh-cn/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/zh-cn/mariadb/">MariaDB - 简体中文</a>
    

    
    » <a class="crumb" href="/kb/zh-cn/mariadb-server/">MariaDB Server文档</a>
    


    » <a class="node_link crumb" href="/kb/zh-cn/setting-character-sets-and-collations/">设置字符集和排序规则</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/zh-cn/">首页</a></li>
                            
                                
                                    <li><a href="/kb/zh-cn/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/zh-cn/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/zh-cn/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/zh-cn/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/zh-cn/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/zh-cn/setting-character-sets-and-collations/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>设置字符集和排序规则 - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/zh-cn/setting-character-sets-and-collations/+r/60588/">60588</a></dd>
            <dt>用户</dt>
            <dd>
<span class="user" id="user-5480">
<a href="/kb/user/id/5480" title="longshuai Ma">longshuai Ma</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2017-09-26 14:39">2017-09-26 14:39</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">&lt;&lt;toc&gt;&gt;
在MariaDB中，默认的字符集[[data-types-character-sets-and-collations|character set]]为latin1，默认的排序规则为latin1_swedish_ci(但不同的发行版可能会不同，例如[[differences-in-mariadb-in-debian|Differences in MariaDB in Debian]])。字符集和排序规则都可以从server端一直指定到字段级别，client到server连接时也可以指定。当修改字符集但却没有指定排序规则时，将总是使用字符集的默认排序规则。

字符集和排序规则总是级联向下的，所以当没有为字段指定排序规则时，将查找表的排序规则，同样对于表来说会上查到数据库，对数据库来说会上查到server级。因此，可以使用极细粒度的字符集和排序规则来控制控制你的数据。

每种字符集的默认排序规则可使用[[show-collation|SHOW COLLATION]]语句查看，例如查找latin2字符集的默认排序规则：
&lt;&lt;code sql&gt;&gt;
SHOW COLLATION LIKE &#39;latin2%&#39;;
+---------------------+---------+----+---------+----------+---------+
| Collation           | Charset | Id | Default | Compiled | Sortlen |
+---------------------+---------+----+---------+----------+---------+
| latin2_czech_cs     | latin2  |  2 |         | Yes      |       4 |
| latin2_general_ci   | latin2  |  9 | Yes     | Yes      |       1 |
| latin2_hungarian_ci | latin2  | 21 |         | Yes      |       1 |
| latin2_croatian_ci  | latin2  | 27 |         | Yes      |       1 |
| latin2_bin          | latin2  | 77 |         | Yes      |       1 |
+---------------------+---------+----+---------+----------+---------+
&lt;&lt;/code&gt;&gt;

== Server级别
可以设置系统变量[[server-system-variables#character_set_server|character_set_server]]来改变默认的server级的字符集。该变量可以使用[[SET]]命令在启动时或动态地设置：
&lt;&lt;sql&gt;&gt;
SET character_set_server = &#39;latin2&#39;;
&lt;&lt;/sql&gt;&gt;
类似地，变量[[server-system-variables#collation_server|collation_server]]用于设置server级别的默认排序规则。
&lt;&lt;sql&gt;&gt;
SET collation_server = &#39;latin2_czech_cs&#39;;
&lt;&lt;/sql&gt;&gt;

== Database级别
[[create-database|CREATE DATABASE]] 和 [[alter-database|ALTER DATABASE]] 语句中包含了可选的字符集、排序规则的设置子句。如果没有设置字符集、排序规则，它们将使用server级别的默认值。

&lt;&lt;sql&gt;&gt;
CREATE DATABASE czech_slovak_names 
  CHARACTER SET = &#39;keybcs2&#39;
  COLLATE = &#39;keybcs2_bin&#39;;
&lt;&lt;/sql&gt;&gt;

&lt;&lt;sql&gt;&gt;
ALTER DATABASE czech_slovak_names COLLATE = &#39;keybcs2_general_ci&#39;;
&lt;&lt;/sql&gt;&gt;

使用下面的语句可以查看数据库所使用的字符集：
&lt;&lt;code sql&gt;&gt;
SHOW CREATE DATABASE czech_slovak_names;
+--------------------+--------------------------------------------------------------------------------+
| Database           | Create Database                                                                |
+--------------------+--------------------------------------------------------------------------------+
| czech_slovak_names | CREATE DATABASE `czech_slovak_names` /*!40100 DEFAULT CHARACTER SET keybcs2 */ |
+--------------------+--------------------------------------------------------------------------------+
&lt;&lt;/code&gt;&gt;
或者，使用下面的语句可以查看各数据库采用的字符集和排序规则：
&lt;&lt;code sql&gt;&gt;
SELECT * FROM INFORMATION_SCHEMA.SCHEMATA;
+--------------+--------------------+----------------------------+------------------------+----------+
| CATALOG_NAME | SCHEMA_NAME        | DEFAULT_CHARACTER_SET_NAME | DEFAULT_COLLATION_NAME | SQL_PATH |
+--------------+--------------------+----------------------------+------------------------+----------+
| def          | czech_slovak_names | keybcs2                    | keybcs2_general_ci     | NULL     |
| def          | information_schema | utf8                       | utf8_general_ci        | NULL     |
| def          | mysql              | latin1                     | latin1_swedish_ci      | NULL     |
| def          | performance_schema | utf8                       | utf8_general_ci        | NULL     |
| def          | test               | latin1                     | latin1_swedish_ci      | NULL     |
+--------------+--------------------+----------------------------+------------------------+----------+
&lt;&lt;/code&gt;&gt;

可以仅指定排序规则，由于每种排序规则都对应于一种字符集，因此会同时设置排序规则所对应的字符集。

&lt;&lt;code sql&gt;&gt;
CREATE DATABASE danish_names COLLATE &#39;utf8_danish_ci&#39;;

SHOW CREATE DATABASE danish_names;
+--------------+----------------------------------------------------------------------------------------------+
| Database     | Create Database                                                                              |
+--------------+----------------------------------------------------------------------------------------------+
| danish_names | CREATE DATABASE `danish_names` /*!40100 DEFAULT CHARACTER SET utf8 COLLATE utf8_danish_ci */ |
+--------------+----------------------------------------------------------------------------------------------+
&lt;&lt;/code&gt;&gt;

尽管可以动态地设置系统变量[[server-system-variables#character_set_database|character_set_database]]和[[server-system-variables#collation_database|collation_database]]，但它们用于确定数据库所使用的默认字符集和排序规则，应该尽量仅在server端进行设置。

== Table级别

[[create-table|CREATE TABLE]] 和 [[alter-table|ALTER TABLE]] 语句支持可选的字符集、排序规则设置子句，它们是MariaDB和MySQL对标准SQL语句的扩展。

&lt;&lt;code sql&gt;&gt;
CREATE TABLE english_names (id INT, name VARCHAR(40)) 
  CHARACTER SET &#39;utf8&#39; 
  COLLATE &#39;utf8_icelandic_ci&#39;;
&lt;&lt;/code&gt;&gt;

如果既没有指定字符集也没有指定排序规则，则采用数据库的默认值。如果仅设置了字符集，将采用字符集的默认排序规则。如果仅设置了排序规则，则排序规则相关联的字符集也会被设置。见 [[supported-character-sets-and-collations|Supported Character Sets and Collations]]。

&lt;&lt;code sql&gt;&gt;
ALTER TABLE table_name
 CONVERT TO CHARACTER SET charset_name [COLLATE collation_name];
&lt;&lt;/code&gt;&gt;

如果没有指定排序规则，将使用字符集默认的排序规则。见 [[supported-character-sets-and-collations|Supported Character Sets and Collations]]。

对于[[varchar|VARCHAR]]或[[text|TEXT]]类型的字段，为了保证新字段足够大以能够存储原字段的大量字符，##CONVERT TO CHARACTER SET##可能会改变数据类型。

例如，某TEXT类型的字段存储ascii字符时由于每个字符仅占用一个字节，因此该字段可以存储65,535个字符。如果该字段转换为UTF8，由于每个字符需要3个字节，该字段的数据类型将被转换为[[mediumtext|MEDIUMTEXT]]类型以便能够存储所有原字段的字符。

##CONVERT TO CHARACTER SET binary##将分别转换[[char|CHAR]]、[[varchar|VARCHAR]]和[[text|TEXT]]字段为[[binary|BINARY]]、 [[varbinary|VARBINARY]]和[[blob|BLOB]]，并且之后将不再具有字符集属性，或者可以在以后使用##CONVERT TO CHARACTER SET##语句来改变该行为。

为了避免##CONVERT TO CHARACTER SET##子句改变数据类型，可以在单独的字段上使用##MODIFY##。例如：
&lt;&lt;code sql&gt;&gt;
ALTER TABLE table_name MODIFY ascii_text_column TEXT CHARACTER SET utf8;
ALTER TABLE table_name MODIFY ascii_varchar_column VARCHAR(M) CHARACTER SET utf8;
&lt;&lt;/code&gt;&gt;

== Column级别
同样可以为字段类型为CHAR、TEXT或VARCHAR的字段设置字符集和排序规则。可以使用[[create-table|CREATE TABLE]]和[[alter-table|ALTER TABLE]]语句进行设置——不像table级别的设置，column级别的设置是标准SQL所支持的。

&lt;&lt;code sql&gt;&gt;
CREATE TABLE european_names (
  croatian_names VARCHAR(40) COLLATE &#39;cp1250_croatian_ci&#39;,
  greek_names VARCHAR(40) CHARACTER SET &#39;greek&#39;);
&lt;&lt;/code&gt;&gt;
如果既没有指定字符集也没有指定排序规则，将使用表的默认值。如果仅设置了字符集，排序规则将使用字符集的默认排序规则，如果仅设置了排序规则，则其对应的字符集也会被设置。

&lt;&lt;style class=&#34;redbox&#34;&gt;&gt;
当使用[[alter-table|ALTER TABLE]]改变字段的字符集时，需要确保字符集可以和已有数据兼容。MariaDB将尽可能地一一映射转换字符数据，但无法转换的数据可能会乱码丢失。
&lt;&lt;/style&gt;&gt;

可以使用[[show-create-table|SHOW CREATE TABLE]]语句，或者查询##INFORMATION_SCHEMA##数据库来查看字段的字符集和排序规则所采用的值。

&lt;&lt;code sql&gt;&gt;
SHOW CREATE TABLE european_names\G
*************************** 1. row ***************************
       Table: european_names
Create Table: CREATE TABLE `european_names` (
  `croatian_names` varchar(40) CHARACTER SET cp1250 COLLATE cp1250_croatian_ci DEFAULT NULL,
  `greek_names` varchar(40) CHARACTER SET greek DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_danish_ci
&lt;&lt;/code&gt;&gt;

&lt;&lt;code sql&gt;&gt;
SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME LIKE &#39;european%&#39;\G
*************************** 1. row ***************************
           TABLE_CATALOG: def
            TABLE_SCHEMA: danish_names
              TABLE_NAME: european_names
             COLUMN_NAME: croatian_names
        ORDINAL_POSITION: 1
          COLUMN_DEFAULT: NULL
             IS_NULLABLE: YES
               DATA_TYPE: varchar
CHARACTER_MAXIMUM_LENGTH: 40
  CHARACTER_OCTET_LENGTH: 40
       NUMERIC_PRECISION: NULL
           NUMERIC_SCALE: NULL
      DATETIME_PRECISION: NULL
      CHARACTER_SET_NAME: cp1250
          COLLATION_NAME: cp1250_croatian_ci
             COLUMN_TYPE: varchar(40)
              COLUMN_KEY: 
                   EXTRA: 
              PRIVILEGES: select,insert,update,references
          COLUMN_COMMENT: 
*************************** 2. row ***************************
           TABLE_CATALOG: def
            TABLE_SCHEMA: danish_names
              TABLE_NAME: european_names
             COLUMN_NAME: greek_names
        ORDINAL_POSITION: 2
          COLUMN_DEFAULT: NULL
             IS_NULLABLE: YES
               DATA_TYPE: varchar
CHARACTER_MAXIMUM_LENGTH: 40
  CHARACTER_OCTET_LENGTH: 40
       NUMERIC_PRECISION: NULL
           NUMERIC_SCALE: NULL
      DATETIME_PRECISION: NULL
      CHARACTER_SET_NAME: greek
          COLLATION_NAME: greek_general_ci
             COLUMN_TYPE: varchar(40)
              COLUMN_KEY: 
                   EXTRA: 
              PRIVILEGES: select,insert,update,references
          COLUMN_COMMENT: 
&lt;&lt;/code&gt;&gt;

== 文件名

从MariaDB 5.1开始，系统变量[[server-system-variables#character_set_filesystem|character_set_filesystem]]可用来控制对给定字符串的文件名解析。它会影响的下面语句和函数：

* [[select-into-dumpfile|SELECT INTO DUMPFILE]]
* ##SELECT INTO OUTFILE##
* [[load-data-infile|LOAD DATA INFILE]]
* [[load-xml|LOAD XML]]
* [[load_file|LOAD_FILE()]]

== 字面符号(译者注：可理解为常量、普通字符串或文本字符)
默认情况下，字符集和排序规则通过系统变量[[server-system-variables#character_set_connection|character_set_connection]]和[[server-system-variables#collation_connection|collation_connection]]来决定使用的字面符号。但是可以显式地指定它们：
&lt;&lt;code sql&gt;&gt;
[_charset_name]&#39;string&#39; [COLLATE collation_name]
&lt;&lt;/code&gt;&gt;

对于没有字符集introducer的字符集来说，它的字符串符号由系统变量[[server-system-variables#character_set_connection|character_set_connection]]决定。

该查询：
&lt;&lt;code sql&gt;&gt;
  SELECT CHARSET(&#39;a&#39;), @@character_set_connection;
&lt;&lt;/code&gt;&gt;
总是会为两列返回相同的字符集名称。

[[server-system-variables#character_set_client|character_set_client]]和[[server-system-variables#character_set_connection|character_set_connection]]一般会被设置为相同的值(例如在三次握手期间，或使用##SET NAMES##进行了设置)。但允许设置为不同值。 

=== 示例
设置@@character_set_client和@@character_set_connection为不同的值时可能很有用处：

示例 1：

假设我们在utf8的数据库中创建下面的表：
&lt;&lt;code sql&gt;&gt;
CREATE TABLE t1 (a VARCHAR(10)) CHARACTER SET utf8 COLLATE utf8_general_ci;
INSERT INTO t1 VALUES (&#39;oe&#39;),(&#39;ö&#39;);
&lt;&lt;/code&gt;&gt;
现在使用&#34;mysql.exe&#34;连接，它会使用DOS的字符集(西欧的机器上是cp850)，如果想要根据德国电话簿规则获取等于“ö”的所有记录。

使用下面的语句：

SET @@character_set_client=cp850, @@character_set_connection=utf8;
SELECT a FROM t1 WHERE a=&#39;ö&#39; COLLATE utf8_german2_ci;

它将返回：
&lt;&lt;code&gt;&gt;
+------+
| a    |
+------+
| oe   |
| ö    |
+------+
&lt;&lt;/code&gt;&gt;

工作方式如下：
# 客户端使用cp850发送查询语句。
# 服务端解析查询语句时，将把&#39;ö&#39;从@@character_set_client (cp850)转换为@@character_set_connection (utf8)的文本字符。
# 服务端对该文本字符应用排序规则&#34;utf8_germal2_ci&#34;。
# 服务端使用utf8_german2_ci进行字符比较。


注意，如果重写为如下脚本：
&lt;&lt;code sql&gt;&gt;
SET NAMES cp850;
SELECT a FROM t1 WHERE a=&#39;ö&#39; COLLATE utf8_german2_ci;
&lt;&lt;/code&gt;&gt;
将报错：
&lt;&lt;code&gt;&gt;
ERROR 1253 (42000): COLLATION &#39;utf8_german2_ci&#39; is not valid for CHARACTER SET &#39;cp850&#39;
&lt;&lt;/code&gt;&gt;
因为：
* 在第2步中，将不会转换为utf8的文本字符，而是转换为cp850的文本字符。
* 在第3步中，服务端无法对cp850的字符串应用排序规则utf8_german2_ci。

示例 2:

继续假设我们的数据库为utf8，并使用西欧机器上的&#34;mysql.exe&#34;进行连接。

我们这样做：
&lt;&lt;code sql&gt;&gt;
SET @@character_set_client=cp850, @@character_set_connection=utf8;
CREATE TABLE t2 AS SELECT &#39;ö&#39;;
&lt;&lt;/code&gt;&gt;
这将会创建一张包含##VARCHAR(1) CHARACTER SET utf8##字段类型的表。

注意，如果查询重写为：
&lt;&lt;code sql&gt;&gt;
SET NAMES cp850;
CREATE TABLE t2 AS SELECT &#39;ö&#39;;
&lt;&lt;/code&gt;&gt;
创建的表中的字段将为##VARCHAR(1) CHARACTER SET cp850##类型，这可能不是我们所期望的。

=== N
同样, 可以使用前缀##N##或##n##来转换文本字符为国际字符集(MariaDB中为utf8)。 

例如：
&lt;&lt;code sql&gt;&gt;
SELECT _latin2 &#39;Müller&#39;;
+-----------+
| MĂźller   |
+-----------+
| MĂźller   |
+-----------+
&lt;&lt;/code&gt;&gt;

&lt;&lt;code sql&gt;&gt;
SELECT CHARSET(N&#39;a string&#39;);
+----------------------+
| CHARSET(N&#39;a string&#39;) |
+----------------------+
| utf8                 |
+----------------------+
&lt;&lt;/code&gt;&gt;

&lt;&lt;code sql&gt;&gt;
SELECT &#39;Mueller&#39; = &#39;Müller&#39; COLLATE &#39;latin1_german2_ci&#39;;
+---------------------------------------------------+
| &#39;Mueller&#39; = &#39;Müller&#39; COLLATE &#39;latin1_german2_ci&#39;  |
+---------------------------------------------------+
|                                                 1 |
+---------------------------------------------------+
&lt;&lt;/code&gt;&gt;

== 存储过程和视图

当创建存储过程或视图时，其内出现的文本字符默认使用系统变量[[server-system-variables#character_set_connection|character_set_connection]]和[[server-system-variables#collation_connection|collation_connection]]指定的字符集和排序规则。可以使用##SHOW CREATE##语句获取所使用的值。要改变已存在存储过程、视图中的文本字符的字符集，需要删除存储程序然后重建。

对于存储过程的参数和返回值，可以通过##CHARACTER SET##和##COLLATE##子句来指定其使用的字符集和排序规则。在MariaDB 5.5之前不支持指定排序规则。

下面的示例中展示了创建存储程序时所使用的字符集和排序规则。

&lt;&lt;code sql&gt;&gt;
SET @@local.character_set_connection=&#39;latin1&#39;;

DELIMITER ||
CREATE PROCEDURE `test`.`x`()
BEGIN
	SELECT CHARSET(&#39;x&#39;);
END;
||
Query OK, 0 rows affected (0.00 sec)

DELIMITER ;
SET @@local.character_set_connection=&#39;utf8&#39;;

CALL `test`.`x`();
+--------------+
| CHARSET(&#39;x&#39;) |
+--------------+
| latin1       |
+--------------+
&lt;&lt;/code&gt;&gt;

下面的示例中展示了如何指定函数的参数和返回值的字符集和排序规则：

&lt;&lt;code sql&gt;&gt;
CREATE FUNCTION `test`.`y`(`str` TEXT CHARACTER SET utf8 COLLATE utf8_bin)
	RETURNS TEXT CHARACTER SET latin1 COLLATE latin1_bin
BEGIN
	SET @param_coll = COLLATION(`str`);
	RETURN `str`;
END;

-- 返回值的排序规则:
SELECT COLLATION(`test`.`y`(&#39;Hello, planet!&#39;));
+-----------------------------------------+
| COLLATION(`test`.`y`(&#39;Hello, planet!&#39;)) |
+-----------------------------------------+
| latin1_bin                              |
+-----------------------------------------+

-- 参数的排序规则：
SELECT @param_coll;
+-------------+
| @param_coll |
+-------------+
| utf8_bin    |
+-------------+
&lt;&lt;/code&gt;&gt;

== 示例：更改默认的字符集为UTF-8
要改变默认的字符集latin1为UTF-8，需要在配置文件my.cnf中进行如下设置：
&lt;&lt;code&gt;&gt;
[client]
...
default-character-set=utf8
...
[mysql]
...
default-character-set=utf8
...
[mysqld]
...
collation-server = utf8_unicode_ci
init-connect=&#39;SET NAMES utf8&#39;
character-set-server = utf8
...
&lt;&lt;/code&gt;&gt;

注意，选项##default-character-set##是一个客户端选项，而非服务端选项。

== See also
* [[string-literals|String literals]]
* [[cast|CAST()]]
* [[convert|CONVERT()]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>