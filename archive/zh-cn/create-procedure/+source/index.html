<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="apple-touch-icon" sizes="180x180" href="/kb/static/images/favicons/apple-touch-icon.159e713979be.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/kb/static/images/favicons/favicon-32x32.bc0ac1d5d11e.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kb/static/images/favicons/favicon-16x16.5801f8f0f34e.png">
    <link rel="shortcut icon" href="/kb/static/images/favicons/favicon.d122d305dee4.ico" type="image/x-icon" />

    <title>CREATE PROCEDURE - Source - MariaDB Knowledge Base</title>

    <link href="/kb/static/css/main.f7633538c846.css" rel="stylesheet" type="text/css" />

    
        <meta name="robots" content="noindex, nofollow">
    

    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="CREATE PROCEDURE - Source" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/zh-cn/create-procedure/+source/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="" />

    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/>
    
</head>
<body class="mpkb nodes autoresize nodes_source jqui" id="nodes_source">





<div id="menu-mobile" class="visible-sm visible-xs">

    <div>
        <div id="mobile-close-menu" class="text-right">
            <a href="javascript:void(0)" title="Close Menu" id="back-main" class="toggle-menu">X<span></span></a>
        </div>
    </div>
    <div class="mainmenu-mobile">
        <ul class="ls-none ul-menu">
            <li data-sub="submenu5"><a class="open-form-search" href="/kb/search/" title="Search">Search </a></li>
            <li data-sub="submenu0"><a href="/products" title="Products">Products</a><span class="arrow-main"></span></li>
            <li data-sub="submenu1"><a href="/services" title="Services">Services</a><span class="arrow-main"></span></li>
            <li data-sub="submenu2"><a href="/resources" title="Resources">Resources</a><span class="arrow-main"></span></li>
            <li data-sub="submenu3"><a href="/about-us" title="About">About</a><span class="arrow-main"></span></li>
            <li data-sub="submenu4"><a href="/contact" title="Contact">Contact</a></li>
        </ul>
    </div>

    <div class="nav-top-mobile">
        <div class="select-box form">

            <ul class="inline-block-md mb-none top-nav">
                <li>

                </li>
                
                    <li>
                        <a href="/kb/user/login?next=/kb/zh-cn/create-procedure/+source/"> Login</a>
                    </li>
                
            </ul>



        </div>
        <p class="text-center copyright">Copyright &copy; 2025 MariaDB. All rights reserved.</p>
    </div>
</div>
<div class="violator-wrap d-none" id="top_violator">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12">
                <div class="violator-outer">
                    <div class="violator-inner">
                        <div class="row">
                            <div class="col-xs-12 col-sm-9 col-lg-7 col-lg-offset-2" id="top_violator_content">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="content-link" target="_blank" rel="nofollow noreferrer">
                                    <span>The Ultimate Guide to High Availability with MariaDB</span>
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-3" id="top_violator_cta">
                                <a href="https://go.mariadb.com/high-availability-guide-MariaDB-whitepaper.html" class="btn btn-mariadb" target="_blank" rel="nofollow noreferrer">Download Now</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-link close-btn">
                        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="15px" height="15px"><path d="M 4.9902344 3.9902344 A 1.0001 1.0001 0 0 0 4.2929688 5.7070312 L 10.585938 12 L 4.2929688 18.292969 A 1.0001 1.0001 0 1 0 5.7070312 19.707031 L 12 13.414062 L 18.292969 19.707031 A 1.0001 1.0001 0 1 0 19.707031 18.292969 L 13.414062 12 L 19.707031 5.7070312 A 1.0001 1.0001 0 0 0 18.980469 3.9902344 A 1.0001 1.0001 0 0 0 18.292969 4.2929688 L 12 10.585938 L 5.7070312 4.2929688 A 1.0001 1.0001 0 0 0 4.9902344 3.9902344 z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="wrapper">
<div id="top-nav">
    <div class="container">
        <ul class="hidden-sm hidden-xs" >
            <li><a href="https://mariadb.com/kb/">Knowledge Base</a></li>
            <li><a href="https://mariadb.com/contact/">Contact</a></li>
            
                
                    <li>
                        <a href="/kb/user/login?next=/kb/zh-cn/create-procedure/+source/" rel="nofollow">Login</a>
                    </li>
                
            
            
            <li id="search-form">
                <form action="/kb/zh-cn/+search/" method="get" id="search-block-form" accept-charset="UTF-8">
                    <input id="search" title="Enter the terms you wish to search for."
                           placeholder="Search . . ." type="text"
                           name="q" value="" size="15" maxlength="128" class="form-text"
                           data-autocomplete-url="/kb/zh-cn/+search/autocomplete/">
                    <input type="hidden" name="quick" value="1" />
                    <input type="hidden" name="source" value="kb" />
                </form>
            </li>
            <li><a id="search-toggler" href="/kb/search/">Search</a></li>
            
        </ul>
    </div>
</div>
<div id="navbar-bottom" class="navbar">
    <div class="container">
        
        
        
        
        <div class="row">
            <div class="col-md-3 col-sm-9 col-xs-9">
                <a class="brand" href="/" title="MariaDB">
                    <img src="/kb/static/images/logo-2018-black.95f5978ae14d.png">
                </a>
            </div>
            <div class="col-md-9 hidden-sm hidden-xs">
                <div class="main-menu">
                    <ul id="main-menu" class="nav navbar-nav inline-block-sm">
    <li class="has-sub full-menu">
        <a href="/products" title="Products">Products</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/services" title="Services">Services</a>
    </li>
    <li class="has-sub full-menu active">
        <a href="/pricing" title="Pricing">Pricing</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/resources" title="Resources">Resources</a>
    </li>
    <li class="has-sub full-menu">
        <a href="/about-us" title="About Us">About Us</a>
    </li>
    <li class="">
        <a class="button electric-eel small top-bar-right-download" href="/downloads/">Download</a>
    </li>
</ul>
                </div>
            </div>
            <div class="col-md-3 visible-sm visible-xs col-sm-3 col-xs-3 ps-rv">
                <div class="navbar-header text-right pull-right">
                    <button type="button" class="menu-control toggle-menu" id="open-menu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="main">
    <div class="container">
        

        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                
                <div id="breadcrumbs" class="breadcrumb">
                    <a href="/kb/zh-cn/">Knowledge Base</a>
                    


    
    » <a class="crumb" href="/kb/zh-cn/mariadb/">MariaDB - 简体中文</a>
    

    
    » <a class="crumb" href="/kb/zh-cn/mariadb-server/">MariaDB Server文档</a>
    


    » <a class="node_link crumb" href="/kb/zh-cn/create-procedure/">CREATE PROCEDURE</a>


                </div>
                
            </div>
        </div>
    </div>
    <div class="container" id="container-main">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar col-md-2 hidden-xs hidden-sm hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-pills nav-stacked">
                            <li><a href="/kb/zh-cn/">首页</a></li>
                            
                                
                                    <li><a href="/kb/zh-cn/+questions/">Open Questions</a></li>
                                
                                <li><a href="/kb/zh-cn/documentation/">MariaDB Server</a></li>
                                <li><a href="/kb/zh-cn/maxscale/">MariaDB MaxScale</a></li>
                                <li><a href="/kb/zh-cn/mariadb-columnstore/">MariaDB ColumnStore</a></li>
                                <li><a href="/kb/zh-cn/connectors/">Connectors</a></li>
                            

                        </ul>
                    

                    
                        <div>
    

<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-small" href="/kb/zh-cn/create-procedure/">Return to article</a>
    
</div>
</div>

</div>
                    

                    

































                </aside>
            
            
            
                
            
            
            <section id="content" class="limited_width col-md-10 clearfix">
                
                    <h1>CREATE PROCEDURE - Source</h1>
                

                



                <div>
                    

    

    
    <div class="revision_info">
        <dl class="table">
            <dt>Revision</dt>
            <dd><a href="/kb/zh-cn/create-procedure/+r/67791/">67791</a></dd>
            <dt>用户</dt>
            <dd>
<span class="user" id="user-5480">
<a href="/kb/user/id/5480" title="longshuai Ma">longshuai Ma</a>
</span></dd>
            <dt>Date</dt>
            <dd>

<span class="datetime" title="2018-04-03 07:56">2018-04-03 07:56</span></dd>
        </dl>
    </div>
    


    

    
        
        <textarea id="answer_source" class="creole_source autogrow">== 语法

&lt;&lt;code&gt;&gt;
CREATE
    [OR REPLACE]
    [DEFINER = { user | CURRENT_USER | role | CURRENT_ROLE }]
    PROCEDURE sp_name ([proc_parameter[,...]])
    [characteristic ...] routine_body

proc_parameter:
    [ IN | OUT | INOUT ] param_name type

type:
    Any valid MariaDB data type

characteristic:
    LANGUAGE SQL
  | [NOT] DETERMINISTIC
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }
  | COMMENT &#39;string&#39;

routine_body:
    Valid SQL procedure statement
&lt;&lt;/code&gt;&gt;
&lt;&lt;toc&gt;&gt;

== 描述

用于创建一个存储过程[[stored-procedures|stored procedure]]。默认情况下，存储程序是关联到其默认数据库中的。要想将存储程序关联到一个给定的数据库中，可以在创建时指定完整的存储程序名称db_name.sp_name。 

当调用存储程序时，将隐含了##USE db_name##动作(且程序执行结束时不会再返回)。这使得当执行存储程序时可以直接调用到其关联的数据库中去。在存储程序内部，不能##USE##语句。

当创建了存储过程后，可以使用##CALL##语句来调用它(见[[call|CALL]])。

##CREATE PROCEDURE##语句需要有##CREATE ROUTINE##权限。默认情况下，MariaDB自动授予##ALTER ROUTINE##和##EXECUTE##权限给程序的创建者。更多内容参见：[[stored-routine-privileges|Stored Routine Privileges]]。

##DEFINER##和##SQL SECURITY##子句指定程序执行时，检查权限时所使用的上下文，下文将描述它们。

如果程序的名称和内置的SQL函数同名，则必须在创建存储过程时，过程的名称和括号之间使用一个空格隔开，否则语法错误。同样，在调用存储过程时也如此。基于此，我们建议尽量避免存储程序的名称和内置函数重名。


##IGNORE_SPACE SQL##模式应用于内置函数，而不是存储过程。它允许在存储程序名称后使用空格，而不管是否启用了##IGNORE_SPACE##。

允许使用空参数列表。如果给定了参数，则参数名不区分大小写。

每个参数都可以声明为任意有效的数据类型，但不能使用COLLATE属性。

=== IN/OUT/INOUT
默认每个参数都是##IN##。要指定其他类型的参数，可以在参数名前面使用关键字##OUT##或##INOUT##。

##IN##参数类型表示将调用者给定的值传递给存储过程。存储过程可能会修改这个值，但是对于调用者来说，在存储过程返回结果时，所做的修改是不可见的。

##OUT##参数类型表示将存储过程的返回值传递给调用者。其初始值为NULL，当存储过程返回时，这个值对调用者来说是可见的。

##INOUT##参数类型表示由调用者传递值给存储过程，存储过程可能会修改这个值，当存储过程返回的时候，所做的修改对调用者来说是可见的。

对于每个##OUT##或##INOUT##类型的参数，当调用者在##CALL##语句中调用存储过程时，所传递的每个变量都可以在存储过程返回的时候获取其值。如果你在其他存储过程或存储函数中调用存储过程，你也可以传递##IN##或##INOUT##类型的参数。

=== DETERMINISTIC/NOT DETERMINISTIC
##DETERMINISTIC##和##NOT DETERMINISTIC##只适用于存储函数，将其指定在存储过程中是无意义的。 见[[create-function|CREATE FUNCTION]]。

=== CONTAINS SQL/NO SQL/READS SQL DATA/MODIFIES SQL DATA
##CONTAINS SQL##, ##NO SQL##, ##READS SQL DATA##以及##MODIFIES SQL DATA##是告诉服务器该过程是做什么的信息类子句。但MariaDB不会根据其内容对子句是否符合此处的定义做任何检查。如果没有指定这些参数，则默认使用##CONTAIN SQL##。

##MODIFIES SQL DATA##意味着函数包含了要修改数据库中数据的语句。例如，在函数中使用了类似于 [[DELETE]], [[UPDATE]], [[INSERT]], [[REPLACE]]或DDL类的语句。

##READS SQL DATA##意味着函数将会从数据库中读取数据，但不会修改任何数据。例如，在函数中使用了不带任何写操作的[[SELECT]]语句。

##CONTAINS SQL##意味着函数包含了至少一条SQL语句，但它们不读、不写数据库中的数据。例如函数中使用了[[SET]]或[[DO]]语句。

##NO SQL##不意味着任何事，因为MariaDB目前支持的语言只有SQL语言。

routine_body部分包含有效的SQL语句。这可以是一个简单的SELECT或INSERT语句，也可以是使用[[begin-end|BEGIN and END]]的语句块。语句块中可以包含变量声明、循环以及其他流程控制语句。详细语法信息见：[[programmatic-and-compound-statements|Programmatic and Compound Statements]]。

MariaDB中允许存储过程中使用DDL语句，例如##CREATE##和##DROP##。MariaDB同样允许存储过程包含SQL事务类语句(但[[stored-functions|存储函数]]不允许)，例如##COMMIT##语句。

关于更多的存储程序中不允许使用的语法，见[[stored-routine-limitations|Stored Routine Limitations]]。

=== 在程序中调用存储过程
关于从其他语言接口上调用MariaDB/MySQL的存储过程，见[[call|CALL]]。

=== OR REPLACE
&lt;&lt;product mariadb from=&#34;10.1.3&#34;&gt;&gt;
如果使用了##OR REPLACE##子句，它的行为等价于

&lt;&lt;code lang=mysql inline=false&gt;&gt;
DROP PROCEDURE IF EXISTS name;
CREATE PROCEDURE name ...;
&lt;&lt;/code&gt;&gt;
但不会删除该函数已有的权限[[stored-routine-privileges|privileges]]。
&lt;&lt;/product&gt;&gt;

=== sql_mode

MariaDB会在创建存储过程时保留系统变量[[server-system-variables#sql_mode|sql_mode]]的值。无论以后该系统变量修改为何值，都会使用此时保留的值作为存储过程执行的上下文环境。

=== 字符集和排序规则
存储过程的参数可以声明为任意有效的字符集和排序规则。如果没有指定字符集和排序规则，将在存储过程创建时使用数据库默认的字符集和排序规则。如果之后数据库的字符集和排序规则发生了改变，存储过程的字符集和排序规则不会随之改变。这种情况下，应该删除存储过程并重现创建存储过程，保证存储过程的字符集和排序规则和数据库的设置保持一致。

== 示例

下面是一个使用##OUT##参数类型的简单存储过程。它使用了##DELIMITER##命令设置了语句结束符为##//##。见[[delimiters-in-the-mysql-client|Delimiters in the mysql client]]。

&lt;&lt;code&gt;&gt;
DELIMITER //

CREATE PROCEDURE simpleproc (OUT param1 INT)
 BEGIN
  SELECT COUNT(*) INTO param1 FROM t;
 END;
//

DELIMITER ;

CALL simpleproc(@a);

SELECT @a;
+------+
| @a   |
+------+
|    1 |
+------+
&lt;&lt;/code&gt;&gt;

字符集和排序规则：
&lt;&lt;code&gt;&gt;
DELIMITER //

CREATE PROCEDURE simpleproc2 (
  OUT param1 CHAR(10) CHARACTER SET &#39;utf8&#39; COLLATE &#39;utf8_bin&#39;
)
 BEGIN
  SELECT CONCAT(&#39;a&#39;),f1 INTO param1 FROM t;
 END;
//

DELIMITER ;
&lt;&lt;/code&gt;&gt;

CREATE OR REPLACE:
&lt;&lt;sql&gt;&gt;
DELIMITER //

CREATE PROCEDURE simpleproc2 (
  OUT param1 CHAR(10) CHARACTER SET &#39;utf8&#39; COLLATE &#39;utf8_bin&#39;
)
 BEGIN
  SELECT CONCAT(&#39;a&#39;),f1 INTO param1 FROM t;
 END;
//
ERROR 1304 (42000): PROCEDURE simpleproc2 already exists

DELIMITER ;

DELIMITER //

CREATE OR REPLACE PROCEDURE simpleproc2 (
  OUT param1 CHAR(10) CHARACTER SET &#39;utf8&#39; COLLATE &#39;utf8_bin&#39;
)
 BEGIN
  SELECT CONCAT(&#39;a&#39;),f1 INTO param1 FROM t;
 END;
//
ERROR 1304 (42000): PROCEDURE simpleproc2 already exists

DELIMITER ;
Query OK, 0 rows affected (0.03 sec)
&lt;&lt;/sql&gt;&gt;

== See Also
* [[stored-procedure-overview|Stored Procedure Overview]]
* [[alter-procedure|ALTER PROCEDURE]]
* [[drop-procedure|DROP PROCEDURE]]
* [[show-create-procedure|SHOW CREATE PROCEDURE]]
* [[show-procedure-status|SHOW PROCEDURE STATUS]]
* [[stored-routine-privileges|Stored Routine Privileges]]
* [[information-schema-routines-table|Information Schema ROUTINES Table]]</textarea>
    


                    <div id="content_disclaimer" class="graybox">
                        Content reproduced on this site is the property of its respective owners,
                        and this content is not reviewed in advance by MariaDB. The views, information and opinions
                        expressed by this content do not necessarily represent those of MariaDB or any other party.
                    </div>
                </div>
            </section>

            
        </div>
    </div>
</div>

<!-- Footer -->
<footer id="footer">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="list-inline text-center footer-nav">
                        <li>
                            <h5>
                                <a href="https://mariadb.com/products" title="Products">Products</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/services" title="Services">Services</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/pricing" title="Pricing">Pricing</a>
                            </h5>
                        </li>
                        <li>
                            <h5>
                                <a href="https://mariadb.com/resources" title="Resources">Resources</a>
                            </h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/about-us" title="About MariaDB">About Us</a></h5>
                        </li>
                        <li>
                            <h5><a href="https://mariadb.com/download" title="Download">Download MariaDB</a></h5>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row row-10">
                
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div id="block-footerformcontact" class="block block-block-content block-block-contentd754ee1b-3cc9-40e7-9ef4-f504f1197fb1">
                        
                            <h5 style="font-weight: 400;">Subscribe to our newsletter!</h5>
                            <script src="//app-sj15.marketo.com/js/forms2/js/forms2.min.js"></script><form id="mktoForm_1498"></form>
                            <script>
                                <!--//--><![CDATA[// ><!--
                                MktoForms2.loadForm("//app-sj15.marketo.com", "573-PXI-984", 1498);
                                //--><!]]]]><![CDATA[>
                                //--><!]]>
                            </script>
                        
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-xs-12 item col-md-offset-4">
                    <div class="footer-copyright">
                        <div class="text-center">
                            <ul class="list-inline no-margin">
                                <li>
                                    <a href="/legal" title="Legal">Legal</a>
                                </li>
                                <li>
                                    <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="/cookie-policy/" title="Cookies">Cookie Policy</a>
                                </li>
                            </ul>
                            <p>Copyright &copy; 2025 MariaDB. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</footer>
</div>

<div id="ajax_loading">
    <img src="/kb/static/images/ajax-loader.a51c5608d01a.gif" />
</div>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MK2847"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MK2847');</script>
    <!-- End Google Tag Manager -->

</body>

<script type="text/javascript" src="/kb/static/js/main.1587e3a666fc.js" charset="utf-8"></script>

</html>